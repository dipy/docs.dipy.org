
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>DIPY &#8212; dipy 1.8.0dev0 documentation</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/dipy.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

  
<link rel="stylesheet" href="../../_static/styles/grg-sphinx-theme.css"/>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/reconstruction/reconst_dki';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

  <meta name="keywords" content="DIPY, dMRI, DTI, DSI, diffusion MRI, Tensor,
  neuroimaging, python, neuroscience, Eleftherios, Garyfallidis, tractography,
  streamlines, fiber tracking">




  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">dipy 1.8.0dev0 documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../documentation.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../stateoftheart.html">
                        A quick overview of features
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

</nav>
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../documentation.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../stateoftheart.html">
                        A quick overview of features
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="reconst_qtiplus.html">Applying positivity constraints to Q-space Trajectory Imaging (QTI+)</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_shore.html">Continuous and analytical diffusion signal modelling with 3D-SHORE</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_dsi.html">Reconstruct with Diffusion Spectrum Imaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_dsid.html">DSI Deconvolution vs DSI</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_shore_metrics.html">Calculate SHORE scalar maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_gqi.html">Reconstruct with Generalized Q-Sampling Imaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_csa.html">Reconstruct with Constant Solid Angle (Q-Ball)</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_sfm.html">Reconstruction with the Sparse Fascicle Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_dsi_metrics.html">Calculate DSI-based scalar maps</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Reconstruction of the diffusion signal with the kurtosis tensor model</a></li>
<li class="toctree-l1"><a class="reference internal" href="kfold_xval.html">K-fold cross-validation for model comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_qti.html">Reconstruct with Q-space Trajectory Imaging (QTI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_dti.html">Reconstruction of the diffusion signal with the Tensor model</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_forecast.html">Crossing invariant fiber response function with FORECAST model</a></li>
<li class="toctree-l1"><a class="reference internal" href="restore_dti.html">Using the RESTORE algorithm for robust tensor fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_dki_micro.html">Reconstruction of the diffusion signal with the WMTI model</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_sh.html">Signal Reconstruction Using Spherical Harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_fwdti.html">Using the free water elimination model to remove DTI free water contamination</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_ivim.html">Intravoxel incoherent motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_csd.html">Reconstruction with Constrained Spherical Deconvolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_mcsd.html">Reconstruction with Multi-Shell Multi-Tissue CSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_mapmri.html">Continuous and analytical diffusion signal modelling with MAP-MRI</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_msdki.html">Mean signal diffusion kurtosis imaging (MSDKI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_rumba.html">Reconstruction with Robust and Unbiased Model-BAsed Spherical Deconvolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_qtdmri.html">Estimating diffusion time dependent q-space indices using qt-dMRI</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">DIPY</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
<div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-reconstruction-reconst-dki-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="reconstruction-of-the-diffusion-signal-with-the-kurtosis-tensor-model">
<span id="sphx-glr-auto-examples-reconstruction-reconst-dki-py"></span><h1>Reconstruction of the diffusion signal with the kurtosis tensor model<a class="headerlink" href="#reconstruction-of-the-diffusion-signal-with-the-kurtosis-tensor-model" title="Permalink to this heading">#</a></h1>
<p>The diffusion kurtosis model is an expansion of the diffusion tensor model
(see <a class="reference internal" href="../../examples_built/reconstruction/reconst_dti.html#sphx-glr-examples-built-reconstruction-reconst-dti-py"><span class="std std-ref">Reconstruction of the diffusion signal with the Tensor model</span></a>). In
addition to the diffusion tensor (DT), the diffusion kurtosis model
quantifies the degree to which water diffusion in biological tissues is
non-Gaussian using the kurtosis tensor (KT) <a class="reference internal" href="../../interfaces/reconstruction_flow.html#jensen2005" id="id1"><span>[Jensen2005]</span></a>.</p>
<p>Measurements of non-Gaussian diffusion from the diffusion kurtosis model are of
interest because they can be used to characterize tissue microstructural
heterogeneity <a class="reference internal" href="../../interfaces/reconstruction_flow.html#jensen2010" id="id2"><span>[Jensen2010]</span></a>. Moreover, DKI can be used to: 1) derive concrete
biophysical parameters, such as the density of axonal fibers and diffusion
tortuosity <a class="reference internal" href="../../interfaces/reconstruction_flow.html#fierem2011" id="id3"><span>[Fierem2011]</span></a> (see
<a class="reference internal" href="../../examples_built/reconstruction/reconst_dki_micro.html#sphx-glr-examples-built-reconstruction-reconst-dki-micro-py"><span class="std std-ref">Reconstruction of the diffusion signal with the WMTI model</span></a>); and 2)
resolve crossing fibers in tractography and to obtain invariant rotational
measures not limited to well-aligned fiber populations <a class="reference internal" href="../../interfaces/reconstruction_flow.html#netohe2015" id="id4"><span>[NetoHe2015]</span></a>.</p>
<p>The diffusion kurtosis model expresses the diffusion-weighted signal as:</p>
<div class="math notranslate nohighlight">
\[S(n,b)=S_{0}e^{-bD(n)+\]</div>
<p>rac{1}{6}b^{2}D(n)^{2}K(n)}</p>
<p>where <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> is the applied diffusion weighting (which is dependent on
the measurement parameters), <span class="math notranslate nohighlight">\(S_0\)</span> is the signal in the absence of diffusion
gradient sensitization, <span class="math notranslate nohighlight">\(\mathbf{D(n)}\)</span> is the value of diffusion along
direction <span class="math notranslate nohighlight">\(\mathbf{n}\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{K(n)}\)</span> is the value of kurtosis along
direction <span class="math notranslate nohighlight">\(\mathbf{n}\)</span>. The directional diffusion <span class="math notranslate nohighlight">\(\mathbf{D(n)}\)</span> and kurtosis
<span class="math notranslate nohighlight">\(\mathbf{K(n)}\)</span> can be related to the diffusion tensor (DT) and kurtosis tensor
(KT) using the following equations:</p>
<div class="math notranslate nohighlight">
\[D(n)=\sum_{i=1}^{3}\sum_{j=1}^{3}n_{i}n_{j}D_{ij}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[K(n)=\]</div>
<dl class="simple">
<dt>rac{MD^{2}}{D(n)^{2}}sum_{i=1}^{3}sum_{j=1}^{3}sum_{k=1}^{3}</dt><dd><p>sum_{l=1}^{3}n_{i}n_{j}n_{k}n_{l}W_{ijkl}</p>
</dd>
</dl>
<p>where <span class="math notranslate nohighlight">\(D_{ij}\)</span> are the elements of the second-order DT, and <span class="math notranslate nohighlight">\(W_{ijkl}\)</span> the
elements of the fourth-order KT and <span class="math notranslate nohighlight">\(MD\)</span> is the mean diffusivity. As the DT,
KT has antipodal symmetry and thus only 15 Wijkl elements are needed to fully
characterize the KT:</p>
<div class="math notranslate nohighlight">
\[egin{matrix} ( &amp; W_{xxxx} &amp; W_{yyyy} &amp; W_{zzzz} &amp; W_{xxxy} &amp; W_{xxxz}
                 &amp; ... \
                 &amp; W_{xyyy} &amp; W_{yyyz} &amp; W_{xzzz} &amp; W_{yzzz} &amp; W_{xxyy}
                 &amp; ... \
                 &amp; W_{xxzz} &amp; W_{yyzz} &amp; W_{xxyz} &amp; W_{xyyz} &amp; W_{xyzz}
                 &amp; &amp; )\end{matrix}\]</div>
<p>In the following example we show how to fit the diffusion kurtosis model on
diffusion-weighted multi-shell datasets and how to estimate diffusion kurtosis
based statistics.</p>
<p>First, we import all relevant modules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">dipy.reconst.dki</span> <span class="k">as</span> <span class="nn">dki</span>
<span class="kn">import</span> <span class="nn">dipy.reconst.dti</span> <span class="k">as</span> <span class="nn">dti</span>
<span class="kn">from</span> <span class="nn">dipy.core.gradients</span> <span class="kn">import</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.gradient_table" title="dipy.core.gradients.gradient_table" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-function"><span class="n">gradient_table</span></a>
<span class="kn">from</span> <span class="nn">dipy.data</span> <span class="kn">import</span> <span class="n">get_fnames</span>
<span class="kn">from</span> <span class="nn">dipy.io.gradients</span> <span class="kn">import</span> <span class="n">read_bvals_bvecs</span>
<span class="kn">from</span> <span class="nn">dipy.io.image</span> <span class="kn">import</span> <a href="../../reference/dipy.io.html#dipy.io.image.load_nifti" title="dipy.io.image.load_nifti" class="sphx-glr-backref-module-dipy-io-image sphx-glr-backref-type-py-function"><span class="n">load_nifti</span></a>
<span class="kn">from</span> <span class="nn">dipy.segment.mask</span> <span class="kn">import</span> <a href="../../reference/dipy.segment.html#dipy.segment.mask.median_otsu" title="dipy.segment.mask.median_otsu" class="sphx-glr-backref-module-dipy-segment-mask sphx-glr-backref-type-py-function"><span class="n">median_otsu</span></a>
<span class="kn">from</span> <span class="nn">dipy.viz.plotting</span> <span class="kn">import</span> <a href="../../reference/dipy.viz.html#dipy.viz.plotting.compare_maps" title="dipy.viz.plotting.compare_maps" class="sphx-glr-backref-module-dipy-viz-plotting sphx-glr-backref-type-py-function"><span class="n">compare_maps</span></a>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter</span>
</pre></div>
</div>
<p>DKI requires multi-shell data, i.e. data acquired from more than one non-zero
b-value. Here, we use fetch to download a multi-shell dataset which was kindly
provided by Hansen and Jespersen (more details about the data are provided in
their paper <a class="reference internal" href="../../interfaces/basic_flow.html#hansen2016" id="id5"><span>[Hansen2016]</span></a>). The total size of the downloaded data is 192
MBytes, however you only need to fetch it once.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fraw</span><span class="p">,</span> <span class="n">fbval</span><span class="p">,</span> <span class="n">fbvec</span><span class="p">,</span> <span class="n">t1_fname</span> <span class="o">=</span> <span class="n">get_fnames</span><span class="p">(</span><span class="s1">&#39;cfin_multib&#39;</span><span class="p">)</span>

<span class="n">data</span><span class="p">,</span> <span class="n">affine</span> <span class="o">=</span> <a href="../../reference/dipy.io.html#dipy.io.image.load_nifti" title="dipy.io.image.load_nifti" class="sphx-glr-backref-module-dipy-io-image sphx-glr-backref-type-py-function"><span class="n">load_nifti</span></a><span class="p">(</span><span class="n">fraw</span><span class="p">)</span>
<span class="n">bvals</span><span class="p">,</span> <span class="n">bvecs</span> <span class="o">=</span> <span class="n">read_bvals_bvecs</span><span class="p">(</span><span class="n">fbval</span><span class="p">,</span> <span class="n">fbvec</span><span class="p">)</span>
<span class="n">gtab</span> <span class="o">=</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.gradient_table" title="dipy.core.gradients.gradient_table" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-function"><span class="n">gradient_table</span></a><span class="p">(</span><span class="n">bvals</span><span class="p">,</span> <span class="n">bvecs</span><span class="p">)</span>
</pre></div>
</div>
<p>Function <code class="docutils literal notranslate"><span class="pre">get_fnames</span></code> downloads and outputs the paths of the data,
<code class="docutils literal notranslate"><span class="pre">load_nifti</span></code> returns the data as a nibabel Nifti1Image object, and
<code class="docutils literal notranslate"><span class="pre">read_bvals_bvecs</span></code> loads the arrays containing the information about the
b-values and b-vectors. These later arrays are converted to the GradientTable
object required for <a class="reference external" href="http://dipy.org">Dipy</a>’s data reconstruction.</p>
<p>Before fitting the data, we perform some data pre-processing. We first compute
a brain mask to avoid unnecessary calculations on the background of the image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">maskdata</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <a href="../../reference/dipy.segment.html#dipy.segment.mask.median_otsu" title="dipy.segment.mask.median_otsu" class="sphx-glr-backref-module-dipy-segment-mask sphx-glr-backref-type-py-function"><span class="n">median_otsu</span></a><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">vol_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">median_radius</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">numpass</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                             <span class="n">autocrop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dilate</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Since the diffusion kurtosis models involves the estimation of a large number
of parameters <a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#taxcmw2015" id="id6"><span>[TaxCMW2015]</span></a> and since the non-Gaussian components of the
diffusion signal are more sensitive to artefacts <a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#netohe2012" id="id7"><span>[NetoHe2012]</span></a>, it might be
favorable to suppress the effects of noise and artefacts before diffusion
kurtosis fitting. In this example the effects of noise and artefacts are
suppress by using 3D Gaussian smoothing (with a Gaussian kernel with
fwhm=1.25) as suggested by pioneer DKI studies (e.g. <a class="reference internal" href="../../interfaces/reconstruction_flow.html#jensen2005" id="id8"><span>[Jensen2005]</span></a>,
<a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#netohe2012" id="id9"><span>[NetoHe2012]</span></a>). Although here the Gaussian smoothing is used so that results
are comparable to these studies, it is important to note that more advanced
noise and artifact suppression algorithms are available in <a class="reference external" href="http://dipy.org">DIPY</a>, e.g. the
Marcenko-Pastur PCA denoising algorithm
(<a class="reference internal" href="../../examples_built/preprocessing/denoise_mppca.html#sphx-glr-examples-built-preprocessing-denoise-mppca-py"><span class="std std-ref">Denoise images using the Marcenko-Pastur PCA algorithm</span></a>) and
the Gibbs artefact suppression algorithm
(<a class="reference internal" href="../../examples_built/preprocessing/denoise_gibbs.html#sphx-glr-examples-built-preprocessing-denoise-gibbs-py"><span class="std std-ref">Suppress Gibbs oscillations</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fwhm</span> <span class="o">=</span> <span class="mf">1.25</span>
<span class="n">gauss_std</span> <span class="o">=</span> <span class="n">fwhm</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># converting fwhm to Gaussian std</span>
<span class="n">data_smooth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">data_smooth</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">gaussian_filter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">v</span><span class="p">],</span> <span class="n">sigma</span><span class="o">=</span><span class="n">gauss_std</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that we have loaded and pre-processed the data we can go forward
with DKI fitting. For this, the DKI model is first defined for the data’s
GradientTable object by instantiating the DiffusionKurtosisModel object in the
following way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dkimodel</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.dki.DiffusionKurtosisModel" title="dipy.reconst.dki.DiffusionKurtosisModel" class="sphx-glr-backref-module-dipy-reconst-dki sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dki</span><span class="o">.</span><span class="n">DiffusionKurtosisModel</span></a><span class="p">(</span><span class="n">gtab</span><span class="p">)</span>
</pre></div>
</div>
<p>To fit the data using the defined model object, we call the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function of
this object. For the purpose of this example, we will only fit a single slice of
the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_smooth</span> <span class="o">=</span> <span class="n">data_smooth</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">dkifit</span> <span class="o">=</span> <span class="n">dkimodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_smooth</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
<p>The fit method creates a DiffusionKurtosisFit object, which contains all the
diffusion and kurtosis fitting parameters and other DKI attributes. For
instance, since the diffusion kurtosis model estimates the diffusion tensor,
all standard diffusion tensor statistics can be computed from the
DiffusionKurtosisFit instance. For example, we can extract the fractional
anisotropy (FA), the mean diffusivity (MD), the axial diffusivity (AD) and the
radial diffusivity (RD) from the DiffusionKurtosisiFit instance. Of course,
these measures can also be computed from DIPY’s <code class="docutils literal notranslate"><span class="pre">TensorModel</span></code> fit, and should
be analogous; however, theoretically, the diffusion statistics from the kurtosis
model are expected to have better accuracy, since DKI’s diffusion tensor are
decoupled from higher order terms effects <a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#veraar2011" id="id10"><span>[Veraar2011]</span></a>, <a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#netohe2012" id="id11"><span>[NetoHe2012]</span></a>. Below we
compare the FA, MD, AD, and RD, computed from both DTI and DKI.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tenmodel</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.dti.TensorModel" title="dipy.reconst.dti.TensorModel" class="sphx-glr-backref-module-dipy-reconst-dti sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dti</span><span class="o">.</span><span class="n">TensorModel</span></a><span class="p">(</span><span class="n">gtab</span><span class="p">)</span>
<span class="n">tenfit</span> <span class="o">=</span> <span class="n">tenmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_smooth</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>

<span class="n">fits</span> <span class="o">=</span> <span class="p">[</span><span class="n">tenfit</span><span class="p">,</span> <span class="n">dkifit</span><span class="p">]</span>
<span class="n">maps</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fa&#39;</span><span class="p">,</span> <span class="s1">&#39;md&#39;</span><span class="p">,</span> <span class="s1">&#39;ad&#39;</span><span class="p">,</span> <span class="s1">&#39;rd&#39;</span><span class="p">]</span>
<span class="n">fit_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DTI&#39;</span><span class="p">,</span> <span class="s1">&#39;DKI&#39;</span><span class="p">]</span>
<span class="n">map_kwargs</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="mf">2e-3</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="mf">2e-3</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="mf">2e-3</span><span class="p">}]</span>
<a href="../../reference/dipy.viz.html#dipy.viz.plotting.compare_maps" title="dipy.viz.plotting.compare_maps" class="sphx-glr-backref-module-dipy-viz-plotting sphx-glr-backref-type-py-function"><span class="n">compare_maps</span></a><span class="p">(</span><span class="n">fits</span><span class="p">,</span> <span class="n">maps</span><span class="p">,</span> <span class="n">fit_labels</span><span class="o">=</span><span class="n">fit_labels</span><span class="p">,</span> <span class="n">map_kwargs</span><span class="o">=</span><span class="n">map_kwargs</span><span class="p">,</span>
             <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;Diffusion_tensor_measures_from_DTI_and_DKI.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id22">
<img alt="auto_examples/reconstruction/Diffusion_tensor_measures_from_DTI_and_DKI.png" src="auto_examples/reconstruction/Diffusion_tensor_measures_from_DTI_and_DKI.png" />
<figcaption>
<p><span class="caption-text">Diffusion tensor measures obtained from the diffusion tensor estimated
from DKI (upper panels) and DTI (lower panels).</span><a class="headerlink" href="#id22" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>DTI’s diffusion estimates present lower values than DKI’s estimates,
showing that DTI’s diffusion measurements are underestimated  by higher order
effects.</p>
<p>In addition to the standard diffusion statistics, the DiffusionKurtosisFit
instance can be used to estimate the non-Gaussian measures of mean kurtosis
(MK), the axial kurtosis (AK) and the radial kurtosis (RK).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">maps</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mk&#39;</span><span class="p">,</span> <span class="s1">&#39;ak&#39;</span><span class="p">,</span> <span class="s1">&#39;rk&#39;</span><span class="p">]</span>
<a href="../../reference/dipy.viz.html#dipy.viz.plotting.compare_maps" title="dipy.viz.plotting.compare_maps" class="sphx-glr-backref-module-dipy-viz-plotting sphx-glr-backref-type-py-function"><span class="n">compare_maps</span></a><span class="p">([</span><span class="n">dkifit</span><span class="p">],</span> <span class="n">maps</span><span class="p">,</span> <span class="n">fit_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DKI&#39;</span><span class="p">],</span>
             <span class="n">map_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;vmin&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
             <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;Kurtosis_tensor_standard_measures.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id23">
<img alt="auto_examples/reconstruction/Kurtosis_tensor_standard_measures.png" src="auto_examples/reconstruction/Kurtosis_tensor_standard_measures.png" />
<figcaption>
<p><span class="caption-text">DKI standard kurtosis measures.</span><a class="headerlink" href="#id23" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The non-Gaussian behaviour of the diffusion signal is expected to be higher
when tissue water is confined by multiple compartments. MK is, therefore,
higher in white matter since it is highly compartmentalized by myelin sheaths.
These water diffusion compartmentalization is expected to be more pronounced
perpendicularly to white matter fibers and thus the RK map presents higher
amplitudes than the AK map.</p>
<p>It is important to note that kurtosis estimates might present negative estimates
in deep white matter regions (e.g. the band of dark voxels in the RK map above).
These negative kurtosis values are artefactual and might be induced by:
1) low radial diffusivities of aligned white matter - since it is very hard
to capture non-Gaussian information in radial direction due to it’s low
diffusion decays, radial kurtosis estimates (and consequently the mean
kurtosis estimates) might have low robustness and tendency to exhibit negative
values <a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#netohe2012" id="id12"><span>[NetoHe2012]</span></a>;
2) Gibbs artefacts - MRI images might be corrupted by signal oscillation
artefact between tissue’s edges if an inadequate number of high frequencies of
the k-space is sampled. These oscillations might have different signs on
images acquired with different diffusion-weighted and inducing negative biases
in kurtosis parametric maps <a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#perron2015" id="id13"><span>[Perron2015]</span></a>, <a class="reference internal" href="../../examples_built/reconstruction/reconst_msdki.html#netohe2018" id="id14"><span>[NetoHe2018]</span></a>.</p>
<p>One can try to suppress this issue by using the more advance noise and artefact
suppression algorithms, e.g., as mentioned above, the MP-PCA denoising
(<a class="reference internal" href="../../examples_built/preprocessing/denoise_mppca.html#sphx-glr-examples-built-preprocessing-denoise-mppca-py"><span class="std std-ref">Denoise images using the Marcenko-Pastur PCA algorithm</span></a>) and Gibbs
Unringing (<a class="reference internal" href="../../examples_built/preprocessing/denoise_gibbs.html#sphx-glr-examples-built-preprocessing-denoise-gibbs-py"><span class="std std-ref">Suppress Gibbs oscillations</span></a>)
algorithms. Alternatively, one can overcome this artefact by computing the
kurtosis values from powder-averaged diffusion-weighted signals. The details on
how to compute the kurtosis from powder-average signals in dipy are described
in follow the tutorial
(<a class="reference internal" href="../../examples_built/reconstruction/reconst_msdki.html#sphx-glr-examples-built-reconstruction-reconst-msdki-py"><span class="std std-ref">Mean signal diffusion kurtosis imaging (MSDKI)</span></a>). Finally, one
can use constrained optimization to ensure that the fitted parameters are
physically plausible <a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#delaha2020" id="id15"><span>[DelaHa2020]</span></a>, as we will illustrate in the next section.
Ideally though, artefacts such as Gibbs ringing should be corrected for as well
as possible before using constrained optimization.</p>
<section id="constrained-optimization-for-dki">
<h2>Constrained optimization for DKI<a class="headerlink" href="#constrained-optimization-for-dki" title="Permalink to this heading">#</a></h2>
<p>When instantiating the DiffusionKurtosisModel, the model can be set up to use
constraints with the option <cite>fit_method=’CLS’</cite> (for ordinary least squares) or
with <cite>fit_method=’CWLS’</cite> (for weighted least squares). Constrained fitting takes
more time than unconstrained fitting, but is generally recommended to prevent
physically unplausible parameter estimates <a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#delaha2020" id="id16"><span>[DelaHa2020]</span></a>. For performance
purposes it is recommended to use the MOSEK solver (<a class="reference external" href="https://www.mosek.com/">https://www.mosek.com/</a>) by
setting <code class="docutils literal notranslate"><span class="pre">cvxpy_solver='MOSEK'</span></code>. Different solvers can differ greatly in terms
of runtime and solution accuracy, and in some cases solvers may show warnings
about convergence or recommended option settings.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In certain atypical scenarios, the DKI+ constraints could potentially be
too restrictive. Always check the results of a constrained fit with their
unconstrained counterpart to verify that there are no unexpected
qualitative differences.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dkimodel_plus</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.dki.DiffusionKurtosisModel" title="dipy.reconst.dki.DiffusionKurtosisModel" class="sphx-glr-backref-module-dipy-reconst-dki sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dki</span><span class="o">.</span><span class="n">DiffusionKurtosisModel</span></a><span class="p">(</span><span class="n">gtab</span><span class="p">,</span> <span class="n">fit_method</span><span class="o">=</span><span class="s1">&#39;CLS&#39;</span><span class="p">)</span>
<span class="n">dkifit_plus</span> <span class="o">=</span> <span class="n">dkimodel_plus</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_smooth</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
<p>We can now compare the kurtosis measures obtained with the constrained fit to
the measures obtained before, where we see that many of the artefactual voxels
have now been corrected. In particular outliers caused by pure noise – instead
of for example acquisition artefacts – can be corrected with this method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../reference/dipy.viz.html#dipy.viz.plotting.compare_maps" title="dipy.viz.plotting.compare_maps" class="sphx-glr-backref-module-dipy-viz-plotting sphx-glr-backref-type-py-function"><span class="n">compare_maps</span></a><span class="p">([</span><span class="n">dkifit_plus</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;mk&#39;</span><span class="p">,</span> <span class="s1">&#39;ak&#39;</span><span class="p">,</span> <span class="s1">&#39;rk&#39;</span><span class="p">],</span> <span class="n">fit_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DKI+&#39;</span><span class="p">],</span>
             <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;Kurtosis_tensor_standard_measures_plus.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id24">
<img alt="auto_examples/reconstruction/Kurtosis_tensor_standard_measures_plus.png" src="auto_examples/reconstruction/Kurtosis_tensor_standard_measures_plus.png" />
<figcaption>
<p><span class="caption-text">DKI standard kurtosis measures obtained with constrained optimization.</span><a class="headerlink" href="#id24" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>When using constrained optimization, the expected range of the kurtosis measures
is also naturally constrained, and so does not typically require additional
clipping.</p>
<p>Finally, constrained optimization obviates the need for smoothing in many cases:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dkifit_noisy</span> <span class="o">=</span> <span class="n">dkimodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
<span class="n">dkifit_noisy_plus</span> <span class="o">=</span> <span class="n">dkimodel_plus</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">9</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>

<a href="../../reference/dipy.viz.html#dipy.viz.plotting.compare_maps" title="dipy.viz.plotting.compare_maps" class="sphx-glr-backref-module-dipy-viz-plotting sphx-glr-backref-type-py-function"><span class="n">compare_maps</span></a><span class="p">([</span><span class="n">dkifit_noisy</span><span class="p">,</span> <span class="n">dkifit_noisy_plus</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;mk&#39;</span><span class="p">,</span> <span class="s1">&#39;ak&#39;</span><span class="p">,</span> <span class="s1">&#39;rk&#39;</span><span class="p">],</span>
             <span class="n">fit_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DKI&#39;</span><span class="p">,</span> <span class="s1">&#39;DKI+&#39;</span><span class="p">],</span> <span class="n">map_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;vmin&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
             <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;Kurtosis_tensor_standard_measures_noisy.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id25">
<img alt="auto_examples/reconstruction/Kurtosis_tensor_standard_measures_noisy.png" src="auto_examples/reconstruction/Kurtosis_tensor_standard_measures_noisy.png" />
<figcaption>
<p><span class="caption-text">DKI standard kurtosis measures obtained on unsmoothed data with constrained
optimization.</span><a class="headerlink" href="#id25" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="mean-kurtosis-tensor-and-kurtosis-fractional-anisotropy">
<h2>Mean kurtosis tensor and kurtosis fractional anisotropy<a class="headerlink" href="#mean-kurtosis-tensor-and-kurtosis-fractional-anisotropy" title="Permalink to this heading">#</a></h2>
<p>As pointed by previous studies <a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#hansen2013" id="id17"><span>[Hansen2013]</span></a>, axial, radial and mean kurtosis
depends on the information of both diffusion and kurtosis tensor. DKI measures
that only depend on the kurtosis tensor include the mean of the kurtosis tensor
<a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#hansen2013" id="id18"><span>[Hansen2013]</span></a>, and the kurtosis fractional anisotropy <a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#glennr2015" id="id19"><span>[GlennR2015]</span></a>. These
measures are computed and illustrated below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../reference/dipy.viz.html#dipy.viz.plotting.compare_maps" title="dipy.viz.plotting.compare_maps" class="sphx-glr-backref-module-dipy-viz-plotting sphx-glr-backref-type-py-function"><span class="n">compare_maps</span></a><span class="p">([</span><span class="n">dkifit_plus</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;mkt&#39;</span><span class="p">,</span> <span class="s1">&#39;kfa&#39;</span><span class="p">],</span> <span class="n">fit_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DKI+&#39;</span><span class="p">],</span>
             <span class="n">map_kwargs</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;vmin&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;vmin&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}],</span>
             <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;Measures_from_kurtosis_tensor_only.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id26">
<img alt="auto_examples/reconstruction/Measures_from_kurtosis_tensor_only.png" src="auto_examples/reconstruction/Measures_from_kurtosis_tensor_only.png" />
<figcaption>
<p><span class="caption-text">DKI measures obtained from the kurtosis tensor only.</span><a class="headerlink" href="#id26" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>As reported by <a class="reference internal" href="../../examples_built/reconstruction/reconst_dki.html#hansen2013" id="id20"><span>[Hansen2013]</span></a>, the mean of the kurtosis tensor (MKT) produces
similar maps than the standard mean kurtosis (MK). On the other hand,
the kurtosis fractional anisotropy (KFA) maps shows that the kurtosis tensor
have different degrees of anisotropy than the FA measures from the diffusion
tensor.</p>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<div role="list" class="citation-list">
<div class="citation" id="jensen2005" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Jensen2005<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id8">2</a>)</span>
<p>Jensen JH, Helpern JA, Ramani A, Lu H, Kaczynski K (2005).
Diffusional Kurtosis Imaging: The Quantification of
Non_Gaussian Water Diffusion by Means of Magnetic Resonance
Imaging. Magnetic Resonance in Medicine 53: 1432-1440</p>
</div>
<div class="citation" id="jensen2010" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">Jensen2010</a><span class="fn-bracket">]</span></span>
<p>Jensen JH, Helpern JA (2010). MRI quantification of
non-Gaussian water diffusion by kurtosis analysis. NMR in
Biomedicine 23(7): 698-710</p>
</div>
<div class="citation" id="fierem2011" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">Fierem2011</a><span class="fn-bracket">]</span></span>
<p>Fieremans E, Jensen JH, Helpern JA (2011). White matter
characterization with diffusion kurtosis imaging. NeuroImage
58: 177-188</p>
</div>
<div class="citation" id="veraar2011" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">Veraar2011</a><span class="fn-bracket">]</span></span>
<p>Veraart J, Poot DH, Van Hecke W, Blockx I, Van der Linden A,
Verhoye M, Sijbers J (2011). More Accurate Estimation of
Diffusion Tensor Parameters Using Diffusion Kurtosis Imaging.
Magnetic Resonance in Medicine 65(1): 138-145</p>
</div>
<div class="citation" id="netohe2012" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>NetoHe2012<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id7">1</a>,<a role="doc-backlink" href="#id9">2</a>,<a role="doc-backlink" href="#id11">3</a>,<a role="doc-backlink" href="#id12">4</a>)</span>
<p>Neto Henriques R, Ferreira H, Correia M, (2012). Diffusion
kurtosis imaging of the healthy human brain. Master
Dissertation Bachelor and Master Programin Biomedical
Engineering and Biophysics, Faculty of Sciences.
<a class="reference external" href="http://repositorio.ul.pt/bitstream/10451/8511/1/ulfc104137_tm_Rafael_Henriques.pdf">http://repositorio.ul.pt/bitstream/10451/8511/1/ulfc104137_tm_Rafael_Henriques.pdf</a></p>
</div>
<div class="citation" id="hansen2013" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Hansen2013<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id17">1</a>,<a role="doc-backlink" href="#id18">2</a>,<a role="doc-backlink" href="#id20">3</a>)</span>
<p>Hansen B, Lund TE, Sangill R, and Jespersen SN (2013).
Experimentally and computationally393fast method for estimation
of a mean kurtosis. Magnetic Resonance in Medicine 69,
1754–1760.394doi:10.1002/mrm.24743</p>
</div>
<div class="citation" id="glennr2015" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id19">GlennR2015</a><span class="fn-bracket">]</span></span>
<p>Glenn GR, Helpern JA, Tabesh A, Jensen JH (2015).
Quantitative assessment of diffusional387kurtosis anisotropy.
NMR in Biomedicine28, 448–459. doi:10.1002/nbm.3271</p>
</div>
<div class="citation" id="netohe2015" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">NetoHe2015</a><span class="fn-bracket">]</span></span>
<p>Neto Henriques R, Correia MM, Nunes RG, Ferreira HA (2015).
Exploring the 3D geometry of the diffusion kurtosis tensor -
Impact on the development of robust tractography procedures and
novel biomarkers, NeuroImage 111: 85-99</p>
</div>
<div class="citation" id="perron2015" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">Perron2015</a><span class="fn-bracket">]</span></span>
<p>Perrone D, Aelterman J, Pižurica A, Jeurissen B, Philips W,
Leemans A, (2015). The effect of Gibbs ringing artifacts on
measures derived from diffusion MRI. Neuroimage 120, 441-455.
<a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2015.06.068">https://doi.org/10.1016/j.neuroimage.2015.06.068</a>.</p>
</div>
<div class="citation" id="taxcmw2015" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">TaxCMW2015</a><span class="fn-bracket">]</span></span>
<p>Tax CMW, Otte WM, Viergever MA, Dijkhuizen RM, Leemans A
(2014). REKINDLE: Robust extraction of kurtosis INDices with
linear estimation. Magnetic Resonance in Medicine 73(2):
794-808.</p>
</div>
<div class="citation" id="hansen2016" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">Hansen2016</a><span class="fn-bracket">]</span></span>
<p>Hansen, B, Jespersen, SN (2016). Data for evaluation of fast
kurtosis strategies, b-value optimization and exploration of
diffusion MRI contrast. Scientific Data 3: 160072
doi:10.1038/sdata.2016.72</p>
</div>
<div class="citation" id="netohe2018" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id14">NetoHe2018</a><span class="fn-bracket">]</span></span>
<p>Neto Henriques R (2018). Advanced Methods for Diffusion MRI
Data Analysis and their Application to the Healthy Ageing Brain
(Doctoral thesis). <a class="reference external" href="https://doi.org/10.17863/CAM.29356">https://doi.org/10.17863/CAM.29356</a></p>
</div>
<div class="citation" id="delaha2020" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>DelaHa2020<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id15">1</a>,<a role="doc-backlink" href="#id16">2</a>)</span>
<p>Dela Haije et al. “Enforcing necessary non-negativity
constraints for common diffusion MRI models using sum of squares
programming”. NeuroImage 209, 2020, 116405.</p>
</div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.000 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-reconstruction-reconst-dki-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/6d53341ed182aa40da0d583c9acdf3d5/reconst_dki.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">reconst_dki.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5e9739f4256c978c63ff31c831a2fb32/reconst_dki.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">reconst_dki.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</section>

<div class="section ablog__blog_comments">
  
  
</div>

                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constrained-optimization-for-dki">Constrained optimization for DKI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-kurtosis-tensor-and-kurtosis-fractional-anisotropy">Mean kurtosis tensor and kurtosis fractional anisotropy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  
<script type="module" src="../../_static/scripts/grg-sphinx-theme.js"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2008-2023, dipy developers &lt;neuroimaging@python.org&gt;.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

    <div class="copyright-text">
      <i class="fa-regular fa-copyright"></i> 
    </div>
  </footer>
  </body>
</html>