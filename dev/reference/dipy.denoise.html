
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>denoise &#8212; dipy 1.11.0 documentation</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/css/dipy.css?v=cedb193d" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

  
<link rel="stylesheet" href="../_static/styles/grg-sphinx-theme.css"/>

    <script src="../_static/documentation_options.js?v=6cf1fb80"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D610GKJZRC"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/dipy.denoise';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.dipy.org/dev/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.11.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="icon" href="../_static/dipy-favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="direction" href="dipy.direction.html" />
    <link rel="prev" title="data" href="dipy.data.html" />
  <meta name="keywords" content="DIPY, dMRI, DTI, DSI, diffusion MRI, Tensor,
  neuroimaging, python, neuroscience, Eleftherios, Garyfallidis, tractography,
  streamlines, fiber tracking">

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
     
  

<a class="navbar-brand logo" href="https://dipy.org">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/dipy-logo.png" class="logo__image only-light" alt="DIPY"/>
    <script>document.write(`<img src="../_static/dipy-logo.png" class="logo__image only-dark" alt="DIPY"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../examples_built/index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

</nav>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../examples_built/index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dipy.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dipy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.align.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">align</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.core.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">core</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.data.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">data</span></code></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.direction.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">direction</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.io.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">io</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.nn.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nn</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.reconst.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">reconst</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.segment.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">segment</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.sims.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sims</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.stats.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stats</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.tracking.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tracking</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.version.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.viz.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">viz</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.workflows.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">workflows</span></code></a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><code...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-dipy.denoise">
<span id="denoise"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise</span></code><a class="headerlink" href="#module-dipy.denoise" title="Link to this heading">#</a></h1>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
<section id="module-dipy.denoise.adaptive_soft_matching">
<span id="module-denoise-adaptive-soft-matching"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.adaptive_soft_matching</span></code><a class="headerlink" href="#module-dipy.denoise.adaptive_soft_matching" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.adaptive_soft_matching.adaptive_soft_matching" title="dipy.denoise.adaptive_soft_matching.adaptive_soft_matching"><code class="xref py py-obj docutils literal notranslate"><span class="pre">adaptive_soft_matching</span></code></a>(ima, fimau, fimao, sigma)</p></td>
<td><p>Adaptive Soft Coefficient Matching</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.denoise.gibbs">
<span id="module-denoise-gibbs"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.gibbs</span></code><a class="headerlink" href="#module-dipy.denoise.gibbs" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.gibbs.gibbs_removal" title="dipy.denoise.gibbs.gibbs_removal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gibbs_removal</span></code></a>(vol, *[, slice_axis, ...])</p></td>
<td><p>Suppresses Gibbs ringing artefacts of images volumes.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.denoise.localpca">
<span id="module-denoise-localpca"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.localpca</span></code><a class="headerlink" href="#module-dipy.denoise.localpca" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.localpca.dimensionality_problem_message" title="dipy.denoise.localpca.dimensionality_problem_message"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimensionality_problem_message</span></code></a>(arr, ...)</p></td>
<td><p>Message about the number of samples being smaller than one less the dimensionality of the data to be denoised.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.localpca.create_patch_radius_arr" title="dipy.denoise.localpca.create_patch_radius_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_patch_radius_arr</span></code></a>(arr, pr)</p></td>
<td><p>Create the patch radius array from the data to be denoised and the patch radius.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.localpca.compute_patch_size" title="dipy.denoise.localpca.compute_patch_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_patch_size</span></code></a>(patch_radius)</p></td>
<td><p>Compute patch size from the patch radius.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.localpca.compute_num_samples" title="dipy.denoise.localpca.compute_num_samples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_num_samples</span></code></a>(patch_size)</p></td>
<td><p>Compute the number of samples as the dot product of the elements.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.localpca.compute_suggested_patch_radius" title="dipy.denoise.localpca.compute_suggested_patch_radius"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_suggested_patch_radius</span></code></a>(arr, patch_size)</p></td>
<td><p>Compute the suggested patch radius.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.localpca.genpca" title="dipy.denoise.localpca.genpca"><code class="xref py py-obj docutils literal notranslate"><span class="pre">genpca</span></code></a>(arr, *[, sigma, mask, patch_radius, ...])</p></td>
<td><p>General function to perform PCA-based denoising of diffusion datasets.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.localpca.localpca" title="dipy.denoise.localpca.localpca"><code class="xref py py-obj docutils literal notranslate"><span class="pre">localpca</span></code></a>(arr, *[, sigma, mask, ...])</p></td>
<td><p>Performs local PCA denoising.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.localpca.mppca" title="dipy.denoise.localpca.mppca"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mppca</span></code></a>(arr, *[, mask, patch_radius, ...])</p></td>
<td><p>Performs PCA-based denoising using the Marcenko-Pastur distribution.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.denoise.nlmeans">
<span id="module-denoise-nlmeans"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.nlmeans</span></code><a class="headerlink" href="#module-dipy.denoise.nlmeans" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.nlmeans.nlmeans" title="dipy.denoise.nlmeans.nlmeans"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nlmeans</span></code></a>(arr, sigma, *[, mask, patch_radius, ...])</p></td>
<td><p>Non-local means for denoising 3D and 4D images.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.denoise.noise_estimate">
<span id="module-denoise-noise-estimate"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.noise_estimate</span></code><a class="headerlink" href="#module-dipy.denoise.noise_estimate" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.noise_estimate.piesno" title="dipy.denoise.noise_estimate.piesno"><code class="xref py py-obj docutils literal notranslate"><span class="pre">piesno</span></code></a>(data, N, *[, alpha, step, itermax, ...])</p></td>
<td><p>Probabilistic Identification and Estimation of Noise (PIESNO).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.noise_estimate.estimate_sigma" title="dipy.denoise.noise_estimate.estimate_sigma"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_sigma</span></code></a>(arr, *[, ...])</p></td>
<td><p>Standard deviation estimation from local patches</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.denoise.non_local_means">
<span id="module-denoise-non-local-means"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.non_local_means</span></code><a class="headerlink" href="#module-dipy.denoise.non_local_means" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.non_local_means.non_local_means" title="dipy.denoise.non_local_means.non_local_means"><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_local_means</span></code></a>(arr, sigma, *[, mask, ...])</p></td>
<td><p>Non-local means for denoising 3D and 4D images, using blockwise averaging approach.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.denoise.patch2self">
<span id="module-denoise-patch2self"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.patch2self</span></code><a class="headerlink" href="#module-dipy.denoise.patch2self" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.patch2self.vol_denoise" title="dipy.denoise.patch2self.vol_denoise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vol_denoise</span></code></a>(data_dict, b0_idx, dwi_idx, ...)</p></td>
<td><p>Denoise a single 3D volume using train and test phase.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.patch2self.patch2self" title="dipy.denoise.patch2self.patch2self"><code class="xref py py-obj docutils literal notranslate"><span class="pre">patch2self</span></code></a>(data, bvals, *[, patch_radius, ...])</p></td>
<td><p>Patch2Self Denoiser.</p></td>
</tr>
</tbody>
</table>
</div>
<section id="adaptive-soft-matching">
<h3>adaptive_soft_matching<a class="headerlink" href="#adaptive-soft-matching" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.adaptive_soft_matching.adaptive_soft_matching">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.adaptive_soft_matching.</span></span><span class="sig-name descname"><span class="pre">adaptive_soft_matching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ima</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fimau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fimao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/adaptive_soft_matching.html#adaptive_soft_matching"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.adaptive_soft_matching.adaptive_soft_matching" title="Link to this definition">#</a></dt>
<dd><p>Adaptive Soft Coefficient Matching</p>
<p>Combines two filtered 3D-images at different resolutions and the original
image. Returns the resulting combined image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ima</strong><span class="classifier">ndarray</span></dt><dd><p>Original (unfiltered) image</p>
</dd>
<dt><strong>fimau</strong><span class="classifier">3D double array,</span></dt><dd><p>filtered image with optimized non-local means using a small block
(suggested:3x3), which corresponds to a “high resolution” filter.</p>
</dd>
<dt><strong>fimao</strong><span class="classifier">3D double array,</span></dt><dd><p>filtered image with optimized non-local means using a small block
(suggested:5x5), which corresponds to a “low resolution” filter.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">the estimated standard deviation of the Gaussian random variables</span></dt><dd><p>that explain the rician noise. Note: In <a class="footnote-reference brackets" href="#footcite-coupe2012" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> the
rician noise was simulated as sqrt((f+x)^2 + (y)^2) where f is
the pixel value and x and y are independent realizations of a
random variable with Normal distribution, with mean=0 and
standard deviation=h</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fima</strong><span class="classifier">3D double array</span></dt><dd><p>output denoised array which is of the same shape as that of
the input</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div class="docutils container" id="id2">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-coupe2012" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id27">2</a>)</span>
<p>Pierrick Coupé, José V. Manjón, Montserrat Robles, and Louis D. Collins. Adaptive Multiresolution Non-Local Means Filter for 3D MR Image Denoising. <em>IET Image Processing</em>, 6(5):558–568, July 2012. URL: <a class="reference external" href="https://doi.org/10.1049/iet-ipr.2011.0161">https://doi.org/10.1049/iet-ipr.2011.0161</a>, <a class="reference external" href="https://doi.org/10.1049/iet-ipr.2011.0161">doi:10.1049/iet-ipr.2011.0161</a>.</p>
</aside>
</aside>
</div>
</dd></dl>

</section>
<section id="gibbs-removal">
<h3>gibbs_removal<a class="headerlink" href="#gibbs-removal" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.gibbs.gibbs_removal">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.gibbs.</span></span><span class="sig-name descname"><span class="pre">gibbs_removal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vol</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_processes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/gibbs.html#gibbs_removal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.gibbs.gibbs_removal" title="Link to this definition">#</a></dt>
<dd><p>Suppresses Gibbs ringing artefacts of images volumes.</p>
<p>See <a class="footnote-reference brackets" href="#footcite-kellner2016" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> and <a class="footnote-reference brackets" href="#footcite-netohenriques2018" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> for
further details about the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>vol</strong><span class="classifier">ndarray ([X, Y]), ([X, Y, Z]) or ([X, Y, Z, g])</span></dt><dd><p>Matrix containing one volume (3D) or multiple (4D) volumes of images.</p>
</dd>
<dt><strong>slice_axis</strong><span class="classifier">int (0, 1, or 2)</span></dt><dd><p>Data axis corresponding to the number of acquired slices.</p>
</dd>
<dt><strong>n_points</strong><span class="classifier">int, optional</span></dt><dd><p>Number of neighbour points to access local TV (see note).</p>
</dd>
<dt><strong>inplace</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, the input data is replaced with results. Otherwise, returns
a new array.</p>
</dd>
<dt><strong>num_processes</strong><span class="classifier">int or None, optional</span></dt><dd><p>Split the calculation to a pool of children processes. This only
applies to 3D or 4D <cite>data</cite> arrays. Default is 1. If &lt; 0 the maximal
number of cores minus <code class="docutils literal notranslate"><span class="pre">num_processes</span> <span class="pre">+</span> <span class="pre">1</span></code> is used (enter -1 to use
as many cores as possible). 0 raises an error.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>vol</strong><span class="classifier">ndarray ([X, Y]), ([X, Y, Z]) or ([X, Y, Z, g])</span></dt><dd><p>Matrix containing one volume (3D) or multiple (4D) volumes of corrected
images.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For 4D matrix last element should always correspond to the number of
diffusion gradient directions.</p>
<p class="rubric">References</p>
<div class="docutils container" id="id5">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-kellner2016" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p>Elias Kellner, Bibek Dhital, Valerij G. Kiselev, and Marco Reisert. Gibbs-ringing artifact removal based on local subvoxel-shifts. <em>Magnetic Resonance in Medicine</em>, 76(5):1574–1581, 2016. URL: <a class="reference external" href="https://doi.org/10.1002/mrm.26054">https://doi.org/10.1002/mrm.26054</a>, <a class="reference external" href="https://doi.org/10.1002/mrm.26054">doi:10.1002/mrm.26054</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-netohenriques2018" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">3</a><span class="fn-bracket">]</span></span>
<p>Rafael Neto Henriques. <em>Advanced Methods for Diffusion MRI Data Analysis and their Application to the Healthy Ageing Brain</em>. PhD thesis, Cambridge University, Cambridge, United Kingdom, 2018. URL: <a class="reference external" href="https://doi.org/10.17863/CAM.29356">https://doi.org/10.17863/CAM.29356</a>, <a class="reference external" href="https://doi.org/10.17863/CAM.29356">doi:10.17863/CAM.29356</a>.</p>
</aside>
</aside>
</div>
</dd></dl>

</section>
<section id="dimensionality-problem-message">
<h3>dimensionality_problem_message<a class="headerlink" href="#dimensionality-problem-message" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.dimensionality_problem_message">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">dimensionality_problem_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/localpca.html#dimensionality_problem_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.localpca.dimensionality_problem_message" title="Link to this definition">#</a></dt>
<dd><p>Message about the number of samples being smaller than one less the
dimensionality of the data to be denoised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong><span class="classifier">ndarray</span></dt><dd><p>Data to be denoised.</p>
</dd>
<dt><strong>num_samples</strong><span class="classifier">int</span></dt><dd><p>Number of samples.</p>
</dd>
<dt><strong>spr</strong><span class="classifier">int</span></dt><dd><p>Suggested patch radius.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>Message.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="create-patch-radius-arr">
<h3>create_patch_radius_arr<a class="headerlink" href="#create-patch-radius-arr" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.create_patch_radius_arr">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">create_patch_radius_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/localpca.html#create_patch_radius_arr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.localpca.create_patch_radius_arr" title="Link to this definition">#</a></dt>
<dd><p>Create the patch radius array from the data to be denoised and the patch
radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong><span class="classifier">ndarray</span></dt><dd><p>Data to be denoised.</p>
</dd>
<dt><strong>pr</strong><span class="classifier">int or ndarray</span></dt><dd><p>Patch radius.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>patch_radius</strong><span class="classifier">ndarray</span></dt><dd><p>Number of samples.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="compute-patch-size">
<h3>compute_patch_size<a class="headerlink" href="#compute-patch-size" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.compute_patch_size">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">compute_patch_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/localpca.html#compute_patch_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.localpca.compute_patch_size" title="Link to this definition">#</a></dt>
<dd><p>Compute patch size from the patch radius.</p>
<p>it is twice the radius plus one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>patch_radius</strong><span class="classifier">ndarray</span></dt><dd><p>Patch radius.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>Number of samples.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="compute-num-samples">
<h3>compute_num_samples<a class="headerlink" href="#compute-num-samples" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.compute_num_samples">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">compute_num_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/localpca.html#compute_num_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.localpca.compute_num_samples" title="Link to this definition">#</a></dt>
<dd><p>Compute the number of samples as the dot product of the elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>patch_size</strong><span class="classifier">ndarray</span></dt><dd><p>Patch size.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>Number of samples.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="compute-suggested-patch-radius">
<h3>compute_suggested_patch_radius<a class="headerlink" href="#compute-suggested-patch-radius" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.compute_suggested_patch_radius">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">compute_suggested_patch_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/localpca.html#compute_suggested_patch_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.localpca.compute_suggested_patch_radius" title="Link to this definition">#</a></dt>
<dd><p>Compute the suggested patch radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong><span class="classifier">ndarray</span></dt><dd><p>Data to be denoised.</p>
</dd>
<dt><strong>patch_size</strong><span class="classifier">ndarray</span></dt><dd><p>Patch size.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>Suggested patch radius.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="genpca">
<h3>genpca<a class="headerlink" href="#genpca" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.genpca">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">genpca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eig'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/localpca.html#genpca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.localpca.genpca" title="Link to this definition">#</a></dt>
<dd><p>General function to perform PCA-based denoising of diffusion datasets.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>arr</strong><span class="classifier">4D array</span></dt><dd><p>Array of data to be denoised. The dimensions are (X, Y, Z, N), where N
are the diffusion gradient directions. The first 3 dimension must have
size &gt;= 2 * patch_radius + 1 or size = 1.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">float or 3D array, optional</span></dt><dd><p>Standard deviation of the noise estimated from the data. If no sigma
is given, this will be estimated based on random matrix theory
<a class="footnote-reference brackets" href="#footcite-veraart2016b" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>, <a class="footnote-reference brackets" href="#footcite-veraart2016c" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">3D boolean array, optional</span></dt><dd><p>A mask with voxels that are true inside the brain and false outside of
it. The function denoises within the true part and returns zeros
outside of those voxels.</p>
</dd>
<dt><strong>patch_radius</strong><span class="classifier">int or 1D array, optional</span></dt><dd><p>The radius of the local patch to be taken around each voxel (in
voxels). E.g. patch_radius=2 gives 5x5x5 patches.</p>
</dd>
<dt><strong>pca_method</strong><span class="classifier">‘eig’ or ‘svd’, optional</span></dt><dd><p>Use either eigenvalue decomposition (eig) or singular value
decomposition (svd) for principal component analysis. The default
method is ‘eig’ which is faster. However, occasionally ‘svd’ might be
more accurate.</p>
</dd>
<dt><strong>tau_factor</strong><span class="classifier">float, optional</span></dt><dd><p>Thresholding of PCA eigenvalues is done by nulling out eigenvalues that
are smaller than:</p>
<div class="math notranslate nohighlight">
\[\tau = (\tau_{factor} \sigma)^2\]</div>
<p><span class="math notranslate nohighlight">\(\tau_{factor}\)</span> can be set to a predefined values (e.g. <span class="math notranslate nohighlight">\(\tau_{factor} =
2.3\)</span> <a class="footnote-reference brackets" href="#footcite-manjon2013" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>), or automatically calculated using random
matrix theory (in case that <span class="math notranslate nohighlight">\(\tau_{factor}\)</span> is set to None).</p>
</dd>
<dt><strong>return_sigma</strong><span class="classifier">bool, optional</span></dt><dd><p>If true, the Standard deviation of the noise will be returned.</p>
</dd>
<dt><strong>out_dtype</strong><span class="classifier">str or dtype, optional</span></dt><dd><p>The dtype for the output array. Default: output has the same dtype as
the input.</p>
</dd>
<dt><strong>suppress_warning</strong><span class="classifier">bool, optional</span></dt><dd><p>If true, suppress warning caused by patch_size &lt; arr.shape[-1].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>denoised_arr</strong><span class="classifier">4D array</span></dt><dd><p>This is the denoised array of the same size as that of the input data,
clipped to non-negative values.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div class="docutils container" id="id9">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-veraart2016b" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id6">1</a>,<a role="doc-backlink" href="#id17">2</a>)</span>
<p>Jelle Veraart, Els Fieremans, and Dmitry S. Novikov. Diffusion MRI noise mapping using random matrix theory. <em>Magnetic Resonance in Medicine</em>, 76(5):1582–1593, November 2016. URL: <a class="reference external" href="https://doi.org/10.1002/mrm.26059">https://doi.org/10.1002/mrm.26059</a>, <a class="reference external" href="https://doi.org/10.1002/mrm.26059">doi:10.1002/mrm.26059</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-veraart2016c" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id7">1</a>,<a role="doc-backlink" href="#id12">2</a>,<a role="doc-backlink" href="#id14">3</a>,<a role="doc-backlink" href="#id16">4</a>)</span>
<p>Jelle Veraart, Dmitry S. Novikov, Daan Christiaens, Benjamin Ades-aron, Jan Sijbers, and Els Fieremans. Denoising of diffusion MRI using random matrix theory. <em>NeuroImage</em>, 142:394–406, November 2016. URL: <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2016.08.016">https://doi.org/10.1016/j.neuroimage.2016.08.016</a>, <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2016.08.016">doi:10.1016/j.neuroimage.2016.08.016</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-manjon2013" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id8">1</a>,<a role="doc-backlink" href="#id10">2</a>,<a role="doc-backlink" href="#id11">3</a>,<a role="doc-backlink" href="#id13">4</a>,<a role="doc-backlink" href="#id15">5</a>)</span>
<p>José V. Manjón, Pierrick Coupé, Luis Concha, Antonio Buades, D. Louis Collins, and Montserrat Robles. Diffusion Weighted Image Denoising Using Overcomplete Local PCA. <em>PLOS ONE</em>, 8(9):e73021, 2013. URL: <a class="reference external" href="https://doi.org/10.1371/journal.pone.0073021">https://doi.org/10.1371/journal.pone.0073021</a>, <a class="reference external" href="https://doi.org/10.1371/journal.pone.0073021">doi:10.1371/journal.pone.0073021</a>.</p>
</aside>
</aside>
</div>
</dd></dl>

</section>
<section id="localpca">
<h3>localpca<a class="headerlink" href="#localpca" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.localpca">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">localpca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gtab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eig'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/localpca.html#localpca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.localpca.localpca" title="Link to this definition">#</a></dt>
<dd><p>Performs local PCA denoising.</p>
<p>The method follows the algorithm in Manjón <em>et al.</em><a class="footnote-reference brackets" href="#footcite-manjon2013" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>arr</strong><span class="classifier">4D array</span></dt><dd><p>Array of data to be denoised. The dimensions are (X, Y, Z, N), where N
are the diffusion gradient directions.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">float or 3D array, optional</span></dt><dd><p>Standard deviation of the noise estimated from the data. If not given,
calculate using method in Manjón <em>et al.</em><a class="footnote-reference brackets" href="#footcite-manjon2013" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">3D boolean array, optional</span></dt><dd><p>A mask with voxels that are true inside the brain and false outside of
it. The function denoises within the true part and returns zeros
outside of those voxels.</p>
</dd>
<dt><strong>patch_radius</strong><span class="classifier">int or 1D array, optional</span></dt><dd><p>The radius of the local patch to be taken around each voxel (in
voxels). E.g. patch_radius=2 gives 5x5x5 patches.</p>
</dd>
<dt><strong>gtab: gradient table object (optional if sigma is provided)</strong></dt><dd><p>gradient information for the data gives us the bvals and bvecs of
diffusion data, which is needed to calculate noise level if sigma is
not provided.</p>
</dd>
<dt><strong>patch_radius_sigma</strong><span class="classifier">int, optional</span></dt><dd><p>The radius of the local patch to be taken around each voxel (in
voxels) for estimating sigma. E.g. patch_radius_sigma=2 gives
5x5x5 patches.</p>
</dd>
<dt><strong>pca_method</strong><span class="classifier">‘eig’ or ‘svd’, optional</span></dt><dd><p>Use either eigenvalue decomposition (eig) or singular value
decomposition (svd) for principal component analysis. The default
method is ‘eig’ which is faster. However, occasionally ‘svd’ might be
more accurate.</p>
</dd>
<dt><strong>tau_factor</strong><span class="classifier">float, optional</span></dt><dd><p>Thresholding of PCA eigenvalues is done by nulling out eigenvalues that
are smaller than:</p>
<div class="math notranslate nohighlight">
\[\tau = (\tau_{factor} \sigma)^2\]</div>
<p>tau_{factor} can be change to adjust the relationship between the
noise standard deviation and the threshold tau. If tau_{factor} is
set to None, it will be automatically calculated using the
Marcenko-Pastur distribution <a class="footnote-reference brackets" href="#footcite-veraart2016c" id="id12" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>. Default: 2.3
according to Manjón <em>et al.</em><a class="footnote-reference brackets" href="#footcite-manjon2013" id="id13" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>.</p>
</dd>
<dt><strong>return_sigma</strong><span class="classifier">bool, optional</span></dt><dd><p>If true, a noise standard deviation estimate based on the
Marcenko-Pastur distribution is returned <a class="footnote-reference brackets" href="#footcite-veraart2016c" id="id14" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>.</p>
</dd>
<dt><strong>correct_bias</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to correct for bias due to Rician noise. This is an
implementation of equation 8 in <a class="footnote-reference brackets" href="#footcite-manjon2013" id="id15" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>.</p>
</dd>
<dt><strong>out_dtype</strong><span class="classifier">str or dtype, optional</span></dt><dd><p>The dtype for the output array. Default: output has the same dtype as
the input.</p>
</dd>
<dt><strong>suppress_warning</strong><span class="classifier">bool, optional</span></dt><dd><p>If true, suppress warning caused by patch_size &lt; arr.shape[-1].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>denoised_arr</strong><span class="classifier">4D array</span></dt><dd><p>This is the denoised array of the same size as that of the input data,
clipped to non-negative values</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
</dd></dl>

</section>
<section id="mppca">
<h3>mppca<a class="headerlink" href="#mppca" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.mppca">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">mppca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eig'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/localpca.html#mppca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.localpca.mppca" title="Link to this definition">#</a></dt>
<dd><p>Performs PCA-based denoising using the Marcenko-Pastur
distribution.</p>
<p>See <a class="footnote-reference brackets" href="#footcite-veraart2016c" id="id16" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a> for further details about the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong><span class="classifier">4D array</span></dt><dd><p>Array of data to be denoised. The dimensions are (X, Y, Z, N), where N
are the diffusion gradient directions.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">3D boolean array, optional</span></dt><dd><p>A mask with voxels that are true inside the brain and false outside of
it. The function denoises within the true part and returns zeros
outside of those voxels.</p>
</dd>
<dt><strong>patch_radius</strong><span class="classifier">int or 1D array, optional</span></dt><dd><p>The radius of the local patch to be taken around each voxel (in
voxels). E.g. patch_radius=2 gives 5x5x5 patches.</p>
</dd>
<dt><strong>pca_method</strong><span class="classifier">‘eig’ or ‘svd’, optional</span></dt><dd><p>Use either eigenvalue decomposition (eig) or singular value
decomposition (svd) for principal component analysis. The default
method is ‘eig’ which is faster. However, occasionally ‘svd’ might be
more accurate.</p>
</dd>
<dt><strong>return_sigma</strong><span class="classifier">bool, optional</span></dt><dd><p>If true, a noise standard deviation estimate based on the
Marcenko-Pastur distribution is returned <a class="footnote-reference brackets" href="#footcite-veraart2016b" id="id17" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p>
</dd>
<dt><strong>out_dtype</strong><span class="classifier">str or dtype, optional</span></dt><dd><p>The dtype for the output array. Default: output has the same dtype as
the input.</p>
</dd>
<dt><strong>suppress_warning</strong><span class="classifier">bool, optional</span></dt><dd><p>If true, suppress warning caused by patch_size &lt; arr.shape[-1].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>denoised_arr</strong><span class="classifier">4D array</span></dt><dd><p>This is the denoised array of the same size as that of the input data,
clipped to non-negative values</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">3D array (when return_sigma=True)</span></dt><dd><p>Estimate of the spatial varying standard deviation of the noise</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
</dd></dl>

</section>
<section id="nlmeans">
<h3>nlmeans<a class="headerlink" href="#nlmeans" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.nlmeans.nlmeans">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.nlmeans.</span></span><span class="sig-name descname"><span class="pre">nlmeans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rician</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/nlmeans.html#nlmeans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.nlmeans.nlmeans" title="Link to this definition">#</a></dt>
<dd><p>Non-local means for denoising 3D and 4D images.</p>
<p>See :footcite:p:Descoteaux2008a` for further details about the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong><span class="classifier">3D or 4D ndarray</span></dt><dd><p>The array to be denoised</p>
</dd>
<dt><strong>mask</strong><span class="classifier">3D ndarray</span></dt><dd></dd>
<dt><strong>sigma</strong><span class="classifier">float or 3D array</span></dt><dd><p>standard deviation of the noise estimated from the data</p>
</dd>
<dt><strong>patch_radius</strong><span class="classifier">int</span></dt><dd><p>patch size is <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">patch_radius</span> <span class="pre">+</span> <span class="pre">1</span></code>. Default is 1.</p>
</dd>
<dt><strong>block_radius</strong><span class="classifier">int</span></dt><dd><p>block size is <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">block_radius</span> <span class="pre">+</span> <span class="pre">1</span></code>. Default is 5.</p>
</dd>
<dt><strong>rician</strong><span class="classifier">boolean</span></dt><dd><p>If True the noise is estimated as Rician, otherwise Gaussian noise
is assumed.</p>
</dd>
<dt><strong>num_threads</strong><span class="classifier">int, optional</span></dt><dd><p>Number of threads to be used for OpenMP parallelization. If None
(default) the value of OMP_NUM_THREADS environment variable is used
if it is set, otherwise all available threads are used. If &lt; 0 the
maximal number of threads minus <span class="math notranslate nohighlight">\(|num_threads + 1|\)</span> is used (enter -1 to
use as many threads as possible). 0 raises an error.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>denoised_arr</strong><span class="classifier">ndarray</span></dt><dd><p>the denoised <code class="docutils literal notranslate"><span class="pre">arr</span></code> which has the same shape as <code class="docutils literal notranslate"><span class="pre">arr</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
</dd></dl>

</section>
<section id="piesno">
<h3>piesno<a class="headerlink" href="#piesno" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.noise_estimate.piesno">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.noise_estimate.</span></span><span class="sig-name descname"><span class="pre">piesno</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/noise_estimate.html#piesno"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.noise_estimate.piesno" title="Link to this definition">#</a></dt>
<dd><p>Probabilistic Identification and Estimation of Noise (PIESNO).</p>
<p>See <a class="footnote-reference brackets" href="#footcite-koay2009a" id="id18" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a> and <a class="footnote-reference brackets" href="#footcite-koay2009b" id="id19" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a> for further details
about the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">ndarray</span></dt><dd><p>The magnitude signals to analyse. The last dimension must contain the
same realisation of the volume, such as dMRI or fMRI data.</p>
</dd>
<dt><strong>N</strong><span class="classifier">int</span></dt><dd><p>The number of phase array coils of the MRI scanner.
If your scanner does a SENSE reconstruction, ALWAYS use N=1, as the
noise profile is always Rician.
If your scanner does a GRAPPA reconstruction, set N as the number
of phase array coils.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">float</span></dt><dd><p>Probabilistic estimation threshold for the gamma function.</p>
</dd>
<dt><strong>step</strong><span class="classifier">int</span></dt><dd><p>number of initial estimates for sigma to try.</p>
</dd>
<dt><strong>itermax</strong><span class="classifier">int</span></dt><dd><p>Maximum number of iterations to execute if convergence
is not reached.</p>
</dd>
<dt><strong>eps</strong><span class="classifier">float</span></dt><dd><p>Tolerance for the convergence criterion. Convergence is
reached if two subsequent estimates are smaller than eps.</p>
</dd>
<dt><strong>return_mask</strong><span class="classifier">bool</span></dt><dd><p>If True, return a mask identifying all the pure noise voxel
that were found.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>sigma</strong><span class="classifier">float</span></dt><dd><p>The estimated standard deviation of the gaussian noise.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">ndarray, optional</span></dt><dd><p>A boolean mask indicating the voxels identified as pure noise.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function assumes two things : 1. The data has a noisy, non-masked
background and 2. The data is a repetition of the same measurements
along the last axis, i.e. dMRI or fMRI data, not structural data like
T1/T2.</p>
<p>This function processes the data slice by slice, as originally designed in
the paper. Use it to get a slice by slice estimation of the noise, as in
spinal cord imaging for example.</p>
<p class="rubric">References</p>
<div class="docutils container" id="id20">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-koay2009a" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id18">7</a><span class="fn-bracket">]</span></span>
<p>Cheng Guan Koay, Evren Özarslan, and Peter J. Basser. A signal transformational framework for breaking the noise floor and its applications in MRI. <em>Journal of Magnetic Resonance</em>, 197(2):108–119, April 2009. URL: <a class="reference external" href="https://doi.org/10.1016/j.jmr.2008.11.015">https://doi.org/10.1016/j.jmr.2008.11.015</a>, <a class="reference external" href="https://doi.org/10.1016/j.jmr.2008.11.015">doi:10.1016/j.jmr.2008.11.015</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-koay2009b" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id19">8</a><span class="fn-bracket">]</span></span>
<p>Cheng Guan Koay, Evren Özarslan, and Carlo Pierpaoli. Probabilistic Identification and Estimation of Noise (PIESNO): A self-consistent approach and its applications in MRI. <em>Journal of Magnetic Resonance</em>, 199(1):94–103, July 2009. URL: <a class="reference external" href="https://doi.org/10.1016/j.jmr.2009.03.005">https://doi.org/10.1016/j.jmr.2009.03.005</a>, <a class="reference external" href="https://doi.org/10.1016/j.jmr.2009.03.005">doi:10.1016/j.jmr.2009.03.005</a>.</p>
</aside>
</aside>
</div>
</dd></dl>

</section>
<section id="estimate-sigma">
<h3>estimate_sigma<a class="headerlink" href="#estimate-sigma" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.noise_estimate.estimate_sigma">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.noise_estimate.</span></span><span class="sig-name descname"><span class="pre">estimate_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_background_masking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/noise_estimate.html#estimate_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.noise_estimate.estimate_sigma" title="Link to this definition">#</a></dt>
<dd><p>Standard deviation estimation from local patches</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong><span class="classifier">3D or 4D ndarray</span></dt><dd><p>The array to be estimated</p>
</dd>
<dt><strong>disable_background_masking</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, uses all voxels for the estimation, otherwise, only non-zeros
voxels are used. Useful if the background is masked by the scanner.</p>
</dd>
<dt><strong>N</strong><span class="classifier">int, optional</span></dt><dd><p>Number of coils of the receiver array. Use N = 1 in case of a SENSE
reconstruction (Philips scanners) or the number of coils for a GRAPPA
reconstruction (Siemens and GE). Use 0 to disable the correction factor,
as for example if the noise is Gaussian distributed. See
<a class="footnote-reference brackets" href="#footcite-koay2006a" id="id21" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a> for more information.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>sigma</strong><span class="classifier">ndarray</span></dt><dd><p>standard deviation of the noise, one estimation per volume.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is the same as manually taking the standard deviation of the
background and gives one value for the whole 3D array.
It also includes the coil-dependent correction factor from
Koay and Basser<a class="footnote-reference brackets" href="#footcite-koay2006a" id="id22" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a> (see equation 18 in <a class="footnote-reference brackets" href="#footcite-koay2006a" id="id23" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a>) with
theta = 0. Since this function was introduced in <a class="footnote-reference brackets" href="#footcite-coupe2008" id="id24" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a> for
T1 imaging, it is expected to perform ok on diffusion MRI data, but might
oversmooth some regions and leave others un-denoised for spatially varying
noise profiles. Consider using <a class="reference internal" href="#dipy.denoise.noise_estimate.piesno" title="dipy.denoise.noise_estimate.piesno"><code class="xref py py-func docutils literal notranslate"><span class="pre">piesno()</span></code></a> to estimate sigma instead if
visual inaccuracies are apparent in the denoised result.</p>
<p class="rubric">References</p>
<div class="docutils container" id="id25">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-koay2006a" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id21">1</a>,<a role="doc-backlink" href="#id22">2</a>,<a role="doc-backlink" href="#id23">3</a>)</span>
<p>Cheng Guan Koay and Peter J. Basser. Analytically exact correction scheme for signal extraction from noisy magnitude MR signals. <em>Journal of Magnetic Resonance</em>, 179(2):317–322, April 2006. URL: <a class="reference external" href="https://doi.org/10.1016/j.jmr.2006.01.016">https://doi.org/10.1016/j.jmr.2006.01.016</a>, <a class="reference external" href="https://doi.org/10.1016/j.jmr.2006.01.016">doi:10.1016/j.jmr.2006.01.016</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-coupe2008" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id24">1</a>,<a role="doc-backlink" href="#id26">2</a>)</span>
<p>Pierrick Coupé, Pierre Yger, Sylvain Prima, Pierre Hellier, Charles Kervrann, and Christian Barillot. An Optimized Blockwise Nonlocal Means Denoising Filter for 3-D Magnetic Resonance Images. <em>IEEE Transactions on Medical Imaging</em>, 27(4):425–441, 2008. URL: <a class="reference external" href="https://doi.org/10.1109/TMI.2008.2008967">https://doi.org/10.1109/TMI.2008.2008967</a>, <a class="reference external" href="https://doi.org/10.1109/TMI.2007.906087">doi:10.1109/TMI.2007.906087</a>.</p>
</aside>
</aside>
</div>
</dd></dl>

</section>
<section id="non-local-means">
<h3>non_local_means<a class="headerlink" href="#non-local-means" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.non_local_means.non_local_means">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.non_local_means.</span></span><span class="sig-name descname"><span class="pre">non_local_means</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rician</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/non_local_means.html#non_local_means"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.non_local_means.non_local_means" title="Link to this definition">#</a></dt>
<dd><p>Non-local means for denoising 3D and 4D images, using blockwise
averaging approach.</p>
<p>See <a class="footnote-reference brackets" href="#footcite-coupe2008" id="id26" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a> and <a class="footnote-reference brackets" href="#footcite-coupe2012" id="id27" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> for further details
about the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong><span class="classifier">3D or 4D ndarray</span></dt><dd><p>The array to be denoised</p>
</dd>
<dt><strong>mask</strong><span class="classifier">3D ndarray</span></dt><dd><p>Mask on data where the non-local means will be applied.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">float or ndarray</span></dt><dd><p>standard deviation of the noise estimated from the data</p>
</dd>
<dt><strong>patch_radius</strong><span class="classifier">int</span></dt><dd><p>patch size is <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">patch_radius</span> <span class="pre">+</span> <span class="pre">1</span></code>. Default is 1.</p>
</dd>
<dt><strong>block_radius</strong><span class="classifier">int</span></dt><dd><p>block size is <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">block_radius</span> <span class="pre">+</span> <span class="pre">1</span></code>. Default is 5.</p>
</dd>
<dt><strong>rician</strong><span class="classifier">boolean</span></dt><dd><p>If True the noise is estimated as Rician, otherwise Gaussian noise
is assumed.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>denoised_arr</strong><span class="classifier">ndarray</span></dt><dd><p>the denoised <code class="docutils literal notranslate"><span class="pre">arr</span></code> which has the same shape as <code class="docutils literal notranslate"><span class="pre">arr</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
</dd></dl>

</section>
<section id="vol-denoise">
<h3>vol_denoise<a class="headerlink" href="#vol-denoise" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.patch2self.vol_denoise">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.patch2self.</span></span><span class="sig-name descname"><span class="pre">vol_denoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dwi_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0_denoising</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/patch2self.html#vol_denoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.patch2self.vol_denoise" title="Link to this definition">#</a></dt>
<dd><p>Denoise a single 3D volume using train and test phase.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data_dict</strong><span class="classifier">dict</span></dt><dd><dl class="simple">
<dt>Dictionary containing the following:</dt><dd><dl class="simple">
<dt>data_name<span class="classifier">str</span></dt><dd><p>The name of the memmap file containing the memmaped data.</p>
</dd>
<dt>data_dtype<span class="classifier">dtype</span></dt><dd><p>The dtype of the data.</p>
</dd>
<dt>data_shape<span class="classifier">tuple</span></dt><dd><p>The shape of the data.</p>
</dd>
<dt>data_b0s<span class="classifier">ndarray</span></dt><dd><p>Array of all 3D patches flattened out to be 2D for b0 volumes.</p>
</dd>
<dt>data_dwi<span class="classifier">ndarray</span></dt><dd><p>Array of all 3D patches flattened out to be 2D for dwi volumes.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt><strong>b0_idx</strong><span class="classifier">ndarray</span></dt><dd><p>The indices of the b0 volumes.</p>
</dd>
<dt><strong>dwi_idx</strong><span class="classifier">ndarray</span></dt><dd><p>The indices of the dwi volumes.</p>
</dd>
<dt><strong>model</strong><span class="classifier">sklearn.base.RegressorMixin</span></dt><dd><p>This is the model that is initialized from the <cite>_fit_denoising_model</cite> function.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">float</span></dt><dd><p>Regularization parameter only for ridge and lasso regression models.</p>
</dd>
<dt><strong>b0_denoising</strong><span class="classifier">bool</span></dt><dd><p>Skips denoising b0 volumes if set to False.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool</span></dt><dd><p>Show progress of Patch2Self and time taken.</p>
</dd>
<dt><strong>tmp_dir</strong><span class="classifier">str</span></dt><dd><p>The directory to save the temporary files.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>denoised_arr.name</strong><span class="classifier">str</span></dt><dd><p>The name of the memmap file containing the denoised array.</p>
</dd>
<dt><strong>denoised_arr.dtype</strong><span class="classifier">dtype</span></dt><dd><p>The dtype of the denoised array.</p>
</dd>
<dt><strong>denoised_arr.shape</strong><span class="classifier">tuple</span></dt><dd><p>The shape of the denoised array.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="patch2self">
<h3>patch2self<a class="headerlink" href="#patch2self" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.patch2self.patch2self">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.patch2self.</span></span><span class="sig-name descname"><span class="pre">patch2self</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bvals</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ols'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0_denoising</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_negative_vals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_intensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/denoise/patch2self.html#patch2self"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.denoise.patch2self.patch2self" title="Link to this definition">#</a></dt>
<dd><p>Patch2Self Denoiser.</p>
<p>See <a class="footnote-reference brackets" href="#footcite-fadnavis2020" id="id28" role="doc-noteref"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></a> for further details about the method.
See <a class="footnote-reference brackets" href="#footcite-fadnavis2024" id="id29" role="doc-noteref"><span class="fn-bracket">[</span>12<span class="fn-bracket">]</span></a> for further details about the new method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">ndarray</span></dt><dd><p>The 4D noisy DWI data to be denoised.</p>
</dd>
<dt><strong>bvals</strong><span class="classifier">array of shape (N,)</span></dt><dd><p>Array of the bvals from the DWI acquisition</p>
</dd>
<dt><strong>patch_radius</strong><span class="classifier">int or array of shape (3,), optional</span></dt><dd><p>The radius of the local patch to be taken around each voxel (in
voxels). Default: 0 (denoise in blocks of 1x1x1 voxels).</p>
</dd>
<dt><strong>model</strong><span class="classifier">string, or sklearn.base.RegressorMixin</span></dt><dd><p>This will determine the algorithm used to solve the set of linear
equations underlying this model. If it is a string it needs to be
one of the following: {‘ols’, ‘ridge’, ‘lasso’}. Otherwise,
it can be an object that inherits from
<cite>dipy.optimize.SKLearnLinearSolver</cite> or an object with a similar
interface from Scikit-Learn:
<cite>sklearn.linear_model.LinearRegression</cite>,
<cite>sklearn.linear_model.Lasso</cite> or <cite>sklearn.linear_model.Ridge</cite>
and other objects that inherit from <cite>sklearn.base.RegressorMixin</cite>.</p>
</dd>
<dt><strong>b0_threshold</strong><span class="classifier">int, optional</span></dt><dd><p>Threshold for considering volumes as b0.</p>
</dd>
<dt><strong>out_dtype</strong><span class="classifier">str or dtype, optional</span></dt><dd><p>The dtype for the output array. Default: output has the same dtype as
the input.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">float, optional</span></dt><dd><p>Regularization parameter only for ridge regression model.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool, optional</span></dt><dd><p>Show progress of Patch2Self and time taken.</p>
</dd>
<dt><strong>b0_denoising</strong><span class="classifier">bool, optional</span></dt><dd><p>Skips denoising b0 volumes if set to False.</p>
</dd>
<dt><strong>clip_negative_vals</strong><span class="classifier">bool, optional</span></dt><dd><p>Sets negative values after denoising to 0 using <cite>np.clip</cite>.</p>
</dd>
<dt><strong>shift_intensity</strong><span class="classifier">bool, optional</span></dt><dd><p>Shifts the distribution of intensities per volume to give
non-negative values.</p>
</dd>
<dt><strong>tmp_dir</strong><span class="classifier">str, optional</span></dt><dd><p>The directory to save the temporary files. If None, the temporary
files are saved in the system’s default temporary directory. Default: None.</p>
</dd>
<dt><strong>version</strong><span class="classifier">int, optional</span></dt><dd><p>Version 1 or 3 of Patch2Self to use. Default: 3</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>denoised array</strong><span class="classifier">ndarray</span></dt><dd><p>This is the denoised array of the same size as that of the input data,
clipped to non-negative values.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div class="docutils container" id="id30">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-fadnavis2020" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id28">11</a><span class="fn-bracket">]</span></span>
<p>Shreyas Fadnavis, Joshua Batson, and Eleftherios Garyfallidis. Patch2Self: Denoising Diffusion MRI with Self-Supervised Learning. In Hugo Larochelle, Marc’Aurelio Ranzato, Raia Hadsell, Maria-Florina Balcan, and Hsuan-Tien Lin, editors, <em>Advances in Neural Information Processing Systems</em>, volume 33, 16293–16303. Curran Associates, Inc., 2020. URL: <a class="reference external" href="https://proceedings.neurips.cc/paper_files/paper/2020/file/bc047286b224b7bfa73d4cb02de1238d-Paper.pdf">https://proceedings.neurips.cc/paper_files/paper/2020/file/bc047286b224b7bfa73d4cb02de1238d-Paper.pdf</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-fadnavis2024" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id29">12</a><span class="fn-bracket">]</span></span>
<p>Shreyas Fadnavis, Agniva Chowdhury, Joshua Batson, Petros Drineas, and Eleftherios Garyfallidis. Patch2Self2: Self-supervised Denoising on Coresets via Matrix Sketching. In <em>Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, volume, 27641–27651. 2024. URL: <a class="reference external" href="https://openaccess.thecvf.com/content/CVPR2024/papers/Fadnavis_Patch2Self2_Self-supervised_Denoising_on_Coresets_via_Matrix_Sketching_CVPR_2024_paper.pdf">https://openaccess.thecvf.com/content/CVPR2024/papers/Fadnavis_Patch2Self2_Self-supervised_Denoising_on_Coresets_via_Matrix_Sketching_CVPR_2024_paper.pdf</a>.</p>
</aside>
</aside>
</div>
</dd></dl>

</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="dipy.data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">data</span></code></p>
      </div>
    </a>
    <a class="right-next"
       href="dipy.direction.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">direction</span></code></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.adaptive_soft_matching">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.adaptive_soft_matching</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.gibbs">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.gibbs</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.localpca">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.localpca</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.nlmeans">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.nlmeans</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.noise_estimate">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.noise_estimate</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.non_local_means">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.non_local_means</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.patch2self">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.patch2self</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptive-soft-matching">adaptive_soft_matching</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.adaptive_soft_matching.adaptive_soft_matching"><code class="docutils literal notranslate"><span class="pre">adaptive_soft_matching()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gibbs-removal">gibbs_removal</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.gibbs.gibbs_removal"><code class="docutils literal notranslate"><span class="pre">gibbs_removal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensionality-problem-message">dimensionality_problem_message</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.dimensionality_problem_message"><code class="docutils literal notranslate"><span class="pre">dimensionality_problem_message()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-patch-radius-arr">create_patch_radius_arr</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.create_patch_radius_arr"><code class="docutils literal notranslate"><span class="pre">create_patch_radius_arr()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-patch-size">compute_patch_size</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.compute_patch_size"><code class="docutils literal notranslate"><span class="pre">compute_patch_size()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-num-samples">compute_num_samples</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.compute_num_samples"><code class="docutils literal notranslate"><span class="pre">compute_num_samples()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-suggested-patch-radius">compute_suggested_patch_radius</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.compute_suggested_patch_radius"><code class="docutils literal notranslate"><span class="pre">compute_suggested_patch_radius()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#genpca">genpca</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.genpca"><code class="docutils literal notranslate"><span class="pre">genpca()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#localpca">localpca</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.localpca"><code class="docutils literal notranslate"><span class="pre">localpca()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mppca">mppca</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.mppca"><code class="docutils literal notranslate"><span class="pre">mppca()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nlmeans">nlmeans</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.nlmeans.nlmeans"><code class="docutils literal notranslate"><span class="pre">nlmeans()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#piesno">piesno</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.noise_estimate.piesno"><code class="docutils literal notranslate"><span class="pre">piesno()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-sigma">estimate_sigma</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.noise_estimate.estimate_sigma"><code class="docutils literal notranslate"><span class="pre">estimate_sigma()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-local-means">non_local_means</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.non_local_means.non_local_means"><code class="docutils literal notranslate"><span class="pre">non_local_means()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vol-denoise">vol_denoise</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.patch2self.vol_denoise"><code class="docutils literal notranslate"><span class="pre">vol_denoise()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#patch2self">patch2self</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.patch2self.patch2self"><code class="docutils literal notranslate"><span class="pre">patch2self()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  
<script type="module" src="../_static/scripts/grg-sphinx-theme.js"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><div>
  <h3 class="footer-heading">
    Never miss an update from us!
  </h3>
  <p class="footer-sub-heading">
    Don't worry! we are not going to spam you.
  </p>
  <div class="input-group mb-3 mar-t-10">
    <input type="text" class="form-control" placeholder="You email" aria-label="You email" id="grg-subscribe-email">
    <div class="input-group-append pointer" onclick="(document.getElementById('grg-subscribe-email').value)">
      <span class="input-group-text subscribe">Subscribe</span>
    </div>
  </div>  
  <ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul>
</div></div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="grid-3">
  
  <div>
    <h5 class="footer-heading">
      About
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://dipy.org/team">
            Developers
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://github.com/dipy/dipy/discussions" target="_blank" rel="noopener noreferrer">
            Support
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../user_guide/installation.html">
            Download
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../user_guide/getting_started.html">
            Get Started
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../examples_built/index.html">
            Tutorials
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank" rel="noopener noreferrer">
            Videos
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Friends
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/" target="_blank" rel="noopener noreferrer">
            Nipy Projects
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://fury.gl/" target="_blank" rel="noopener noreferrer">
            FURY
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/nibabel" target="_blank" rel="noopener noreferrer">
            Nibabel
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://tortoise.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            Tortoise
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Support
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://engineering.indiana.edu/" target="_blank" rel="noopener noreferrer">
            The department of Intelligent Systems Engineering of Indiana University
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            The National Institute of Biomedical Imaging and Bioengineering, NIH
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://escience.washington.edu" target="_blank" rel="noopener noreferrer">
            The Gordon and Betty Moore Foundation and the Alfred P. Sloan Foundation, through the University of Washington eScience Institute Data Science Environment
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://summerofcode.withgoogle.com/" target="_blank" rel="noopener noreferrer">
            Google supported DIPY through the Google Summer of Code Program (2015-2024)
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
</div></div>
      
    </div>
  
</div>

    <div class="copyright-text">
      <i class="fa-regular fa-copyright"></i> Copyright 2008-2025,DIPY developers. Created using Grg Sphinx Theme and PyData Sphinx Theme.
    </div>
  </footer>
  </body>
</html>