
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DIPY &#8212; dipy 1.10.0.dev0+199.e3b0e11 documentation</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/css/dipy.css?v=cedb193d" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

  
<link rel="stylesheet" href="../_static/styles/grg-sphinx-theme.css"/>

    <script src="../_static/documentation_options.js?v=611e7fdb"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D610GKJZRC"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/dipy.denoise';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.dipy.org/dev/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.8.0';
        </script>
    <link rel="icon" href="../_static/dipy-favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="direction" href="dipy.direction.html" />
    <link rel="prev" title="data" href="dipy.data.html" />
  <meta name="keywords" content="DIPY, dMRI, DTI, DSI, diffusion MRI, Tensor,
  neuroimaging, python, neuroscience, Eleftherios, Garyfallidis, tractography,
  streamlines, fiber tracking">

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
   

<a class="navbar-brand logo" href="https://dipy.org">
  
  
  
  
    
    
      
    
    
    <img src="../_static/dipy-logo.png" class="logo__image only-light" alt="DIPY"/>
    <script>document.write(`<img src="../_static/dipy-logo.png" class="logo__image only-dark" alt="DIPY"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../examples_built/index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      1.8.0  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter/X</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-youtube"></i></span>
            <label class="sr-only">YouTube</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin"></i></span>
            <label class="sr-only">LinkedIn</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

</nav>
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../examples_built/index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      1.8.0  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter/X</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-youtube"></i></span>
            <label class="sr-only">YouTube</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin"></i></span>
            <label class="sr-only">LinkedIn</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dipy.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dipy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.align.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">align</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.core.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">core</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.data.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">data</span></code></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.direction.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">direction</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.io.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">io</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.nn.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nn</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.reconst.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">reconst</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.segment.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">segment</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.sims.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sims</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.stats.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stats</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.tracking.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tracking</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.viz.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">viz</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.workflows.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">workflows</span></code></a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">DIPY</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="module-dipy.denoise">
<span id="denoise"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise</span></code><a class="headerlink" href="#module-dipy.denoise" title="Link to this heading">#</a></h1>
<table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
<section id="module-dipy.denoise.adaptive_soft_matching">
<span id="module-denoise-adaptive-soft-matching"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.adaptive_soft_matching</span></code><a class="headerlink" href="#module-dipy.denoise.adaptive_soft_matching" title="Link to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.adaptive_soft_matching.adaptive_soft_matching" title="dipy.denoise.adaptive_soft_matching.adaptive_soft_matching"><code class="xref py py-obj docutils literal notranslate"><span class="pre">adaptive_soft_matching</span></code></a>(ima, fimau, fimao, sigma)</p></td>
<td><p>Adaptive Soft Coefficient Matching</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-dipy.denoise.denspeed">
<span id="module-denoise-denspeed"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.denspeed</span></code><a class="headerlink" href="#module-dipy.denoise.denspeed" title="Link to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.denspeed.add_padding_reflection" title="dipy.denoise.denspeed.add_padding_reflection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_padding_reflection</span></code></a>(arr, padding)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.denspeed.correspond_indices" title="dipy.denoise.denspeed.correspond_indices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">correspond_indices</span></code></a>(dim_size, padding)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.denspeed.determine_num_threads" title="dipy.denoise.denspeed.determine_num_threads"><code class="xref py py-obj docutils literal notranslate"><span class="pre">determine_num_threads</span></code></a>(num_threads)</p></td>
<td><p>Determine the effective number of threads to be used for OpenMP calls</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.denspeed.nlmeans_3d" title="dipy.denoise.denspeed.nlmeans_3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nlmeans_3d</span></code></a>(arr[, mask, sigma, patch_radius, ...])</p></td>
<td><p>Non-local means for denoising 3D images</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.denspeed.remove_padding" title="dipy.denoise.denspeed.remove_padding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_padding</span></code></a>(arr, padding)</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-dipy.denoise.enhancement_kernel">
<span id="module-denoise-enhancement-kernel"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.enhancement_kernel</span></code><a class="headerlink" href="#module-dipy.denoise.enhancement_kernel" title="Link to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.enhancement_kernel.EnhancementKernel" title="dipy.denoise.enhancement_kernel.EnhancementKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EnhancementKernel</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.enhancement_kernel.HemiSphere" title="dipy.denoise.enhancement_kernel.HemiSphere"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HemiSphere</span></code></a>([x, y, z, theta, phi, xyz, ...])</p></td>
<td><p>Points on the unit sphere.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.enhancement_kernel.Sphere" title="dipy.denoise.enhancement_kernel.Sphere"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Sphere</span></code></a>([x, y, z, theta, phi, xyz, faces, edges])</p></td>
<td><p>Points on the unit sphere.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.enhancement_kernel.ceil" title="dipy.denoise.enhancement_kernel.ceil"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ceil</span></code></a>(x, /)</p></td>
<td><p>Return the ceiling of x as an Integral.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.enhancement_kernel.disperse_charges" title="dipy.denoise.enhancement_kernel.disperse_charges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">disperse_charges</span></code></a>(hemi, iters[, const])</p></td>
<td><p>Models electrostatic repulsion on the unit sphere</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.enhancement_kernel.get_sphere" title="dipy.denoise.enhancement_kernel.get_sphere"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sphere</span></code></a>([name])</p></td>
<td><p>provide triangulated spheres</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.enhancement_kernel.gettempdir" title="dipy.denoise.enhancement_kernel.gettempdir"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gettempdir</span></code></a>()</p></td>
<td><p>Returns tempfile.tempdir as str.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-dipy.denoise.gibbs">
<span id="module-denoise-gibbs"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.gibbs</span></code><a class="headerlink" href="#module-dipy.denoise.gibbs" title="Link to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.gibbs.gibbs_removal" title="dipy.denoise.gibbs.gibbs_removal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gibbs_removal</span></code></a>(vol[, slice_axis, n_points, ...])</p></td>
<td><p>Suppresses Gibbs ringing artefacts of images volumes.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-dipy.denoise.localpca">
<span id="module-denoise-localpca"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.localpca</span></code><a class="headerlink" href="#module-dipy.denoise.localpca" title="Link to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.localpca.dimensionality_problem_message" title="dipy.denoise.localpca.dimensionality_problem_message"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimensionality_problem_message</span></code></a>(arr, ...)</p></td>
<td><p>Message about the number of samples being smaller than one less the</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.localpca.create_patch_radius_arr" title="dipy.denoise.localpca.create_patch_radius_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_patch_radius_arr</span></code></a>(arr, pr)</p></td>
<td><p>Create the patch radius array from the data to be denoised and the patch radius.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.localpca.compute_patch_size" title="dipy.denoise.localpca.compute_patch_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_patch_size</span></code></a>(patch_radius)</p></td>
<td><p>Compute patch size from the patch radius.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.localpca.compute_num_samples" title="dipy.denoise.localpca.compute_num_samples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_num_samples</span></code></a>(patch_size)</p></td>
<td><p>Compute the number of samples as the dot product of the elements.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.localpca.compute_suggested_patch_radius" title="dipy.denoise.localpca.compute_suggested_patch_radius"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_suggested_patch_radius</span></code></a>(arr, patch_size)</p></td>
<td><p>Compute the suggested patch radius.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.localpca.genpca" title="dipy.denoise.localpca.genpca"><code class="xref py py-obj docutils literal notranslate"><span class="pre">genpca</span></code></a>(arr[, sigma, mask, patch_radius, ...])</p></td>
<td><p>General function to perform PCA-based denoising of diffusion datasets.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.localpca.localpca" title="dipy.denoise.localpca.localpca"><code class="xref py py-obj docutils literal notranslate"><span class="pre">localpca</span></code></a>(arr[, sigma, mask, patch_radius, ...])</p></td>
<td><p>Performs local PCA denoising according to Manjon et al. <a href="#id132"><span class="problematic" id="id1">[1]_</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.localpca.mppca" title="dipy.denoise.localpca.mppca"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mppca</span></code></a>(arr[, mask, patch_radius, pca_method, ...])</p></td>
<td><p>Performs PCA-based denoising using the Marcenko-Pastur distribution <a href="#id133"><span class="problematic" id="id2">[1]_</span></a>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-dipy.denoise.nlmeans">
<span id="module-denoise-nlmeans"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.nlmeans</span></code><a class="headerlink" href="#module-dipy.denoise.nlmeans" title="Link to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.nlmeans.nlmeans" title="dipy.denoise.nlmeans.nlmeans"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nlmeans</span></code></a>(arr, sigma[, mask, patch_radius, ...])</p></td>
<td><p>Non-local means for denoising 3D and 4D images</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-dipy.denoise.nlmeans_block">
<span id="module-denoise-nlmeans-block"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.nlmeans_block</span></code><a class="headerlink" href="#module-dipy.denoise.nlmeans_block" title="Link to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.nlmeans_block.firdn" title="dipy.denoise.nlmeans_block.firdn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">firdn</span></code></a>(image, h)</p></td>
<td><p>Applies the filter given by the convolution kernel 'h' columnwise to 'image', then subsamples by 2.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.nlmeans_block.nlmeans_block" title="dipy.denoise.nlmeans_block.nlmeans_block"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nlmeans_block</span></code></a>(image, mask, patch_radius, ...)</p></td>
<td><p>Non-Local Means Denoising Using Blockwise Averaging</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.nlmeans_block.upfir" title="dipy.denoise.nlmeans_block.upfir"><code class="xref py py-obj docutils literal notranslate"><span class="pre">upfir</span></code></a>(image, h)</p></td>
<td><p>Upsamples the columns of the input image by 2, then applies the convolution kernel 'h' (again, columnwise).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-dipy.denoise.noise_estimate">
<span id="module-denoise-noise-estimate"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.noise_estimate</span></code><a class="headerlink" href="#module-dipy.denoise.noise_estimate" title="Link to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.noise_estimate.piesno" title="dipy.denoise.noise_estimate.piesno"><code class="xref py py-obj docutils literal notranslate"><span class="pre">piesno</span></code></a>(data, N[, alpha, l, itermax, eps, ...])</p></td>
<td><p>Probabilistic Identification and Estimation of Noise (PIESNO).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.noise_estimate.estimate_sigma" title="dipy.denoise.noise_estimate.estimate_sigma"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_sigma</span></code></a>(arr[, ...])</p></td>
<td><p>Standard deviation estimation from local patches</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-dipy.denoise.non_local_means">
<span id="module-denoise-non-local-means"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.non_local_means</span></code><a class="headerlink" href="#module-dipy.denoise.non_local_means" title="Link to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.non_local_means.non_local_means" title="dipy.denoise.non_local_means.non_local_means"><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_local_means</span></code></a>(arr, sigma[, mask, ...])</p></td>
<td><p>Non-local means for denoising 3D and 4D images, using</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-dipy.denoise.patch2self">
<span id="module-denoise-patch2self"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.patch2self</span></code><a class="headerlink" href="#module-dipy.denoise.patch2self" title="Link to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.patch2self.patch2self" title="dipy.denoise.patch2self.patch2self"><code class="xref py py-obj docutils literal notranslate"><span class="pre">patch2self</span></code></a>(data, bvals[, patch_radius, ...])</p></td>
<td><p>Patch2Self Denoiser.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-dipy.denoise.pca_noise_estimate">
<span id="module-denoise-pca-noise-estimate"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.pca_noise_estimate</span></code><a class="headerlink" href="#module-dipy.denoise.pca_noise_estimate" title="Link to this heading">#</a></h2>
<section id="pca-based-local-noise-estimation">
<h3>PCA Based Local Noise Estimation<a class="headerlink" href="#pca-based-local-noise-estimation" title="Link to this heading">#</a></h3>
</section>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.pca_noise_estimate.pca_noise_estimate" title="dipy.denoise.pca_noise_estimate.pca_noise_estimate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pca_noise_estimate</span></code></a>(data, gtab[, ...])</p></td>
<td><p>PCA based local noise estimation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.pca_noise_estimate.warn" title="dipy.denoise.pca_noise_estimate.warn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">warn</span></code></a>(message[, category, stacklevel, source])</p></td>
<td><p>Issue a warning, or maybe ignore it or raise an exception.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-dipy.denoise.shift_twist_convolution">
<span id="module-denoise-shift-twist-convolution"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.shift_twist_convolution</span></code><a class="headerlink" href="#module-dipy.denoise.shift_twist_convolution" title="Link to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.shift_twist_convolution.convolve" title="dipy.denoise.shift_twist_convolution.convolve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convolve</span></code></a>(odfs_sh, kernel, sh_order_max[, ...])</p></td>
<td><p>Perform the shift-twist convolution with the ODF data and the lookup-table of the kernel.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.shift_twist_convolution.convolve_sf" title="dipy.denoise.shift_twist_convolution.convolve_sf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convolve_sf</span></code></a>(odfs_sf, kernel[, test_mode, ...])</p></td>
<td><p>Perform the shift-twist convolution with the ODF data and the lookup-table of the kernel.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.shift_twist_convolution.deprecated_params" title="dipy.denoise.shift_twist_convolution.deprecated_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deprecated_params</span></code></a>(old_name[, new_name, ...])</p></td>
<td><p>Deprecate a <em>renamed</em> or <em>removed</em> function argument.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.shift_twist_convolution.determine_num_threads" title="dipy.denoise.shift_twist_convolution.determine_num_threads"><code class="xref py py-obj docutils literal notranslate"><span class="pre">determine_num_threads</span></code></a>(num_threads)</p></td>
<td><p>Determine the effective number of threads to be used for OpenMP calls</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.denoise.shift_twist_convolution.sf_to_sh" title="dipy.denoise.shift_twist_convolution.sf_to_sh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sf_to_sh</span></code></a>(sf, sphere[, sh_order_max, ...])</p></td>
<td><p>Spherical function to spherical harmonics (SH).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.denoise.shift_twist_convolution.sh_to_sf" title="dipy.denoise.shift_twist_convolution.sh_to_sf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sh_to_sf</span></code></a>(sh, sphere[, sh_order_max, ...])</p></td>
<td><p>Spherical harmonics (SH) to spherical function (SF).</p></td>
</tr>
</tbody>
</table>
<section id="adaptive-soft-matching">
<h3>adaptive_soft_matching<a class="headerlink" href="#adaptive-soft-matching" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.adaptive_soft_matching.adaptive_soft_matching">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.adaptive_soft_matching.</span></span><span class="sig-name descname"><span class="pre">adaptive_soft_matching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ima</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fimau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fimao</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.adaptive_soft_matching.adaptive_soft_matching" title="Link to this definition">#</a></dt>
<dd><p>Adaptive Soft Coefficient Matching</p>
<p>Combines two filtered 3D-images at different resolutions and the original
image. Returns the resulting combined image.</p>
<section id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h4>
<p>ima : the original (not filtered) image
fimau : 3D double array,</p>
<blockquote>
<div><p>filtered image with optimized non-local means using a small block
(suggested:3x3), which corresponds to a “high resolution” filter.</p>
</div></blockquote>
<dl class="simple">
<dt>fimao<span class="classifier">3D double array,</span></dt><dd><p>filtered image with optimized non-local means using a small block
(suggested:5x5), which corresponds to a “low resolution” filter.</p>
</dd>
<dt>sigma<span class="classifier">the estimated standard deviation of the Gaussian random variables</span></dt><dd><p>that explain the rician noise. Note: In P. Coupe et al. the
rician noise was simulated as sqrt((f+x)^2 + (y)^2) where f is
the pixel value and x and y are independent realizations of a
random variable with Normal distribution, with mean=0 and
standard deviation=h</p>
</dd>
</dl>
</section>
<section id="returns">
<h4>Returns<a class="headerlink" href="#returns" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>fima<span class="classifier">3D double array</span></dt><dd><p>output denoised array which is of the same shape as that of
the input</p>
</dd>
</dl>
</section>
<section id="references">
<h4>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h4>
<div role="list" class="citation-list">
<div class="citation" id="coupe11" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Coupe11<span class="fn-bracket">]</span></span>
<p>Pierrick Coupe, Jose Manjon, Montserrat Robles, Louis Collins.
“Multiresolution Non-Local Means Filter for 3D MR Image
Denoising” IET Image Processing, Institution of Engineering
and Technology,
2011</p>
</div>
</div>
</section>
</dd></dl>

</section>
<section id="add-padding-reflection">
<h3>add_padding_reflection<a class="headerlink" href="#add-padding-reflection" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.denspeed.add_padding_reflection">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.denspeed.</span></span><span class="sig-name descname"><span class="pre">add_padding_reflection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.denspeed.add_padding_reflection" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="correspond-indices">
<h3>correspond_indices<a class="headerlink" href="#correspond-indices" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.denspeed.correspond_indices">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.denspeed.</span></span><span class="sig-name descname"><span class="pre">correspond_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.denspeed.correspond_indices" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="determine-num-threads">
<h3>determine_num_threads<a class="headerlink" href="#determine-num-threads" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.denspeed.determine_num_threads">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.denspeed.</span></span><span class="sig-name descname"><span class="pre">determine_num_threads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_threads</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.denspeed.determine_num_threads" title="Link to this definition">#</a></dt>
<dd><p>Determine the effective number of threads to be used for OpenMP calls</p>
<ul class="simple">
<li><p>For <code class="docutils literal notranslate"><span class="pre">num_threads</span> <span class="pre">=</span> <span class="pre">None</span></code>,
- if the <code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code> environment variable is set, return that
value
- otherwise, return the maximum number of cores retrieved by
<code class="docutils literal notranslate"><span class="pre">openmp.opm_get_num_procs()</span></code>.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">num_threads</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, return this value.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">num_threads</span> <span class="pre">&lt;</span> <span class="pre">0</span></code>, return the maximal number of threads minus
<code class="docutils literal notranslate"><span class="pre">|num_threads</span> <span class="pre">+</span> <span class="pre">1|</span></code>. In particular <code class="docutils literal notranslate"><span class="pre">num_threads</span> <span class="pre">=</span> <span class="pre">-1</span></code> will use as
many threads as there are available cores on the machine.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">num_threads</span> <span class="pre">=</span> <span class="pre">0</span></code> a ValueError is raised.</p></li>
</ul>
<section id="id3">
<h4>Parameters<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>num_threads<span class="classifier">int or None</span></dt><dd><p>Desired number of threads to be used.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="nlmeans-3d">
<h3>nlmeans_3d<a class="headerlink" href="#nlmeans-3d" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.denspeed.nlmeans_3d">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.denspeed.</span></span><span class="sig-name descname"><span class="pre">nlmeans_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rician</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.denspeed.nlmeans_3d" title="Link to this definition">#</a></dt>
<dd><p>Non-local means for denoising 3D images</p>
<section id="id4">
<h4>Parameters<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>arr<span class="classifier">3D ndarray</span></dt><dd><p>The array to be denoised</p>
</dd>
</dl>
<p>mask : 3D ndarray
sigma : float or 3D array</p>
<blockquote>
<div><p>standard deviation of the noise estimated from the data</p>
</div></blockquote>
<dl class="simple">
<dt>patch_radius<span class="classifier">int</span></dt><dd><p>patch size is <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">patch_radius</span> <span class="pre">+</span> <span class="pre">1</span></code>. Default is 1.</p>
</dd>
<dt>block_radius<span class="classifier">int</span></dt><dd><p>block size is <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">block_radius</span> <span class="pre">+</span> <span class="pre">1</span></code>. Default is 5.</p>
</dd>
<dt>rician<span class="classifier">boolean</span></dt><dd><p>If True the noise is estimated as Rician, otherwise Gaussian noise
is assumed.</p>
</dd>
<dt>num_threads<span class="classifier">int, optional</span></dt><dd><p>Number of threads to be used for OpenMP parallelization. If None
(default) the value of OMP_NUM_THREADS environment variable is used
if it is set, otherwise all available threads are used. If &lt; 0 the
maximal number of threads minus <a href="#id124"><span class="problematic" id="id125">|num_threads + 1|</span></a> is used (enter -1 to
use as many threads as possible). 0 raises an error.</p>
</dd>
</dl>
</section>
<section id="id5">
<h4>Returns<a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>denoised_arr<span class="classifier">ndarray</span></dt><dd><p>the denoised <code class="docutils literal notranslate"><span class="pre">arr</span></code> which has the same shape as <code class="docutils literal notranslate"><span class="pre">arr</span></code>.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="remove-padding">
<h3>remove_padding<a class="headerlink" href="#remove-padding" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.denspeed.remove_padding">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.denspeed.</span></span><span class="sig-name descname"><span class="pre">remove_padding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.denspeed.remove_padding" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="enhancementkernel">
<h3><a class="reference internal" href="#dipy.denoise.enhancement_kernel.EnhancementKernel" title="dipy.denoise.enhancement_kernel.EnhancementKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnhancementKernel</span></code></a><a class="headerlink" href="#enhancementkernel" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.EnhancementKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.denoise.enhancement_kernel.</span></span><span class="sig-name descname"><span class="pre">EnhancementKernel</span></span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.EnhancementKernel" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.EnhancementKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.EnhancementKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Compute a look-up table for the contextual
enhancement kernel</p>
<section id="id6">
<h4>Parameters<a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>D33<span class="classifier">float</span></dt><dd><p>Spatial diffusion</p>
</dd>
<dt>D44<span class="classifier">float</span></dt><dd><p>Angular diffusion</p>
</dd>
<dt>t<span class="classifier">float</span></dt><dd><p>Diffusion time</p>
</dd>
<dt>force_recompute<span class="classifier">boolean</span></dt><dd><p>Always compute the look-up table even if it is available
in cache. Default is False.</p>
</dd>
<dt>orientations<span class="classifier">integer or Sphere object</span></dt><dd><p>Specify the number of orientations to be used with
electrostatic repulsion, or provide a Sphere object.
The default sphere is ‘repulsion100’.</p>
</dd>
<dt>verbose<span class="classifier">boolean</span></dt><dd><p>Enable verbose mode.</p>
</dd>
</dl>
</section>
<section id="id7">
<h4>References<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>[Meesters2016_ISMRM] S. Meesters, G. Sanguinetti, E. Garyfallidis,</dt><dd><p>J. Portegies, R. Duits. (2016) Fast implementations
of contextual PDE’s for HARDI data processing in
DIPY. ISMRM 2016 conference.</p>
</dd>
<dt>[DuitsAndFranken_IJCV] R. Duits and E. Franken (2011) Left-invariant diffusions</dt><dd><p>on the space of positions and orientations and their
application to crossing-preserving smoothing of HARDI
images. International Journal of Computer Vision, 92:231-264.</p>
</dd>
<dt>[Portegies2015] J. Portegies, G. Sanguinetti, S. Meesters, and R. Duits.</dt><dd><p>(2015) New Approximation of a Scale Space Kernel on SE(3)
and Applications in Neuroimaging. Fifth International
Conference on Scale Space and Variational Methods in
Computer Vision</p>
</dd>
<dt>[Portegies2015b] J. Portegies, R. Fick, G. Sanguinetti, S. Meesters,</dt><dd><p>G. Girard, and R. Duits. (2015) Improving Fiber
Alignment in HARDI by Combining Contextual PDE flow with
Constrained Spherical Deconvolution. PLoS One.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.EnhancementKernel.evaluate_kernel">
<span class="sig-name descname"><span class="pre">evaluate_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.EnhancementKernel.evaluate_kernel" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the kernel at position x relative to
position y, with orientation r relative to orientation v.</p>
<section id="id8">
<h4>Parameters<a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>x<span class="classifier">1D ndarray</span></dt><dd><p>Position x</p>
</dd>
<dt>y<span class="classifier">1D ndarray</span></dt><dd><p>Position y</p>
</dd>
<dt>r<span class="classifier">1D ndarray</span></dt><dd><p>Orientation r</p>
</dd>
<dt>v<span class="classifier">1D ndarray</span></dt><dd><p>Orientation v</p>
</dd>
</dl>
</section>
<section id="id9">
<h4>Returns<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<p>kernel_value : double</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.EnhancementKernel.get_lookup_table">
<span class="sig-name descname"><span class="pre">get_lookup_table</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.EnhancementKernel.get_lookup_table" title="Link to this definition">#</a></dt>
<dd><p>Return the computed look-up table.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.EnhancementKernel.get_orientations">
<span class="sig-name descname"><span class="pre">get_orientations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.EnhancementKernel.get_orientations" title="Link to this definition">#</a></dt>
<dd><p>Return the orientations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.EnhancementKernel.get_sphere">
<span class="sig-name descname"><span class="pre">get_sphere</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.EnhancementKernel.get_sphere" title="Link to this definition">#</a></dt>
<dd><p>Get the sphere corresponding with the orientations</p>
</dd></dl>

</dd></dl>

</section>
<section id="hemisphere">
<h3><a class="reference internal" href="#dipy.denoise.enhancement_kernel.HemiSphere" title="dipy.denoise.enhancement_kernel.HemiSphere"><code class="xref py py-class docutils literal notranslate"><span class="pre">HemiSphere</span></code></a><a class="headerlink" href="#hemisphere" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.HemiSphere">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.denoise.enhancement_kernel.</span></span><span class="sig-name descname"><span class="pre">HemiSphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.HemiSphere" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="dipy.core.html#dipy.core.sphere.Sphere" title="dipy.core.sphere.Sphere"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sphere</span></code></a></p>
<p>Points on the unit sphere.</p>
<p>A HemiSphere is similar to a Sphere but it takes antipodal symmetry into
account. Antipodal symmetry means that point v on a HemiSphere is the same
as the point -v. Duplicate points are discarded when constructing a
HemiSphere (including antipodal duplicates). <cite>edges</cite> and <cite>faces</cite> are
remapped to the remaining points as closely as possible.</p>
<p>The HemiSphere can be constructed using one of three conventions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HemiSphere</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">HemiSphere</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="n">xyz</span><span class="p">)</span>
<span class="n">HemiSphere</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
<section id="id10">
<h4>Parameters<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>x, y, z<span class="classifier">1-D array_like</span></dt><dd><p>Vertices as x-y-z coordinates.</p>
</dd>
<dt>theta, phi<span class="classifier">1-D array_like</span></dt><dd><p>Vertices as spherical coordinates.  Theta and phi are the inclination
and azimuth angles respectively.</p>
</dd>
<dt>xyz<span class="classifier">(N, 3) ndarray</span></dt><dd><p>Vertices as x-y-z coordinates.</p>
</dd>
<dt>faces<span class="classifier">(N, 3) ndarray</span></dt><dd><p>Indices into vertices that form triangular faces.  If unspecified,
the faces are computed using a Delaunay triangulation.</p>
</dd>
<dt>edges<span class="classifier">(N, 2) ndarray</span></dt><dd><p>Edges between vertices.  If unspecified, the edges are
derived from the faces.</p>
</dd>
<dt>tol<span class="classifier">float</span></dt><dd><p>Angle in degrees. Vertices that are less than tol degrees apart are
treated as duplicates.</p>
</dd>
</dl>
</section>
<section id="see-also">
<h4>See Also<a class="headerlink" href="#see-also" title="Link to this heading">#</a></h4>
<p>Sphere</p>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.HemiSphere.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.HemiSphere.__init__" title="Link to this definition">#</a></dt>
<dd><p>Create a HemiSphere from points</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.HemiSphere.faces">
<span class="sig-name descname"><span class="pre">faces</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.HemiSphere.faces" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.HemiSphere.find_closest">
<span class="sig-name descname"><span class="pre">find_closest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.HemiSphere.find_closest" title="Link to this definition">#</a></dt>
<dd><p>Find the index of the vertex in the Sphere closest to the input vector,
taking into account antipodal symmetry</p>
<section id="id11">
<h5>Parameters<a class="headerlink" href="#id11" title="Link to this heading">#</a></h5>
<dl class="simple">
<dt>xyz<span class="classifier">array-like, 3 elements</span></dt><dd><p>A unit vector</p>
</dd>
</dl>
</section>
<section id="id12">
<h5>Returns<a class="headerlink" href="#id12" title="Link to this heading">#</a></h5>
<dl class="simple">
<dt>idx<span class="classifier">int</span></dt><dd><p>The index into the Sphere.vertices array that gives the closest
vertex (in angle).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.HemiSphere.from_sphere">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.HemiSphere.from_sphere" title="Link to this definition">#</a></dt>
<dd><p>Create instance from a Sphere</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.HemiSphere.mirror">
<span class="sig-name descname"><span class="pre">mirror</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.HemiSphere.mirror" title="Link to this definition">#</a></dt>
<dd><p>Create a full Sphere from a HemiSphere</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.HemiSphere.subdivide">
<span class="sig-name descname"><span class="pre">subdivide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.HemiSphere.subdivide" title="Link to this definition">#</a></dt>
<dd><p>Create a more subdivided HemiSphere</p>
<p>See Sphere.subdivide for full documentation.</p>
</dd></dl>

</section>
</dd></dl>

</section>
<section id="sphere">
<h3><a class="reference internal" href="#dipy.denoise.enhancement_kernel.Sphere" title="dipy.denoise.enhancement_kernel.Sphere"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sphere</span></code></a><a class="headerlink" href="#sphere" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.Sphere">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.denoise.enhancement_kernel.</span></span><span class="sig-name descname"><span class="pre">Sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.Sphere" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Points on the unit sphere.</p>
<p>The sphere can be constructed using one of three conventions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Sphere</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">Sphere</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="n">xyz</span><span class="p">)</span>
<span class="n">Sphere</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
<section id="id13">
<h4>Parameters<a class="headerlink" href="#id13" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>x, y, z<span class="classifier">1-D array_like</span></dt><dd><p>Vertices as x-y-z coordinates.</p>
</dd>
<dt>theta, phi<span class="classifier">1-D array_like</span></dt><dd><p>Vertices as spherical coordinates.  Theta and phi are the inclination
and azimuth angles respectively.</p>
</dd>
<dt>xyz<span class="classifier">(N, 3) ndarray</span></dt><dd><p>Vertices as x-y-z coordinates.</p>
</dd>
<dt>faces<span class="classifier">(N, 3) ndarray</span></dt><dd><p>Indices into vertices that form triangular faces.  If unspecified,
the faces are computed using a Delaunay triangulation.</p>
</dd>
<dt>edges<span class="classifier">(N, 2) ndarray</span></dt><dd><p>Edges between vertices.  If unspecified, the edges are
derived from the faces.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.Sphere.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.Sphere.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.Sphere.edges">
<span class="sig-name descname"><span class="pre">edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.Sphere.edges" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.Sphere.faces">
<span class="sig-name descname"><span class="pre">faces</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.Sphere.faces" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.Sphere.find_closest">
<span class="sig-name descname"><span class="pre">find_closest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.Sphere.find_closest" title="Link to this definition">#</a></dt>
<dd><p>Find the index of the vertex in the Sphere closest to the input vector</p>
<section id="id14">
<h5>Parameters<a class="headerlink" href="#id14" title="Link to this heading">#</a></h5>
<dl class="simple">
<dt>xyz<span class="classifier">array-like, 3 elements</span></dt><dd><p>A unit vector</p>
</dd>
</dl>
</section>
<section id="id15">
<h5>Returns<a class="headerlink" href="#id15" title="Link to this heading">#</a></h5>
<dl class="simple">
<dt>idx<span class="classifier">int</span></dt><dd><p>The index into the Sphere.vertices array that gives the closest
vertex (in angle).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.Sphere.subdivide">
<span class="sig-name descname"><span class="pre">subdivide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.Sphere.subdivide" title="Link to this definition">#</a></dt>
<dd><p>Subdivides each face of the sphere into four new faces.</p>
<p>New vertices are created at a, b, and c. Then each face [x, y, z] is
divided into faces [x, a, c], [y, a, b], [z, b, c], and [a, b, c].</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">y</span>
      <span class="o">/</span>\
     <span class="o">/</span>  \
   <span class="n">a</span><span class="o">/</span><span class="n">____</span>\<span class="n">b</span>
   <span class="o">/</span>\    <span class="o">/</span>\
  <span class="o">/</span>  \  <span class="o">/</span>  \
 <span class="o">/</span><span class="n">____</span>\<span class="o">/</span><span class="n">____</span>\
<span class="n">x</span>      <span class="n">c</span>     <span class="n">z</span>
</pre></div>
</div>
<section id="id16">
<h5>Parameters<a class="headerlink" href="#id16" title="Link to this heading">#</a></h5>
<dl class="simple">
<dt>n<span class="classifier">int, optional</span></dt><dd><p>The number of subdivisions to perform.</p>
</dd>
</dl>
</section>
<section id="id17">
<h5>Returns<a class="headerlink" href="#id17" title="Link to this heading">#</a></h5>
<dl class="simple">
<dt>new_sphere<span class="classifier">Sphere</span></dt><dd><p>The subdivided sphere.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.Sphere.vertices">
<span class="sig-name descname"><span class="pre">vertices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.Sphere.vertices" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.Sphere.x">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.Sphere.x" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.Sphere.y">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">y</span></span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.Sphere.y" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.Sphere.z">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">z</span></span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.Sphere.z" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
</dd></dl>

</section>
<section id="ceil">
<h3>ceil<a class="headerlink" href="#ceil" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.ceil">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.enhancement_kernel.</span></span><span class="sig-name descname"><span class="pre">ceil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.ceil" title="Link to this definition">#</a></dt>
<dd><p>Return the ceiling of x as an Integral.</p>
<p>This is the smallest integer &gt;= x.</p>
</dd></dl>

</section>
<section id="disperse-charges">
<h3>disperse_charges<a class="headerlink" href="#disperse-charges" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.disperse_charges">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.enhancement_kernel.</span></span><span class="sig-name descname"><span class="pre">disperse_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hemi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.disperse_charges" title="Link to this definition">#</a></dt>
<dd><p>Models electrostatic repulsion on the unit sphere</p>
<p>Places charges on a sphere and simulates the repulsive forces felt by each
one. Allows the charges to move for some number of iterations and returns
their final location as well as the total potential of the system at each
step.</p>
<section id="id18">
<h4>Parameters<a class="headerlink" href="#id18" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>hemi<span class="classifier">HemiSphere</span></dt><dd><p>Points on a unit sphere.</p>
</dd>
<dt>iters<span class="classifier">int</span></dt><dd><p>Number of iterations to run.</p>
</dd>
<dt>const<span class="classifier">float</span></dt><dd><p>Using a smaller const could provide a more accurate result, but will
need more iterations to converge.</p>
</dd>
</dl>
</section>
<section id="id19">
<h4>Returns<a class="headerlink" href="#id19" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>hemi<span class="classifier">HemiSphere</span></dt><dd><p>Distributed points on a unit sphere.</p>
</dd>
<dt>potential<span class="classifier">ndarray</span></dt><dd><p>The electrostatic potential at each iteration. This can be useful to
check if the repulsion converged to a minimum.</p>
</dd>
</dl>
</section>
<section id="notes">
<h4>Notes<a class="headerlink" href="#notes" title="Link to this heading">#</a></h4>
<p>This function is meant to be used with diffusion imaging so antipodal
symmetry is assumed. Therefore, each charge must not only be unique, but if
there is a charge at +x, there cannot be a charge at -x. These are treated
as the same location and because the distance between the two charges will
be zero, the result will be unstable.</p>
</section>
</dd></dl>

</section>
<section id="get-sphere">
<h3>get_sphere<a class="headerlink" href="#get-sphere" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.get_sphere">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.enhancement_kernel.</span></span><span class="sig-name descname"><span class="pre">get_sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'symmetric362'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.get_sphere" title="Link to this definition">#</a></dt>
<dd><p>provide triangulated spheres</p>
<section id="id20">
<h4>Parameters<a class="headerlink" href="#id20" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>name<span class="classifier">str</span></dt><dd><p>which sphere - one of:
* ‘symmetric362’
* ‘symmetric642’
* ‘symmetric724’
* ‘repulsion724’
* ‘repulsion100’
* ‘repulsion200’</p>
</dd>
</dl>
</section>
<section id="id21">
<h4>Returns<a class="headerlink" href="#id21" title="Link to this heading">#</a></h4>
<p>sphere : a dipy.core.sphere.Sphere class instance</p>
</section>
<section id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">dipy.data</span> <span class="kn">import</span> <span class="n">get_sphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sphere</span> <span class="o">=</span> <span class="n">get_sphere</span><span class="p">(</span><span class="s1">&#39;symmetric362&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span><span class="p">,</span> <span class="n">faces</span> <span class="o">=</span> <span class="n">sphere</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">sphere</span><span class="o">.</span><span class="n">faces</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">362</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">faces</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">720</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verts</span><span class="p">,</span> <span class="n">faces</span> <span class="o">=</span> <span class="n">get_sphere</span><span class="p">(</span><span class="s1">&#39;not a sphere name&#39;</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="o">...</span>
<span class="gr">DataError</span>: <span class="n">No sphere called &quot;not a sphere name&quot;</span>
</pre></div>
</div>
</section>
</dd></dl>

</section>
<section id="gettempdir">
<h3>gettempdir<a class="headerlink" href="#gettempdir" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.enhancement_kernel.gettempdir">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.enhancement_kernel.</span></span><span class="sig-name descname"><span class="pre">gettempdir</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.enhancement_kernel.gettempdir" title="Link to this definition">#</a></dt>
<dd><p>Returns tempfile.tempdir as str.</p>
</dd></dl>

</section>
<section id="gibbs-removal">
<h3>gibbs_removal<a class="headerlink" href="#gibbs-removal" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.gibbs.gibbs_removal">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.gibbs.</span></span><span class="sig-name descname"><span class="pre">gibbs_removal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_processes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.gibbs.gibbs_removal" title="Link to this definition">#</a></dt>
<dd><p>Suppresses Gibbs ringing artefacts of images volumes.</p>
<section id="id22">
<h4>Parameters<a class="headerlink" href="#id22" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>vol<span class="classifier">ndarray ([X, Y]), ([X, Y, Z]) or ([X, Y, Z, g])</span></dt><dd><p>Matrix containing one volume (3D) or multiple (4D) volumes of images.</p>
</dd>
<dt>slice_axis<span class="classifier">int (0, 1, or 2)</span></dt><dd><p>Data axis corresponding to the number of acquired slices.
Default is set to the third axis.</p>
</dd>
<dt>n_points<span class="classifier">int, optional</span></dt><dd><p>Number of neighbour points to access local TV (see note).
Default is set to 3.</p>
</dd>
<dt>inplace<span class="classifier">bool, optional</span></dt><dd><p>If True, the input data is replaced with results. Otherwise, returns
a new array.
Default is set to True.</p>
</dd>
<dt>num_processes<span class="classifier">int or None, optional</span></dt><dd><p>Split the calculation to a pool of children processes. This only
applies to 3D or 4D <cite>data</cite> arrays. Default is 1. If &lt; 0 the maximal
number of cores minus <code class="docutils literal notranslate"><span class="pre">num_processes</span> <span class="pre">+</span> <span class="pre">1</span></code> is used (enter -1 to use
as many cores as possible). 0 raises an error.</p>
</dd>
</dl>
</section>
<section id="id23">
<h4>Returns<a class="headerlink" href="#id23" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>vol<span class="classifier">ndarray ([X, Y]), ([X, Y, Z]) or ([X, Y, Z, g])</span></dt><dd><p>Matrix containing one volume (3D) or multiple (4D) volumes of corrected
images.</p>
</dd>
</dl>
</section>
<section id="id24">
<h4>Notes<a class="headerlink" href="#id24" title="Link to this heading">#</a></h4>
<p>For 4D matrix last element should always correspond to the number of
diffusion gradient directions.</p>
</section>
<section id="id25">
<h4>References<a class="headerlink" href="#id25" title="Link to this heading">#</a></h4>
<p>Please cite the following articles
.. [1] Neto Henriques, R., 2018. Advanced Methods for Diffusion MRI Data</p>
<blockquote>
<div><p>Analysis and their Application to the Healthy Ageing Brain
(Doctoral thesis). <a class="reference external" href="https://doi.org/10.17863/CAM.29356">https://doi.org/10.17863/CAM.29356</a></p>
</div></blockquote>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id26" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Kellner E, Dhital B, Kiselev VG, Reisert M. Gibbs-ringing artifact
removal based on local subvoxel-shifts. Magn Reson Med. 2016
doi: 10.1002/mrm.26054.</p>
</aside>
</aside>
</section>
</dd></dl>

</section>
<section id="dimensionality-problem-message">
<h3>dimensionality_problem_message<a class="headerlink" href="#dimensionality-problem-message" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.dimensionality_problem_message">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">dimensionality_problem_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.localpca.dimensionality_problem_message" title="Link to this definition">#</a></dt>
<dd><dl>
<dt>Message about the number of samples being smaller than one less the</dt><dd><p>dimensionality of the data to be denoised.</p>
<dl class="simple">
<dt>arr<span class="classifier">ndarray</span></dt><dd><p>Data to be denoised.</p>
</dd>
<dt>num_samples<span class="classifier">int</span></dt><dd><p>Number of samples.</p>
</dd>
<dt>spr<span class="classifier">int</span></dt><dd><p>Suggested patch radius.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="simple">
<dt>.</dt><dd><dl class="simple">
<dt>str</dt><dd><p>Message.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="create-patch-radius-arr">
<h3>create_patch_radius_arr<a class="headerlink" href="#create-patch-radius-arr" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.create_patch_radius_arr">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">create_patch_radius_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.localpca.create_patch_radius_arr" title="Link to this definition">#</a></dt>
<dd><p>Create the patch radius array from the data to be denoised and the patch
radius.</p>
<section id="id27">
<h4>Parameters<a class="headerlink" href="#id27" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>arr<span class="classifier">ndarray</span></dt><dd><p>Data to be denoised.</p>
</dd>
<dt>pr<span class="classifier">int or ndarray</span></dt><dd><p>Patch radius.</p>
</dd>
</dl>
</section>
<section id="id28">
<h4>Returns<a class="headerlink" href="#id28" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>patch_radius<span class="classifier">ndarray</span></dt><dd><p>Number of samples.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="compute-patch-size">
<h3>compute_patch_size<a class="headerlink" href="#compute-patch-size" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.compute_patch_size">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">compute_patch_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.localpca.compute_patch_size" title="Link to this definition">#</a></dt>
<dd><p>Compute patch size from the patch radius.</p>
<p>it is twice the radius plus one.</p>
<section id="id29">
<h4>Parameters<a class="headerlink" href="#id29" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>patch_radius<span class="classifier">ndarray</span></dt><dd><p>Patch radius.</p>
</dd>
</dl>
</section>
<section id="id30">
<h4>Returns<a class="headerlink" href="#id30" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>int</dt><dd><p>Number of samples.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="compute-num-samples">
<h3>compute_num_samples<a class="headerlink" href="#compute-num-samples" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.compute_num_samples">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">compute_num_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.localpca.compute_num_samples" title="Link to this definition">#</a></dt>
<dd><p>Compute the number of samples as the dot product of the elements.</p>
<section id="id31">
<h4>Parameters<a class="headerlink" href="#id31" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>patch_size<span class="classifier">ndarray</span></dt><dd><p>Patch size.</p>
</dd>
</dl>
</section>
<section id="id32">
<h4>Returns<a class="headerlink" href="#id32" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>int</dt><dd><p>Number of samples.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="compute-suggested-patch-radius">
<h3>compute_suggested_patch_radius<a class="headerlink" href="#compute-suggested-patch-radius" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.compute_suggested_patch_radius">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">compute_suggested_patch_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.localpca.compute_suggested_patch_radius" title="Link to this definition">#</a></dt>
<dd><p>Compute the suggested patch radius.</p>
<section id="id33">
<h4>Parameters<a class="headerlink" href="#id33" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>arr<span class="classifier">ndarray</span></dt><dd><p>Data to be denoised.</p>
</dd>
<dt>patch_size<span class="classifier">ndarray</span></dt><dd><p>Patch size.</p>
</dd>
</dl>
</section>
<section id="id34">
<h4>Returns<a class="headerlink" href="#id34" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>int</dt><dd><p>Suggested patch radius.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="genpca">
<h3>genpca<a class="headerlink" href="#genpca" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.genpca">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">genpca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eig'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.localpca.genpca" title="Link to this definition">#</a></dt>
<dd><p>General function to perform PCA-based denoising of diffusion datasets.</p>
<section id="id35">
<h4>Parameters<a class="headerlink" href="#id35" title="Link to this heading">#</a></h4>
<dl>
<dt>arr<span class="classifier">4D array</span></dt><dd><p>Array of data to be denoised. The dimensions are (X, Y, Z, N), where N
are the diffusion gradient directions. The first 3 dimension must have
size &gt;= 2 * patch_radius + 1 or size = 1.</p>
</dd>
<dt>sigma<span class="classifier">float or 3D array (optional)</span></dt><dd><p>Standard deviation of the noise estimated from the data. If no sigma
is given, this will be estimated based on random matrix theory
<a href="#id134"><span class="problematic" id="id36">[1]_</span></a>,[2]_</p>
</dd>
<dt>mask<span class="classifier">3D boolean array (optional)</span></dt><dd><p>A mask with voxels that are true inside the brain and false outside of
it. The function denoises within the true part and returns zeros
outside of those voxels.</p>
</dd>
<dt>patch_radius<span class="classifier">int or 1D array (optional)</span></dt><dd><p>The radius of the local patch to be taken around each voxel (in
voxels). E.g. patch_radius=2 gives 5x5x5 patches.</p>
</dd>
<dt>pca_method<span class="classifier">‘eig’ or ‘svd’ (optional)</span></dt><dd><p>Use either eigenvalue decomposition (eig) or singular value
decomposition (svd) for principal component analysis. The default
method is ‘eig’ which is faster. However, occasionally ‘svd’ might be
more accurate.</p>
</dd>
<dt>tau_factor<span class="classifier">float (optional)</span></dt><dd><p>Thresholding of PCA eigenvalues is done by nulling out eigenvalues that
are smaller than:</p>
<div class="math notranslate nohighlight">
\[\tau = (\tau_{factor} \sigma)^2\]</div>
<p>tau_{factor} can be set to a predefined values (e.g. tau_{factor} =
2.3 <a href="#id135"><span class="problematic" id="id37">[3]_</span></a>), or automatically calculated using random matrix theory
(in case that tau_{factor} is set to None).</p>
</dd>
<dt>return_sigma<span class="classifier">bool (optional)</span></dt><dd><p>If true, the Standard deviation of the noise will be returned.</p>
</dd>
<dt>out_dtype<span class="classifier">str or dtype (optional)</span></dt><dd><p>The dtype for the output array. Default: output has the same dtype as
the input.</p>
</dd>
<dt>suppress_warning<span class="classifier">bool (optional)</span></dt><dd><p>If true, suppress warning caused by patch_size &lt; arr.shape[-1].</p>
</dd>
</dl>
</section>
<section id="id38">
<h4>Returns<a class="headerlink" href="#id38" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>denoised_arr<span class="classifier">4D array</span></dt><dd><p>This is the denoised array of the same size as that of the input data,
clipped to non-negative values.</p>
</dd>
</dl>
</section>
<section id="id39">
<h4>References<a class="headerlink" href="#id39" title="Link to this heading">#</a></h4>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id40" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Veraart J, Novikov DS, Christiaens D, Ades-aron B, Sijbers,
Fieremans E, 2016. Denoising of Diffusion MRI using random matrix
theory. Neuroimage 142:394-406.
doi: 10.1016/j.neuroimage.2016.08.016</p>
</aside>
<aside class="footnote brackets" id="id41" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Veraart J, Fieremans E, Novikov DS. 2016. Diffusion MRI noise
mapping using random matrix theory. Magnetic Resonance in Medicine.
doi: 10.1002/mrm.26059.</p>
</aside>
<aside class="footnote brackets" id="id42" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>Manjon JV, Coupe P, Concha L, Buades A, Collins DL (2013)
Diffusion Weighted Image Denoising Using Overcomplete Local
PCA. PLoS ONE 8(9): e73021.
<a class="reference external" href="https://doi.org/10.1371/journal.pone.0073021">https://doi.org/10.1371/journal.pone.0073021</a></p>
</aside>
</aside>
</section>
</dd></dl>

</section>
<section id="localpca">
<h3>localpca<a class="headerlink" href="#localpca" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.localpca">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">localpca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gtab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eig'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.localpca.localpca" title="Link to this definition">#</a></dt>
<dd><p>Performs local PCA denoising according to Manjon et al. <a href="#id136"><span class="problematic" id="id43">[1]_</span></a>.</p>
<section id="id44">
<h4>Parameters<a class="headerlink" href="#id44" title="Link to this heading">#</a></h4>
<dl>
<dt>arr<span class="classifier">4D array</span></dt><dd><p>Array of data to be denoised. The dimensions are (X, Y, Z, N), where N
are the diffusion gradient directions.</p>
</dd>
<dt>sigma<span class="classifier">float or 3D array (optional)</span></dt><dd><p>Standard deviation of the noise estimated from the data. If not given,
calculate using method in <a href="#id137"><span class="problematic" id="id45">[1]_</span></a>.</p>
</dd>
<dt>mask<span class="classifier">3D boolean array (optional)</span></dt><dd><p>A mask with voxels that are true inside the brain and false outside of
it. The function denoises within the true part and returns zeros
outside of those voxels.</p>
</dd>
<dt>patch_radius<span class="classifier">int or 1D array (optional)</span></dt><dd><p>The radius of the local patch to be taken around each voxel (in
voxels). E.g. patch_radius=2 gives 5x5x5 patches.</p>
</dd>
<dt>gtab: gradient table object (optional if sigma is provided)</dt><dd><p>gradient information for the data gives us the bvals and bvecs of
diffusion data, which is needed to calculate noise level if sigma is
not provided.</p>
</dd>
<dt>patch_radius_sigma<span class="classifier">int (optional)</span></dt><dd><p>The radius of the local patch to be taken around each voxel (in
voxels) for estimating sigma. E.g. patch_radius_sigma=2 gives
5x5x5 patches.</p>
</dd>
<dt>pca_method<span class="classifier">‘eig’ or ‘svd’ (optional)</span></dt><dd><p>Use either eigenvalue decomposition (eig) or singular value
decomposition (svd) for principal component analysis. The default
method is ‘eig’ which is faster. However, occasionally ‘svd’ might be
more accurate.</p>
</dd>
<dt>tau_factor<span class="classifier">float (optional)</span></dt><dd><p>Thresholding of PCA eigenvalues is done by nulling out eigenvalues that
are smaller than:</p>
<div class="math notranslate nohighlight">
\[\tau = (\tau_{factor} \sigma)^2\]</div>
<p>tau_{factor} can be change to adjust the relationship between the
noise standard deviation and the threshold tau. If tau_{factor} is
set to None, it will be automatically calculated using the
Marcenko-Pastur distribution <a href="#id138"><span class="problematic" id="id46">[2]_</span></a>. Default: 2.3 according to <a href="#id139"><span class="problematic" id="id47">[1]_</span></a>.</p>
</dd>
<dt>return_sigma<span class="classifier">bool (optional)</span></dt><dd><p>If true, a noise standard deviation estimate based on the
Marcenko-Pastur distribution is returned <a href="#id140"><span class="problematic" id="id48">[2]_</span></a>.</p>
</dd>
<dt>correct_bias<span class="classifier">bool (optional)</span></dt><dd><p>Whether to correct for bias due to Rician noise. This is an
implementation of equation 8 in <a href="#id141"><span class="problematic" id="id49">[1]_</span></a>.</p>
</dd>
<dt>out_dtype<span class="classifier">str or dtype (optional)</span></dt><dd><p>The dtype for the output array. Default: output has the same dtype as
the input.</p>
</dd>
<dt>suppress_warning<span class="classifier">bool (optional)</span></dt><dd><p>If true, suppress warning caused by patch_size &lt; arr.shape[-1].</p>
</dd>
</dl>
</section>
<section id="id50">
<h4>Returns<a class="headerlink" href="#id50" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>denoised_arr<span class="classifier">4D array</span></dt><dd><p>This is the denoised array of the same size as that of the input data,
clipped to non-negative values</p>
</dd>
</dl>
</section>
<section id="id51">
<h4>References<a class="headerlink" href="#id51" title="Link to this heading">#</a></h4>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id52" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Manjon JV, Coupe P, Concha L, Buades A, Collins DL (2013)
Diffusion Weighted Image Denoising Using Overcomplete Local
PCA. PLoS ONE 8(9): e73021.
<a class="reference external" href="https://doi.org/10.1371/journal.pone.0073021">https://doi.org/10.1371/journal.pone.0073021</a></p>
</aside>
<aside class="footnote brackets" id="id53" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Veraart J, Novikov DS, Christiaens D, Ades-aron B, Sijbers,
Fieremans E, 2016. Denoising of Diffusion MRI using random matrix
theory. Neuroimage 142:394-406.
doi: 10.1016/j.neuroimage.2016.08.016</p>
</aside>
</aside>
</section>
</dd></dl>

</section>
<section id="mppca">
<h3>mppca<a class="headerlink" href="#mppca" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.localpca.mppca">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.localpca.</span></span><span class="sig-name descname"><span class="pre">mppca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eig'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.localpca.mppca" title="Link to this definition">#</a></dt>
<dd><p>Performs PCA-based denoising using the Marcenko-Pastur
distribution <a href="#id142"><span class="problematic" id="id54">[1]_</span></a>.</p>
<section id="id55">
<h4>Parameters<a class="headerlink" href="#id55" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>arr<span class="classifier">4D array</span></dt><dd><p>Array of data to be denoised. The dimensions are (X, Y, Z, N), where N
are the diffusion gradient directions.</p>
</dd>
<dt>mask<span class="classifier">3D boolean array (optional)</span></dt><dd><p>A mask with voxels that are true inside the brain and false outside of
it. The function denoises within the true part and returns zeros
outside of those voxels.</p>
</dd>
<dt>patch_radius<span class="classifier">int or 1D array (optional)</span></dt><dd><p>The radius of the local patch to be taken around each voxel (in
voxels). E.g. patch_radius=2 gives 5x5x5 patches.</p>
</dd>
<dt>pca_method<span class="classifier">‘eig’ or ‘svd’ (optional)</span></dt><dd><p>Use either eigenvalue decomposition (eig) or singular value
decomposition (svd) for principal component analysis. The default
method is ‘eig’ which is faster. However, occasionally ‘svd’ might be
more accurate.</p>
</dd>
<dt>return_sigma<span class="classifier">bool (optional)</span></dt><dd><p>If true, a noise standard deviation estimate based on the
Marcenko-Pastur distribution is returned <a href="#id143"><span class="problematic" id="id56">[2]_</span></a>.</p>
</dd>
<dt>out_dtype<span class="classifier">str or dtype (optional)</span></dt><dd><p>The dtype for the output array. Default: output has the same dtype as
the input.</p>
</dd>
<dt>suppress_warning<span class="classifier">bool (optional)</span></dt><dd><p>If true, suppress warning caused by patch_size &lt; arr.shape[-1].</p>
</dd>
</dl>
</section>
<section id="id57">
<h4>Returns<a class="headerlink" href="#id57" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>denoised_arr<span class="classifier">4D array</span></dt><dd><p>This is the denoised array of the same size as that of the input data,
clipped to non-negative values</p>
</dd>
<dt>sigma<span class="classifier">3D array (when return_sigma=True)</span></dt><dd><p>Estimate of the spatial varying standard deviation of the noise</p>
</dd>
</dl>
</section>
<section id="id58">
<h4>References<a class="headerlink" href="#id58" title="Link to this heading">#</a></h4>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id59" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Veraart J, Novikov DS, Christiaens D, Ades-aron B, Sijbers,
Fieremans E, 2016. Denoising of Diffusion MRI using random matrix
theory. Neuroimage 142:394-406.
doi: 10.1016/j.neuroimage.2016.08.016</p>
</aside>
<aside class="footnote brackets" id="id60" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Veraart J, Fieremans E, Novikov DS. 2016. Diffusion MRI noise
mapping using random matrix theory. Magnetic Resonance in Medicine.
doi: 10.1002/mrm.26059.</p>
</aside>
</aside>
</section>
</dd></dl>

</section>
<section id="nlmeans">
<h3>nlmeans<a class="headerlink" href="#nlmeans" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.nlmeans.nlmeans">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.nlmeans.</span></span><span class="sig-name descname"><span class="pre">nlmeans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rician</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.nlmeans.nlmeans" title="Link to this definition">#</a></dt>
<dd><p>Non-local means for denoising 3D and 4D images</p>
<section id="id61">
<h4>Parameters<a class="headerlink" href="#id61" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>arr<span class="classifier">3D or 4D ndarray</span></dt><dd><p>The array to be denoised</p>
</dd>
</dl>
<p>mask : 3D ndarray
sigma : float or 3D array</p>
<blockquote>
<div><p>standard deviation of the noise estimated from the data</p>
</div></blockquote>
<dl class="simple">
<dt>patch_radius<span class="classifier">int</span></dt><dd><p>patch size is <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">patch_radius</span> <span class="pre">+</span> <span class="pre">1</span></code>. Default is 1.</p>
</dd>
<dt>block_radius<span class="classifier">int</span></dt><dd><p>block size is <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">block_radius</span> <span class="pre">+</span> <span class="pre">1</span></code>. Default is 5.</p>
</dd>
<dt>rician<span class="classifier">boolean</span></dt><dd><p>If True the noise is estimated as Rician, otherwise Gaussian noise
is assumed.</p>
</dd>
<dt>num_threads<span class="classifier">int, optional</span></dt><dd><p>Number of threads to be used for OpenMP parallelization. If None
(default) the value of OMP_NUM_THREADS environment variable is used
if it is set, otherwise all available threads are used. If &lt; 0 the
maximal number of threads minus <a href="#id126"><span class="problematic" id="id127">|num_threads + 1|</span></a> is used (enter -1 to
use as many threads as possible). 0 raises an error.</p>
</dd>
</dl>
</section>
<section id="id62">
<h4>Returns<a class="headerlink" href="#id62" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>denoised_arr<span class="classifier">ndarray</span></dt><dd><p>the denoised <code class="docutils literal notranslate"><span class="pre">arr</span></code> which has the same shape as <code class="docutils literal notranslate"><span class="pre">arr</span></code>.</p>
</dd>
</dl>
</section>
<section id="id63">
<h4>References<a class="headerlink" href="#id63" title="Link to this heading">#</a></h4>
<div role="list" class="citation-list">
<div class="citation" id="descoteaux08" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Descoteaux08<span class="fn-bracket">]</span></span>
<p>Descoteaux, Maxime and Wiest-Daesslé, Nicolas and Prima,
Sylvain and Barillot, Christian and Deriche, Rachid
Impact of Rician Adapted Non-Local Means Filtering on
HARDI, MICCAI 2008</p>
</div>
</div>
</section>
</dd></dl>

</section>
<section id="firdn">
<h3>firdn<a class="headerlink" href="#firdn" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.nlmeans_block.firdn">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.nlmeans_block.</span></span><span class="sig-name descname"><span class="pre">firdn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.nlmeans_block.firdn" title="Link to this definition">#</a></dt>
<dd><p>Applies the filter given by the convolution kernel ‘h’ columnwise to
‘image’, then subsamples by 2. This is a special case of the matlab’s
‘upfirdn’ function, ported to python. Returns the filtered image.</p>
<section id="id64">
<h4>Parameters<a class="headerlink" href="#id64" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>image: 2D array of doubles</dt><dd><p>the input image to be filtered</p>
</dd>
<dt>h: double array</dt><dd><p>the convolution kernel</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="nlmeans-block">
<h3>nlmeans_block<a class="headerlink" href="#nlmeans-block" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.nlmeans_block.nlmeans_block">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.nlmeans_block.</span></span><span class="sig-name descname"><span class="pre">nlmeans_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rician</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.nlmeans_block.nlmeans_block" title="Link to this definition">#</a></dt>
<dd><p>Non-Local Means Denoising Using Blockwise Averaging</p>
<section id="id65">
<h4>Parameters<a class="headerlink" href="#id65" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>image<span class="classifier">3D array of doubles</span></dt><dd><p>the input image, corrupted with rician noise</p>
</dd>
<dt>mask<span class="classifier">3D array of doubles</span></dt><dd><p>the input mask</p>
</dd>
<dt>patch_radius<span class="classifier">int</span></dt><dd><p>similar patches in the non-local means are searched for locally,
inside a cube of side 2*v+1 centered at each voxel of interest.</p>
</dd>
<dt>block_radius<span class="classifier">int</span></dt><dd><p>the size of the block to be used (2*f+1)x(2*f+1)x(2*f+1) in the
blockwise non-local means implementation (the Coupe’s proposal).</p>
</dd>
<dt>h<span class="classifier">double</span></dt><dd><p>the estimated amount of rician noise in the input image: in P.
Coupe et al. the rician noise was simulated as
sqrt((f+x)^2 + (y)^2) where f is the pixel value and x and y are
independent realizations of a random variable with Normal
distribution, with mean=0 and standard deviation=h</p>
</dd>
<dt>rician<span class="classifier">boolean</span></dt><dd><p>If True the noise is estimated as Rician, otherwise Gaussian noise
is assumed.</p>
</dd>
</dl>
</section>
<section id="id66">
<h4>Returns<a class="headerlink" href="#id66" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>fima: 3D double array</dt><dd><p>the denoised output which has the same shape as input image.</p>
</dd>
</dl>
</section>
<section id="id67">
<h4>References<a class="headerlink" href="#id67" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>[1] P. Coupe, P. Yger, S. Prima, P. Hellier, C. Kervrann, C. Barillot,</dt><dd><p>“An Optimized Blockwise Non Local Means Denoising Filter for 3D Magnetic
Resonance Images”
IEEE Transactions on Medical Imaging, 27(4):425-441, 2008</p>
</dd>
<dt>[2] Pierrick Coupe, Jose Manjon, Montserrat Robles, Louis Collins.</dt><dd><p>“Multiresolution Non-Local Means Filter for 3D MR Image Denoising”
IET Image Processing, Institution of Engineering and Technology, 2011</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="upfir">
<h3>upfir<a class="headerlink" href="#upfir" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.nlmeans_block.upfir">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.nlmeans_block.</span></span><span class="sig-name descname"><span class="pre">upfir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.nlmeans_block.upfir" title="Link to this definition">#</a></dt>
<dd><p>Upsamples the columns of the input image by 2, then applies the
convolution kernel ‘h’ (again, columnwise). This is a special case of the
matlab’s ‘upfirdn’ function, ported to python. Returns the filtered image.</p>
<section id="id68">
<h4>Parameters<a class="headerlink" href="#id68" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>image: 2D array of doubles</dt><dd><p>the input image to be filtered</p>
</dd>
<dt>h: double array</dt><dd><p>the convolution kernel</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="piesno">
<h3>piesno<a class="headerlink" href="#piesno" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.noise_estimate.piesno">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.noise_estimate.</span></span><span class="sig-name descname"><span class="pre">piesno</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.noise_estimate.piesno" title="Link to this definition">#</a></dt>
<dd><p>Probabilistic Identification and Estimation of Noise (PIESNO).</p>
<section id="id69">
<h4>Parameters<a class="headerlink" href="#id69" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>data<span class="classifier">ndarray</span></dt><dd><p>The magnitude signals to analyse. The last dimension must contain the
same realisation of the volume, such as dMRI or fMRI data.</p>
</dd>
<dt>N<span class="classifier">int</span></dt><dd><p>The number of phase array coils of the MRI scanner.
If your scanner does a SENSE reconstruction, ALWAYS use N=1, as the
noise profile is always Rician.
If your scanner does a GRAPPA reconstruction, set N as the number
of phase array coils.</p>
</dd>
<dt>alpha<span class="classifier">float</span></dt><dd><p>Probabilistic estimation threshold for the gamma function.</p>
</dd>
<dt>l<span class="classifier">int</span></dt><dd><p>number of initial estimates for sigma to try.</p>
</dd>
<dt>itermax<span class="classifier">int</span></dt><dd><p>Maximum number of iterations to execute if convergence
is not reached.</p>
</dd>
<dt>eps<span class="classifier">float</span></dt><dd><p>Tolerance for the convergence criterion. Convergence is
reached if two subsequent estimates are smaller than eps.</p>
</dd>
<dt>return_mask<span class="classifier">bool</span></dt><dd><p>If True, return a mask identifying all the pure noise voxel
that were found.</p>
</dd>
</dl>
</section>
<section id="id70">
<h4>Returns<a class="headerlink" href="#id70" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>sigma<span class="classifier">float</span></dt><dd><p>The estimated standard deviation of the gaussian noise.</p>
</dd>
<dt>mask<span class="classifier">ndarray (optional)</span></dt><dd><p>A boolean mask indicating the voxels identified as pure noise.</p>
</dd>
</dl>
</section>
<section id="id71">
<h4>Notes<a class="headerlink" href="#id71" title="Link to this heading">#</a></h4>
<p>This function assumes two things : 1. The data has a noisy, non-masked
background and 2. The data is a repetition of the same measurements
along the last axis, i.e. dMRI or fMRI data, not structural data like
T1/T2.</p>
<p>This function processes the data slice by slice, as originally designed in
the paper. Use it to get a slice by slice estimation of the noise, as in
spinal cord imaging for example.</p>
</section>
<section id="id72">
<h4>References<a class="headerlink" href="#id72" title="Link to this heading">#</a></h4>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id73" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Koay CG, Ozarslan E and Pierpaoli C.</p>
</aside>
</aside>
<p>“Probabilistic Identification and Estimation of Noise (PIESNO):
A self-consistent approach and its applications in MRI.”
Journal of Magnetic Resonance 2009; 199: 94-103.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id74" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Koay CG, Ozarslan E and Basser PJ.</p>
</aside>
</aside>
<p>“A signal transformational framework for breaking the noise floor
and its applications in MRI.”
Journal of Magnetic Resonance 2009; 197: 108-119.</p>
</section>
</dd></dl>

</section>
<section id="estimate-sigma">
<h3>estimate_sigma<a class="headerlink" href="#estimate-sigma" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.noise_estimate.estimate_sigma">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.noise_estimate.</span></span><span class="sig-name descname"><span class="pre">estimate_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_background_masking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.noise_estimate.estimate_sigma" title="Link to this definition">#</a></dt>
<dd><p>Standard deviation estimation from local patches</p>
<section id="id75">
<h4>Parameters<a class="headerlink" href="#id75" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>arr<span class="classifier">3D or 4D ndarray</span></dt><dd><p>The array to be estimated</p>
</dd>
<dt>disable_background_masking<span class="classifier">bool, default False</span></dt><dd><p>If True, uses all voxels for the estimation, otherwise, only non-zeros
voxels are used. Useful if the background is masked by the scanner.</p>
</dd>
<dt>N<span class="classifier">int, default 0</span></dt><dd><p>Number of coils of the receiver array. Use N = 1 in case of a SENSE
reconstruction (Philips scanners) or the number of coils for a GRAPPA
reconstruction (Siemens and GE). Use 0 to disable the correction factor,
as for example if the noise is Gaussian distributed. See [1] for more
information.</p>
</dd>
</dl>
</section>
<section id="id76">
<h4>Returns<a class="headerlink" href="#id76" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>sigma<span class="classifier">ndarray</span></dt><dd><p>standard deviation of the noise, one estimation per volume.</p>
</dd>
</dl>
</section>
<section id="id77">
<h4>Notes<a class="headerlink" href="#id77" title="Link to this heading">#</a></h4>
<p>This function is the same as manually taking the standard deviation of the
background and gives one value for the whole 3D array.
It also includes the coil-dependent correction factor of Koay 2006
(see <a href="#id144"><span class="problematic" id="id78">[1]_</span></a>, equation 18) with theta = 0.
Since this function was introduced in <a href="#id145"><span class="problematic" id="id79">[2]_</span></a> for T1 imaging,
it is expected to perform ok on diffusion MRI data, but might oversmooth
some regions and leave others un-denoised for spatially varying noise
profiles. Consider using <a class="reference internal" href="#dipy.denoise.noise_estimate.piesno" title="dipy.denoise.noise_estimate.piesno"><code class="xref py py-func docutils literal notranslate"><span class="pre">piesno()</span></code></a> to estimate sigma instead if visual
inaccuracies are apparent in the denoised result.</p>
</section>
<section id="id80">
<h4>References<a class="headerlink" href="#id80" title="Link to this heading">#</a></h4>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id81" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Koay, C. G., &amp; Basser, P. J. (2006). Analytically exact correction</p>
</aside>
</aside>
<p>scheme for signal extraction from noisy magnitude MR signals.
Journal of Magnetic Resonance), 179(2), 317-22.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id82" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Coupe, P., Yger, P., Prima, S., Hellier, P., Kervrann, C., Barillot,</p>
</aside>
</aside>
<p>C., 2008. An optimized blockwise nonlocal means denoising filter for 3-D
magnetic resonance images, IEEE Trans. Med. Imaging 27, 425-41.</p>
</section>
</dd></dl>

</section>
<section id="non-local-means">
<h3>non_local_means<a class="headerlink" href="#non-local-means" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.non_local_means.non_local_means">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.non_local_means.</span></span><span class="sig-name descname"><span class="pre">non_local_means</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rician</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.non_local_means.non_local_means" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Non-local means for denoising 3D and 4D images, using</dt><dd><p>blockwise averaging approach</p>
</dd>
</dl>
<section id="id83">
<h4>Parameters<a class="headerlink" href="#id83" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>arr<span class="classifier">3D or 4D ndarray</span></dt><dd><p>The array to be denoised</p>
</dd>
</dl>
<p>mask : 3D ndarray
sigma : float</p>
<blockquote>
<div><p>standard deviation of the noise estimated from the data</p>
</div></blockquote>
<dl class="simple">
<dt>patch_radius<span class="classifier">int</span></dt><dd><p>patch size is <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">patch_radius</span> <span class="pre">+</span> <span class="pre">1</span></code>. Default is 1.</p>
</dd>
<dt>block_radius<span class="classifier">int</span></dt><dd><p>block size is <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">block_radius</span> <span class="pre">+</span> <span class="pre">1</span></code>. Default is 5.</p>
</dd>
<dt>rician<span class="classifier">boolean</span></dt><dd><p>If True the noise is estimated as Rician, otherwise Gaussian noise
is assumed.</p>
</dd>
</dl>
</section>
<section id="id84">
<h4>Returns<a class="headerlink" href="#id84" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>denoised_arr<span class="classifier">ndarray</span></dt><dd><p>the denoised <code class="docutils literal notranslate"><span class="pre">arr</span></code> which has the same shape as <code class="docutils literal notranslate"><span class="pre">arr</span></code>.</p>
</dd>
</dl>
</section>
<section id="id85">
<h4>References<a class="headerlink" href="#id85" title="Link to this heading">#</a></h4>
<div role="list" class="citation-list">
<div class="citation" id="coupe08" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Coupe08<span class="fn-bracket">]</span></span>
<p>P. Coupe, P. Yger, S. Prima, P. Hellier, C. Kervrann, C.
Barillot, An Optimized Blockwise Non Local Means Denoising
Filter for 3D Magnetic Resonance Images, IEEE Transactions on
Medical Imaging, 27(4):425-441, 2008</p>
</div>
<div class="citation" id="id86" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Coupe11<span class="fn-bracket">]</span></span>
<p>Pierrick Coupe, Jose Manjon, Montserrat Robles, Louis Collins.
Adaptive Multiresolution Non-Local Means Filter for 3D MR Image
Denoising IET Image Processing, Institution of Engineering and
Technology, 2011</p>
</div>
</div>
</section>
</dd></dl>

</section>
<section id="patch2self">
<h3>patch2self<a class="headerlink" href="#patch2self" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.patch2self.patch2self">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.patch2self.</span></span><span class="sig-name descname"><span class="pre">patch2self</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ols'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b0_denoising</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_negative_vals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_intensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.patch2self.patch2self" title="Link to this definition">#</a></dt>
<dd><p>Patch2Self Denoiser.</p>
<section id="id87">
<h4>Parameters<a class="headerlink" href="#id87" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>data<span class="classifier">ndarray</span></dt><dd><p>The 4D noisy DWI data to be denoised.</p>
</dd>
<dt>bvals<span class="classifier">1D array</span></dt><dd><p>Array of the bvals from the DWI acquisition</p>
</dd>
<dt>patch_radius<span class="classifier">int or 1D array, optional</span></dt><dd><p>The radius of the local patch to be taken around each voxel (in
voxels). Default: 0 (denoise in blocks of 1x1x1 voxels).</p>
</dd>
<dt>model<span class="classifier">string, or initialized linear model object.</span></dt><dd><p>This will determine the algorithm used to solve the set of linear
equations underlying this model. If it is a string it needs to be
one of the following: {‘ols’, ‘ridge’, ‘lasso’}. Otherwise,
it can be an object that inherits from
<cite>dipy.optimize.SKLearnLinearSolver</cite> or an object with a similar
interface from Scikit-Learn:
<cite>sklearn.linear_model.LinearRegression</cite>,
<cite>sklearn.linear_model.Lasso</cite> or <cite>sklearn.linear_model.Ridge</cite>
and other objects that inherit from <cite>sklearn.base.RegressorMixin</cite>.
Default: ‘ols’.</p>
</dd>
<dt>b0_threshold<span class="classifier">int, optional</span></dt><dd><p>Threshold for considering volumes as b0.</p>
</dd>
<dt>out_dtype<span class="classifier">str or dtype, optional</span></dt><dd><p>The dtype for the output array. Default: output has the same dtype as
the input.</p>
</dd>
<dt>alpha<span class="classifier">float, optional</span></dt><dd><p>Regularization parameter only for ridge regression model.</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>Show progress of Patch2Self and time taken.</p>
</dd>
<dt>b0_denoising<span class="classifier">bool, optional</span></dt><dd><p>Skips denoising b0 volumes if set to False.</p>
</dd>
<dt>clip_negative_vals<span class="classifier">bool, optional</span></dt><dd><p>Sets negative values after denoising to 0 using <cite>np.clip</cite>.</p>
</dd>
<dt>shift_intensity<span class="classifier">bool, optional</span></dt><dd><p>Shifts the distribution of intensities per volume to give
non-negative values</p>
</dd>
</dl>
</section>
<section id="id88">
<h4>Returns<a class="headerlink" href="#id88" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>denoised array<span class="classifier">ndarray</span></dt><dd><p>This is the denoised array of the same size as that of the input data,
clipped to non-negative values.</p>
</dd>
</dl>
</section>
<section id="id89">
<h4>References<a class="headerlink" href="#id89" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>[Fadnavis20] S. Fadnavis, J. Batson, E. Garyfallidis, Patch2Self:</dt><dd><p>Denoising Diffusion MRI with Self-supervised Learning,
Advances in Neural Information Processing Systems 33 (2020)</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="pca-noise-estimate">
<h3>pca_noise_estimate<a class="headerlink" href="#pca-noise-estimate" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.pca_noise_estimate.pca_noise_estimate">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.pca_noise_estimate.</span></span><span class="sig-name descname"><span class="pre">pca_noise_estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gtab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">images_as_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.pca_noise_estimate.pca_noise_estimate" title="Link to this definition">#</a></dt>
<dd><p>PCA based local noise estimation.</p>
<section id="id90">
<h4>Parameters<a class="headerlink" href="#id90" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>data: 4D array</dt><dd><p>the input dMRI data. The first 3 dimension must have size &gt;= 2 *
patch_radius + 1 or size = 1.</p>
</dd>
<dt>gtab: gradient table object</dt><dd><p>gradient information for the data gives us the bvals and bvecs of
diffusion data, which is needed here to select between the noise
estimation methods.</p>
</dd>
<dt>patch_radius<span class="classifier">int</span></dt><dd><p>The radius of the local patch to be taken around each voxel (in
voxels). Default: 1 (estimate noise in blocks of 3x3x3 voxels).</p>
</dd>
<dt>correct_bias<span class="classifier">bool</span></dt><dd><p>Whether to correct for bias due to Rician noise. This is an
implementation of equation 8 in <a href="#id146"><span class="problematic" id="id91">[1]_</span></a>.</p>
</dd>
<dt>smooth<span class="classifier">int</span></dt><dd><p>Radius of a Gaussian smoothing filter to apply to the noise estimate
before returning. Default: 2.</p>
</dd>
<dt>image_as_samples<span class="classifier">bool, optional</span></dt><dd><p>Whether to use images as rows (samples) for PCA (algorithm in <a href="#id147"><span class="problematic" id="id92">[1]_</span></a>) or
to use images as columns (features).</p>
</dd>
</dl>
</section>
<section id="id93">
<h4>Returns<a class="headerlink" href="#id93" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>sigma_corr: 3D array</dt><dd><p>The local noise standard deviation estimate.</p>
</dd>
</dl>
</section>
<section id="id94">
<h4>Notes<a class="headerlink" href="#id94" title="Link to this heading">#</a></h4>
<blockquote>
<div><p>In <a href="#id148"><span class="problematic" id="id95">[1]_</span></a>, images are used as samples, so voxels are features, therefore
eigenvectors are image-shaped. However, <a href="#id149"><span class="problematic" id="id96">[1]_</span></a> is not clear on how to use
these eigenvectors to determine the noise level, so here eigenvalues
(variance over samples explained by eigenvectors) are used to scale
the eigenvectors. Use images_as_samples=True to use this algorithm.
Alternatively, voxels can be used as samples using
images_as_samples=False. This is not the canonical algorithm of <a href="#id150"><span class="problematic" id="id97">[1]_</span></a>.</p>
</div></blockquote>
</section>
<section id="id98">
<h4>References<a class="headerlink" href="#id98" title="Link to this heading">#</a></h4>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id99" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Manjon JV, Coupe P, Concha L, Buades A, Collins DL “Diffusion
Weighted Image Denoising Using Overcomplete Local PCA”. PLoS ONE
8(9): e73021. doi:10.1371/journal.pone.0073021.</p>
</aside>
</aside>
</section>
</dd></dl>

</section>
<section id="warn">
<h3>warn<a class="headerlink" href="#warn" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.pca_noise_estimate.warn">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.pca_noise_estimate.</span></span><span class="sig-name descname"><span class="pre">warn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacklevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.pca_noise_estimate.warn" title="Link to this definition">#</a></dt>
<dd><p>Issue a warning, or maybe ignore it or raise an exception.</p>
</dd></dl>

</section>
<section id="convolve">
<h3>convolve<a class="headerlink" href="#convolve" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.shift_twist_convolution.convolve">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.shift_twist_convolution.</span></span><span class="sig-name descname"><span class="pre">convolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">odfs_sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh_order_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.shift_twist_convolution.convolve" title="Link to this definition">#</a></dt>
<dd><p>Perform the shift-twist convolution with the ODF data and
the lookup-table of the kernel.</p>
<section id="id100">
<h4>Parameters<a class="headerlink" href="#id100" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>odfs<span class="classifier">array of double</span></dt><dd><p>The ODF data in spherical harmonics format</p>
</dd>
<dt>kernel<span class="classifier">array of double</span></dt><dd><p>The 5D lookup table</p>
</dd>
<dt>sh_order_max<span class="classifier">integer</span></dt><dd><p>Maximal spherical harmonics order (l)</p>
</dd>
<dt>test_mode<span class="classifier">boolean</span></dt><dd><p>Reduced convolution in one direction only for testing</p>
</dd>
<dt>num_threads<span class="classifier">int, optional</span></dt><dd><p>Number of threads to be used for OpenMP parallelization. If None
(default) the value of OMP_NUM_THREADS environment variable is used
if it is set, otherwise all available threads are used. If &lt; 0 the
maximal number of threads minus <a href="#id128"><span class="problematic" id="id129">|num_threads + 1|</span></a> is used (enter -1 to
use as many threads as possible). 0 raises an error.</p>
</dd>
<dt>normalize<span class="classifier">boolean</span></dt><dd><p>Apply max-normalization to the output such that its value range matches
the input ODF data.</p>
</dd>
</dl>
</section>
<section id="id101">
<h4>Returns<a class="headerlink" href="#id101" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>output<span class="classifier">array of double</span></dt><dd><p>The ODF data after convolution enhancement in spherical harmonics format</p>
</dd>
</dl>
</section>
<section id="id102">
<h4>References<a class="headerlink" href="#id102" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>[Meesters2016_ISMRM] S. Meesters, G. Sanguinetti, E. Garyfallidis,</dt><dd><p>J. Portegies, R. Duits. (2016) Fast implementations of
contextual PDE’s for HARDI data processing in DIPY.
ISMRM 2016 conference.</p>
</dd>
<dt>[DuitsAndFranken_IJCV] R. Duits and E. Franken (2011) Left-invariant diffusions</dt><dd><p>on the space of positions and orientations and their
application to crossing-preserving smoothing of HARDI
images. International Journal of Computer Vision, 92:231-264.</p>
</dd>
<dt>[Portegies2015] J. Portegies, G. Sanguinetti, S. Meesters, and R. Duits.</dt><dd><p>(2015) New Approximation of a Scale Space Kernel on SE(3) and
Applications in Neuroimaging. Fifth International
Conference on Scale Space and Variational Methods in
Computer Vision</p>
</dd>
<dt>[Portegies2015b] J. Portegies, R. Fick, G. Sanguinetti, S. Meesters, G.Girard,</dt><dd><p>and R. Duits. (2015) Improving Fiber Alignment in HARDI by
Combining Contextual PDE flow with Constrained Spherical
Deconvolution. PLoS One.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="convolve-sf">
<h3>convolve_sf<a class="headerlink" href="#convolve-sf" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.shift_twist_convolution.convolve_sf">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.shift_twist_convolution.</span></span><span class="sig-name descname"><span class="pre">convolve_sf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">odfs_sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.shift_twist_convolution.convolve_sf" title="Link to this definition">#</a></dt>
<dd><p>Perform the shift-twist convolution with the ODF data and
the lookup-table of the kernel.</p>
<section id="id103">
<h4>Parameters<a class="headerlink" href="#id103" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>odfs<span class="classifier">array of double</span></dt><dd><p>The ODF data sampled on a sphere</p>
</dd>
<dt>kernel<span class="classifier">array of double</span></dt><dd><p>The 5D lookup table</p>
</dd>
<dt>test_mode<span class="classifier">boolean</span></dt><dd><p>Reduced convolution in one direction only for testing</p>
</dd>
<dt>num_threads<span class="classifier">int, optional</span></dt><dd><p>Number of threads to be used for OpenMP parallelization. If None
(default) the value of OMP_NUM_THREADS environment variable is used
if it is set, otherwise all available threads are used. If &lt; 0 the
maximal number of threads minus <a href="#id130"><span class="problematic" id="id131">|num_threads + 1|</span></a> is used (enter -1 to
use as many threads as possible). 0 raises an error.</p>
</dd>
<dt>normalize<span class="classifier">boolean</span></dt><dd><p>Apply max-normalization to the output such that its value range matches
the input ODF data.</p>
</dd>
</dl>
</section>
<section id="id104">
<h4>Returns<a class="headerlink" href="#id104" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>output<span class="classifier">array of double</span></dt><dd><p>The ODF data after convolution enhancement, sampled on a sphere</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="deprecated-params">
<h3>deprecated_params<a class="headerlink" href="#deprecated-params" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.shift_twist_convolution.deprecated_params">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.shift_twist_convolution.</span></span><span class="sig-name descname"><span class="pre">deprecated_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_name=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">since=''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">until=''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version_comparator=&lt;function</span> <span class="pre">cmp_pkg_version&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg_in_kwargs=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn_class=&lt;class</span> <span class="pre">'dipy.utils.deprecator.ArgsDeprecationWarning'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_class=&lt;class</span> <span class="pre">'dipy.utils.deprecator.ExpiredDeprecationError'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alternative=''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.shift_twist_convolution.deprecated_params" title="Link to this definition">#</a></dt>
<dd><p>Deprecate a <em>renamed</em> or <em>removed</em> function argument.</p>
<p>The decorator assumes that the argument with the <code class="docutils literal notranslate"><span class="pre">old_name</span></code> was removed
from the function signature and the <code class="docutils literal notranslate"><span class="pre">new_name</span></code> replaced it at the
<strong>same position</strong> in the signature.  If the <code class="docutils literal notranslate"><span class="pre">old_name</span></code> argument is
given when calling the decorated function the decorator will catch it and
issue a deprecation warning and pass it on as <code class="docutils literal notranslate"><span class="pre">new_name</span></code> argument.</p>
<section id="id105">
<h4>Parameters<a class="headerlink" href="#id105" title="Link to this heading">#</a></h4>
<dl>
<dt>old_name<span class="classifier">str or list/tuple thereof</span></dt><dd><p>The old name of the argument.</p>
</dd>
<dt>new_name<span class="classifier">str or list/tuple thereof or <code class="docutils literal notranslate"><span class="pre">None</span></code>, optional</span></dt><dd><p>The new name of the argument. Set this to <cite>None</cite> to remove the
argument <code class="docutils literal notranslate"><span class="pre">old_name</span></code> instead of renaming it.</p>
</dd>
<dt>since<span class="classifier">str or number or list/tuple thereof, optional</span></dt><dd><p>The release at which the old argument became deprecated.</p>
</dd>
<dt>until<span class="classifier">str or number or list/tuple thereof, optional</span></dt><dd><p>Last released version at which this function will still raise a
deprecation warning.  Versions higher than this will raise an
error.</p>
</dd>
<dt>version_comparator<span class="classifier">callable</span></dt><dd><p>Callable accepting string as argument, and return 1 if string
represents a higher version than encoded in the <code class="docutils literal notranslate"><span class="pre">version_comparator</span></code>,
0 if the version is equal, and -1 if the version is lower. For example,
the <code class="docutils literal notranslate"><span class="pre">version_comparator</span></code> may compare the input version string to the
current package version string.</p>
</dd>
<dt>arg_in_kwargs<span class="classifier">bool or list/tuple thereof, optional</span></dt><dd><p>If the argument is not a named argument (for example it
was meant to be consumed by <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>) set this to
<code class="docutils literal notranslate"><span class="pre">True</span></code>.  Otherwise the decorator will throw an Exception
if the <code class="docutils literal notranslate"><span class="pre">new_name</span></code> cannot be found in the signature of
the decorated function.
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt>warn_class<span class="classifier">warning, optional</span></dt><dd><p>Warning to be issued.</p>
</dd>
<dt>error_class<span class="classifier">Exception, optional</span></dt><dd><p>Error to be issued</p>
</dd>
<dt>alternative<span class="classifier">str, optional</span></dt><dd><p>An alternative function or class name that the user may use in
place of the deprecated object if <code class="docutils literal notranslate"><span class="pre">new_name</span></code> is None. The deprecation
warning will tell the user about this alternative if provided.</p>
</dd>
</dl>
</section>
<section id="raises">
<h4>Raises<a class="headerlink" href="#raises" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>TypeError</dt><dd><p>If the new argument name cannot be found in the function
signature and arg_in_kwargs was False or if it is used to
deprecate the name of the <code class="docutils literal notranslate"><span class="pre">*args</span></code>-, <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>-like arguments.
At runtime such an Error is raised if both the new_name
and old_name were specified when calling the function and
“relax=False”.</p>
</dd>
</dl>
</section>
<section id="id106">
<h4>Notes<a class="headerlink" href="#id106" title="Link to this heading">#</a></h4>
<p>This function is based on the Astropy (major modification).
<a class="github reference external" href="https://github.com/astropy/astropy">astropy/astropy</a>. See COPYING file distributed along with
the astropy package for the copyright and license terms.</p>
</section>
<section id="id107">
<h4>Examples<a class="headerlink" href="#id107" title="Link to this heading">#</a></h4>
<p>The deprecation warnings are not shown in the following examples.
To deprecate a positional or keyword argument::
&gt;&gt;&gt; from dipy.utils.deprecator import deprecated_params
&gt;&gt;&gt; &#64;deprecated_params(‘sig’, ‘sigma’, ‘0.3’)
… def test(sigma):
…     return sigma
&gt;&gt;&gt; test(2)
2
&gt;&gt;&gt; test(sigma=2)
2
&gt;&gt;&gt; test(sig=2)  # doctest: +SKIP
2</p>
<p>It is also possible to replace multiple arguments. The <code class="docutils literal notranslate"><span class="pre">old_name</span></code>,
<code class="docutils literal notranslate"><span class="pre">new_name</span></code> and <code class="docutils literal notranslate"><span class="pre">since</span></code> have to be <cite>tuple</cite> or <cite>list</cite> and contain the
same number of entries::
&gt;&gt;&gt; &#64;deprecated_params([‘a’, ‘b’], [‘alpha’, ‘beta’],
…                    [‘0.2’, 0.4])
… def test(alpha, beta):
…     return alpha, beta
&gt;&gt;&gt; test(a=2, b=3)  # doctest: +SKIP
(2, 3)</p>
</section>
</dd></dl>

</section>
<section id="id108">
<h3>determine_num_threads<a class="headerlink" href="#id108" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.shift_twist_convolution.determine_num_threads">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.shift_twist_convolution.</span></span><span class="sig-name descname"><span class="pre">determine_num_threads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_threads</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.shift_twist_convolution.determine_num_threads" title="Link to this definition">#</a></dt>
<dd><p>Determine the effective number of threads to be used for OpenMP calls</p>
<ul class="simple">
<li><p>For <code class="docutils literal notranslate"><span class="pre">num_threads</span> <span class="pre">=</span> <span class="pre">None</span></code>,
- if the <code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code> environment variable is set, return that
value
- otherwise, return the maximum number of cores retrieved by
<code class="docutils literal notranslate"><span class="pre">openmp.opm_get_num_procs()</span></code>.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">num_threads</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, return this value.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">num_threads</span> <span class="pre">&lt;</span> <span class="pre">0</span></code>, return the maximal number of threads minus
<code class="docutils literal notranslate"><span class="pre">|num_threads</span> <span class="pre">+</span> <span class="pre">1|</span></code>. In particular <code class="docutils literal notranslate"><span class="pre">num_threads</span> <span class="pre">=</span> <span class="pre">-1</span></code> will use as
many threads as there are available cores on the machine.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">num_threads</span> <span class="pre">=</span> <span class="pre">0</span></code> a ValueError is raised.</p></li>
</ul>
<section id="id109">
<h4>Parameters<a class="headerlink" href="#id109" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>num_threads<span class="classifier">int or None</span></dt><dd><p>Desired number of threads to be used.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="sf-to-sh">
<h3>sf_to_sh<a class="headerlink" href="#sf-to-sh" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.shift_twist_convolution.sf_to_sh">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.shift_twist_convolution.</span></span><span class="sig-name descname"><span class="pre">sf_to_sh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh_order_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.shift_twist_convolution.sf_to_sh" title="Link to this definition">#</a></dt>
<dd><p>Spherical function to spherical harmonics (SH).</p>
<section id="id110">
<h4>Parameters<a class="headerlink" href="#id110" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>sf<span class="classifier">ndarray</span></dt><dd><p>Values of a function on the given <code class="docutils literal notranslate"><span class="pre">sphere</span></code>.</p>
</dd>
<dt>sphere<span class="classifier">Sphere</span></dt><dd><p>The points on which the sf is defined.</p>
</dd>
<dt>sh_order_max<span class="classifier">int, optional</span></dt><dd><p>Maximum SH order (l) in the SH fit.  For <code class="docutils literal notranslate"><span class="pre">sh_order_max</span></code>, there will be
<code class="docutils literal notranslate"><span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">*</span> <span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">2)</span> <span class="pre">/</span> <span class="pre">2</span></code> SH coefficients for a
symmetric basis and <code class="docutils literal notranslate"><span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">*</span> <span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">1)</span></code>
coefficients for a full SH basis.</p>
</dd>
<dt>basis_type<span class="classifier">{None, ‘tournier07’, ‘descoteaux07’}, optional</span></dt><dd><p><code class="docutils literal notranslate"><span class="pre">None</span></code> for the default DIPY basis,
<code class="docutils literal notranslate"><span class="pre">tournier07</span></code> for the Tournier 2007 [2]_[3]_ basis,
<code class="docutils literal notranslate"><span class="pre">descoteaux07</span></code> for the Descoteaux 2007 <a href="#id151"><span class="problematic" id="id111">[1]_</span></a> basis,
(<code class="docutils literal notranslate"><span class="pre">None</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">descoteaux07</span></code>).</p>
</dd>
<dt>full_basis: bool, optional</dt><dd><p>True for using a SH basis containing even and odd order SH functions.
False for using a SH basis consisting only of even order SH functions.</p>
</dd>
<dt>legacy: bool, optional</dt><dd><p>True to use a legacy basis definition for backward compatibility
with previous <code class="docutils literal notranslate"><span class="pre">tournier07</span></code> and <code class="docutils literal notranslate"><span class="pre">descoteaux07</span></code> implementations.</p>
</dd>
<dt>smooth<span class="classifier">float, optional</span></dt><dd><p>Lambda-regularization in the SH fit.</p>
</dd>
</dl>
</section>
<section id="id112">
<h4>Returns<a class="headerlink" href="#id112" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>sh<span class="classifier">ndarray</span></dt><dd><p>SH coefficients representing the input function.</p>
</dd>
</dl>
</section>
<section id="id113">
<h4>References<a class="headerlink" href="#id113" title="Link to this heading">#</a></h4>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id114" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Descoteaux, M., Angelino, E., Fitzgibbons, S. and Deriche, R.
Regularized, Fast, and Robust Analytical Q-ball Imaging.
Magn. Reson. Med. 2007;58:497-510.</p>
</aside>
<aside class="footnote brackets" id="id115" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Tournier J.D., Calamante F. and Connelly A. Robust determination
of the fibre orientation distribution in diffusion MRI:
Non-negativity constrained super-resolved spherical deconvolution.
NeuroImage. 2007;35(4):1459-1472.</p>
</aside>
<aside class="footnote brackets" id="id116" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>Tournier J-D, Smith R, Raffelt D, Tabbara R, Dhollander T,
Pietsch M, et al. MRtrix3: A fast, flexible and open software
framework for medical image processing and visualisation.
NeuroImage. 2019 Nov 15;202:116-137.</p>
</aside>
</aside>
</section>
</dd></dl>

</section>
<section id="sh-to-sf">
<h3>sh_to_sf<a class="headerlink" href="#sh-to-sf" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.denoise.shift_twist_convolution.sh_to_sf">
<span class="sig-prename descclassname"><span class="pre">dipy.denoise.shift_twist_convolution.</span></span><span class="sig-name descname"><span class="pre">sh_to_sf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sphere</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh_order_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dipy.denoise.shift_twist_convolution.sh_to_sf" title="Link to this definition">#</a></dt>
<dd><p>Spherical harmonics (SH) to spherical function (SF).</p>
<section id="id117">
<h4>Parameters<a class="headerlink" href="#id117" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>sh<span class="classifier">ndarray</span></dt><dd><p>SH coefficients representing a spherical function.</p>
</dd>
<dt>sphere<span class="classifier">Sphere</span></dt><dd><p>The points on which to sample the spherical function.</p>
</dd>
<dt>sh_order_max<span class="classifier">int, optional</span></dt><dd><p>Maximum SH order (l) in the SH fit.  For <code class="docutils literal notranslate"><span class="pre">sh_order_max</span></code>, there will be
<code class="docutils literal notranslate"><span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">*</span> <span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">2)</span> <span class="pre">/</span> <span class="pre">2</span></code> SH coefficients for a
symmetric basis and <code class="docutils literal notranslate"><span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">*</span> <span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">1)</span></code>
coefficients for a full SH basis.</p>
</dd>
<dt>basis_type<span class="classifier">{None, ‘tournier07’, ‘descoteaux07’}, optional</span></dt><dd><p><code class="docutils literal notranslate"><span class="pre">None</span></code> for the default DIPY basis,
<code class="docutils literal notranslate"><span class="pre">tournier07</span></code> for the Tournier 2007 [2]_[3]_ basis,
<code class="docutils literal notranslate"><span class="pre">descoteaux07</span></code> for the Descoteaux 2007 <a href="#id152"><span class="problematic" id="id118">[1]_</span></a> basis,
(<code class="docutils literal notranslate"><span class="pre">None</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">descoteaux07</span></code>).</p>
</dd>
<dt>full_basis: bool, optional</dt><dd><p>True to use a SH basis containing even and odd order SH functions.
Else, use a SH basis consisting only of even order SH functions.</p>
</dd>
<dt>legacy: bool, optional</dt><dd><p>True to use a legacy basis definition for backward compatibility
with previous <code class="docutils literal notranslate"><span class="pre">tournier07</span></code> and <code class="docutils literal notranslate"><span class="pre">descoteaux07</span></code> implementations.</p>
</dd>
</dl>
</section>
<section id="id119">
<h4>Returns<a class="headerlink" href="#id119" title="Link to this heading">#</a></h4>
<dl class="simple">
<dt>sf<span class="classifier">ndarray</span></dt><dd><p>Spherical function values on the <code class="docutils literal notranslate"><span class="pre">sphere</span></code>.</p>
</dd>
</dl>
</section>
<section id="id120">
<h4>References<a class="headerlink" href="#id120" title="Link to this heading">#</a></h4>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id121" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Descoteaux, M., Angelino, E., Fitzgibbons, S. and Deriche, R.
Regularized, Fast, and Robust Analytical Q-ball Imaging.
Magn. Reson. Med. 2007;58:497-510.</p>
</aside>
<aside class="footnote brackets" id="id122" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Tournier J.D., Calamante F. and Connelly A. Robust determination
of the fibre orientation distribution in diffusion MRI:
Non-negativity constrained super-resolved spherical deconvolution.
NeuroImage. 2007;35(4):1459-1472.</p>
</aside>
<aside class="footnote brackets" id="id123" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>Tournier J-D, Smith R, Raffelt D, Tabbara R, Dhollander T,
Pietsch M, et al. MRtrix3: A fast, flexible and open software
framework for medical image processing and visualisation.
NeuroImage. 2019 Nov 15;202:116-137.</p>
</aside>
</aside>
</section>
</dd></dl>

</section>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="dipy.data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">data</span></code></p>
      </div>
    </a>
    <a class="right-next"
       href="dipy.direction.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">direction</span></code></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.adaptive_soft_matching">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.adaptive_soft_matching</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.denspeed">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.denspeed</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.enhancement_kernel">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.enhancement_kernel</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.gibbs">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.gibbs</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.localpca">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.localpca</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.nlmeans">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.nlmeans</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.nlmeans_block">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.nlmeans_block</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.noise_estimate">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.noise_estimate</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.non_local_means">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.non_local_means</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.patch2self">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.patch2self</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.pca_noise_estimate">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.pca_noise_estimate</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pca-based-local-noise-estimation">PCA Based Local Noise Estimation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.denoise.shift_twist_convolution">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise.shift_twist_convolution</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptive-soft-matching">adaptive_soft_matching</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.adaptive_soft_matching.adaptive_soft_matching"><code class="docutils literal notranslate"><span class="pre">adaptive_soft_matching()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-padding-reflection">add_padding_reflection</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.denspeed.add_padding_reflection"><code class="docutils literal notranslate"><span class="pre">add_padding_reflection()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correspond-indices">correspond_indices</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.denspeed.correspond_indices"><code class="docutils literal notranslate"><span class="pre">correspond_indices()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#determine-num-threads">determine_num_threads</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.denspeed.determine_num_threads"><code class="docutils literal notranslate"><span class="pre">determine_num_threads()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nlmeans-3d">nlmeans_3d</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.denspeed.nlmeans_3d"><code class="docutils literal notranslate"><span class="pre">nlmeans_3d()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-padding">remove_padding</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.denspeed.remove_padding"><code class="docutils literal notranslate"><span class="pre">remove_padding()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enhancementkernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnhancementKernel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.EnhancementKernel"><code class="docutils literal notranslate"><span class="pre">EnhancementKernel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.EnhancementKernel.__init__"><code class="docutils literal notranslate"><span class="pre">EnhancementKernel.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.EnhancementKernel.evaluate_kernel"><code class="docutils literal notranslate"><span class="pre">EnhancementKernel.evaluate_kernel()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.EnhancementKernel.get_lookup_table"><code class="docutils literal notranslate"><span class="pre">EnhancementKernel.get_lookup_table()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.EnhancementKernel.get_orientations"><code class="docutils literal notranslate"><span class="pre">EnhancementKernel.get_orientations()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.EnhancementKernel.get_sphere"><code class="docutils literal notranslate"><span class="pre">EnhancementKernel.get_sphere()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hemisphere"><code class="xref py py-class docutils literal notranslate"><span class="pre">HemiSphere</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.HemiSphere"><code class="docutils literal notranslate"><span class="pre">HemiSphere</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.HemiSphere.__init__"><code class="docutils literal notranslate"><span class="pre">HemiSphere.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.HemiSphere.faces"><code class="docutils literal notranslate"><span class="pre">HemiSphere.faces()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.HemiSphere.find_closest"><code class="docutils literal notranslate"><span class="pre">HemiSphere.find_closest()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.HemiSphere.from_sphere"><code class="docutils literal notranslate"><span class="pre">HemiSphere.from_sphere()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.HemiSphere.mirror"><code class="docutils literal notranslate"><span class="pre">HemiSphere.mirror()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.HemiSphere.subdivide"><code class="docutils literal notranslate"><span class="pre">HemiSphere.subdivide()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sphere"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sphere</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.Sphere"><code class="docutils literal notranslate"><span class="pre">Sphere</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.Sphere.__init__"><code class="docutils literal notranslate"><span class="pre">Sphere.__init__()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.Sphere.edges"><code class="docutils literal notranslate"><span class="pre">Sphere.edges()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.Sphere.faces"><code class="docutils literal notranslate"><span class="pre">Sphere.faces()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.Sphere.find_closest"><code class="docutils literal notranslate"><span class="pre">Sphere.find_closest()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.Sphere.subdivide"><code class="docutils literal notranslate"><span class="pre">Sphere.subdivide()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.Sphere.vertices"><code class="docutils literal notranslate"><span class="pre">Sphere.vertices()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.Sphere.x"><code class="docutils literal notranslate"><span class="pre">Sphere.x</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.Sphere.y"><code class="docutils literal notranslate"><span class="pre">Sphere.y</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.Sphere.z"><code class="docutils literal notranslate"><span class="pre">Sphere.z</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ceil">ceil</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.ceil"><code class="docutils literal notranslate"><span class="pre">ceil()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disperse-charges">disperse_charges</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.disperse_charges"><code class="docutils literal notranslate"><span class="pre">disperse_charges()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-sphere">get_sphere</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.get_sphere"><code class="docutils literal notranslate"><span class="pre">get_sphere()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gettempdir">gettempdir</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.enhancement_kernel.gettempdir"><code class="docutils literal notranslate"><span class="pre">gettempdir()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gibbs-removal">gibbs_removal</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.gibbs.gibbs_removal"><code class="docutils literal notranslate"><span class="pre">gibbs_removal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensionality-problem-message">dimensionality_problem_message</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.dimensionality_problem_message"><code class="docutils literal notranslate"><span class="pre">dimensionality_problem_message()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-patch-radius-arr">create_patch_radius_arr</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.create_patch_radius_arr"><code class="docutils literal notranslate"><span class="pre">create_patch_radius_arr()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-patch-size">compute_patch_size</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.compute_patch_size"><code class="docutils literal notranslate"><span class="pre">compute_patch_size()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-num-samples">compute_num_samples</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.compute_num_samples"><code class="docutils literal notranslate"><span class="pre">compute_num_samples()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-suggested-patch-radius">compute_suggested_patch_radius</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.compute_suggested_patch_radius"><code class="docutils literal notranslate"><span class="pre">compute_suggested_patch_radius()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#genpca">genpca</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.genpca"><code class="docutils literal notranslate"><span class="pre">genpca()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#localpca">localpca</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.localpca"><code class="docutils literal notranslate"><span class="pre">localpca()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mppca">mppca</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.localpca.mppca"><code class="docutils literal notranslate"><span class="pre">mppca()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nlmeans">nlmeans</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.nlmeans.nlmeans"><code class="docutils literal notranslate"><span class="pre">nlmeans()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#firdn">firdn</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.nlmeans_block.firdn"><code class="docutils literal notranslate"><span class="pre">firdn()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nlmeans-block">nlmeans_block</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.nlmeans_block.nlmeans_block"><code class="docutils literal notranslate"><span class="pre">nlmeans_block()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upfir">upfir</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.nlmeans_block.upfir"><code class="docutils literal notranslate"><span class="pre">upfir()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#piesno">piesno</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.noise_estimate.piesno"><code class="docutils literal notranslate"><span class="pre">piesno()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-sigma">estimate_sigma</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.noise_estimate.estimate_sigma"><code class="docutils literal notranslate"><span class="pre">estimate_sigma()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-local-means">non_local_means</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.non_local_means.non_local_means"><code class="docutils literal notranslate"><span class="pre">non_local_means()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#patch2self">patch2self</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.patch2self.patch2self"><code class="docutils literal notranslate"><span class="pre">patch2self()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pca-noise-estimate">pca_noise_estimate</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.pca_noise_estimate.pca_noise_estimate"><code class="docutils literal notranslate"><span class="pre">pca_noise_estimate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warn">warn</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.pca_noise_estimate.warn"><code class="docutils literal notranslate"><span class="pre">warn()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convolve">convolve</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.shift_twist_convolution.convolve"><code class="docutils literal notranslate"><span class="pre">convolve()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convolve-sf">convolve_sf</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.shift_twist_convolution.convolve_sf"><code class="docutils literal notranslate"><span class="pre">convolve_sf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deprecated-params">deprecated_params</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.shift_twist_convolution.deprecated_params"><code class="docutils literal notranslate"><span class="pre">deprecated_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id108">determine_num_threads</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.shift_twist_convolution.determine_num_threads"><code class="docutils literal notranslate"><span class="pre">determine_num_threads()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sf-to-sh">sf_to_sh</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.shift_twist_convolution.sf_to_sh"><code class="docutils literal notranslate"><span class="pre">sf_to_sh()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sh-to-sf">sh_to_sf</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.denoise.shift_twist_convolution.sh_to_sf"><code class="docutils literal notranslate"><span class="pre">sh_to_sf()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  
<script type="module" src="../_static/scripts/grg-sphinx-theme.js"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><div>
  <h3 class="footer-heading">
    Never miss an update from us!
  </h3>
  <p class="footer-sub-heading">
    Don't worry! we are not going to spam you.
  </p>
  <div class="input-group mb-3 mar-t-10">
    <input type="text" class="form-control" placeholder="You email" aria-label="You email" id="grg-subscribe-email">
    <div class="input-group-append pointer" onclick="(document.getElementById('grg-subscribe-email').value)">
      <span class="input-group-text subscribe">Subscribe</span>
    </div>
  </div>  
  <ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter/X</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-youtube"></i></span>
            <label class="sr-only">YouTube</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin"></i></span>
            <label class="sr-only">LinkedIn</label></a>
        </li>
</ul>
</div></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="grid-3">
  
  <div>
    <h5 class="footer-heading">
      About
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://dipy.org/team">
            Developers
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://github.com/dipy/dipy/discussions" target="_blank" rel="noopener noreferrer">
            Support
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../user_guide/installation.html">
            Download
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../user_guide/getting_started.html">
            Get Started
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../examples_built/index.html">
            Tutorials
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank" rel="noopener noreferrer">
            Videos
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Friends
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/" target="_blank" rel="noopener noreferrer">
            Nipy Projects
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://fury.gl/" target="_blank" rel="noopener noreferrer">
            FURY
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/nibabel" target="_blank" rel="noopener noreferrer">
            Nibabel
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://tortoise.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            Tortoise
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Support
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://engineering.indiana.edu/" target="_blank" rel="noopener noreferrer">
            The department of Intelligent Systems Engineering of Indiana University
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            The National Institute of Biomedical Imaging and Bioengineering, NIH
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://escience.washington.edu" target="_blank" rel="noopener noreferrer">
            The Gordon and Betty Moore Foundation and the Alfred P. Sloan Foundation, through the University of Washington eScience Institute Data Science Environment
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://summerofcode.withgoogle.com/" target="_blank" rel="noopener noreferrer">
            Google supported DIPY through the Google Summer of Code Program (2015-2024)
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
</div></div>
      
    </div>
  
</div>

    <div class="copyright-text">
      <i class="fa-regular fa-copyright"></i> Copyright 2008-2024, DIPY developers. Created using Grg Sphinx Theme and PyData Sphinx Theme.
    </div>
  </footer>
  </body>
</html>