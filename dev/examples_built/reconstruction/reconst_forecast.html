
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DIPY &#8212; dipy 1.10.0.dev0+199.e3b0e11 documentation</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/dipy.css?v=cedb193d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

  
<link rel="stylesheet" href="../../_static/styles/grg-sphinx-theme.css"/>

    <script src="../../_static/documentation_options.js?v=611e7fdb"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D610GKJZRC"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples_built/reconstruction/reconst_forecast';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.dipy.org/dev/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'development';
        </script>
    <link rel="icon" href="../../_static/dipy-favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Local reconstruction using the Histological ResDNN" href="histology_resdnn.html" />
    <link rel="prev" title="Reconstruction of the diffusion signal with the Tensor model" href="reconst_dti.html" />
  <meta name="keywords" content="DIPY, dMRI, DTI, DSI, diffusion MRI, Tensor,
  neuroimaging, python, neuroscience, Eleftherios, Garyfallidis, tractography,
  streamlines, fiber tracking">

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
   

<a class="navbar-brand logo" href="https://dipy.org">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/dipy-logo.png" class="logo__image only-light" alt="DIPY"/>
    <script>document.write(`<img src="../../_static/dipy-logo.png" class="logo__image only-dark" alt="DIPY"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference/index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      development  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter/X</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-youtube"></i></span>
            <label class="sr-only">YouTube</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin"></i></span>
            <label class="sr-only">LinkedIn</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

</nav>
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference/index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      development  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter/X</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-youtube"></i></span>
            <label class="sr-only">YouTube</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin"></i></span>
            <label class="sr-only">LinkedIn</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../quick_start/index.html">Quick Start</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../quick_start/quick_start.html">Getting started with DIPY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick_start/tracking_introduction_eudx.html">Introduction to Basic Tracking</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../preprocessing/index.html">Preprocessing</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/reslice_datasets.html">Reslice diffusion datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/motion_correction.html">Between-volumes Motion Correction on DWI datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/piesno.html">Noise estimation using PIESNO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_nlmeans.html">Denoise images using Non-Local Means (NLMEANS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/brain_extraction_dwi.html">Brain segmentation with median_otsu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_patch2self.html">Patch2Self: Self-Supervised Denoising via Statistical Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_localpca.html">Denoise images using Local PCA via empirical thresholds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/gradients_spheres.html">Gradients and Spheres</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_ascm.html">Denoise images using Adaptive Soft Coefficient Matching (ASCM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/snr_in_cc.html">SNR estimation for Diffusion-Weighted Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_mppca.html">Denoise images using the Marcenko-Pastur PCA algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_gibbs.html">Suppress Gibbs oscillations</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Reconstruction</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="reconst_qtiplus.html">Applying positivity constraints to Q-space Trajectory Imaging (QTI+)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dsi.html">Reconstruct with Diffusion Spectrum Imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_cti.html">Reconstruction of the diffusion signal with the correlation tensor model</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dsid.html">DSI Deconvolution vs DSI</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_shore_metrics.html">Calculate SHORE scalar maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_shore.html">Continuous and analytical diffusion signal modelling with 3D-SHORE</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_gqi.html">Reconstruct with Generalized Q-Sampling Imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_csa.html">Reconstruct with Constant Solid Angle (Q-Ball)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_sfm.html">Reconstruction with the Sparse Fascicle Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dsi_metrics.html">Calculate DSI-based scalar maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dki.html">Reconstruction of the diffusion signal with the kurtosis tensor model</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_qti.html">Reconstruct with Q-space Trajectory Imaging (QTI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="kfold_xval.html">K-fold cross-validation for model comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dti.html">Reconstruction of the diffusion signal with the Tensor model</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Crossing invariant fiber response function with FORECAST model</a></li>
<li class="toctree-l2"><a class="reference internal" href="histology_resdnn.html">Local reconstruction using the Histological ResDNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dki_micro.html">Reconstruction of the diffusion signal with the WMTI model</a></li>
<li class="toctree-l2"><a class="reference internal" href="restore_dti.html">Using the RESTORE algorithm for robust tensor fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_sh.html">Signal Reconstruction Using Spherical Harmonics</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_fwdti.html">Using the free water elimination model to remove DTI free water contamination</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_ivim.html">Intravoxel incoherent motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_csd.html">Reconstruction with Constrained Spherical Deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_mcsd.html">Reconstruction with Multi-Shell Multi-Tissue CSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_mapmri.html">Continuous and analytical diffusion signal modelling with MAP-MRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_msdki.html">Mean signal diffusion kurtosis imaging (MSDKI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_rumba.html">Reconstruction with Robust and Unbiased Model-BAsed Spherical Deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_qtdmri.html">Estimating diffusion time dependent q-space indices using qt-dMRI</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contextual_enhancement/index.html">Contextual Enhancement</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../contextual_enhancement/fiber_to_bundle_coherence.html">Fiber to bundle coherence measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contextual_enhancement/contextual_enhancement.html">Crossing-preserving contextual enhancement</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fiber_tracking/index.html">Fiber Tracking</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/surface_seed.html">Surface seeding for tractography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_deterministic.html">An introduction to the Deterministic Maximum Direction Getter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_ptt.html">Parallel Transport Tractography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_rumba.html">Tracking with Robust Unbiased Model-BAsed Spherical Deconvolution (RUMBA-SD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_bootstrap_peaks.html">Bootstrap and Closest Peak Direction Getters Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_sfm.html">Tracking with the Sparse Fascicle Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_introduction_eudx_1.html">Introduction to Basic Tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_probabilistic.html">An introduction to the Probabilistic Direction Getter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_pft.html">Particle Filtering Tractography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/linear_fascicle_evaluation.html">Linear fascicle evaluation (LiFE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_stopping_criterion.html">Using Various Stopping Criterion for Tractography</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../streamline_analysis/index.html">Streamlines Analysis and Connectivity</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/bundle_shape_similarity.html">BUAN Bundle Shape Similarity Score</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/bundle_assignment_maps.html">BUAN Bundle Assignment Maps Creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/afq_tract_profiles.html">Extracting AFQ tract profiles from segmented bundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/streamline_length.html">Streamline length and size reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/cluster_confidence.html">Calculation of Outliers with Cluster Confidence Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/path_length_map.html">Calculate Path Length Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/streamline_tools.html">Connectivity Matrices, ROI Intersections and Density Maps</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../registration/index.html">Registration</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../registration/bundle_group_registration.html">Groupwise Bundle Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/bundle_registration.html">Direct Bundle Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/syn_registration_3d.html">Symmetric Diffeomorphic Registration in 3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/syn_registration_2d.html">Symmetric Diffeomorphic Registration in 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/register_binary_fuzzy.html">Diffeomorphic Registration with binary and fuzzy images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/bundlewarp_registration.html">Nonrigid Bundle Registration with BundleWarp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/streamline_registration.html">Applying image-based deformations to streamlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/affine_registration_masks.html">Affine Registration with Masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/affine_registration_3d.html">Affine Registration in 3D</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../segmentation/index.html">Segmentation</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/brain_extraction_dwi_1.html">Brain segmentation with median_otsu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_quickbundles.html">Tractography Clustering with QuickBundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/tissue_classification.html">Tissue Classification of a T1-weighted Structural Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_clustering_metrics.html">Tractography Clustering - Available Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/fast_streamline_search.html">Fast Streamline Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_extending_clustering_framework.html">Enhancing QuickBundles with different metrics and features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_clustering_features.html">Tractography Clustering - Available Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/bundle_extraction.html">Automatic Fiber Bundle Extraction with RecoBundles</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../simulations/index.html">Simulation</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../simulations/reconst_dsid_1.html">DSI Deconvolution vs DSI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/simulate_dki.html">DKI MultiTensor Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/simulate_multi_tensor.html">MultiTensor Simulation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../multiprocessing/index.html">Multiprocessing</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../multiprocessing/reconst_csa_parallel.html">Parallel reconstruction using Q-Ball</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multiprocessing/reconst_csd_parallel.html">Parallel reconstruction using CSD</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../file_formats/index.html">File Formats</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../file_formats/streamline_formats.html">Read/Write streamline files</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualization/index.html">Visualization</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_roi_contour.html">Visualization of ROI Surface Rendered with Streamlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_bundles.html">Visualize bundles and metrics on bundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_slice.html">Simple volume slicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_advanced.html">Advanced interactive visualization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../workflows/index.html">Workflows</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../workflows/workflow_creation.html">Creating a new workflow.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workflows/combined_workflow_creation.html">Creating a new combined workflow</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Reconstruction</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">DIPY</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-built-reconstruction-reconst-forecast-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="crossing-invariant-fiber-response-function-with-forecast-model">
<span id="sphx-glr-examples-built-reconstruction-reconst-forecast-py"></span><h1>Crossing invariant fiber response function with FORECAST model<a class="headerlink" href="#crossing-invariant-fiber-response-function-with-forecast-model" title="Link to this heading">#</a></h1>
<p>We show how to obtain a voxel specific response function in the form of
axially symmetric tensor and the fODF using the FORECAST model from
<a class="reference internal" href="#anderson2005" id="id1"><span>[Anderson2005]</span></a> , <a class="reference internal" href="#kaden2016" id="id2"><span>[Kaden2016]</span></a> and <a class="reference internal" href="#zucchelli2017" id="id3"><span>[Zucchelli2017]</span></a>.</p>
<p>First import the necessary modules:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">dipy.reconst.forecast</span> <span class="kn">import</span> <span class="n">ForecastModel</span>
<span class="kn">from</span> <span class="nn">dipy.viz</span> <span class="kn">import</span> <span class="n">actor</span><span class="p">,</span> <span class="n">window</span>
<span class="kn">from</span> <span class="nn">dipy.data</span> <span class="kn">import</span> <span class="n">fetch_hbn</span><span class="p">,</span> <span class="n">get_sphere</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">op</span>
<span class="kn">from</span> <span class="nn">dipy.core.gradients</span> <span class="kn">import</span> <span class="n">gradient_table</span>
</pre></div>
</div>
<p>Download and read the data for this tutorial. Our implementation of FORECAST
requires multi-shell <cite>data.fetch_hbn()</cite> provides data that was acquired using
b-values of 1000 and 2000 as part of the Healthy Brain Network study
<a class="reference internal" href="#alexander2017" id="id4"><span>[Alexander2017]</span></a> and was preprocessed and quality controlled in the HBN-POD2
dataset <a class="reference internal" href="#richiehalford2022" id="id5"><span>[RichieHalford2022]</span></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <span class="n">fetch_hbn</span><span class="p">([</span><span class="s2">&quot;NDARAA948VFH&quot;</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dwi_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span>
       <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a><span class="p">,</span> <span class="s2">&quot;derivatives&quot;</span><span class="p">,</span> <span class="s2">&quot;qsiprep&quot;</span><span class="p">,</span> <span class="s2">&quot;sub-NDARAA948VFH&quot;</span><span class="p">,</span>
       <span class="s2">&quot;ses-HBNsiteRU&quot;</span><span class="p">,</span> <span class="s2">&quot;dwi&quot;</span><span class="p">)</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span>
       <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dwi_path</span></a><span class="p">,</span>
       <span class="s2">&quot;sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.nii.gz&quot;</span><span class="p">))</span>

<span class="n">gtab</span> <span class="o">=</span> <span class="n">gradient_table</span><span class="p">(</span>
       <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dwi_path</span></a><span class="p">,</span>
<span class="s2">&quot;sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bval&quot;</span><span class="p">),</span>
       <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dwi_path</span></a><span class="p">,</span>
<span class="s2">&quot;sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bvec&quot;</span><span class="p">))</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">dataobj</span><span class="p">)</span>

<span class="n">mask_img</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
       <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">op</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dwi_path</span></a><span class="p">,</span>
<span class="s2">&quot;sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-brain_mask.nii.gz&quot;</span><span class="p">))</span>

<span class="n">brain_mask</span> <span class="o">=</span> <span class="n">mask_img</span><span class="o">.</span><span class="n">get_fdata</span><span class="p">()</span>
</pre></div>
</div>
<p>Let us consider only a single slice for the FORECAST fitting</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">data_small</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">50</span><span class="p">:</span><span class="mi">51</span><span class="p">]</span>
<span class="n">mask_small</span> <span class="o">=</span> <span class="n">brain_mask</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">50</span><span class="p">:</span><span class="mi">51</span><span class="p">]</span>
</pre></div>
</div>
<p>Instantiate the FORECAST Model.</p>
<p>“sh_order_max” is the spherical harmonics order (l) used for the fODF.</p>
<p>dec_alg is the spherical deconvolution algorithm used for the FORECAST basis
fitting, in this case we used the Constrained Spherical Deconvolution (CSD)
algorithm.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fm</span> <span class="o">=</span> <span class="n">ForecastModel</span><span class="p">(</span><span class="n">gtab</span><span class="p">,</span> <span class="n">sh_order_max</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">dec_alg</span><span class="o">=</span><span class="s1">&#39;CSD&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Fit the FORECAST to the data</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">f_fit</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_small</span><span class="p">,</span> <span class="n">mask_small</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/5148.0 [00:00&lt;?, ?it/s]
  0%|          | 2/5148.0 [00:00&lt;04:39, 18.41it/s]
  0%|          | 14/5148.0 [00:00&lt;01:11, 71.76it/s]
  0%|          | 22/5148.0 [00:00&lt;01:32, 55.46it/s]
  1%|▏         | 71/5148.0 [00:00&lt;00:26, 191.29it/s]
  2%|▏         | 94/5148.0 [00:00&lt;00:27, 182.25it/s]
  2%|▏         | 115/5148.0 [00:00&lt;00:34, 143.99it/s]
  3%|▎         | 132/5148.0 [00:01&lt;00:37, 133.82it/s]
  3%|▎         | 148/5148.0 [00:01&lt;00:43, 114.53it/s]
  3%|▎         | 161/5148.0 [00:01&lt;01:15, 65.91it/s]
  3%|▎         | 171/5148.0 [00:01&lt;01:21, 60.71it/s]
  3%|▎         | 180/5148.0 [00:01&lt;01:16, 64.68it/s]
  4%|▎         | 189/5148.0 [00:02&lt;01:31, 54.16it/s]
  4%|▍         | 196/5148.0 [00:02&lt;01:39, 49.54it/s]
  4%|▍         | 208/5148.0 [00:02&lt;01:21, 60.70it/s]
  4%|▍         | 227/5148.0 [00:02&lt;00:58, 83.57it/s]
  5%|▍         | 238/5148.0 [00:03&lt;01:24, 58.00it/s]
  5%|▍         | 247/5148.0 [00:03&lt;01:57, 41.88it/s]
  5%|▍         | 254/5148.0 [00:03&lt;02:10, 37.45it/s]
  5%|▌         | 260/5148.0 [00:03&lt;02:01, 40.14it/s]
  5%|▌         | 270/5148.0 [00:03&lt;01:38, 49.43it/s]
  5%|▌         | 278/5148.0 [00:04&lt;01:29, 54.55it/s]
  6%|▌         | 285/5148.0 [00:04&lt;01:25, 56.56it/s]
  6%|▌         | 297/5148.0 [00:04&lt;01:17, 62.96it/s]
  6%|▌         | 305/5148.0 [00:04&lt;01:26, 55.79it/s]
  6%|▋         | 326/5148.0 [00:04&lt;00:54, 88.13it/s]
  7%|▋         | 337/5148.0 [00:04&lt;00:51, 92.71it/s]
  7%|▋         | 352/5148.0 [00:04&lt;00:46, 103.34it/s]
  7%|▋         | 364/5148.0 [00:04&lt;00:50, 95.20it/s]
  7%|▋         | 375/5148.0 [00:05&lt;00:48, 98.80it/s]
  8%|▊         | 389/5148.0 [00:05&lt;00:43, 108.89it/s]
  8%|▊         | 401/5148.0 [00:05&lt;00:44, 107.84it/s]
  8%|▊         | 413/5148.0 [00:05&lt;01:01, 77.32it/s]
  8%|▊         | 423/5148.0 [00:05&lt;00:59, 78.84it/s]
  9%|▊         | 439/5148.0 [00:05&lt;00:49, 94.36it/s]
  9%|▊         | 450/5148.0 [00:06&lt;01:15, 62.06it/s]
  9%|▉         | 460/5148.0 [00:06&lt;01:10, 66.17it/s]
  9%|▉         | 473/5148.0 [00:06&lt;01:10, 65.88it/s]
  9%|▉         | 483/5148.0 [00:06&lt;01:07, 69.33it/s]
 10%|▉         | 492/5148.0 [00:06&lt;01:03, 72.90it/s]
 10%|▉         | 507/5148.0 [00:06&lt;00:54, 84.83it/s]
 10%|█         | 517/5148.0 [00:06&lt;01:04, 72.03it/s]
 10%|█         | 530/5148.0 [00:07&lt;00:57, 80.38it/s]
 10%|█         | 539/5148.0 [00:07&lt;01:08, 67.71it/s]
 11%|█         | 576/5148.0 [00:07&lt;00:35, 130.41it/s]
 12%|█▏        | 608/5148.0 [00:07&lt;00:26, 172.02it/s]
 12%|█▏        | 629/5148.0 [00:07&lt;00:38, 118.20it/s]
 13%|█▎        | 646/5148.0 [00:07&lt;00:39, 115.18it/s]
 13%|█▎        | 661/5148.0 [00:08&lt;00:54, 82.74it/s]
 13%|█▎        | 673/5148.0 [00:08&lt;01:06, 67.56it/s]
 13%|█▎        | 683/5148.0 [00:08&lt;01:11, 62.15it/s]
 13%|█▎        | 691/5148.0 [00:08&lt;01:09, 64.02it/s]
 14%|█▎        | 699/5148.0 [00:09&lt;01:06, 66.81it/s]
 14%|█▍        | 710/5148.0 [00:09&lt;00:58, 75.29it/s]
 14%|█▍        | 719/5148.0 [00:09&lt;01:19, 55.45it/s]
 14%|█▍        | 731/5148.0 [00:09&lt;01:06, 66.72it/s]
 14%|█▍        | 740/5148.0 [00:09&lt;01:07, 64.88it/s]
 15%|█▍        | 749/5148.0 [00:09&lt;01:03, 69.47it/s]
 15%|█▍        | 762/5148.0 [00:09&lt;00:52, 82.99it/s]
 15%|█▍        | 772/5148.0 [00:09&lt;00:51, 85.57it/s]
 15%|█▌        | 782/5148.0 [00:10&lt;00:51, 84.91it/s]
 15%|█▌        | 792/5148.0 [00:10&lt;01:39, 43.71it/s]
 16%|█▌        | 810/5148.0 [00:10&lt;01:07, 64.68it/s]
 16%|█▌        | 821/5148.0 [00:10&lt;01:01, 70.89it/s]
 16%|█▌        | 832/5148.0 [00:11&lt;02:12, 32.61it/s]
 16%|█▋        | 840/5148.0 [00:12&lt;02:41, 26.75it/s]
 16%|█▋        | 846/5148.0 [00:12&lt;02:30, 28.55it/s]
 17%|█▋        | 854/5148.0 [00:12&lt;02:04, 34.54it/s]
 17%|█▋        | 861/5148.0 [00:12&lt;01:53, 37.93it/s]
 17%|█▋        | 867/5148.0 [00:12&lt;01:50, 38.73it/s]
 17%|█▋        | 873/5148.0 [00:12&lt;02:16, 31.24it/s]
 17%|█▋        | 878/5148.0 [00:13&lt;02:14, 31.86it/s]
 17%|█▋        | 884/5148.0 [00:13&lt;02:03, 34.59it/s]
 17%|█▋        | 893/5148.0 [00:13&lt;01:36, 44.29it/s]
 18%|█▊        | 907/5148.0 [00:13&lt;01:05, 64.26it/s]
 18%|█▊        | 915/5148.0 [00:13&lt;01:47, 39.39it/s]
 18%|█▊        | 922/5148.0 [00:13&lt;01:37, 43.56it/s]
 18%|█▊        | 929/5148.0 [00:14&lt;01:47, 39.20it/s]
 18%|█▊        | 935/5148.0 [00:14&lt;02:49, 24.90it/s]
 19%|█▊        | 956/5148.0 [00:14&lt;01:26, 48.30it/s]
 19%|█▊        | 965/5148.0 [00:14&lt;01:22, 50.71it/s]
 19%|█▉        | 979/5148.0 [00:15&lt;01:03, 65.58it/s]
 19%|█▉        | 989/5148.0 [00:15&lt;01:16, 54.72it/s]
 19%|█▉        | 1001/5148.0 [00:15&lt;01:03, 65.57it/s]
 20%|█▉        | 1011/5148.0 [00:15&lt;00:59, 69.92it/s]
 20%|█▉        | 1020/5148.0 [00:15&lt;01:00, 68.35it/s]
 20%|█▉        | 1029/5148.0 [00:15&lt;01:08, 60.25it/s]
 20%|██        | 1040/5148.0 [00:15&lt;00:58, 70.35it/s]
 20%|██        | 1051/5148.0 [00:16&lt;00:52, 78.35it/s]
 21%|██        | 1060/5148.0 [00:16&lt;00:51, 79.97it/s]
 21%|██        | 1069/5148.0 [00:16&lt;01:24, 48.39it/s]
 21%|██        | 1087/5148.0 [00:16&lt;01:00, 67.64it/s]
 21%|██▏       | 1096/5148.0 [00:16&lt;01:07, 60.35it/s]
 21%|██▏       | 1104/5148.0 [00:17&lt;01:19, 50.77it/s]
 22%|██▏       | 1115/5148.0 [00:17&lt;01:06, 61.08it/s]
 22%|██▏       | 1123/5148.0 [00:17&lt;01:07, 59.68it/s]
 22%|██▏       | 1131/5148.0 [00:17&lt;01:10, 56.93it/s]
 23%|██▎       | 1183/5148.0 [00:17&lt;00:25, 153.63it/s]
 23%|██▎       | 1204/5148.0 [00:18&lt;00:42, 92.62it/s]
 24%|██▎       | 1220/5148.0 [00:18&lt;00:43, 91.08it/s]
 24%|██▍       | 1234/5148.0 [00:18&lt;00:53, 73.55it/s]
 24%|██▍       | 1249/5148.0 [00:18&lt;00:46, 83.23it/s]
 24%|██▍       | 1261/5148.0 [00:19&lt;01:09, 56.00it/s]
 25%|██▍       | 1270/5148.0 [00:19&lt;01:17, 49.77it/s]
 25%|██▍       | 1278/5148.0 [00:19&lt;01:28, 43.92it/s]
 25%|██▌       | 1287/5148.0 [00:19&lt;01:17, 49.53it/s]
 25%|██▌       | 1295/5148.0 [00:19&lt;01:11, 53.80it/s]
 25%|██▌       | 1304/5148.0 [00:19&lt;01:03, 60.44it/s]
 26%|██▌       | 1314/5148.0 [00:20&lt;00:56, 67.41it/s]
 26%|██▌       | 1322/5148.0 [00:20&lt;00:56, 67.64it/s]
 26%|██▌       | 1333/5148.0 [00:20&lt;00:49, 77.63it/s]
 26%|██▌       | 1342/5148.0 [00:20&lt;00:47, 80.37it/s]
 26%|██▋       | 1353/5148.0 [00:20&lt;00:45, 84.19it/s]
 26%|██▋       | 1364/5148.0 [00:20&lt;00:42, 89.58it/s]
 27%|██▋       | 1374/5148.0 [00:20&lt;00:59, 63.83it/s]
 27%|██▋       | 1382/5148.0 [00:21&lt;00:58, 64.06it/s]
 27%|██▋       | 1394/5148.0 [00:21&lt;00:49, 75.95it/s]
 27%|██▋       | 1409/5148.0 [00:21&lt;00:43, 86.35it/s]
 28%|██▊       | 1419/5148.0 [00:21&lt;00:42, 87.90it/s]
 28%|██▊       | 1429/5148.0 [00:21&lt;00:41, 90.33it/s]
 28%|██▊       | 1442/5148.0 [00:21&lt;00:37, 98.24it/s]
 28%|██▊       | 1453/5148.0 [00:21&lt;00:46, 78.86it/s]
 28%|██▊       | 1462/5148.0 [00:22&lt;00:57, 63.77it/s]
 29%|██▊       | 1470/5148.0 [00:22&lt;00:55, 66.87it/s]
 29%|██▊       | 1478/5148.0 [00:22&lt;01:22, 44.53it/s]
 29%|██▉       | 1484/5148.0 [00:22&lt;01:28, 41.62it/s]
 29%|██▉       | 1496/5148.0 [00:22&lt;01:06, 54.93it/s]
 29%|██▉       | 1504/5148.0 [00:22&lt;01:00, 59.92it/s]
 29%|██▉       | 1513/5148.0 [00:22&lt;00:56, 63.86it/s]
 30%|██▉       | 1521/5148.0 [00:23&lt;01:12, 49.90it/s]
 30%|██▉       | 1533/5148.0 [00:23&lt;00:58, 62.15it/s]
 30%|██▉       | 1541/5148.0 [00:23&lt;01:01, 58.99it/s]
 30%|███       | 1548/5148.0 [00:23&lt;00:58, 61.34it/s]
 30%|███       | 1559/5148.0 [00:23&lt;00:49, 71.82it/s]
 31%|███       | 1579/5148.0 [00:23&lt;00:35, 99.37it/s]
 31%|███       | 1590/5148.0 [00:23&lt;00:37, 94.91it/s]
 31%|███       | 1600/5148.0 [00:24&lt;00:58, 60.72it/s]
 31%|███▏      | 1615/5148.0 [00:24&lt;00:46, 76.34it/s]
 32%|███▏      | 1625/5148.0 [00:24&lt;00:45, 78.22it/s]
 32%|███▏      | 1635/5148.0 [00:24&lt;00:59, 58.78it/s]
 32%|███▏      | 1643/5148.0 [00:24&lt;01:05, 53.48it/s]
 32%|███▏      | 1650/5148.0 [00:25&lt;01:41, 34.35it/s]
 32%|███▏      | 1656/5148.0 [00:25&lt;02:17, 25.41it/s]
 32%|███▏      | 1660/5148.0 [00:26&lt;02:11, 26.53it/s]
 32%|███▏      | 1669/5148.0 [00:26&lt;01:38, 35.37it/s]
 33%|███▎      | 1675/5148.0 [00:26&lt;02:08, 27.09it/s]
 33%|███▎      | 1680/5148.0 [00:26&lt;03:00, 19.26it/s]
 33%|███▎      | 1684/5148.0 [00:27&lt;03:10, 18.16it/s]
 33%|███▎      | 1687/5148.0 [00:27&lt;03:37, 15.90it/s]
 33%|███▎      | 1690/5148.0 [00:27&lt;03:39, 15.77it/s]
 33%|███▎      | 1693/5148.0 [00:27&lt;03:45, 15.31it/s]
 33%|███▎      | 1695/5148.0 [00:28&lt;03:44, 15.35it/s]
 33%|███▎      | 1698/5148.0 [00:28&lt;03:18, 17.42it/s]
 33%|███▎      | 1701/5148.0 [00:28&lt;03:33, 16.15it/s]
 33%|███▎      | 1704/5148.0 [00:28&lt;03:06, 18.48it/s]
 33%|███▎      | 1708/5148.0 [00:28&lt;02:33, 22.46it/s]
 33%|███▎      | 1719/5148.0 [00:28&lt;01:23, 41.02it/s]
 34%|███▎      | 1729/5148.0 [00:28&lt;01:03, 53.46it/s]
 34%|███▍      | 1742/5148.0 [00:29&lt;00:51, 66.48it/s]
 34%|███▍      | 1750/5148.0 [00:29&lt;01:31, 37.19it/s]
 34%|███▍      | 1756/5148.0 [00:29&lt;01:50, 30.75it/s]
 34%|███▍      | 1763/5148.0 [00:29&lt;01:36, 35.24it/s]
 34%|███▍      | 1775/5148.0 [00:29&lt;01:08, 49.13it/s]
 35%|███▍      | 1782/5148.0 [00:30&lt;01:24, 39.80it/s]
 35%|███▍      | 1792/5148.0 [00:30&lt;01:09, 48.45it/s]
 35%|███▍      | 1799/5148.0 [00:30&lt;01:08, 48.73it/s]
 35%|███▌      | 1805/5148.0 [00:30&lt;01:22, 40.60it/s]
 35%|███▌      | 1812/5148.0 [00:30&lt;01:13, 45.56it/s]
 35%|███▌      | 1822/5148.0 [00:31&lt;01:03, 52.19it/s]
 36%|███▌      | 1828/5148.0 [00:31&lt;01:08, 48.80it/s]
 36%|███▌      | 1841/5148.0 [00:31&lt;00:50, 65.51it/s]
 36%|███▌      | 1852/5148.0 [00:31&lt;00:45, 73.21it/s]
 36%|███▌      | 1861/5148.0 [00:31&lt;00:48, 67.83it/s]
 36%|███▋      | 1869/5148.0 [00:31&lt;01:09, 47.05it/s]
 36%|███▋      | 1875/5148.0 [00:32&lt;01:22, 39.47it/s]
 37%|███▋      | 1880/5148.0 [00:32&lt;01:39, 33.00it/s]
 37%|███▋      | 1885/5148.0 [00:32&lt;01:38, 32.99it/s]
 37%|███▋      | 1889/5148.0 [00:32&lt;01:48, 30.14it/s]
 37%|███▋      | 1893/5148.0 [00:32&lt;01:56, 27.89it/s]
 37%|███▋      | 1901/5148.0 [00:33&lt;01:43, 31.51it/s]
 37%|███▋      | 1911/5148.0 [00:33&lt;01:15, 42.83it/s]
 37%|███▋      | 1916/5148.0 [00:33&lt;01:27, 36.96it/s]
 37%|███▋      | 1925/5148.0 [00:33&lt;01:09, 46.09it/s]
 38%|███▊      | 1931/5148.0 [00:33&lt;01:09, 46.61it/s]
 38%|███▊      | 1937/5148.0 [00:33&lt;01:05, 48.82it/s]
 38%|███▊      | 1945/5148.0 [00:33&lt;00:59, 53.56it/s]
 38%|███▊      | 1955/5148.0 [00:33&lt;00:49, 64.51it/s]
 38%|███▊      | 1962/5148.0 [00:34&lt;00:54, 58.28it/s]
 38%|███▊      | 1969/5148.0 [00:34&lt;00:55, 57.15it/s]
 39%|███▊      | 1982/5148.0 [00:34&lt;00:43, 72.55it/s]
 39%|███▊      | 1990/5148.0 [00:34&lt;00:44, 71.46it/s]
 39%|███▉      | 1998/5148.0 [00:34&lt;00:44, 70.16it/s]
 39%|███▉      | 2006/5148.0 [00:34&lt;00:46, 67.37it/s]
 39%|███▉      | 2013/5148.0 [00:35&lt;01:13, 42.60it/s]
 39%|███▉      | 2019/5148.0 [00:35&lt;01:25, 36.70it/s]
 39%|███▉      | 2024/5148.0 [00:35&lt;01:23, 37.40it/s]
 39%|███▉      | 2029/5148.0 [00:35&lt;01:37, 31.93it/s]
 40%|███▉      | 2034/5148.0 [00:35&lt;01:37, 32.00it/s]
 40%|███▉      | 2038/5148.0 [00:36&lt;02:26, 21.30it/s]
 40%|███▉      | 2043/5148.0 [00:36&lt;02:02, 25.26it/s]
 40%|███▉      | 2048/5148.0 [00:36&lt;01:52, 27.44it/s]
 40%|███▉      | 2052/5148.0 [00:36&lt;01:46, 28.96it/s]
 40%|███▉      | 2056/5148.0 [00:36&lt;01:56, 26.56it/s]
 40%|████      | 2060/5148.0 [00:36&lt;02:10, 23.73it/s]
 40%|████      | 2078/5148.0 [00:37&lt;00:57, 53.12it/s]
 41%|████      | 2086/5148.0 [00:37&lt;00:57, 53.44it/s]
 41%|████      | 2095/5148.0 [00:37&lt;00:49, 61.18it/s]
 41%|████      | 2107/5148.0 [00:37&lt;00:41, 73.44it/s]
 41%|████      | 2116/5148.0 [00:37&lt;00:48, 61.95it/s]
 41%|████▏     | 2124/5148.0 [00:37&lt;00:46, 65.61it/s]
 41%|████▏     | 2133/5148.0 [00:37&lt;00:49, 60.99it/s]
 42%|████▏     | 2140/5148.0 [00:37&lt;00:48, 61.56it/s]
 42%|████▏     | 2149/5148.0 [00:38&lt;00:44, 67.19it/s]
 42%|████▏     | 2157/5148.0 [00:38&lt;00:52, 56.53it/s]
 42%|████▏     | 2174/5148.0 [00:38&lt;00:36, 81.51it/s]
 42%|████▏     | 2186/5148.0 [00:38&lt;00:33, 89.00it/s]
 43%|████▎     | 2196/5148.0 [00:38&lt;00:32, 89.66it/s]
 43%|████▎     | 2206/5148.0 [00:38&lt;00:51, 56.79it/s]
 43%|████▎     | 2215/5148.0 [00:39&lt;00:46, 62.90it/s]
 43%|████▎     | 2224/5148.0 [00:39&lt;00:53, 54.31it/s]
 44%|████▎     | 2240/5148.0 [00:39&lt;00:41, 70.53it/s]
 44%|████▎     | 2250/5148.0 [00:39&lt;00:38, 76.24it/s]
 44%|████▍     | 2259/5148.0 [00:39&lt;00:45, 63.04it/s]
 44%|████▍     | 2267/5148.0 [00:39&lt;00:44, 65.10it/s]
 44%|████▍     | 2275/5148.0 [00:39&lt;00:49, 58.26it/s]
 44%|████▍     | 2282/5148.0 [00:40&lt;00:56, 50.84it/s]
 45%|████▍     | 2296/5148.0 [00:40&lt;00:44, 63.82it/s]
 45%|████▍     | 2305/5148.0 [00:40&lt;00:41, 68.34it/s]
 45%|████▍     | 2313/5148.0 [00:40&lt;00:51, 54.94it/s]
 45%|████▌     | 2320/5148.0 [00:40&lt;00:57, 49.56it/s]
 45%|████▌     | 2326/5148.0 [00:41&lt;01:06, 42.71it/s]
 45%|████▌     | 2333/5148.0 [00:41&lt;01:00, 46.27it/s]
 45%|████▌     | 2339/5148.0 [00:41&lt;01:11, 39.12it/s]
 46%|████▌     | 2344/5148.0 [00:41&lt;01:31, 30.78it/s]
 46%|████▌     | 2376/5148.0 [00:41&lt;00:34, 79.37it/s]
 47%|████▋     | 2394/5148.0 [00:41&lt;00:28, 96.70it/s]
 47%|████▋     | 2408/5148.0 [00:42&lt;00:32, 83.47it/s]
 47%|████▋     | 2420/5148.0 [00:42&lt;00:33, 80.80it/s]
 47%|████▋     | 2431/5148.0 [00:42&lt;00:31, 86.41it/s]
 47%|████▋     | 2442/5148.0 [00:42&lt;00:30, 87.85it/s]
 48%|████▊     | 2458/5148.0 [00:42&lt;00:25, 104.56it/s]
 48%|████▊     | 2470/5148.0 [00:42&lt;00:27, 97.89it/s]
 48%|████▊     | 2484/5148.0 [00:42&lt;00:26, 102.40it/s]
 49%|████▊     | 2500/5148.0 [00:42&lt;00:22, 115.89it/s]
 49%|████▉     | 2513/5148.0 [00:43&lt;00:22, 117.21it/s]
 49%|████▉     | 2526/5148.0 [00:43&lt;00:22, 118.66it/s]
 49%|████▉     | 2539/5148.0 [00:43&lt;00:24, 104.37it/s]
 50%|████▉     | 2561/5148.0 [00:43&lt;00:19, 130.55it/s]
 50%|█████     | 2578/5148.0 [00:43&lt;00:18, 136.11it/s]
 50%|█████     | 2594/5148.0 [00:43&lt;00:18, 136.16it/s]
 51%|█████     | 2611/5148.0 [00:43&lt;00:19, 131.52it/s]
 51%|█████     | 2626/5148.0 [00:43&lt;00:19, 132.36it/s]
 51%|█████▏    | 2640/5148.0 [00:44&lt;00:19, 128.08it/s]
 52%|█████▏    | 2653/5148.0 [00:44&lt;00:21, 118.14it/s]
 52%|█████▏    | 2665/5148.0 [00:44&lt;00:22, 111.31it/s]
 52%|█████▏    | 2683/5148.0 [00:44&lt;00:19, 126.93it/s]
 52%|█████▏    | 2696/5148.0 [00:44&lt;00:22, 111.18it/s]
 53%|█████▎    | 2708/5148.0 [00:44&lt;00:34, 71.00it/s]
 53%|█████▎    | 2720/5148.0 [00:45&lt;00:31, 77.34it/s]
 53%|█████▎    | 2730/5148.0 [00:45&lt;00:33, 72.00it/s]
 53%|█████▎    | 2739/5148.0 [00:45&lt;00:31, 75.43it/s]
 53%|█████▎    | 2752/5148.0 [00:45&lt;00:27, 86.34it/s]
 54%|█████▍    | 2768/5148.0 [00:45&lt;00:23, 99.56it/s]
 54%|█████▍    | 2779/5148.0 [00:45&lt;00:27, 87.62it/s]
 54%|█████▍    | 2796/5148.0 [00:45&lt;00:26, 88.78it/s]
 55%|█████▍    | 2806/5148.0 [00:46&lt;00:27, 84.90it/s]
 55%|█████▍    | 2816/5148.0 [00:46&lt;00:27, 85.23it/s]
 55%|█████▍    | 2825/5148.0 [00:46&lt;00:29, 77.59it/s]
 55%|█████▌    | 2833/5148.0 [00:46&lt;00:33, 69.89it/s]
 55%|█████▌    | 2841/5148.0 [00:46&lt;00:48, 47.60it/s]
 55%|█████▌    | 2847/5148.0 [00:46&lt;00:58, 39.61it/s]
 55%|█████▌    | 2853/5148.0 [00:47&lt;00:53, 42.65it/s]
 56%|█████▌    | 2866/5148.0 [00:47&lt;00:38, 58.63it/s]
 56%|█████▌    | 2878/5148.0 [00:47&lt;00:31, 71.62it/s]
 56%|█████▌    | 2887/5148.0 [00:47&lt;00:43, 52.52it/s]
 56%|█████▋    | 2900/5148.0 [00:47&lt;00:33, 66.59it/s]
 57%|█████▋    | 2957/5148.0 [00:47&lt;00:12, 171.48it/s]
 58%|█████▊    | 2980/5148.0 [00:48&lt;00:16, 133.86it/s]
 58%|█████▊    | 2999/5148.0 [00:48&lt;00:16, 131.27it/s]
 59%|█████▊    | 3016/5148.0 [00:48&lt;00:27, 78.80it/s]
 59%|█████▉    | 3048/5148.0 [00:48&lt;00:18, 111.64it/s]
 60%|█████▉    | 3067/5148.0 [00:49&lt;00:19, 109.11it/s]
 60%|█████▉    | 3083/5148.0 [00:49&lt;00:22, 90.42it/s]
 60%|██████    | 3096/5148.0 [00:49&lt;00:25, 80.87it/s]
 60%|██████    | 3107/5148.0 [00:49&lt;00:24, 84.76it/s]
 61%|██████    | 3118/5148.0 [00:49&lt;00:23, 86.07it/s]
 61%|██████    | 3129/5148.0 [00:49&lt;00:24, 82.71it/s]
 61%|██████    | 3139/5148.0 [00:49&lt;00:23, 84.03it/s]
 61%|██████    | 3149/5148.0 [00:50&lt;00:23, 86.42it/s]
 61%|██████▏   | 3159/5148.0 [00:50&lt;00:24, 81.96it/s]
 62%|██████▏   | 3168/5148.0 [00:50&lt;00:30, 65.86it/s]
 62%|██████▏   | 3176/5148.0 [00:50&lt;00:32, 60.14it/s]
 62%|██████▏   | 3183/5148.0 [00:50&lt;00:34, 57.22it/s]
 62%|██████▏   | 3193/5148.0 [00:50&lt;00:33, 58.55it/s]
 62%|██████▏   | 3202/5148.0 [00:51&lt;00:31, 61.82it/s]
 62%|██████▏   | 3209/5148.0 [00:51&lt;00:42, 45.29it/s]
 62%|██████▏   | 3217/5148.0 [00:51&lt;00:38, 50.23it/s]
 63%|██████▎   | 3223/5148.0 [00:52&lt;01:17, 24.98it/s]
 63%|██████▎   | 3228/5148.0 [00:52&lt;02:03, 15.60it/s]
 63%|██████▎   | 3232/5148.0 [00:53&lt;02:31, 12.65it/s]
 63%|██████▎   | 3235/5148.0 [00:53&lt;02:39, 12.03it/s]
 63%|██████▎   | 3238/5148.0 [00:54&lt;02:59, 10.66it/s]
 63%|██████▎   | 3240/5148.0 [00:54&lt;02:53, 11.01it/s]
 63%|██████▎   | 3242/5148.0 [00:54&lt;03:11,  9.94it/s]
 63%|██████▎   | 3245/5148.0 [00:54&lt;02:46, 11.40it/s]
 63%|██████▎   | 3247/5148.0 [00:54&lt;02:42, 11.73it/s]
 63%|██████▎   | 3249/5148.0 [00:55&lt;02:47, 11.35it/s]
 63%|██████▎   | 3251/5148.0 [00:55&lt;02:55, 10.81it/s]
 63%|██████▎   | 3253/5148.0 [00:55&lt;02:36, 12.14it/s]
 63%|██████▎   | 3255/5148.0 [00:55&lt;02:31, 12.48it/s]
 63%|██████▎   | 3257/5148.0 [00:55&lt;02:21, 13.39it/s]
 63%|██████▎   | 3259/5148.0 [00:55&lt;02:24, 13.04it/s]
 63%|██████▎   | 3261/5148.0 [00:55&lt;02:17, 13.77it/s]
 63%|██████▎   | 3264/5148.0 [00:56&lt;01:50, 17.07it/s]
 63%|██████▎   | 3266/5148.0 [00:56&lt;02:24, 13.00it/s]
 63%|██████▎   | 3268/5148.0 [00:56&lt;02:45, 11.35it/s]
 64%|██████▎   | 3270/5148.0 [00:56&lt;03:12,  9.76it/s]
 64%|██████▎   | 3272/5148.0 [00:56&lt;03:06, 10.03it/s]
 64%|██████▎   | 3274/5148.0 [00:57&lt;03:10,  9.81it/s]
 64%|██████▎   | 3276/5148.0 [00:57&lt;03:17,  9.49it/s]
 64%|██████▎   | 3278/5148.0 [00:57&lt;03:50,  8.10it/s]
 64%|██████▎   | 3279/5148.0 [00:58&lt;04:27,  6.99it/s]
 64%|██████▎   | 3280/5148.0 [00:58&lt;04:32,  6.86it/s]
 64%|██████▍   | 3282/5148.0 [00:58&lt;04:03,  7.66it/s]
 64%|██████▍   | 3284/5148.0 [00:58&lt;03:36,  8.61it/s]
 64%|██████▍   | 3286/5148.0 [00:58&lt;03:14,  9.59it/s]
 64%|██████▍   | 3288/5148.0 [00:58&lt;02:50, 10.92it/s]
 64%|██████▍   | 3290/5148.0 [00:58&lt;02:31, 12.29it/s]
 64%|██████▍   | 3292/5148.0 [00:59&lt;02:37, 11.76it/s]
 64%|██████▍   | 3294/5148.0 [00:59&lt;02:46, 11.12it/s]
 64%|██████▍   | 3296/5148.0 [00:59&lt;02:46, 11.10it/s]
 64%|██████▍   | 3298/5148.0 [00:59&lt;02:52, 10.70it/s]
 64%|██████▍   | 3300/5148.0 [00:59&lt;02:46, 11.11it/s]
 64%|██████▍   | 3302/5148.0 [01:00&lt;02:28, 12.41it/s]
 64%|██████▍   | 3305/5148.0 [01:00&lt;02:21, 13.07it/s]
 64%|██████▍   | 3307/5148.0 [01:00&lt;02:19, 13.22it/s]
 64%|██████▍   | 3309/5148.0 [01:00&lt;02:21, 13.00it/s]
 64%|██████▍   | 3311/5148.0 [01:00&lt;02:13, 13.75it/s]
 64%|██████▍   | 3313/5148.0 [01:00&lt;02:28, 12.33it/s]
 64%|██████▍   | 3315/5148.0 [01:01&lt;02:45, 11.09it/s]
 64%|██████▍   | 3317/5148.0 [01:01&lt;02:42, 11.29it/s]
 64%|██████▍   | 3319/5148.0 [01:01&lt;02:47, 10.91it/s]
 65%|██████▍   | 3321/5148.0 [01:01&lt;02:46, 10.97it/s]
 65%|██████▍   | 3323/5148.0 [01:01&lt;02:30, 12.09it/s]
 65%|██████▍   | 3325/5148.0 [01:01&lt;02:20, 12.95it/s]
 65%|██████▍   | 3327/5148.0 [01:02&lt;02:41, 11.29it/s]
 65%|██████▍   | 3329/5148.0 [01:02&lt;03:10,  9.54it/s]
 65%|██████▍   | 3331/5148.0 [01:02&lt;02:55, 10.33it/s]
 65%|██████▍   | 3333/5148.0 [01:02&lt;03:42,  8.15it/s]
 65%|██████▍   | 3334/5148.0 [01:03&lt;03:38,  8.30it/s]
 65%|██████▍   | 3335/5148.0 [01:03&lt;03:33,  8.49it/s]
 65%|██████▍   | 3336/5148.0 [01:03&lt;03:31,  8.55it/s]
 65%|██████▍   | 3337/5148.0 [01:03&lt;03:53,  7.75it/s]
 65%|██████▍   | 3339/5148.0 [01:03&lt;03:15,  9.28it/s]
 65%|██████▍   | 3341/5148.0 [01:03&lt;02:56, 10.26it/s]
 65%|██████▍   | 3343/5148.0 [01:03&lt;03:08,  9.56it/s]
 65%|██████▍   | 3344/5148.0 [01:04&lt;03:17,  9.15it/s]
 65%|██████▍   | 3346/5148.0 [01:04&lt;02:39, 11.31it/s]
 65%|██████▌   | 3348/5148.0 [01:04&lt;02:33, 11.73it/s]
 65%|██████▌   | 3350/5148.0 [01:04&lt;02:28, 12.12it/s]
 65%|██████▌   | 3352/5148.0 [01:04&lt;02:36, 11.49it/s]
 65%|██████▌   | 3354/5148.0 [01:04&lt;02:32, 11.76it/s]
 65%|██████▌   | 3356/5148.0 [01:05&lt;02:35, 11.51it/s]
 65%|██████▌   | 3358/5148.0 [01:05&lt;02:53, 10.35it/s]
 65%|██████▌   | 3360/5148.0 [01:05&lt;03:06,  9.59it/s]
 65%|██████▌   | 3361/5148.0 [01:05&lt;03:19,  8.97it/s]
 65%|██████▌   | 3363/5148.0 [01:05&lt;03:14,  9.18it/s]
 65%|██████▌   | 3365/5148.0 [01:06&lt;03:08,  9.44it/s]
 65%|██████▌   | 3367/5148.0 [01:06&lt;02:38, 11.22it/s]
 65%|██████▌   | 3369/5148.0 [01:06&lt;02:42, 10.95it/s]
 65%|██████▌   | 3371/5148.0 [01:06&lt;02:29, 11.86it/s]
 66%|██████▌   | 3373/5148.0 [01:06&lt;02:19, 12.69it/s]
 66%|██████▌   | 3375/5148.0 [01:06&lt;02:27, 12.00it/s]
 66%|██████▌   | 3377/5148.0 [01:06&lt;02:09, 13.64it/s]
 66%|██████▌   | 3379/5148.0 [01:07&lt;02:40, 11.05it/s]
 66%|██████▌   | 3381/5148.0 [01:07&lt;02:30, 11.76it/s]
 66%|██████▌   | 3383/5148.0 [01:07&lt;02:16, 12.90it/s]
 66%|██████▌   | 3386/5148.0 [01:07&lt;01:57, 14.97it/s]
 66%|██████▌   | 3388/5148.0 [01:07&lt;02:04, 14.11it/s]
 66%|██████▌   | 3390/5148.0 [01:07&lt;02:05, 14.05it/s]
 66%|██████▌   | 3392/5148.0 [01:08&lt;02:12, 13.21it/s]
 66%|██████▌   | 3394/5148.0 [01:08&lt;02:08, 13.63it/s]
 66%|██████▌   | 3396/5148.0 [01:08&lt;01:57, 14.90it/s]
 66%|██████▌   | 3398/5148.0 [01:08&lt;02:53, 10.06it/s]
 66%|██████▌   | 3400/5148.0 [01:09&lt;03:55,  7.44it/s]
 66%|██████▌   | 3402/5148.0 [01:09&lt;04:31,  6.44it/s]
 66%|██████▌   | 3404/5148.0 [01:09&lt;03:53,  7.46it/s]
 66%|██████▌   | 3406/5148.0 [01:09&lt;03:21,  8.67it/s]
 66%|██████▌   | 3409/5148.0 [01:10&lt;02:46, 10.46it/s]
 66%|██████▋   | 3411/5148.0 [01:10&lt;02:36, 11.13it/s]
 66%|██████▋   | 3413/5148.0 [01:10&lt;02:41, 10.75it/s]
 66%|██████▋   | 3415/5148.0 [01:10&lt;02:29, 11.56it/s]
 66%|██████▋   | 3417/5148.0 [01:10&lt;02:31, 11.40it/s]
 66%|██████▋   | 3419/5148.0 [01:10&lt;02:24, 11.96it/s]
 66%|██████▋   | 3421/5148.0 [01:11&lt;02:47, 10.29it/s]
 66%|██████▋   | 3423/5148.0 [01:11&lt;02:50, 10.11it/s]
 67%|██████▋   | 3425/5148.0 [01:11&lt;02:27, 11.68it/s]
 67%|██████▋   | 3427/5148.0 [01:11&lt;02:25, 11.86it/s]
 67%|██████▋   | 3429/5148.0 [01:11&lt;02:10, 13.20it/s]
 67%|██████▋   | 3431/5148.0 [01:11&lt;02:19, 12.33it/s]
 67%|██████▋   | 3433/5148.0 [01:12&lt;02:43, 10.50it/s]
 67%|██████▋   | 3435/5148.0 [01:12&lt;02:51,  9.98it/s]
 67%|██████▋   | 3437/5148.0 [01:12&lt;02:49, 10.10it/s]
 67%|██████▋   | 3439/5148.0 [01:12&lt;02:55,  9.72it/s]
 67%|██████▋   | 3441/5148.0 [01:12&lt;02:38, 10.75it/s]
 67%|██████▋   | 3443/5148.0 [01:13&lt;02:27, 11.52it/s]
 67%|██████▋   | 3445/5148.0 [01:13&lt;02:28, 11.49it/s]
 67%|██████▋   | 3448/5148.0 [01:13&lt;02:07, 13.35it/s]
 67%|██████▋   | 3450/5148.0 [01:13&lt;02:14, 12.64it/s]
 67%|██████▋   | 3452/5148.0 [01:13&lt;02:20, 12.06it/s]
 67%|██████▋   | 3454/5148.0 [01:13&lt;02:09, 13.08it/s]
 67%|██████▋   | 3456/5148.0 [01:14&lt;02:20, 12.01it/s]
 67%|██████▋   | 3458/5148.0 [01:14&lt;02:41, 10.43it/s]
 67%|██████▋   | 3460/5148.0 [01:14&lt;02:34, 10.95it/s]
 67%|██████▋   | 3462/5148.0 [01:14&lt;02:36, 10.80it/s]
 67%|██████▋   | 3464/5148.0 [01:14&lt;02:41, 10.41it/s]
 67%|██████▋   | 3466/5148.0 [01:15&lt;03:08,  8.92it/s]
 67%|██████▋   | 3467/5148.0 [01:15&lt;03:24,  8.21it/s]
 67%|██████▋   | 3469/5148.0 [01:15&lt;03:11,  8.76it/s]
 67%|██████▋   | 3471/5148.0 [01:15&lt;02:40, 10.47it/s]
 67%|██████▋   | 3473/5148.0 [01:15&lt;02:20, 11.91it/s]
 68%|██████▊   | 3475/5148.0 [01:15&lt;02:13, 12.51it/s]
 68%|██████▊   | 3478/5148.0 [01:16&lt;01:56, 14.38it/s]
 68%|██████▊   | 3482/5148.0 [01:16&lt;01:24, 19.62it/s]
 68%|██████▊   | 3485/5148.0 [01:16&lt;01:54, 14.52it/s]
 68%|██████▊   | 3487/5148.0 [01:16&lt;01:58, 14.00it/s]
 68%|██████▊   | 3490/5148.0 [01:16&lt;01:38, 16.91it/s]
 68%|██████▊   | 3493/5148.0 [01:16&lt;01:31, 18.11it/s]
 68%|██████▊   | 3496/5148.0 [01:17&lt;01:37, 17.02it/s]
 68%|██████▊   | 3498/5148.0 [01:17&lt;01:53, 14.52it/s]
 68%|██████▊   | 3500/5148.0 [01:17&lt;02:18, 11.87it/s]
 68%|██████▊   | 3502/5148.0 [01:17&lt;02:26, 11.25it/s]
 68%|██████▊   | 3504/5148.0 [01:18&lt;02:34, 10.63it/s]
 68%|██████▊   | 3506/5148.0 [01:18&lt;02:49,  9.70it/s]
 68%|██████▊   | 3508/5148.0 [01:18&lt;03:02,  9.00it/s]
 68%|██████▊   | 3510/5148.0 [01:18&lt;02:34, 10.62it/s]
 68%|██████▊   | 3512/5148.0 [01:18&lt;02:18, 11.77it/s]
 68%|██████▊   | 3514/5148.0 [01:18&lt;02:10, 12.51it/s]
 68%|██████▊   | 3517/5148.0 [01:19&lt;02:00, 13.54it/s]
 68%|██████▊   | 3519/5148.0 [01:19&lt;02:14, 12.08it/s]
 68%|██████▊   | 3521/5148.0 [01:19&lt;02:35, 10.47it/s]
 68%|██████▊   | 3523/5148.0 [01:19&lt;03:09,  8.58it/s]
 68%|██████▊   | 3524/5148.0 [01:20&lt;03:18,  8.17it/s]
 68%|██████▊   | 3525/5148.0 [01:20&lt;03:49,  7.08it/s]
 69%|██████▊   | 3527/5148.0 [01:20&lt;03:29,  7.73it/s]
 69%|██████▊   | 3528/5148.0 [01:20&lt;03:28,  7.79it/s]
 69%|██████▊   | 3530/5148.0 [01:20&lt;02:43,  9.87it/s]
 69%|██████▊   | 3532/5148.0 [01:21&lt;03:15,  8.25it/s]
 69%|██████▊   | 3534/5148.0 [01:21&lt;02:55,  9.20it/s]
 69%|██████▊   | 3536/5148.0 [01:21&lt;03:21,  7.99it/s]
 69%|██████▊   | 3538/5148.0 [01:21&lt;02:48,  9.53it/s]
 69%|██████▉   | 3540/5148.0 [01:21&lt;02:36, 10.28it/s]
 69%|██████▉   | 3542/5148.0 [01:21&lt;02:25, 11.07it/s]
 69%|██████▉   | 3544/5148.0 [01:22&lt;02:32, 10.55it/s]
 69%|██████▉   | 3546/5148.0 [01:22&lt;02:27, 10.83it/s]
 69%|██████▉   | 3548/5148.0 [01:22&lt;02:11, 12.16it/s]
 69%|██████▉   | 3550/5148.0 [01:22&lt;02:16, 11.73it/s]
 69%|██████▉   | 3552/5148.0 [01:22&lt;02:28, 10.76it/s]
 69%|██████▉   | 3554/5148.0 [01:23&lt;02:21, 11.27it/s]
 69%|██████▉   | 3556/5148.0 [01:23&lt;02:42,  9.79it/s]
 69%|██████▉   | 3558/5148.0 [01:23&lt;02:25, 10.96it/s]
 69%|██████▉   | 3560/5148.0 [01:23&lt;02:35, 10.19it/s]
 69%|██████▉   | 3562/5148.0 [01:23&lt;02:23, 11.02it/s]
 69%|██████▉   | 3564/5148.0 [01:23&lt;02:26, 10.83it/s]
 69%|██████▉   | 3566/5148.0 [01:24&lt;02:06, 12.49it/s]
 69%|██████▉   | 3568/5148.0 [01:24&lt;02:04, 12.70it/s]
 69%|██████▉   | 3570/5148.0 [01:24&lt;02:17, 11.49it/s]
 69%|██████▉   | 3572/5148.0 [01:24&lt;02:03, 12.72it/s]
 69%|██████▉   | 3574/5148.0 [01:24&lt;02:22, 11.07it/s]
 69%|██████▉   | 3576/5148.0 [01:25&lt;02:53,  9.08it/s]
 70%|██████▉   | 3578/5148.0 [01:25&lt;02:49,  9.26it/s]
 70%|██████▉   | 3580/5148.0 [01:25&lt;03:19,  7.85it/s]
 70%|██████▉   | 3581/5148.0 [01:25&lt;03:27,  7.56it/s]
 70%|██████▉   | 3582/5148.0 [01:25&lt;03:35,  7.27it/s]
 70%|██████▉   | 3583/5148.0 [01:26&lt;03:29,  7.47it/s]
 70%|██████▉   | 3585/5148.0 [01:26&lt;03:27,  7.54it/s]
 70%|██████▉   | 3587/5148.0 [01:26&lt;02:45,  9.43it/s]
 70%|██████▉   | 3589/5148.0 [01:26&lt;02:21, 11.01it/s]
 70%|██████▉   | 3591/5148.0 [01:26&lt;02:20, 11.09it/s]
 70%|██████▉   | 3593/5148.0 [01:26&lt;02:03, 12.62it/s]
 70%|██████▉   | 3595/5148.0 [01:27&lt;02:56,  8.78it/s]
 70%|██████▉   | 3597/5148.0 [01:27&lt;03:26,  7.51it/s]
 70%|██████▉   | 3598/5148.0 [01:27&lt;03:36,  7.15it/s]
 70%|██████▉   | 3599/5148.0 [01:28&lt;04:00,  6.45it/s]
 70%|██████▉   | 3600/5148.0 [01:28&lt;04:22,  5.90it/s]
 70%|██████▉   | 3601/5148.0 [01:28&lt;04:26,  5.79it/s]
 70%|██████▉   | 3602/5148.0 [01:28&lt;04:13,  6.10it/s]
 70%|██████▉   | 3603/5148.0 [01:28&lt;04:14,  6.06it/s]
 70%|███████   | 3604/5148.0 [01:28&lt;04:21,  5.90it/s]
 70%|███████   | 3605/5148.0 [01:29&lt;03:56,  6.53it/s]
 70%|███████   | 3606/5148.0 [01:29&lt;03:45,  6.84it/s]
 70%|███████   | 3608/5148.0 [01:29&lt;02:47,  9.18it/s]
 70%|███████   | 3611/5148.0 [01:29&lt;02:13, 11.55it/s]
 70%|███████   | 3613/5148.0 [01:29&lt;03:07,  8.18it/s]
 70%|███████   | 3615/5148.0 [01:30&lt;02:53,  8.84it/s]
 70%|███████   | 3617/5148.0 [01:30&lt;03:06,  8.20it/s]
 70%|███████   | 3618/5148.0 [01:30&lt;03:13,  7.91it/s]
 70%|███████   | 3619/5148.0 [01:30&lt;03:23,  7.51it/s]
 70%|███████   | 3620/5148.0 [01:30&lt;03:55,  6.48it/s]
 70%|███████   | 3621/5148.0 [01:31&lt;04:00,  6.35it/s]
 70%|███████   | 3622/5148.0 [01:31&lt;04:06,  6.19it/s]
 70%|███████   | 3623/5148.0 [01:31&lt;03:47,  6.70it/s]
 70%|███████   | 3625/5148.0 [01:31&lt;03:05,  8.23it/s]
 70%|███████   | 3626/5148.0 [01:31&lt;03:10,  7.97it/s]
 70%|███████   | 3628/5148.0 [01:31&lt;03:09,  8.03it/s]
 71%|███████   | 3630/5148.0 [01:32&lt;03:00,  8.40it/s]
 71%|███████   | 3632/5148.0 [01:32&lt;02:25, 10.38it/s]
 71%|███████   | 3634/5148.0 [01:32&lt;03:15,  7.74it/s]
 71%|███████   | 3636/5148.0 [01:32&lt;03:44,  6.72it/s]
 71%|███████   | 3637/5148.0 [01:33&lt;04:02,  6.23it/s]
 71%|███████   | 3638/5148.0 [01:33&lt;04:05,  6.15it/s]
 71%|███████   | 3640/5148.0 [01:33&lt;03:18,  7.59it/s]
 71%|███████   | 3641/5148.0 [01:33&lt;03:27,  7.27it/s]
 71%|███████   | 3643/5148.0 [01:34&lt;03:50,  6.53it/s]
 71%|███████   | 3644/5148.0 [01:34&lt;03:53,  6.45it/s]
 71%|███████   | 3645/5148.0 [01:34&lt;04:06,  6.10it/s]
 71%|███████   | 3646/5148.0 [01:34&lt;03:57,  6.33it/s]
 71%|███████   | 3647/5148.0 [01:34&lt;04:00,  6.24it/s]
 71%|███████   | 3648/5148.0 [01:34&lt;03:55,  6.37it/s]
 71%|███████   | 3649/5148.0 [01:34&lt;03:40,  6.81it/s]
 71%|███████   | 3651/5148.0 [01:35&lt;03:49,  6.52it/s]
 71%|███████   | 3652/5148.0 [01:35&lt;04:02,  6.16it/s]
 71%|███████   | 3653/5148.0 [01:35&lt;03:55,  6.34it/s]
 71%|███████   | 3654/5148.0 [01:35&lt;04:13,  5.89it/s]
 71%|███████   | 3655/5148.0 [01:36&lt;06:05,  4.09it/s]
 71%|███████   | 3656/5148.0 [01:36&lt;05:32,  4.49it/s]
 71%|███████   | 3657/5148.0 [01:36&lt;05:39,  4.40it/s]
 71%|███████   | 3658/5148.0 [01:36&lt;05:33,  4.46it/s]
 71%|███████   | 3659/5148.0 [01:37&lt;05:32,  4.48it/s]
 71%|███████   | 3661/5148.0 [01:37&lt;03:43,  6.65it/s]
 71%|███████   | 3663/5148.0 [01:37&lt;03:02,  8.14it/s]
 71%|███████   | 3665/5148.0 [01:37&lt;02:32,  9.71it/s]
 71%|███████   | 3667/5148.0 [01:37&lt;02:09, 11.43it/s]
 71%|███████▏  | 3669/5148.0 [01:37&lt;02:40,  9.23it/s]
 71%|███████▏  | 3671/5148.0 [01:38&lt;02:38,  9.32it/s]
 71%|███████▏  | 3673/5148.0 [01:38&lt;02:35,  9.50it/s]
 71%|███████▏  | 3675/5148.0 [01:38&lt;02:25, 10.13it/s]
 71%|███████▏  | 3677/5148.0 [01:38&lt;02:50,  8.63it/s]
 71%|███████▏  | 3679/5148.0 [01:39&lt;02:43,  8.97it/s]
 71%|███████▏  | 3680/5148.0 [01:39&lt;03:12,  7.62it/s]
 72%|███████▏  | 3681/5148.0 [01:39&lt;03:13,  7.56it/s]
 72%|███████▏  | 3682/5148.0 [01:39&lt;03:15,  7.49it/s]
 72%|███████▏  | 3683/5148.0 [01:39&lt;03:54,  6.25it/s]
 72%|███████▏  | 3684/5148.0 [01:39&lt;03:39,  6.66it/s]
 72%|███████▏  | 3685/5148.0 [01:40&lt;04:04,  5.99it/s]
 72%|███████▏  | 3687/5148.0 [01:40&lt;03:01,  8.07it/s]
 72%|███████▏  | 3689/5148.0 [01:40&lt;02:38,  9.23it/s]
 72%|███████▏  | 3690/5148.0 [01:40&lt;02:37,  9.28it/s]
 72%|███████▏  | 3692/5148.0 [01:40&lt;02:42,  8.98it/s]
 72%|███████▏  | 3693/5148.0 [01:40&lt;02:56,  8.22it/s]
 72%|███████▏  | 3694/5148.0 [01:41&lt;02:58,  8.14it/s]
 72%|███████▏  | 3696/5148.0 [01:41&lt;02:31,  9.57it/s]
 72%|███████▏  | 3697/5148.0 [01:41&lt;02:38,  9.14it/s]
 72%|███████▏  | 3698/5148.0 [01:41&lt;02:48,  8.59it/s]
 72%|███████▏  | 3699/5148.0 [01:41&lt;03:06,  7.76it/s]
 72%|███████▏  | 3700/5148.0 [01:41&lt;03:47,  6.36it/s]
 72%|███████▏  | 3702/5148.0 [01:41&lt;02:43,  8.83it/s]
 72%|███████▏  | 3705/5148.0 [01:42&lt;02:50,  8.48it/s]
 72%|███████▏  | 3706/5148.0 [01:42&lt;03:05,  7.77it/s]
 72%|███████▏  | 3707/5148.0 [01:42&lt;03:10,  7.56it/s]
 72%|███████▏  | 3709/5148.0 [01:42&lt;02:45,  8.68it/s]
 72%|███████▏  | 3710/5148.0 [01:43&lt;03:11,  7.49it/s]
 72%|███████▏  | 3711/5148.0 [01:43&lt;03:42,  6.45it/s]
 72%|███████▏  | 3712/5148.0 [01:43&lt;03:35,  6.67it/s]
 72%|███████▏  | 3713/5148.0 [01:43&lt;03:32,  6.75it/s]
 72%|███████▏  | 3714/5148.0 [01:43&lt;03:37,  6.58it/s]
 72%|███████▏  | 3715/5148.0 [01:43&lt;03:49,  6.25it/s]
 72%|███████▏  | 3716/5148.0 [01:44&lt;03:45,  6.35it/s]
 72%|███████▏  | 3717/5148.0 [01:44&lt;04:38,  5.14it/s]
 72%|███████▏  | 3721/5148.0 [01:44&lt;03:00,  7.92it/s]
 72%|███████▏  | 3722/5148.0 [01:44&lt;03:40,  6.46it/s]
 72%|███████▏  | 3723/5148.0 [01:45&lt;04:16,  5.56it/s]
 72%|███████▏  | 3724/5148.0 [01:45&lt;03:55,  6.04it/s]
 72%|███████▏  | 3725/5148.0 [01:45&lt;04:06,  5.78it/s]
 72%|███████▏  | 3726/5148.0 [01:45&lt;04:38,  5.11it/s]
 72%|███████▏  | 3727/5148.0 [01:46&lt;04:38,  5.10it/s]
 72%|███████▏  | 3728/5148.0 [01:46&lt;04:18,  5.50it/s]
 72%|███████▏  | 3729/5148.0 [01:46&lt;04:22,  5.40it/s]
 72%|███████▏  | 3730/5148.0 [01:46&lt;04:30,  5.24it/s]
 72%|███████▏  | 3731/5148.0 [01:46&lt;04:21,  5.42it/s]
 72%|███████▏  | 3732/5148.0 [01:46&lt;04:17,  5.49it/s]
 73%|███████▎  | 3733/5148.0 [01:47&lt;04:22,  5.39it/s]
 73%|███████▎  | 3734/5148.0 [01:47&lt;04:00,  5.89it/s]
 73%|███████▎  | 3735/5148.0 [01:47&lt;04:18,  5.46it/s]
 73%|███████▎  | 3736/5148.0 [01:47&lt;04:02,  5.83it/s]
 73%|███████▎  | 3737/5148.0 [01:47&lt;03:33,  6.59it/s]
 73%|███████▎  | 3739/5148.0 [01:47&lt;02:53,  8.13it/s]
 73%|███████▎  | 3740/5148.0 [01:48&lt;03:21,  6.98it/s]
 73%|███████▎  | 3741/5148.0 [01:48&lt;04:16,  5.48it/s]
 73%|███████▎  | 3743/5148.0 [01:48&lt;03:19,  7.03it/s]
 73%|███████▎  | 3745/5148.0 [01:48&lt;02:48,  8.35it/s]
 73%|███████▎  | 3747/5148.0 [01:48&lt;02:23,  9.78it/s]
 73%|███████▎  | 3749/5148.0 [01:49&lt;02:12, 10.58it/s]
 73%|███████▎  | 3751/5148.0 [01:49&lt;02:29,  9.35it/s]
 73%|███████▎  | 3753/5148.0 [01:49&lt;02:16, 10.22it/s]
 73%|███████▎  | 3755/5148.0 [01:49&lt;02:28,  9.39it/s]
 73%|███████▎  | 3757/5148.0 [01:49&lt;02:23,  9.67it/s]
 73%|███████▎  | 3759/5148.0 [01:49&lt;02:03, 11.21it/s]
 73%|███████▎  | 3761/5148.0 [01:50&lt;02:03, 11.27it/s]
 73%|███████▎  | 3763/5148.0 [01:50&lt;01:51, 12.47it/s]
 73%|███████▎  | 3765/5148.0 [01:50&lt;02:00, 11.46it/s]
 73%|███████▎  | 3767/5148.0 [01:50&lt;01:59, 11.59it/s]
 73%|███████▎  | 3769/5148.0 [01:50&lt;01:45, 13.13it/s]
 73%|███████▎  | 3771/5148.0 [01:50&lt;02:01, 11.36it/s]
 73%|███████▎  | 3773/5148.0 [01:51&lt;02:07, 10.78it/s]
 73%|███████▎  | 3775/5148.0 [01:51&lt;02:06, 10.85it/s]
 73%|███████▎  | 3777/5148.0 [01:51&lt;02:31,  9.04it/s]
 73%|███████▎  | 3780/5148.0 [01:51&lt;02:08, 10.67it/s]
 73%|███████▎  | 3783/5148.0 [01:52&lt;01:43, 13.15it/s]
 74%|███████▎  | 3786/5148.0 [01:52&lt;01:29, 15.15it/s]
 74%|███████▎  | 3788/5148.0 [01:52&lt;01:57, 11.61it/s]
 74%|███████▎  | 3790/5148.0 [01:52&lt;02:22,  9.55it/s]
 74%|███████▎  | 3792/5148.0 [01:52&lt;02:07, 10.65it/s]
 74%|███████▎  | 3794/5148.0 [01:53&lt;02:14, 10.07it/s]
 74%|███████▎  | 3796/5148.0 [01:53&lt;02:22,  9.50it/s]
 74%|███████▍  | 3798/5148.0 [01:53&lt;02:31,  8.93it/s]
 74%|███████▍  | 3799/5148.0 [01:53&lt;02:43,  8.26it/s]
 74%|███████▍  | 3800/5148.0 [01:53&lt;02:45,  8.16it/s]
 74%|███████▍  | 3801/5148.0 [01:54&lt;03:12,  7.01it/s]
 74%|███████▍  | 3805/5148.0 [01:54&lt;02:02, 10.95it/s]
 74%|███████▍  | 3811/5148.0 [01:54&lt;01:10, 19.01it/s]
 74%|███████▍  | 3820/5148.0 [01:54&lt;00:40, 32.43it/s]
 74%|███████▍  | 3825/5148.0 [01:54&lt;00:37, 35.23it/s]
 75%|███████▍  | 3841/5148.0 [01:54&lt;00:21, 60.40it/s]
 75%|███████▍  | 3848/5148.0 [01:54&lt;00:23, 55.15it/s]
 75%|███████▌  | 3861/5148.0 [01:55&lt;00:17, 72.33it/s]
 75%|███████▌  | 3878/5148.0 [01:55&lt;00:13, 96.16it/s]
 76%|███████▌  | 3890/5148.0 [01:55&lt;00:12, 101.50it/s]
 76%|███████▌  | 3901/5148.0 [01:55&lt;00:14, 87.29it/s]
 76%|███████▌  | 3911/5148.0 [01:55&lt;00:13, 88.88it/s]
 76%|███████▌  | 3924/5148.0 [01:55&lt;00:13, 93.24it/s]
 76%|███████▋  | 3935/5148.0 [01:55&lt;00:13, 91.53it/s]
 77%|███████▋  | 3945/5148.0 [01:55&lt;00:16, 74.56it/s]
 77%|███████▋  | 3954/5148.0 [01:56&lt;00:16, 74.15it/s]
 77%|███████▋  | 3966/5148.0 [01:56&lt;00:14, 80.90it/s]
 77%|███████▋  | 3975/5148.0 [01:56&lt;00:14, 80.23it/s]
 77%|███████▋  | 3984/5148.0 [01:56&lt;00:23, 48.82it/s]
 78%|███████▊  | 3997/5148.0 [01:56&lt;00:19, 59.93it/s]
 78%|███████▊  | 4005/5148.0 [01:58&lt;01:03, 17.96it/s]
 78%|███████▊  | 4011/5148.0 [01:58&lt;01:15, 15.02it/s]
 78%|███████▊  | 4018/5148.0 [01:59&lt;01:01, 18.41it/s]
 78%|███████▊  | 4023/5148.0 [01:59&lt;01:01, 18.21it/s]
 78%|███████▊  | 4032/5148.0 [01:59&lt;00:44, 25.02it/s]
 78%|███████▊  | 4038/5148.0 [02:00&lt;01:00, 18.21it/s]
 79%|███████▊  | 4044/5148.0 [02:00&lt;00:56, 19.71it/s]
 79%|███████▊  | 4048/5148.0 [02:01&lt;01:43, 10.64it/s]
 79%|███████▊  | 4051/5148.0 [02:01&lt;02:01,  9.01it/s]
 79%|███████▊  | 4053/5148.0 [02:02&lt;02:14,  8.14it/s]
 79%|███████▉  | 4055/5148.0 [02:02&lt;02:20,  7.77it/s]
 79%|███████▉  | 4057/5148.0 [02:02&lt;02:29,  7.27it/s]
 79%|███████▉  | 4059/5148.0 [02:03&lt;02:15,  8.04it/s]
 79%|███████▉  | 4061/5148.0 [02:03&lt;02:22,  7.64it/s]
 79%|███████▉  | 4062/5148.0 [02:03&lt;02:42,  6.69it/s]
 79%|███████▉  | 4063/5148.0 [02:04&lt;03:15,  5.55it/s]
 79%|███████▉  | 4064/5148.0 [02:04&lt;03:15,  5.53it/s]
 79%|███████▉  | 4065/5148.0 [02:04&lt;03:35,  5.03it/s]
 79%|███████▉  | 4066/5148.0 [02:04&lt;03:48,  4.73it/s]
 79%|███████▉  | 4067/5148.0 [02:05&lt;04:26,  4.06it/s]
 79%|███████▉  | 4068/5148.0 [02:05&lt;04:31,  3.98it/s]
 79%|███████▉  | 4069/5148.0 [02:05&lt;03:47,  4.73it/s]
 79%|███████▉  | 4080/5148.0 [02:05&lt;00:52, 20.49it/s]
 79%|███████▉  | 4084/5148.0 [02:05&lt;00:56, 18.70it/s]
 79%|███████▉  | 4088/5148.0 [02:05&lt;00:50, 20.99it/s]
 79%|███████▉  | 4091/5148.0 [02:06&lt;00:58, 17.95it/s]
 80%|███████▉  | 4099/5148.0 [02:06&lt;00:37, 28.22it/s]
 80%|███████▉  | 4103/5148.0 [02:06&lt;00:50, 20.62it/s]
 80%|███████▉  | 4113/5148.0 [02:06&lt;00:32, 31.99it/s]
 80%|███████▉  | 4118/5148.0 [02:07&lt;00:43, 23.88it/s]
 80%|████████  | 4122/5148.0 [02:07&lt;00:42, 24.17it/s]
 80%|████████  | 4126/5148.0 [02:07&lt;00:50, 20.12it/s]
 80%|████████  | 4134/5148.0 [02:07&lt;00:38, 26.21it/s]
 80%|████████  | 4138/5148.0 [02:08&lt;00:44, 22.47it/s]
 81%|████████  | 4145/5148.0 [02:08&lt;00:34, 29.37it/s]
 81%|████████  | 4152/5148.0 [02:08&lt;00:33, 30.17it/s]
 81%|████████  | 4156/5148.0 [02:08&lt;00:34, 29.17it/s]
 81%|████████  | 4166/5148.0 [02:08&lt;00:23, 41.95it/s]
 81%|████████  | 4172/5148.0 [02:09&lt;00:35, 27.61it/s]
 81%|████████  | 4177/5148.0 [02:09&lt;00:45, 21.36it/s]
 81%|████████  | 4181/5148.0 [02:09&lt;00:42, 22.86it/s]
 81%|████████▏ | 4185/5148.0 [02:10&lt;00:55, 17.28it/s]
 81%|████████▏ | 4188/5148.0 [02:10&lt;00:54, 17.71it/s]
 81%|████████▏ | 4191/5148.0 [02:10&lt;01:04, 14.73it/s]
 82%|████████▏ | 4203/5148.0 [02:10&lt;00:33, 28.09it/s]
 82%|████████▏ | 4210/5148.0 [02:10&lt;00:34, 27.38it/s]
 82%|████████▏ | 4214/5148.0 [02:11&lt;00:34, 27.42it/s]
 82%|████████▏ | 4224/5148.0 [02:11&lt;00:25, 36.86it/s]
 82%|████████▏ | 4229/5148.0 [02:11&lt;00:50, 18.16it/s]
 82%|████████▏ | 4233/5148.0 [02:12&lt;01:03, 14.50it/s]
 82%|████████▏ | 4236/5148.0 [02:12&lt;01:09, 13.21it/s]
 82%|████████▏ | 4239/5148.0 [02:13&lt;01:16, 11.91it/s]
 82%|████████▏ | 4241/5148.0 [02:13&lt;01:13, 12.34it/s]
 82%|████████▏ | 4243/5148.0 [02:13&lt;01:25, 10.64it/s]
 82%|████████▏ | 4245/5148.0 [02:13&lt;01:16, 11.73it/s]
 82%|████████▏ | 4247/5148.0 [02:13&lt;01:17, 11.60it/s]
 83%|████████▎ | 4249/5148.0 [02:14&lt;01:32,  9.69it/s]
 83%|████████▎ | 4251/5148.0 [02:14&lt;01:37,  9.17it/s]
 83%|████████▎ | 4253/5148.0 [02:14&lt;01:29,  9.95it/s]
 83%|████████▎ | 4260/5148.0 [02:14&lt;00:55, 16.11it/s]
 83%|████████▎ | 4262/5148.0 [02:15&lt;01:14, 11.94it/s]
 83%|████████▎ | 4265/5148.0 [02:15&lt;01:02, 14.23it/s]
 83%|████████▎ | 4277/5148.0 [02:15&lt;00:27, 31.50it/s]
 83%|████████▎ | 4285/5148.0 [02:15&lt;00:24, 35.22it/s]
 83%|████████▎ | 4290/5148.0 [02:15&lt;00:30, 27.71it/s]
 83%|████████▎ | 4296/5148.0 [02:15&lt;00:26, 31.87it/s]
 84%|████████▎ | 4302/5148.0 [02:16&lt;00:24, 34.62it/s]
 84%|████████▎ | 4307/5148.0 [02:16&lt;00:32, 25.91it/s]
 84%|████████▍ | 4324/5148.0 [02:16&lt;00:17, 47.44it/s]
 84%|████████▍ | 4331/5148.0 [02:16&lt;00:23, 35.19it/s]
 85%|████████▍ | 4351/5148.0 [02:16&lt;00:13, 59.44it/s]
 85%|████████▍ | 4361/5148.0 [02:17&lt;00:12, 64.50it/s]
 85%|████████▍ | 4370/5148.0 [02:17&lt;00:16, 47.97it/s]
 85%|████████▌ | 4378/5148.0 [02:17&lt;00:17, 44.77it/s]
 85%|████████▌ | 4385/5148.0 [02:17&lt;00:16, 47.24it/s]
 85%|████████▌ | 4391/5148.0 [02:18&lt;00:20, 36.25it/s]
 85%|████████▌ | 4401/5148.0 [02:18&lt;00:16, 45.82it/s]
 86%|████████▌ | 4408/5148.0 [02:18&lt;00:15, 47.62it/s]
 86%|████████▌ | 4420/5148.0 [02:18&lt;00:13, 54.88it/s]
 86%|████████▌ | 4427/5148.0 [02:18&lt;00:17, 42.27it/s]
 86%|████████▋ | 4441/5148.0 [02:18&lt;00:12, 56.30it/s]
 86%|████████▋ | 4452/5148.0 [02:18&lt;00:11, 63.04it/s]
 87%|████████▋ | 4460/5148.0 [02:19&lt;00:14, 46.65it/s]
 87%|████████▋ | 4470/5148.0 [02:19&lt;00:12, 53.41it/s]
 87%|████████▋ | 4477/5148.0 [02:19&lt;00:12, 55.43it/s]
 87%|████████▋ | 4484/5148.0 [02:19&lt;00:19, 34.30it/s]
 87%|████████▋ | 4490/5148.0 [02:20&lt;00:20, 31.93it/s]
 87%|████████▋ | 4495/5148.0 [02:20&lt;00:24, 26.74it/s]
 87%|████████▋ | 4499/5148.0 [02:20&lt;00:28, 22.66it/s]
 87%|████████▋ | 4503/5148.0 [02:20&lt;00:27, 23.86it/s]
 88%|████████▊ | 4506/5148.0 [02:21&lt;00:34, 18.78it/s]
 88%|████████▊ | 4510/5148.0 [02:21&lt;00:30, 21.16it/s]
 88%|████████▊ | 4519/5148.0 [02:21&lt;00:19, 32.08it/s]
 88%|████████▊ | 4528/5148.0 [02:21&lt;00:14, 42.39it/s]
 88%|████████▊ | 4534/5148.0 [02:21&lt;00:19, 31.06it/s]
 88%|████████▊ | 4547/5148.0 [02:21&lt;00:12, 46.87it/s]
 89%|████████▊ | 4557/5148.0 [02:22&lt;00:10, 54.67it/s]
 89%|████████▊ | 4565/5148.0 [02:22&lt;00:16, 35.91it/s]
 89%|████████▉ | 4573/5148.0 [02:22&lt;00:13, 41.67it/s]
 89%|████████▉ | 4579/5148.0 [02:22&lt;00:12, 43.97it/s]
 89%|████████▉ | 4585/5148.0 [02:22&lt;00:12, 45.70it/s]
 89%|████████▉ | 4591/5148.0 [02:23&lt;00:18, 30.70it/s]
 89%|████████▉ | 4605/5148.0 [02:23&lt;00:11, 47.59it/s]
 90%|████████▉ | 4612/5148.0 [02:23&lt;00:15, 34.33it/s]
 90%|████████▉ | 4618/5148.0 [02:23&lt;00:14, 35.48it/s]
 90%|████████▉ | 4629/5148.0 [02:23&lt;00:11, 46.52it/s]
 90%|█████████ | 4639/5148.0 [02:24&lt;00:09, 55.48it/s]
 90%|█████████ | 4647/5148.0 [02:24&lt;00:12, 39.55it/s]
 90%|█████████ | 4653/5148.0 [02:24&lt;00:12, 40.89it/s]
 91%|█████████ | 4665/5148.0 [02:24&lt;00:08, 54.20it/s]
 91%|█████████ | 4673/5148.0 [02:25&lt;00:12, 37.20it/s]
 91%|█████████ | 4685/5148.0 [02:25&lt;00:09, 46.77it/s]
 91%|█████████ | 4692/5148.0 [02:25&lt;00:15, 28.77it/s]
 91%|█████████ | 4697/5148.0 [02:26&lt;00:16, 26.70it/s]
 91%|█████████▏| 4702/5148.0 [02:26&lt;00:19, 22.98it/s]
 91%|█████████▏| 4709/5148.0 [02:26&lt;00:15, 28.69it/s]
 92%|█████████▏| 4718/5148.0 [02:26&lt;00:11, 37.88it/s]
 92%|█████████▏| 4735/5148.0 [02:26&lt;00:06, 60.22it/s]
 92%|█████████▏| 4744/5148.0 [02:26&lt;00:06, 64.36it/s]
 92%|█████████▏| 4760/5148.0 [02:27&lt;00:06, 59.32it/s]
 93%|█████████▎| 4768/5148.0 [02:27&lt;00:07, 50.92it/s]
 93%|█████████▎| 4780/5148.0 [02:27&lt;00:05, 61.47it/s]
 93%|█████████▎| 4788/5148.0 [02:27&lt;00:07, 46.89it/s]
 93%|█████████▎| 4804/5148.0 [02:27&lt;00:05, 64.85it/s]
 94%|█████████▎| 4815/5148.0 [02:28&lt;00:05, 60.69it/s]
 94%|█████████▎| 4823/5148.0 [02:29&lt;00:15, 21.15it/s]
 94%|█████████▍| 4829/5148.0 [02:29&lt;00:14, 21.42it/s]
 94%|█████████▍| 4834/5148.0 [02:30&lt;00:18, 16.65it/s]
 94%|█████████▍| 4838/5148.0 [02:30&lt;00:20, 14.77it/s]
 94%|█████████▍| 4841/5148.0 [02:30&lt;00:19, 15.57it/s]
 94%|█████████▍| 4849/5148.0 [02:30&lt;00:13, 21.95it/s]
 94%|█████████▍| 4853/5148.0 [02:30&lt;00:13, 21.62it/s]
 94%|█████████▍| 4857/5148.0 [02:31&lt;00:13, 21.98it/s]
 94%|█████████▍| 4860/5148.0 [02:31&lt;00:15, 18.97it/s]
 94%|█████████▍| 4863/5148.0 [02:31&lt;00:14, 19.66it/s]
 95%|█████████▍| 4866/5148.0 [02:31&lt;00:17, 16.14it/s]
 95%|█████████▍| 4872/5148.0 [02:31&lt;00:12, 21.42it/s]
 95%|█████████▍| 4875/5148.0 [02:32&lt;00:14, 18.40it/s]
 95%|█████████▍| 4880/5148.0 [02:32&lt;00:11, 23.06it/s]
 95%|█████████▍| 4883/5148.0 [02:32&lt;00:14, 18.56it/s]
 95%|█████████▍| 4886/5148.0 [02:32&lt;00:17, 14.65it/s]
 95%|█████████▍| 4888/5148.0 [02:33&lt;00:20, 12.52it/s]
 95%|█████████▌| 4897/5148.0 [02:33&lt;00:10, 23.69it/s]
 95%|█████████▌| 4901/5148.0 [02:33&lt;00:10, 22.53it/s]
 95%|█████████▌| 4905/5148.0 [02:33&lt;00:10, 23.85it/s]
 95%|█████████▌| 4909/5148.0 [02:33&lt;00:11, 19.93it/s]
 96%|█████████▌| 4920/5148.0 [02:34&lt;00:07, 29.45it/s]
 96%|█████████▌| 4924/5148.0 [02:34&lt;00:08, 27.06it/s]
 96%|█████████▌| 4930/5148.0 [02:34&lt;00:06, 31.85it/s]
 96%|█████████▌| 4934/5148.0 [02:34&lt;00:08, 26.14it/s]
 96%|█████████▌| 4942/5148.0 [02:34&lt;00:06, 33.67it/s]
 96%|█████████▌| 4946/5148.0 [02:35&lt;00:06, 29.27it/s]
 96%|█████████▌| 4952/5148.0 [02:35&lt;00:07, 27.93it/s]
 96%|█████████▋| 4956/5148.0 [02:35&lt;00:08, 23.68it/s]
 96%|█████████▋| 4959/5148.0 [02:35&lt;00:12, 15.48it/s]
 96%|█████████▋| 4964/5148.0 [02:36&lt;00:09, 19.14it/s]
 96%|█████████▋| 4967/5148.0 [02:36&lt;00:11, 16.15it/s]
 97%|█████████▋| 4971/5148.0 [02:36&lt;00:09, 18.58it/s]
 97%|█████████▋| 4974/5148.0 [02:36&lt;00:10, 16.14it/s]
 97%|█████████▋| 4978/5148.0 [02:36&lt;00:09, 17.42it/s]
 97%|█████████▋| 4981/5148.0 [02:37&lt;00:09, 17.24it/s]
 97%|█████████▋| 4989/5148.0 [02:37&lt;00:08, 19.73it/s]
 97%|█████████▋| 4997/5148.0 [02:37&lt;00:05, 26.71it/s]
 97%|█████████▋| 5001/5148.0 [02:37&lt;00:05, 24.54it/s]
 97%|█████████▋| 5007/5148.0 [02:38&lt;00:05, 25.57it/s]
 97%|█████████▋| 5010/5148.0 [02:38&lt;00:05, 23.69it/s]
 97%|█████████▋| 5013/5148.0 [02:38&lt;00:06, 20.13it/s]
 98%|█████████▊| 5053/5148.0 [02:38&lt;00:01, 84.52it/s]
 99%|█████████▉| 5111/5148.0 [02:38&lt;00:00, 119.51it/s]
100%|█████████▉| 5126/5148.0 [02:39&lt;00:00, 55.47it/s]
100%|█████████▉| 5137/5148.0 [02:40&lt;00:00, 36.14it/s]
100%|█████████▉| 5145/5148.0 [02:41&lt;00:00, 33.85it/s]
100%|██████████| 5148/5148.0 [02:41&lt;00:00, 31.97it/s]
</pre></div>
</div>
<p>Calculate the crossing invariant tensor indices <a class="reference internal" href="#kaden2016" id="id6"><span>[Kaden2016]</span></a> : the parallel
diffusivity, the perpendicular diffusivity, the fractional anisotropy and
the mean diffusivity.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">d_par</span> <span class="o">=</span> <span class="n">f_fit</span><span class="o">.</span><span class="n">dpar</span>
<span class="n">d_perp</span> <span class="o">=</span> <span class="n">f_fit</span><span class="o">.</span><span class="n">dperp</span>
<span class="n">fa</span> <span class="o">=</span> <span class="n">f_fit</span><span class="o">.</span><span class="n">fractional_anisotropy</span><span class="p">()</span>
<span class="n">md</span> <span class="o">=</span> <span class="n">f_fit</span><span class="o">.</span><span class="n">mean_diffusivity</span><span class="p">()</span>
</pre></div>
</div>
<p>Show the indices and save them in FORECAST_indices.png.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;parallel diffusivity&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">d_par</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
                 <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;perpendicular diffusivity&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">d_perp</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
                 <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;fractional anisotropy&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fa</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
                 <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mean diffusivity&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">md</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
                 <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;FORECAST_indices.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_reconst_forecast_001.png" srcset="../../_images/sphx_glr_reconst_forecast_001.png" alt="reconst forecast" class = "sphx-glr-single-img"/><p class="centered small fst-italic fw-semibold">FORECAST scalar indices.</p>
<p>Load an ODF reconstruction sphere</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sphere</span> <span class="o">=</span> <span class="n">get_sphere</span><span class="p">(</span><span class="s1">&#39;repulsion724&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute the fODFs.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">odf</span> <span class="o">=</span> <span class="n">f_fit</span><span class="o">.</span><span class="n">odf</span><span class="p">(</span><span class="n">sphere</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fODF.shape (</span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">odf</span><span class="o">.</span><span class="n">shape</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>fODF.shape (108, 129, 1, 724)
</pre></div>
</div>
<p>Display a part of the fODFs</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">odf_actor</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">odf_slicer</span><span class="p">(</span><span class="n">odf</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span> <span class="mi">30</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span> <span class="p">:],</span> <span class="n">sphere</span><span class="o">=</span><span class="n">sphere</span><span class="p">,</span>
                             <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">scene</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">Scene</span><span class="p">()</span>
<span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">odf_actor</span><span class="p">)</span>
<span class="n">window</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">scene</span><span class="p">,</span> <span class="n">out_path</span><span class="o">=</span><span class="s1">&#39;fODFs.png&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="n">magnification</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_reconst_forecast_002.png" srcset="../../_images/sphx_glr_reconst_forecast_002.png" alt="reconst forecast" class = "sphx-glr-single-img"/><p class="centered small fst-italic fw-semibold">Fiber Orientation Distribution Functions, in a small ROI of the brain.</p>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="anderson2005" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Anderson2005</a><span class="fn-bracket">]</span></span>
<p>Anderson A. W., “Measurement of Fiber Orientation
Distributions Using High Angular Resolution Diffusion Imaging”,
Magnetic Resonance in Medicine, 2005.</p>
</div>
<div class="citation" id="kaden2016" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Kaden2016<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id6">2</a>)</span>
<p>Kaden E. et al., “Quantitative Mapping of the Per-Axon
Diffusion Coefficients in Brain White Matter”, Magnetic Resonance
in Medicine, 2016.</p>
</div>
<div class="citation" id="zucchelli2017" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">Zucchelli2017</a><span class="fn-bracket">]</span></span>
<p>Zucchelli E. et al., “A generalized SMT-based framework
for Diffusion MRI microstructural model estimation”, MICCAI Workshop
on Computational DIFFUSION MRI (CDMRI), 2017.</p>
</div>
<div class="citation" id="alexander2017" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">Alexander2017</a><span class="fn-bracket">]</span></span>
<p>Alexander LM, Escalera J, Ai L, et al. An open resource
for transdiagnostic research in pediatric mental health and learning
disorders. Sci Data. 2017;4:170181.</p>
</div>
<div class="citation" id="richiehalford2022" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">RichieHalford2022</a><span class="fn-bracket">]</span></span>
<p>Richie-Halford A, Cieslak M, Ai L, et al. An
analysis-ready and quality controlled resource for pediatric brain
white-matter research. Scientific Data. 2022;9(1):1-27.</p>
</div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (3 minutes 36.057 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-built-reconstruction-reconst-forecast-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5397bbe0587f6eee18cf295cf23c649b/reconst_forecast.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">reconst_forecast.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a55a6bddc90abd3e082754fb32eaddc1/reconst_forecast.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">reconst_forecast.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="reconst_dti.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Reconstruction of the diffusion signal with the Tensor model</p>
      </div>
    </a>
    <a class="right-next"
       href="histology_resdnn.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Local reconstruction using the Histological ResDNN</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  
<script type="module" src="../../_static/scripts/grg-sphinx-theme.js"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><div>
  <h3 class="footer-heading">
    Never miss an update from us!
  </h3>
  <p class="footer-sub-heading">
    Don't worry! we are not going to spam you.
  </p>
  <div class="input-group mb-3 mar-t-10">
    <input type="text" class="form-control" placeholder="You email" aria-label="You email" id="grg-subscribe-email">
    <div class="input-group-append pointer" onclick="(document.getElementById('grg-subscribe-email').value)">
      <span class="input-group-text subscribe">Subscribe</span>
    </div>
  </div>  
  <ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter/X</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-youtube"></i></span>
            <label class="sr-only">YouTube</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin"></i></span>
            <label class="sr-only">LinkedIn</label></a>
        </li>
</ul>
</div></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="grid-3">
  
  <div>
    <h5 class="footer-heading">
      About
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://dipy.org/team">
            Developers
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://github.com/dipy/dipy/discussions" target="_blank" rel="noopener noreferrer">
            Support
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../user_guide/installation.html">
            Download
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../user_guide/getting_started.html">
            Get Started
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../index.html">
            Tutorials
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank" rel="noopener noreferrer">
            Videos
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Friends
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/" target="_blank" rel="noopener noreferrer">
            Nipy Projects
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://fury.gl/" target="_blank" rel="noopener noreferrer">
            FURY
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/nibabel" target="_blank" rel="noopener noreferrer">
            Nibabel
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://tortoise.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            Tortoise
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Support
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://engineering.indiana.edu/" target="_blank" rel="noopener noreferrer">
            The department of Intelligent Systems Engineering of Indiana University
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            The National Institute of Biomedical Imaging and Bioengineering, NIH
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://escience.washington.edu" target="_blank" rel="noopener noreferrer">
            The Gordon and Betty Moore Foundation and the Alfred P. Sloan Foundation, through the University of Washington eScience Institute Data Science Environment
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://summerofcode.withgoogle.com/" target="_blank" rel="noopener noreferrer">
            Google supported DIPY through the Google Summer of Code Program (2015-2024)
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
</div></div>
      
    </div>
  
</div>

    <div class="copyright-text">
      <i class="fa-regular fa-copyright"></i> Copyright 2008-2024, DIPY developers. Created using Grg Sphinx Theme and PyData Sphinx Theme.
    </div>
  </footer>
  </body>
</html>