
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples_built/reconstruction/reconst_mapmri.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_built_reconstruction_reconst_mapmri.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_built_reconstruction_reconst_mapmri.py:


=================================================================
Continuous and analytical diffusion signal modelling with MAP-MRI
=================================================================

We show how to model the diffusion signal as a linear combination of continuous
functions from the MAP-MRI basis [Ozarslan2013]_. This continuous representation
allows for the computation of many properties of both the signal and diffusion
propagator.

We show how to estimate the analytical orientation distribution function (ODF)
and a variety of scalar indices. These include rotationally invariant quantities
such as the mean squared displacement (MSD), Q-space inverse variance (QIV),
teturn-to-origin probability (RTOP) and non-Gaussianity (NG). Interestingly, the
MAP-MRI basis also allows for the computation of directional indices, such as
the return-to-axis probability (RTAP), the return-to-plane probability
(RTPP), and the parallel and perpendicular non-Gaussianity.

The estimation of these properties from noisy and sparse DWIs requires that the
fitting of the MAP-MRI basis is constrained and/or regularized. This can be done
by constraining the diffusion propagator to positive values [Ozarslan2013]_
[DelaHaije2020]_, and through analytic Laplacian regularization (MAPL)
[Fick2016a]_.

First import the necessary modules:

.. GENERATED FROM PYTHON SOURCE LINES 27-36

.. code-block:: default


    from dipy.reconst import mapmri
    from dipy.viz import window, actor
    from dipy.data import get_fnames, get_sphere
    from dipy.core.gradients import gradient_table
    from dipy.io.image import load_nifti
    from dipy.io.gradients import read_bvals_bvecs
    from dipy.viz.plotting import compare_maps








.. GENERATED FROM PYTHON SOURCE LINES 37-42

Download and read the data for this tutorial.

MAP-MRI requires multi-shell data, to properly fit the radial part of the basis.
The total size of the downloaded data is 187.66 MBytes, however you only need
to fetch it once.

.. GENERATED FROM PYTHON SOURCE LINES 42-46

.. code-block:: default



    fraw, fbval, fbvec, t1_fname = get_fnames('cfin_multib')








.. GENERATED FROM PYTHON SOURCE LINES 47-56

``data`` contains the voxel data and ``gtab`` contains a ``GradientTable``
object (gradient information e.g. b-values). For example, to show the b-values
it is possible to write::

   print(gtab.bvals)

For the values of the q-space indices to make sense it is necessary to
explicitly state the ``big_delta`` and ``small_delta`` parameters in the
gradient table.

.. GENERATED FROM PYTHON SOURCE LINES 56-72

.. code-block:: default



    data, affine = load_nifti(fraw)
    bvals, bvecs = read_bvals_bvecs(fbval, fbvec)
    gtab = gradient_table(bvals, bvecs)

    big_delta = 0.0365  # seconds
    small_delta = 0.0157  # seconds
    gtab = gradient_table(bvals=gtab.bvals, bvecs=gtab.bvecs,
                          big_delta=big_delta,
                          small_delta=small_delta)

    data_small = data[40:65, 50:51]

    print('data.shape (%d, %d, %d, %d)' % data.shape)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    data.shape (96, 96, 19, 496)




.. GENERATED FROM PYTHON SOURCE LINES 73-130

The MAP-MRI Model can now be instantiated. The ``radial_order`` determines the
expansion order of the basis, i.e., how many basis functions are used to
approximate the signal.

First, we must decide to use the anisotropic or isotropic MAP-MRI basis. As was
shown in [Fick2016a]_, the isotropic basis is best used for tractography
purposes, as the anisotropic basis has a bias towards smaller crossing angles
in the ODF. For signal fitting and estimation of scalar quantities the
anisotropic basis is suggested. The choice can be made by setting
``anisotropic_scaling=True`` or ``anisotropic_scaling=False``.

First, we must select the method of regularization and/or constraining the
basis fitting.

- ``laplacian_regularization=True`` makes it use Laplacian regularization
  [Fick2016a]_. This method essentially reduces spurious oscillations in the
  reconstruction by minimizing the Laplacian of the fitted signal. Several
  options can be given to select the regularization weight:

    - ``regularization_weighting=GCV`` uses generalized cross-validation
      [Craven1978]_ to find an optimal weight.
    - ``regularization_weighting=0.2`` for example would omit the GCV and
      just set it to 0.2 (found to be reasonable in HCP data [Fick2016a]_).
    - ``regularization_weighting=np.array(weights)`` would make the GCV use
      a custom range to find an optimal weight.

- ``positivity_constraint=True`` makes it use a positivity constraint on the
  diffusion propagator. This method constrains the final solution of the
  diffusion propagator to be positive either globally [DelaHaije2020] or at a
  set of discrete points [Ozarslan2013]_, since negative values should not
  exist.

    - Setting ``global_constraints=True`` enforces positivity everywhere.
      With the setting ``global_constraints=False`` positivity is enforced on
      a grid determined by ``pos_grid`` and ``pos_radius``.

Both methods do a good job of producing viable solutions to the signal fitting
in practice. The difference is that the Laplacian regularization imposes
smoothness over the entire signal, including the extrapolation beyond the
measured signal. In practice this may result in, but does not guarantee,
positive solutions of the diffusion propagator. The positivity constraint
guarantees a positive solution which in general results in smooth solutions, but
does not guarantee it.

A suggested strategy is to use a low Laplacian weight together with a positivity
constraint. In this way both desired properties are guaranteed in final
solution. Higher Laplacian weights are recommended when the data is very noisy.

We use the package CVXPY (https://www.cvxpy.org/) to solve convex optimization
problems when ``positivity_constraint=True``, so we need to first install CVXPY.
When using ``global_constraints=True`` to ensure global positivity, it is
recommended to use the MOSEK solver (https://www.mosek.com/) together with CVXPY
by setting ``cvxpy_solver='MOSEK'``. Different solvers can differ greatly in
terms of runtime and solution accuracy, and in some cases solvers may show
warnings about convergence or recommended option settings.

For now we will generate the anisotropic models for different combinations.

.. GENERATED FROM PYTHON SOURCE LINES 130-154

.. code-block:: default



    radial_order = 6

    map_model_laplacian_aniso = mapmri.MapmriModel(gtab, radial_order=radial_order,
                                                   laplacian_regularization=True,
                                                   laplacian_weighting=.2)

    map_model_positivity_aniso = mapmri.MapmriModel(gtab,
                                                    radial_order=radial_order,
                                                    laplacian_regularization=False,
                                                    positivity_constraint=True)

    map_model_both_aniso = mapmri.MapmriModel(gtab, radial_order=radial_order,
                                              laplacian_regularization=True,
                                              laplacian_weighting=.05,
                                              positivity_constraint=True)

    map_model_plus_aniso = mapmri.MapmriModel(gtab,
                                              radial_order=radial_order,
                                              laplacian_regularization=False,
                                              positivity_constraint=True,
                                              global_constraints=True)








.. GENERATED FROM PYTHON SOURCE LINES 155-162

Note that when we use only Laplacian regularization, the ``GCV`` option may
select very low regularization weights in very anisotropic white matter such
as the corpus callosum, resulting in corrupted scalar indices. In this example
we therefore choose a preset value of 0.2, which was shown to be quite robust
and also faster in practice [Fick2016a]_.

We can then fit the MAP-MRI model to the data:

.. GENERATED FROM PYTHON SOURCE LINES 162-173

.. code-block:: default



    mapfit_laplacian_aniso = map_model_laplacian_aniso.fit(data_small)
    mapfit_positivity_aniso = map_model_positivity_aniso.fit(data_small)
    mapfit_both_aniso = map_model_both_aniso.fit(data_small)
    mapfit_plus_aniso = map_model_plus_aniso.fit(data_small)

    fits = [mapfit_laplacian_aniso, mapfit_positivity_aniso, mapfit_both_aniso,
            mapfit_plus_aniso]
    fit_labels = ['MAPL', 'CMAP', 'CMAPL', 'MAP+']





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/475 [00:00<?, ?it/s]      2%|▏         | 9/475 [00:00<00:05, 81.50it/s]      4%|▍         | 20/475 [00:00<00:04, 92.27it/s]      6%|▋         | 30/475 [00:00<00:04, 95.25it/s]      8%|▊         | 40/475 [00:00<00:04, 91.57it/s]     11%|█         | 50/475 [00:00<00:05, 79.62it/s]     13%|█▎        | 61/475 [00:00<00:04, 86.98it/s]     15%|█▍        | 71/475 [00:00<00:04, 90.72it/s]     17%|█▋        | 82/475 [00:00<00:04, 95.77it/s]     20%|█▉        | 93/475 [00:01<00:03, 98.34it/s]     22%|██▏       | 103/475 [00:01<00:03, 96.97it/s]     24%|██▍       | 113/475 [00:01<00:03, 97.39it/s]     26%|██▌       | 124/475 [00:01<00:03, 99.15it/s]     28%|██▊       | 134/475 [00:01<00:03, 96.99it/s]     31%|███       | 145/475 [00:01<00:03, 98.42it/s]     33%|███▎      | 155/475 [00:01<00:03, 93.23it/s]     35%|███▍      | 165/475 [00:01<00:03, 93.79it/s]     37%|███▋      | 176/475 [00:01<00:03, 96.41it/s]     39%|███▉      | 186/475 [00:01<00:03, 95.08it/s]     41%|████▏     | 196/475 [00:02<00:03, 91.13it/s]     43%|████▎     | 206/475 [00:02<00:02, 92.34it/s]     46%|████▌     | 217/475 [00:02<00:02, 95.61it/s]     48%|████▊     | 228/475 [00:02<00:02, 97.82it/s]     50%|█████     | 239/475 [00:02<00:02, 99.50it/s]     53%|█████▎    | 250/475 [00:02<00:02, 98.77it/s]     55%|█████▍    | 260/475 [00:02<00:02, 74.92it/s]     57%|█████▋    | 269/475 [00:02<00:02, 76.88it/s]     59%|█████▊    | 279/475 [00:03<00:02, 82.02it/s]     61%|██████    | 288/475 [00:03<00:02, 82.83it/s]     63%|██████▎   | 299/475 [00:03<00:01, 89.25it/s]     65%|██████▌   | 310/475 [00:03<00:01, 94.63it/s]     67%|██████▋   | 320/475 [00:03<00:01, 94.17it/s]     70%|██████▉   | 331/475 [00:03<00:01, 96.20it/s]     72%|███████▏  | 341/475 [00:03<00:01, 96.78it/s]     74%|███████▍  | 351/475 [00:03<00:01, 94.49it/s]     76%|███████▌  | 361/475 [00:03<00:01, 94.43it/s]     78%|███████▊  | 371/475 [00:04<00:01, 94.96it/s]     80%|████████  | 381/475 [00:04<00:00, 95.31it/s]     82%|████████▏ | 391/475 [00:04<00:00, 93.31it/s]     85%|████████▍ | 402/475 [00:04<00:00, 96.27it/s]     87%|████████▋ | 413/475 [00:04<00:00, 98.31it/s]     89%|████████▉ | 424/475 [00:04<00:00, 99.61it/s]     91%|█████████▏| 434/475 [00:04<00:00, 98.94it/s]     93%|█████████▎| 444/475 [00:04<00:00, 98.11it/s]     96%|█████████▌| 455/475 [00:04<00:00, 100.95it/s]     98%|█████████▊| 466/475 [00:04<00:00, 99.75it/s]     100%|██████████| 475/475 [00:05<00:00, 93.91it/s]
      0%|          | 0/475 [00:00<?, ?it/s]      0%|          | 1/475 [00:00<03:12,  2.46it/s]      0%|          | 2/475 [00:00<01:53,  4.18it/s]      1%|          | 3/475 [00:00<01:52,  4.19it/s]      1%|          | 4/475 [00:01<02:14,  3.51it/s]      1%|          | 5/475 [00:01<02:05,  3.75it/s]      1%|▏         | 6/475 [00:01<02:49,  2.77it/s]      1%|▏         | 7/475 [00:02<02:25,  3.21it/s]      2%|▏         | 8/475 [00:02<03:01,  2.58it/s]      2%|▏         | 9/475 [00:03<03:08,  2.47it/s]      2%|▏         | 10/475 [00:03<03:22,  2.29it/s]      2%|▏         | 11/475 [00:03<03:14,  2.39it/s]      3%|▎         | 12/475 [00:04<03:01,  2.56it/s]      3%|▎         | 13/475 [00:04<02:55,  2.63it/s]      3%|▎         | 14/475 [00:05<03:15,  2.36it/s]      3%|▎         | 15/475 [00:05<03:16,  2.34it/s]      3%|▎         | 16/475 [00:05<03:07,  2.45it/s]      4%|▎         | 17/475 [00:06<03:18,  2.31it/s]      4%|▍         | 18/475 [00:07<03:32,  2.16it/s]      4%|▍         | 19/475 [00:07<03:26,  2.21it/s]      4%|▍         | 20/475 [00:07<02:44,  2.77it/s]      4%|▍         | 21/475 [00:07<02:32,  2.98it/s]      5%|▍         | 22/475 [00:08<02:14,  3.37it/s]      5%|▍         | 23/475 [00:08<03:19,  2.26it/s]      5%|▌         | 24/475 [00:09<02:56,  2.56it/s]      5%|▌         | 25/475 [00:09<03:38,  2.05it/s]      5%|▌         | 26/475 [00:10<03:31,  2.12it/s]      6%|▌         | 27/475 [00:10<03:18,  2.26it/s]      6%|▌         | 28/475 [00:11<03:43,  2.00it/s]      6%|▌         | 29/475 [00:11<03:34,  2.08it/s]      6%|▋         | 30/475 [00:12<03:33,  2.08it/s]      7%|▋         | 31/475 [00:13<04:19,  1.71it/s]      7%|▋         | 32/475 [00:13<04:22,  1.69it/s]      7%|▋         | 33/475 [00:14<04:08,  1.78it/s]      7%|▋         | 34/475 [00:14<03:32,  2.07it/s]      7%|▋         | 35/475 [00:14<03:22,  2.18it/s]      8%|▊         | 36/475 [00:15<03:02,  2.41it/s]      8%|▊         | 37/475 [00:15<03:20,  2.19it/s]      8%|▊         | 38/475 [00:16<03:11,  2.29it/s]      8%|▊         | 39/475 [00:16<03:15,  2.23it/s]      8%|▊         | 40/475 [00:16<02:48,  2.58it/s]      9%|▊         | 41/475 [00:17<02:22,  3.04it/s]      9%|▉         | 42/475 [00:17<02:27,  2.94it/s]      9%|▉         | 43/475 [00:17<02:11,  3.28it/s]      9%|▉         | 44/475 [00:17<02:22,  3.03it/s]      9%|▉         | 45/475 [00:18<02:31,  2.83it/s]     10%|▉         | 46/475 [00:18<02:38,  2.71it/s]     10%|▉         | 47/475 [00:19<03:14,  2.20it/s]     10%|█         | 48/475 [00:19<03:07,  2.28it/s]     10%|█         | 49/475 [00:20<03:17,  2.16it/s]     11%|█         | 50/475 [00:20<03:22,  2.10it/s]     11%|█         | 51/475 [00:21<03:09,  2.24it/s]     11%|█         | 52/475 [00:21<03:06,  2.27it/s]     11%|█         | 53/475 [00:22<02:54,  2.42it/s]     11%|█▏        | 54/475 [00:22<03:03,  2.30it/s]     12%|█▏        | 55/475 [00:22<02:30,  2.80it/s]     12%|█▏        | 56/475 [00:23<03:00,  2.33it/s]     12%|█▏        | 57/475 [00:23<02:57,  2.36it/s]     12%|█▏        | 58/475 [00:24<03:47,  1.83it/s]     12%|█▏        | 59/475 [00:24<02:51,  2.42it/s]     13%|█▎        | 60/475 [00:24<02:41,  2.56it/s]     13%|█▎        | 61/475 [00:25<02:55,  2.36it/s]     13%|█▎        | 62/475 [00:25<03:07,  2.20it/s]     13%|█▎        | 63/475 [00:26<02:45,  2.49it/s]     13%|█▎        | 64/475 [00:26<02:42,  2.53it/s]     14%|█▎        | 65/475 [00:27<02:57,  2.31it/s]     14%|█▍        | 66/475 [00:27<02:49,  2.41it/s]     14%|█▍        | 67/475 [00:27<02:45,  2.47it/s]     14%|█▍        | 68/475 [00:28<02:59,  2.27it/s]     15%|█▍        | 69/475 [00:28<02:47,  2.42it/s]     15%|█▍        | 70/475 [00:29<02:37,  2.56it/s]     15%|█▍        | 71/475 [00:29<02:51,  2.36it/s]     15%|█▌        | 72/475 [00:29<02:18,  2.91it/s]     15%|█▌        | 73/475 [00:30<02:26,  2.75it/s]     16%|█▌        | 74/475 [00:30<02:02,  3.26it/s]     16%|█▌        | 75/475 [00:30<02:02,  3.25it/s]     16%|█▌        | 76/475 [00:31<02:09,  3.07it/s]     16%|█▌        | 77/475 [00:31<02:27,  2.69it/s]     17%|█▋        | 79/475 [00:31<01:58,  3.34it/s]     17%|█▋        | 80/475 [00:32<02:03,  3.19it/s]     17%|█▋        | 81/475 [00:32<02:18,  2.85it/s]     17%|█▋        | 82/475 [00:33<02:33,  2.56it/s]     17%|█▋        | 83/475 [00:33<02:33,  2.55it/s]     18%|█▊        | 84/475 [00:34<02:28,  2.63it/s]     18%|█▊        | 85/475 [00:34<02:59,  2.17it/s]     18%|█▊        | 86/475 [00:35<03:08,  2.06it/s]     18%|█▊        | 87/475 [00:35<02:48,  2.30it/s]     19%|█▊        | 88/475 [00:35<02:41,  2.39it/s]     19%|█▊        | 89/475 [00:36<02:24,  2.67it/s]     19%|█▉        | 90/475 [00:36<02:14,  2.86it/s]     19%|█▉        | 91/475 [00:36<02:09,  2.95it/s]     19%|█▉        | 92/475 [00:37<01:59,  3.21it/s]     20%|█▉        | 94/475 [00:37<01:50,  3.43it/s]     20%|██        | 95/475 [00:38<02:03,  3.07it/s]     20%|██        | 96/475 [00:38<01:44,  3.64it/s]     20%|██        | 97/475 [00:38<01:41,  3.74it/s]     21%|██        | 98/475 [00:38<01:53,  3.34it/s]     21%|██        | 99/475 [00:39<02:00,  3.11it/s]     21%|██        | 100/475 [00:39<02:05,  2.99it/s]     21%|██▏       | 101/475 [00:39<02:15,  2.76it/s]     21%|██▏       | 102/475 [00:40<02:13,  2.78it/s]     22%|██▏       | 103/475 [00:40<02:15,  2.74it/s]     22%|██▏       | 104/475 [00:41<02:14,  2.77it/s]     22%|██▏       | 105/475 [00:41<02:24,  2.57it/s]     22%|██▏       | 106/475 [00:41<01:55,  3.20it/s]     23%|██▎       | 107/475 [00:41<01:43,  3.56it/s]     23%|██▎       | 108/475 [00:42<01:41,  3.61it/s]     23%|██▎       | 109/475 [00:42<01:42,  3.56it/s]     23%|██▎       | 110/475 [00:42<01:37,  3.75it/s]     23%|██▎       | 111/475 [00:43<01:52,  3.25it/s]     24%|██▎       | 112/475 [00:43<01:36,  3.74it/s]     24%|██▍       | 113/475 [00:43<02:01,  2.99it/s]     24%|██▍       | 114/475 [00:44<02:04,  2.89it/s]     24%|██▍       | 115/475 [00:44<02:24,  2.49it/s]     24%|██▍       | 116/475 [00:45<02:36,  2.30it/s]     25%|██▍       | 117/475 [00:45<02:35,  2.30it/s]     25%|██▍       | 118/475 [00:46<02:50,  2.09it/s]     25%|██▌       | 119/475 [00:46<02:52,  2.07it/s]     25%|██▌       | 120/475 [00:46<02:38,  2.24it/s]     25%|██▌       | 121/475 [00:47<02:47,  2.12it/s]     26%|██▌       | 122/475 [00:47<02:11,  2.69it/s]     26%|██▌       | 123/475 [00:47<01:48,  3.24it/s]     26%|██▌       | 124/475 [00:47<01:31,  3.85it/s]     26%|██▋       | 125/475 [00:48<01:17,  4.49it/s]     27%|██▋       | 126/475 [00:48<01:18,  4.42it/s]     27%|██▋       | 127/475 [00:48<01:19,  4.40it/s]     27%|██▋       | 128/475 [00:48<01:40,  3.44it/s]     27%|██▋       | 129/475 [00:49<01:39,  3.47it/s]     27%|██▋       | 130/475 [00:49<01:27,  3.94it/s]     28%|██▊       | 131/475 [00:49<01:39,  3.45it/s]     28%|██▊       | 132/475 [00:50<01:49,  3.14it/s]     28%|██▊       | 133/475 [00:50<01:49,  3.12it/s]     28%|██▊       | 134/475 [00:50<01:34,  3.60it/s]     28%|██▊       | 135/475 [00:51<01:46,  3.20it/s]     29%|██▊       | 136/475 [00:51<01:30,  3.73it/s]     29%|██▉       | 137/475 [00:51<01:32,  3.67it/s]     29%|██▉       | 138/475 [00:51<01:47,  3.12it/s]     29%|██▉       | 139/475 [00:52<02:02,  2.75it/s]     29%|██▉       | 140/475 [00:52<01:59,  2.81it/s]     30%|██▉       | 141/475 [00:53<01:50,  3.03it/s]     30%|██▉       | 142/475 [00:53<01:41,  3.29it/s]     30%|███       | 143/475 [00:53<01:23,  3.99it/s]     31%|███       | 145/475 [00:53<01:08,  4.79it/s]     31%|███       | 146/475 [00:53<01:11,  4.58it/s]     31%|███       | 147/475 [00:54<01:08,  4.77it/s]     31%|███       | 148/475 [00:54<01:08,  4.76it/s]     31%|███▏      | 149/475 [00:54<01:10,  4.63it/s]     32%|███▏      | 150/475 [00:54<01:21,  3.99it/s]     32%|███▏      | 151/475 [00:55<01:52,  2.87it/s]     32%|███▏      | 152/475 [00:55<01:50,  2.93it/s]     32%|███▏      | 153/475 [00:56<01:32,  3.49it/s]     32%|███▏      | 154/475 [00:56<01:15,  4.23it/s]     33%|███▎      | 155/475 [00:56<01:03,  5.07it/s]     33%|███▎      | 157/475 [00:56<01:02,  5.10it/s]     33%|███▎      | 158/475 [00:56<01:05,  4.83it/s]     33%|███▎      | 159/475 [00:57<01:18,  4.02it/s]     34%|███▎      | 160/475 [00:57<01:09,  4.55it/s]     34%|███▍      | 161/475 [00:57<01:00,  5.19it/s]     34%|███▍      | 162/475 [00:57<01:00,  5.15it/s]     34%|███▍      | 163/475 [00:58<01:58,  2.64it/s]     35%|███▍      | 164/475 [00:58<01:44,  2.98it/s]     35%|███▍      | 165/475 [00:59<01:36,  3.21it/s]     35%|███▍      | 166/475 [00:59<01:34,  3.27it/s]     35%|███▌      | 167/475 [00:59<01:25,  3.62it/s]     35%|███▌      | 168/475 [00:59<01:17,  3.96it/s]     36%|███▌      | 169/475 [01:00<01:33,  3.28it/s]     36%|███▌      | 170/475 [01:00<01:38,  3.09it/s]     36%|███▌      | 171/475 [01:00<01:28,  3.44it/s]     36%|███▌      | 172/475 [01:01<01:29,  3.38it/s]     36%|███▋      | 173/475 [01:01<01:15,  3.98it/s]     37%|███▋      | 174/475 [01:01<01:32,  3.24it/s]     37%|███▋      | 175/475 [01:02<01:42,  2.91it/s]     37%|███▋      | 176/475 [01:02<01:34,  3.17it/s]     37%|███▋      | 177/475 [01:02<01:38,  3.03it/s]     37%|███▋      | 178/475 [01:02<01:25,  3.48it/s]     38%|███▊      | 179/475 [01:03<01:21,  3.65it/s]     38%|███▊      | 180/475 [01:03<01:06,  4.42it/s]     38%|███▊      | 181/475 [01:03<01:05,  4.52it/s]     38%|███▊      | 182/475 [01:03<00:58,  4.98it/s]     39%|███▊      | 183/475 [01:03<01:01,  4.72it/s]     39%|███▊      | 184/475 [01:04<01:10,  4.12it/s]     39%|███▉      | 185/475 [01:04<01:04,  4.49it/s]     39%|███▉      | 186/475 [01:04<00:59,  4.87it/s]     39%|███▉      | 187/475 [01:04<00:53,  5.38it/s]     40%|███▉      | 188/475 [01:04<01:04,  4.44it/s]     40%|███▉      | 189/475 [01:05<01:21,  3.51it/s]     40%|████      | 190/475 [01:05<01:27,  3.25it/s]     40%|████      | 191/475 [01:05<01:24,  3.36it/s]     40%|████      | 192/475 [01:06<01:15,  3.74it/s]     41%|████      | 193/475 [01:06<01:26,  3.24it/s]     41%|████      | 194/475 [01:06<01:34,  2.97it/s]     41%|████      | 195/475 [01:07<01:54,  2.44it/s]     41%|████▏     | 196/475 [01:07<01:53,  2.47it/s]     41%|████▏     | 197/475 [01:08<01:57,  2.37it/s]     42%|████▏     | 198/475 [01:08<01:35,  2.89it/s]     42%|████▏     | 199/475 [01:08<01:22,  3.34it/s]     42%|████▏     | 200/475 [01:08<01:12,  3.79it/s]     42%|████▏     | 201/475 [01:09<01:02,  4.35it/s]     43%|████▎     | 202/475 [01:09<01:06,  4.09it/s]     43%|████▎     | 203/475 [01:09<01:16,  3.55it/s]     43%|████▎     | 204/475 [01:10<01:14,  3.64it/s]     43%|████▎     | 205/475 [01:10<01:29,  3.03it/s]     43%|████▎     | 206/475 [01:10<01:16,  3.50it/s]     44%|████▎     | 207/475 [01:10<01:19,  3.38it/s]     44%|████▍     | 208/475 [01:11<01:33,  2.86it/s]     44%|████▍     | 209/475 [01:11<01:28,  2.99it/s]     44%|████▍     | 210/475 [01:12<01:25,  3.09it/s]     44%|████▍     | 211/475 [01:12<01:45,  2.51it/s]     45%|████▍     | 212/475 [01:13<01:45,  2.48it/s]     45%|████▍     | 213/475 [01:13<01:34,  2.78it/s]     45%|████▌     | 214/475 [01:13<01:32,  2.84it/s]     45%|████▌     | 215/475 [01:14<01:37,  2.68it/s]     45%|████▌     | 216/475 [01:14<01:37,  2.67it/s]     46%|████▌     | 217/475 [01:14<01:38,  2.62it/s]     46%|████▌     | 218/475 [01:15<01:43,  2.49it/s]     46%|████▌     | 219/475 [01:15<01:35,  2.67it/s]     46%|████▋     | 220/475 [01:15<01:34,  2.69it/s]     47%|████▋     | 221/475 [01:16<01:14,  3.39it/s]     47%|████▋     | 222/475 [01:16<01:09,  3.67it/s]     47%|████▋     | 223/475 [01:16<01:03,  4.00it/s]     47%|████▋     | 224/475 [01:16<00:58,  4.29it/s]     47%|████▋     | 225/475 [01:16<00:52,  4.79it/s]     48%|████▊     | 226/475 [01:17<01:04,  3.84it/s]     48%|████▊     | 227/475 [01:17<01:32,  2.69it/s]     48%|████▊     | 228/475 [01:18<01:47,  2.29it/s]     48%|████▊     | 229/475 [01:18<01:27,  2.81it/s]     48%|████▊     | 230/475 [01:18<01:11,  3.44it/s]     49%|████▊     | 231/475 [01:19<01:26,  2.82it/s]     49%|████▉     | 232/475 [01:19<01:30,  2.68it/s]     49%|████▉     | 233/475 [01:20<01:32,  2.62it/s]     49%|████▉     | 234/475 [01:20<01:53,  2.13it/s]     49%|████▉     | 235/475 [01:21<01:44,  2.30it/s]     50%|████▉     | 236/475 [01:21<01:39,  2.40it/s]     50%|████▉     | 237/475 [01:21<01:28,  2.69it/s]     50%|█████     | 238/475 [01:22<01:29,  2.65it/s]     50%|█████     | 239/475 [01:22<01:27,  2.69it/s]     51%|█████     | 240/475 [01:22<01:30,  2.59it/s]     51%|█████     | 241/475 [01:23<01:21,  2.88it/s]     51%|█████     | 242/475 [01:23<01:11,  3.25it/s]     51%|█████     | 243/475 [01:23<01:04,  3.62it/s]     51%|█████▏    | 244/475 [01:23<01:08,  3.36it/s]     52%|█████▏    | 245/475 [01:24<01:05,  3.52it/s]     52%|█████▏    | 246/475 [01:24<01:41,  2.26it/s]     52%|█████▏    | 247/475 [01:25<02:00,  1.89it/s]     52%|█████▏    | 248/475 [01:25<01:33,  2.43it/s]     52%|█████▏    | 249/475 [01:25<01:12,  3.13it/s]     53%|█████▎    | 250/475 [01:26<01:40,  2.24it/s]     53%|█████▎    | 251/475 [01:27<01:36,  2.33it/s]     53%|█████▎    | 252/475 [01:27<01:29,  2.49it/s]     53%|█████▎    | 253/475 [01:27<01:18,  2.82it/s]     53%|█████▎    | 254/475 [01:28<01:19,  2.78it/s]     54%|█████▎    | 255/475 [01:28<01:23,  2.64it/s]     54%|█████▍    | 256/475 [01:28<01:22,  2.67it/s]     54%|█████▍    | 257/475 [01:29<01:20,  2.72it/s]     54%|█████▍    | 258/475 [01:29<01:23,  2.59it/s]     55%|█████▍    | 259/475 [01:30<01:29,  2.41it/s]     55%|█████▍    | 260/475 [01:30<01:24,  2.54it/s]     55%|█████▍    | 261/475 [01:31<01:37,  2.20it/s]     55%|█████▌    | 262/475 [01:31<01:31,  2.33it/s]     55%|█████▌    | 263/475 [01:31<01:10,  3.01it/s]     56%|█████▌    | 264/475 [01:31<01:06,  3.15it/s]     56%|█████▌    | 265/475 [01:32<01:06,  3.17it/s]     56%|█████▌    | 266/475 [01:32<01:13,  2.86it/s]     56%|█████▌    | 267/475 [01:32<01:00,  3.46it/s]     57%|█████▋    | 269/475 [01:33<00:53,  3.84it/s]     57%|█████▋    | 270/475 [01:33<01:14,  2.75it/s]     57%|█████▋    | 271/475 [01:34<01:15,  2.70it/s]     57%|█████▋    | 272/475 [01:34<01:13,  2.76it/s]     57%|█████▋    | 273/475 [01:35<01:23,  2.42it/s]     58%|█████▊    | 274/475 [01:35<01:24,  2.38it/s]     58%|█████▊    | 275/475 [01:36<01:58,  1.69it/s]     58%|█████▊    | 276/475 [01:36<01:48,  1.83it/s]     58%|█████▊    | 277/475 [01:37<01:47,  1.84it/s]     59%|█████▊    | 278/475 [01:38<01:46,  1.86it/s]     59%|█████▊    | 279/475 [01:38<01:39,  1.97it/s]     59%|█████▉    | 280/475 [01:38<01:23,  2.32it/s]     59%|█████▉    | 281/475 [01:39<01:37,  1.99it/s]     59%|█████▉    | 282/475 [01:39<01:26,  2.23it/s]     60%|█████▉    | 283/475 [01:40<01:19,  2.42it/s]     60%|█████▉    | 284/475 [01:40<01:31,  2.09it/s]     60%|██████    | 285/475 [01:41<01:24,  2.25it/s]     60%|██████    | 286/475 [01:41<01:16,  2.49it/s]     60%|██████    | 287/475 [01:41<00:59,  3.16it/s]     61%|██████    | 288/475 [01:41<00:52,  3.57it/s]     61%|██████    | 289/475 [01:41<00:55,  3.37it/s]     61%|██████    | 290/475 [01:42<00:53,  3.43it/s]     61%|██████▏   | 291/475 [01:42<00:53,  3.47it/s]     61%|██████▏   | 292/475 [01:43<01:21,  2.24it/s]     62%|██████▏   | 293/475 [01:43<01:19,  2.28it/s]     62%|██████▏   | 294/475 [01:44<01:08,  2.65it/s]     62%|██████▏   | 295/475 [01:44<01:06,  2.70it/s]     62%|██████▏   | 296/475 [01:44<01:08,  2.60it/s]     63%|██████▎   | 297/475 [01:45<01:13,  2.43it/s]     63%|██████▎   | 298/475 [01:45<01:13,  2.40it/s]     63%|██████▎   | 299/475 [01:46<01:33,  1.87it/s]     63%|██████▎   | 300/475 [01:46<01:26,  2.02it/s]     63%|██████▎   | 301/475 [01:47<01:22,  2.11it/s]     64%|██████▎   | 302/475 [01:47<01:16,  2.25it/s]     64%|██████▍   | 303/475 [01:48<01:33,  1.85it/s]     64%|██████▍   | 304/475 [01:48<01:24,  2.03it/s]     64%|██████▍   | 305/475 [01:49<01:06,  2.55it/s]     64%|██████▍   | 306/475 [01:49<00:55,  3.06it/s]     65%|██████▍   | 307/475 [01:49<00:43,  3.86it/s]     65%|██████▍   | 308/475 [01:49<00:48,  3.47it/s]     65%|██████▌   | 309/475 [01:50<00:54,  3.06it/s]     65%|██████▌   | 310/475 [01:50<00:47,  3.45it/s]     65%|██████▌   | 311/475 [01:50<00:58,  2.79it/s]     66%|██████▌   | 312/475 [01:51<01:05,  2.49it/s]     66%|██████▌   | 313/475 [01:51<00:53,  3.05it/s]     66%|██████▌   | 314/475 [01:51<00:56,  2.86it/s]     66%|██████▋   | 315/475 [01:52<01:02,  2.56it/s]     67%|██████▋   | 316/475 [01:52<01:02,  2.56it/s]     67%|██████▋   | 317/475 [01:53<01:02,  2.53it/s]     67%|██████▋   | 318/475 [01:53<01:01,  2.55it/s]     67%|██████▋   | 319/475 [01:53<01:04,  2.42it/s]     67%|██████▋   | 320/475 [01:54<01:09,  2.22it/s]     68%|██████▊   | 321/475 [01:54<01:01,  2.49it/s]     68%|██████▊   | 322/475 [01:55<01:13,  2.07it/s]     68%|██████▊   | 323/475 [01:56<01:18,  1.94it/s]     68%|██████▊   | 324/475 [01:56<01:12,  2.09it/s]     68%|██████▊   | 325/475 [01:56<00:55,  2.68it/s]     69%|██████▊   | 326/475 [01:56<00:45,  3.29it/s]     69%|██████▉   | 327/475 [01:57<00:48,  3.06it/s]     69%|██████▉   | 328/475 [01:57<00:52,  2.78it/s]     69%|██████▉   | 329/475 [01:57<00:53,  2.71it/s]     69%|██████▉   | 330/475 [01:58<00:50,  2.88it/s]     70%|██████▉   | 331/475 [01:58<00:41,  3.48it/s]     70%|██████▉   | 332/475 [01:58<00:42,  3.40it/s]     70%|███████   | 333/475 [01:58<00:41,  3.39it/s]     70%|███████   | 334/475 [01:59<00:45,  3.09it/s]     71%|███████   | 335/475 [01:59<00:46,  2.99it/s]     71%|███████   | 336/475 [02:00<00:51,  2.73it/s]     71%|███████   | 337/475 [02:00<00:51,  2.67it/s]     71%|███████   | 338/475 [02:01<00:57,  2.37it/s]     71%|███████▏  | 339/475 [02:01<00:58,  2.34it/s]     72%|███████▏  | 340/475 [02:01<00:58,  2.31it/s]     72%|███████▏  | 341/475 [02:02<00:56,  2.38it/s]     72%|███████▏  | 342/475 [02:02<00:56,  2.36it/s]     72%|███████▏  | 343/475 [02:03<01:12,  1.82it/s]     72%|███████▏  | 344/475 [02:03<01:02,  2.10it/s]     73%|███████▎  | 345/475 [02:04<00:52,  2.47it/s]     73%|███████▎  | 346/475 [02:04<00:47,  2.70it/s]     73%|███████▎  | 347/475 [02:04<00:47,  2.68it/s]     73%|███████▎  | 348/475 [02:05<00:44,  2.87it/s]     73%|███████▎  | 349/475 [02:05<00:46,  2.71it/s]     74%|███████▎  | 350/475 [02:06<00:49,  2.51it/s]     74%|███████▍  | 351/475 [02:06<00:48,  2.58it/s]     74%|███████▍  | 352/475 [02:06<00:50,  2.42it/s]     74%|███████▍  | 353/475 [02:07<00:48,  2.50it/s]     75%|███████▍  | 354/475 [02:07<00:51,  2.33it/s]     75%|███████▍  | 355/475 [02:08<00:57,  2.08it/s]     75%|███████▍  | 356/475 [02:08<00:53,  2.20it/s]     75%|███████▌  | 357/475 [02:09<00:55,  2.14it/s]     75%|███████▌  | 358/475 [02:09<00:52,  2.23it/s]     76%|███████▌  | 359/475 [02:10<00:49,  2.34it/s]     76%|███████▌  | 360/475 [02:11<01:08,  1.68it/s]     76%|███████▌  | 361/475 [02:11<01:00,  1.89it/s]     76%|███████▌  | 362/475 [02:11<01:00,  1.88it/s]     76%|███████▋  | 363/475 [02:12<00:51,  2.19it/s]     77%|███████▋  | 364/475 [02:12<00:48,  2.31it/s]     77%|███████▋  | 365/475 [02:12<00:46,  2.36it/s]     77%|███████▋  | 366/475 [02:13<00:43,  2.49it/s]     77%|███████▋  | 367/475 [02:13<00:46,  2.33it/s]     77%|███████▋  | 368/475 [02:14<00:45,  2.35it/s]     78%|███████▊  | 369/475 [02:14<00:41,  2.54it/s]     78%|███████▊  | 370/475 [02:14<00:39,  2.67it/s]     78%|███████▊  | 371/475 [02:15<00:51,  2.03it/s]     78%|███████▊  | 372/475 [02:16<00:49,  2.08it/s]     79%|███████▊  | 373/475 [02:16<00:51,  2.00it/s]     79%|███████▊  | 374/475 [02:17<00:54,  1.87it/s]     79%|███████▉  | 375/475 [02:17<00:51,  1.93it/s]     79%|███████▉  | 376/475 [02:18<00:46,  2.12it/s]     79%|███████▉  | 377/475 [02:18<00:45,  2.15it/s]     80%|███████▉  | 378/475 [02:19<00:44,  2.19it/s]     80%|███████▉  | 379/475 [02:19<00:52,  1.83it/s]     80%|████████  | 380/475 [02:20<00:46,  2.03it/s]     80%|████████  | 381/475 [02:20<00:50,  1.84it/s]     80%|████████  | 382/475 [02:21<00:45,  2.05it/s]     81%|████████  | 383/475 [02:21<00:42,  2.18it/s]     81%|████████  | 384/475 [02:21<00:40,  2.25it/s]     81%|████████  | 385/475 [02:22<00:32,  2.80it/s]     81%|████████▏ | 386/475 [02:22<00:29,  2.98it/s]     81%|████████▏ | 387/475 [02:22<00:32,  2.72it/s]     82%|████████▏ | 388/475 [02:23<00:38,  2.27it/s]     82%|████████▏ | 389/475 [02:24<00:42,  2.00it/s]     82%|████████▏ | 390/475 [02:24<00:39,  2.17it/s]     82%|████████▏ | 391/475 [02:24<00:37,  2.22it/s]     83%|████████▎ | 392/475 [02:25<00:36,  2.27it/s]     83%|████████▎ | 393/475 [02:25<00:33,  2.48it/s]     83%|████████▎ | 394/475 [02:25<00:32,  2.53it/s]     83%|████████▎ | 395/475 [02:26<00:31,  2.50it/s]     83%|████████▎ | 396/475 [02:26<00:31,  2.51it/s]     84%|████████▎ | 397/475 [02:27<00:32,  2.38it/s]     84%|████████▍ | 398/475 [02:27<00:33,  2.32it/s]     84%|████████▍ | 399/475 [02:28<00:32,  2.36it/s]     84%|████████▍ | 400/475 [02:28<00:37,  2.01it/s]     84%|████████▍ | 401/475 [02:29<00:34,  2.12it/s]     85%|████████▍ | 402/475 [02:29<00:31,  2.29it/s]     85%|████████▍ | 403/475 [02:29<00:31,  2.31it/s]     85%|████████▌ | 404/475 [02:30<00:31,  2.28it/s]     85%|████████▌ | 405/475 [02:30<00:27,  2.58it/s]     85%|████████▌ | 406/475 [02:31<00:28,  2.46it/s]     86%|████████▌ | 407/475 [02:31<00:28,  2.40it/s]     86%|████████▌ | 408/475 [02:32<00:28,  2.37it/s]     86%|████████▌ | 409/475 [02:32<00:26,  2.53it/s]     86%|████████▋ | 410/475 [02:32<00:24,  2.64it/s]     87%|████████▋ | 411/475 [02:33<00:23,  2.69it/s]     87%|████████▋ | 412/475 [02:33<00:22,  2.81it/s]     87%|████████▋ | 413/475 [02:33<00:22,  2.76it/s]     87%|████████▋ | 414/475 [02:34<00:24,  2.47it/s]     87%|████████▋ | 415/475 [02:34<00:26,  2.25it/s]     88%|████████▊ | 416/475 [02:35<00:26,  2.23it/s]     88%|████████▊ | 417/475 [02:35<00:27,  2.13it/s]     88%|████████▊ | 418/475 [02:36<00:27,  2.06it/s]     88%|████████▊ | 419/475 [02:36<00:24,  2.29it/s]     88%|████████▊ | 420/475 [02:36<00:22,  2.39it/s]     89%|████████▊ | 421/475 [02:37<00:20,  2.58it/s]     89%|████████▉ | 422/475 [02:37<00:18,  2.79it/s]     89%|████████▉ | 423/475 [02:37<00:16,  3.12it/s]     89%|████████▉ | 424/475 [02:38<00:16,  3.14it/s]     89%|████████▉ | 425/475 [02:38<00:19,  2.57it/s]     90%|████████▉ | 426/475 [02:39<00:23,  2.07it/s]     90%|████████▉ | 427/475 [02:39<00:24,  1.99it/s]     90%|█████████ | 428/475 [02:40<00:29,  1.61it/s]     90%|█████████ | 429/475 [02:41<00:30,  1.53it/s]     91%|█████████ | 430/475 [02:41<00:25,  1.75it/s]     91%|█████████ | 431/475 [02:42<00:22,  1.97it/s]     91%|█████████ | 432/475 [02:42<00:18,  2.31it/s]     91%|█████████ | 433/475 [02:42<00:17,  2.44it/s]     91%|█████████▏| 434/475 [02:43<00:16,  2.48it/s]     92%|█████████▏| 435/475 [02:43<00:16,  2.38it/s]     92%|█████████▏| 436/475 [02:44<00:17,  2.21it/s]     92%|█████████▏| 437/475 [02:44<00:16,  2.26it/s]     92%|█████████▏| 438/475 [02:45<00:17,  2.12it/s]     92%|█████████▏| 439/475 [02:45<00:18,  1.92it/s]     93%|█████████▎| 440/475 [02:46<00:16,  2.06it/s]     93%|█████████▎| 441/475 [02:46<00:17,  1.98it/s]     93%|█████████▎| 442/475 [02:47<00:16,  1.94it/s]     93%|█████████▎| 443/475 [02:48<00:19,  1.67it/s]     93%|█████████▎| 444/475 [02:48<00:16,  1.89it/s]     94%|█████████▎| 445/475 [02:49<00:15,  1.94it/s]     94%|█████████▍| 446/475 [02:49<00:14,  1.95it/s]     94%|█████████▍| 447/475 [02:50<00:17,  1.64it/s]     94%|█████████▍| 448/475 [02:51<00:18,  1.44it/s]     95%|█████████▍| 449/475 [02:51<00:17,  1.45it/s]     95%|█████████▍| 450/475 [02:52<00:17,  1.43it/s]     95%|█████████▍| 451/475 [02:53<00:15,  1.54it/s]     95%|█████████▌| 452/475 [02:53<00:13,  1.75it/s]     95%|█████████▌| 453/475 [02:53<00:11,  1.98it/s]     96%|█████████▌| 454/475 [02:54<00:10,  2.06it/s]     96%|█████████▌| 455/475 [02:54<00:09,  2.18it/s]     96%|█████████▌| 456/475 [02:55<00:08,  2.29it/s]     96%|█████████▌| 457/475 [02:55<00:08,  2.20it/s]     96%|█████████▋| 458/475 [02:56<00:07,  2.21it/s]     97%|█████████▋| 459/475 [02:56<00:05,  2.82it/s]     97%|█████████▋| 460/475 [02:56<00:04,  3.53it/s]     97%|█████████▋| 461/475 [02:56<00:03,  4.06it/s]     97%|█████████▋| 462/475 [02:56<00:03,  3.38it/s]     97%|█████████▋| 463/475 [02:57<00:05,  2.16it/s]     98%|█████████▊| 464/475 [02:58<00:05,  1.91it/s]     98%|█████████▊| 465/475 [02:59<00:05,  1.72it/s]     98%|█████████▊| 466/475 [02:59<00:05,  1.69it/s]     98%|█████████▊| 467/475 [02:59<00:03,  2.09it/s]     99%|█████████▊| 468/475 [03:00<00:03,  2.11it/s]     99%|█████████▊| 469/475 [03:00<00:02,  2.13it/s]     99%|█████████▉| 470/475 [03:01<00:02,  2.31it/s]     99%|█████████▉| 471/475 [03:01<00:01,  2.48it/s]     99%|█████████▉| 472/475 [03:02<00:01,  2.40it/s]    100%|█████████▉| 473/475 [03:02<00:00,  2.41it/s]    100%|█████████▉| 474/475 [03:02<00:00,  2.53it/s]    100%|██████████| 475/475 [03:03<00:00,  2.56it/s]    100%|██████████| 475/475 [03:03<00:00,  2.59it/s]
      0%|          | 0/475 [00:00<?, ?it/s]      0%|          | 1/475 [00:00<01:48,  4.39it/s]      0%|          | 2/475 [00:00<01:21,  5.77it/s]      1%|          | 3/475 [00:00<01:29,  5.27it/s]      1%|          | 4/475 [00:00<01:32,  5.08it/s]      1%|          | 5/475 [00:01<01:36,  4.85it/s]      1%|▏         | 6/475 [00:01<02:46,  2.82it/s]      1%|▏         | 7/475 [00:01<02:32,  3.07it/s]      2%|▏         | 8/475 [00:02<02:59,  2.60it/s]      2%|▏         | 9/475 [00:02<02:46,  2.80it/s]      2%|▏         | 10/475 [00:03<02:58,  2.60it/s]      2%|▏         | 11/475 [00:03<02:34,  3.01it/s]      3%|▎         | 12/475 [00:03<02:18,  3.35it/s]      3%|▎         | 13/475 [00:03<02:11,  3.52it/s]      3%|▎         | 14/475 [00:04<02:16,  3.39it/s]      3%|▎         | 15/475 [00:04<02:13,  3.45it/s]      3%|▎         | 16/475 [00:04<02:42,  2.83it/s]      4%|▎         | 17/475 [00:05<02:27,  3.10it/s]      4%|▍         | 18/475 [00:05<02:28,  3.09it/s]      4%|▍         | 19/475 [00:05<02:16,  3.35it/s]      4%|▍         | 20/475 [00:05<01:55,  3.95it/s]      4%|▍         | 21/475 [00:06<01:52,  4.05it/s]      5%|▍         | 22/475 [00:06<01:46,  4.25it/s]      5%|▍         | 23/475 [00:06<01:47,  4.19it/s]      5%|▌         | 24/475 [00:06<01:55,  3.92it/s]      5%|▌         | 25/475 [00:07<02:00,  3.74it/s]      5%|▌         | 26/475 [00:07<02:11,  3.42it/s]      6%|▌         | 27/475 [00:07<02:01,  3.69it/s]      6%|▌         | 28/475 [00:08<01:59,  3.74it/s]      6%|▌         | 29/475 [00:08<02:16,  3.27it/s]      6%|▋         | 30/475 [00:08<02:17,  3.25it/s]      7%|▋         | 31/475 [00:09<02:11,  3.37it/s]      7%|▋         | 32/475 [00:09<02:03,  3.60it/s]      7%|▋         | 33/475 [00:09<01:55,  3.82it/s]      7%|▋         | 34/475 [00:09<01:54,  3.86it/s]      7%|▋         | 35/475 [00:09<01:47,  4.09it/s]      8%|▊         | 36/475 [00:10<01:39,  4.42it/s]      8%|▊         | 37/475 [00:10<01:39,  4.40it/s]      8%|▊         | 38/475 [00:10<02:01,  3.58it/s]      8%|▊         | 39/475 [00:11<02:33,  2.83it/s]      8%|▊         | 40/475 [00:11<02:24,  3.01it/s]      9%|▊         | 41/475 [00:11<02:00,  3.59it/s]      9%|▉         | 42/475 [00:12<02:09,  3.36it/s]      9%|▉         | 43/475 [00:12<01:59,  3.62it/s]      9%|▉         | 44/475 [00:12<02:15,  3.19it/s]      9%|▉         | 45/475 [00:13<02:36,  2.75it/s]     10%|▉         | 46/475 [00:13<02:20,  3.05it/s]     10%|▉         | 47/475 [00:13<02:29,  2.87it/s]     10%|█         | 48/475 [00:14<02:15,  3.15it/s]     10%|█         | 49/475 [00:14<02:12,  3.22it/s]     11%|█         | 50/475 [00:14<02:17,  3.08it/s]     11%|█         | 51/475 [00:14<02:02,  3.46it/s]     11%|█         | 52/475 [00:15<01:57,  3.61it/s]     11%|█         | 53/475 [00:15<02:01,  3.46it/s]     11%|█▏        | 54/475 [00:15<01:47,  3.93it/s]     12%|█▏        | 55/475 [00:15<01:28,  4.72it/s]     12%|█▏        | 56/475 [00:15<01:33,  4.50it/s]     12%|█▏        | 57/475 [00:16<01:35,  4.39it/s]     12%|█▏        | 58/475 [00:16<02:23,  2.90it/s]     13%|█▎        | 60/475 [00:17<01:53,  3.67it/s]     13%|█▎        | 61/475 [00:17<02:02,  3.39it/s]     13%|█▎        | 62/475 [00:17<02:14,  3.08it/s]     13%|█▎        | 63/475 [00:18<02:00,  3.41it/s]     13%|█▎        | 64/475 [00:18<02:03,  3.34it/s]     14%|█▎        | 65/475 [00:18<02:04,  3.29it/s]     14%|█▍        | 66/475 [00:19<01:58,  3.46it/s]     14%|█▍        | 67/475 [00:19<01:55,  3.53it/s]     14%|█▍        | 68/475 [00:19<02:20,  2.89it/s]     15%|█▍        | 69/475 [00:20<02:10,  3.12it/s]     15%|█▍        | 70/475 [00:20<01:58,  3.40it/s]     15%|█▍        | 71/475 [00:20<01:48,  3.73it/s]     15%|█▌        | 72/475 [00:20<01:35,  4.22it/s]     15%|█▌        | 73/475 [00:20<01:21,  4.92it/s]     16%|█▌        | 74/475 [00:20<01:10,  5.66it/s]     16%|█▌        | 75/475 [00:21<01:13,  5.46it/s]     16%|█▌        | 76/475 [00:21<01:18,  5.08it/s]     16%|█▌        | 77/475 [00:21<01:09,  5.73it/s]     16%|█▋        | 78/475 [00:21<01:00,  6.56it/s]     17%|█▋        | 79/475 [00:21<01:05,  6.01it/s]     17%|█▋        | 80/475 [00:22<01:10,  5.62it/s]     17%|█▋        | 81/475 [00:22<01:21,  4.84it/s]     17%|█▋        | 82/475 [00:22<01:32,  4.23it/s]     17%|█▋        | 83/475 [00:22<01:38,  3.96it/s]     18%|█▊        | 84/475 [00:23<01:35,  4.11it/s]     18%|█▊        | 85/475 [00:23<01:34,  4.11it/s]     18%|█▊        | 86/475 [00:23<01:37,  3.99it/s]     18%|█▊        | 87/475 [00:23<01:34,  4.11it/s]     19%|█▊        | 88/475 [00:24<01:31,  4.24it/s]     19%|█▊        | 89/475 [00:24<01:18,  4.93it/s]     19%|█▉        | 90/475 [00:24<01:08,  5.58it/s]     19%|█▉        | 91/475 [00:24<01:02,  6.14it/s]     19%|█▉        | 92/475 [00:24<00:57,  6.61it/s]     20%|█▉        | 93/475 [00:24<00:52,  7.26it/s]     20%|█▉        | 94/475 [00:24<00:57,  6.66it/s]     20%|██        | 95/475 [00:25<01:07,  5.59it/s]     20%|██        | 96/475 [00:25<01:03,  6.00it/s]     20%|██        | 97/475 [00:25<01:02,  6.08it/s]     21%|██        | 98/475 [00:25<01:04,  5.88it/s]     21%|██        | 99/475 [00:25<01:12,  5.16it/s]     21%|██        | 100/475 [00:26<01:21,  4.60it/s]     21%|██▏       | 101/475 [00:26<01:22,  4.52it/s]     21%|██▏       | 102/475 [00:26<01:25,  4.35it/s]     22%|██▏       | 103/475 [00:26<01:26,  4.28it/s]     22%|██▏       | 104/475 [00:27<01:42,  3.64it/s]     22%|██▏       | 105/475 [00:27<01:42,  3.62it/s]     22%|██▏       | 106/475 [00:27<01:26,  4.28it/s]     23%|██▎       | 107/475 [00:27<01:18,  4.68it/s]     23%|██▎       | 108/475 [00:27<01:07,  5.47it/s]     23%|██▎       | 109/475 [00:27<00:59,  6.17it/s]     23%|██▎       | 110/475 [00:28<00:52,  6.95it/s]     23%|██▎       | 111/475 [00:28<00:49,  7.30it/s]     24%|██▎       | 112/475 [00:28<00:54,  6.65it/s]     24%|██▍       | 113/475 [00:28<01:04,  5.65it/s]     24%|██▍       | 114/475 [00:28<01:11,  5.07it/s]     24%|██▍       | 115/475 [00:29<01:17,  4.64it/s]     24%|██▍       | 116/475 [00:29<01:14,  4.79it/s]     25%|██▍       | 117/475 [00:29<01:10,  5.11it/s]     25%|██▍       | 118/475 [00:29<01:14,  4.78it/s]     25%|██▌       | 119/475 [00:29<01:19,  4.50it/s]     25%|██▌       | 120/475 [00:30<01:50,  3.20it/s]     25%|██▌       | 121/475 [00:30<01:42,  3.44it/s]     26%|██▌       | 122/475 [00:30<01:28,  3.98it/s]     26%|██▌       | 123/475 [00:31<01:27,  4.01it/s]     26%|██▌       | 124/475 [00:31<01:17,  4.51it/s]     26%|██▋       | 125/475 [00:31<01:10,  4.94it/s]     27%|██▋       | 126/475 [00:31<01:01,  5.65it/s]     27%|██▋       | 127/475 [00:31<00:54,  6.36it/s]     27%|██▋       | 128/475 [00:31<00:50,  6.91it/s]     27%|██▋       | 129/475 [00:31<00:47,  7.22it/s]     27%|██▋       | 130/475 [00:32<00:45,  7.64it/s]     28%|██▊       | 131/475 [00:32<00:52,  6.51it/s]     28%|██▊       | 132/475 [00:32<00:59,  5.74it/s]     28%|██▊       | 133/475 [00:32<01:21,  4.17it/s]     28%|██▊       | 134/475 [00:33<01:12,  4.72it/s]     28%|██▊       | 135/475 [00:33<01:11,  4.73it/s]     29%|██▊       | 136/475 [00:33<01:10,  4.82it/s]     29%|██▉       | 137/475 [00:33<01:08,  4.93it/s]     29%|██▉       | 138/475 [00:33<01:08,  4.89it/s]     29%|██▉       | 139/475 [00:34<01:13,  4.59it/s]     29%|██▉       | 140/475 [00:34<01:14,  4.51it/s]     30%|██▉       | 141/475 [00:34<01:13,  4.56it/s]     30%|██▉       | 142/475 [00:34<01:06,  4.98it/s]     30%|███       | 143/475 [00:34<00:58,  5.63it/s]     31%|███       | 145/475 [00:35<00:47,  7.01it/s]     31%|███       | 146/475 [00:35<00:45,  7.30it/s]     31%|███       | 147/475 [00:35<00:42,  7.66it/s]     31%|███       | 148/475 [00:35<00:42,  7.74it/s]     31%|███▏      | 149/475 [00:35<00:40,  8.02it/s]     32%|███▏      | 150/475 [00:35<00:45,  7.14it/s]     32%|███▏      | 151/475 [00:35<00:52,  6.13it/s]     32%|███▏      | 152/475 [00:36<00:59,  5.40it/s]     32%|███▏      | 153/475 [00:36<00:55,  5.77it/s]     32%|███▏      | 154/475 [00:36<00:49,  6.48it/s]     33%|███▎      | 155/475 [00:36<00:44,  7.15it/s]     33%|███▎      | 156/475 [00:36<00:44,  7.12it/s]     33%|███▎      | 157/475 [00:36<00:45,  6.94it/s]     33%|███▎      | 158/475 [00:36<00:52,  6.09it/s]     33%|███▎      | 159/475 [00:37<01:09,  4.57it/s]     34%|███▎      | 160/475 [00:37<01:11,  4.41it/s]     34%|███▍      | 161/475 [00:37<01:00,  5.15it/s]     34%|███▍      | 162/475 [00:38<01:12,  4.29it/s]     34%|███▍      | 163/475 [00:38<01:12,  4.30it/s]     35%|███▍      | 164/475 [00:38<01:04,  4.82it/s]     35%|███▍      | 165/475 [00:38<00:56,  5.49it/s]     35%|███▍      | 166/475 [00:38<00:50,  6.11it/s]     35%|███▌      | 167/475 [00:38<00:45,  6.84it/s]     35%|███▌      | 168/475 [00:38<00:45,  6.70it/s]     36%|███▌      | 169/475 [00:39<00:55,  5.55it/s]     36%|███▌      | 170/475 [00:39<00:55,  5.46it/s]     36%|███▌      | 171/475 [00:39<01:08,  4.45it/s]     36%|███▌      | 172/475 [00:39<01:01,  4.93it/s]     36%|███▋      | 173/475 [00:39<00:59,  5.10it/s]     37%|███▋      | 174/475 [00:40<00:59,  5.06it/s]     37%|███▋      | 175/475 [00:40<01:00,  4.98it/s]     37%|███▋      | 176/475 [00:40<00:57,  5.16it/s]     37%|███▋      | 177/475 [00:40<01:08,  4.36it/s]     37%|███▋      | 178/475 [00:41<01:08,  4.35it/s]     38%|███▊      | 179/475 [00:41<01:08,  4.34it/s]     38%|███▊      | 180/475 [00:41<00:57,  5.11it/s]     38%|███▊      | 181/475 [00:41<00:53,  5.45it/s]     38%|███▊      | 182/475 [00:41<00:50,  5.85it/s]     39%|███▊      | 183/475 [00:41<00:49,  5.87it/s]     39%|███▊      | 184/475 [00:42<00:44,  6.55it/s]     39%|███▉      | 185/475 [00:42<00:40,  7.14it/s]     39%|███▉      | 186/475 [00:42<00:37,  7.65it/s]     39%|███▉      | 187/475 [00:42<00:39,  7.36it/s]     40%|███▉      | 188/475 [00:42<00:46,  6.14it/s]     40%|███▉      | 189/475 [00:43<01:10,  4.04it/s]     40%|████      | 190/475 [00:43<01:08,  4.16it/s]     40%|████      | 191/475 [00:43<01:07,  4.23it/s]     40%|████      | 192/475 [00:43<01:03,  4.42it/s]     41%|████      | 193/475 [00:43<01:02,  4.53it/s]     41%|████      | 194/475 [00:44<01:03,  4.42it/s]     41%|████      | 195/475 [00:44<01:04,  4.35it/s]     41%|████▏     | 196/475 [00:44<01:06,  4.21it/s]     41%|████▏     | 197/475 [00:44<01:06,  4.20it/s]     42%|████▏     | 198/475 [00:45<00:59,  4.62it/s]     42%|████▏     | 199/475 [00:45<01:05,  4.20it/s]     42%|████▏     | 200/475 [00:45<01:04,  4.28it/s]     42%|████▏     | 201/475 [00:45<00:56,  4.86it/s]     43%|████▎     | 202/475 [00:45<00:49,  5.55it/s]     43%|████▎     | 203/475 [00:45<00:44,  6.11it/s]     43%|████▎     | 204/475 [00:46<00:40,  6.63it/s]     43%|████▎     | 205/475 [00:46<00:37,  7.17it/s]     43%|████▎     | 206/475 [00:46<00:34,  7.79it/s]     44%|████▎     | 207/475 [00:46<01:02,  4.28it/s]     44%|████▍     | 208/475 [00:46<00:58,  4.56it/s]     44%|████▍     | 209/475 [00:47<01:04,  4.13it/s]     44%|████▍     | 210/475 [00:47<00:56,  4.71it/s]     44%|████▍     | 211/475 [00:47<00:54,  4.84it/s]     45%|████▍     | 212/475 [00:47<00:56,  4.68it/s]     45%|████▍     | 213/475 [00:48<00:58,  4.47it/s]     45%|████▌     | 214/475 [00:48<00:57,  4.55it/s]     45%|████▌     | 215/475 [00:48<01:03,  4.12it/s]     45%|████▌     | 216/475 [00:48<01:05,  3.96it/s]     46%|████▌     | 217/475 [00:49<01:02,  4.14it/s]     46%|████▌     | 218/475 [00:49<01:06,  3.84it/s]     46%|████▌     | 219/475 [00:49<01:03,  4.02it/s]     46%|████▋     | 220/475 [00:49<01:02,  4.06it/s]     47%|████▋     | 221/475 [00:50<00:56,  4.49it/s]     47%|████▋     | 222/475 [00:50<00:48,  5.25it/s]     47%|████▋     | 223/475 [00:50<00:42,  5.95it/s]     47%|████▋     | 224/475 [00:50<00:37,  6.71it/s]     47%|████▋     | 225/475 [00:50<00:34,  7.29it/s]     48%|████▊     | 226/475 [00:50<00:37,  6.70it/s]     48%|████▊     | 227/475 [00:50<00:39,  6.33it/s]     48%|████▊     | 228/475 [00:51<00:52,  4.67it/s]     48%|████▊     | 229/475 [00:51<00:49,  5.01it/s]     48%|████▊     | 230/475 [00:51<00:52,  4.64it/s]     49%|████▊     | 231/475 [00:51<00:53,  4.59it/s]     49%|████▉     | 232/475 [00:52<00:56,  4.28it/s]     49%|████▉     | 233/475 [00:52<01:03,  3.83it/s]     49%|████▉     | 234/475 [00:53<01:44,  2.30it/s]     49%|████▉     | 235/475 [00:53<01:33,  2.57it/s]     50%|████▉     | 236/475 [00:53<01:22,  2.89it/s]     50%|████▉     | 237/475 [00:54<01:19,  3.01it/s]     50%|█████     | 238/475 [00:54<01:11,  3.32it/s]     50%|█████     | 239/475 [00:54<01:07,  3.49it/s]     51%|█████     | 240/475 [00:54<01:02,  3.74it/s]     51%|█████     | 241/475 [00:54<00:56,  4.12it/s]     51%|█████     | 242/475 [00:55<00:48,  4.85it/s]     51%|█████     | 243/475 [00:55<00:41,  5.54it/s]     51%|█████▏    | 244/475 [00:55<00:37,  6.14it/s]     52%|█████▏    | 245/475 [00:55<00:33,  6.77it/s]     52%|█████▏    | 246/475 [00:55<00:39,  5.76it/s]     52%|█████▏    | 247/475 [00:55<00:45,  4.99it/s]     52%|█████▏    | 248/475 [00:56<00:40,  5.56it/s]     52%|█████▏    | 249/475 [00:56<00:36,  6.20it/s]     53%|█████▎    | 250/475 [00:56<00:41,  5.44it/s]     53%|█████▎    | 251/475 [00:56<00:50,  4.42it/s]     53%|█████▎    | 252/475 [00:57<00:54,  4.12it/s]     53%|█████▎    | 253/475 [00:57<01:01,  3.63it/s]     53%|█████▎    | 254/475 [00:57<01:18,  2.82it/s]     54%|█████▎    | 255/475 [00:58<01:09,  3.16it/s]     54%|█████▍    | 256/475 [00:58<01:02,  3.49it/s]     54%|█████▍    | 257/475 [00:58<00:58,  3.70it/s]     54%|█████▍    | 258/475 [00:58<01:02,  3.47it/s]     55%|█████▍    | 259/475 [00:59<01:02,  3.46it/s]     55%|█████▍    | 260/475 [00:59<01:01,  3.47it/s]     55%|█████▍    | 261/475 [00:59<00:59,  3.62it/s]     55%|█████▌    | 262/475 [01:00<00:58,  3.67it/s]     55%|█████▌    | 263/475 [01:00<00:47,  4.48it/s]     56%|█████▌    | 264/475 [01:00<00:40,  5.19it/s]     56%|█████▌    | 265/475 [01:00<00:37,  5.54it/s]     56%|█████▌    | 266/475 [01:00<00:38,  5.48it/s]     56%|█████▌    | 267/475 [01:00<00:35,  5.79it/s]     56%|█████▋    | 268/475 [01:00<00:31,  6.60it/s]     57%|█████▋    | 269/475 [01:01<00:35,  5.82it/s]     57%|█████▋    | 270/475 [01:01<00:49,  4.15it/s]     57%|█████▋    | 271/475 [01:01<01:01,  3.34it/s]     57%|█████▋    | 272/475 [01:02<01:03,  3.20it/s]     57%|█████▋    | 273/475 [01:02<01:11,  2.84it/s]     58%|█████▊    | 274/475 [01:03<01:14,  2.69it/s]     58%|█████▊    | 275/475 [01:03<01:06,  3.03it/s]     58%|█████▊    | 276/475 [01:03<01:01,  3.26it/s]     58%|█████▊    | 277/475 [01:03<01:00,  3.26it/s]     59%|█████▊    | 278/475 [01:04<01:00,  3.28it/s]     59%|█████▊    | 279/475 [01:04<00:59,  3.27it/s]     59%|█████▉    | 280/475 [01:04<00:57,  3.40it/s]     59%|█████▉    | 281/475 [01:05<00:55,  3.50it/s]     59%|█████▉    | 282/475 [01:05<00:57,  3.36it/s]     60%|█████▉    | 283/475 [01:05<00:47,  4.04it/s]     60%|█████▉    | 284/475 [01:05<00:42,  4.49it/s]     60%|██████    | 285/475 [01:05<00:42,  4.43it/s]     60%|██████    | 286/475 [01:06<00:48,  3.93it/s]     60%|██████    | 287/475 [01:06<00:41,  4.58it/s]     61%|██████    | 288/475 [01:06<00:37,  4.99it/s]     61%|██████    | 289/475 [01:06<00:41,  4.48it/s]     61%|██████    | 290/475 [01:07<00:45,  4.05it/s]     61%|██████▏   | 291/475 [01:07<00:49,  3.74it/s]     61%|██████▏   | 292/475 [01:07<00:53,  3.43it/s]     62%|██████▏   | 293/475 [01:08<01:07,  2.71it/s]     62%|██████▏   | 294/475 [01:08<01:03,  2.84it/s]     62%|██████▏   | 295/475 [01:09<01:10,  2.57it/s]     62%|██████▏   | 296/475 [01:09<01:00,  2.98it/s]     63%|██████▎   | 297/475 [01:09<00:59,  2.98it/s]     63%|██████▎   | 298/475 [01:09<00:54,  3.24it/s]     63%|██████▎   | 299/475 [01:10<00:50,  3.46it/s]     63%|██████▎   | 300/475 [01:10<00:47,  3.67it/s]     63%|██████▎   | 301/475 [01:10<00:45,  3.79it/s]     64%|██████▎   | 302/475 [01:10<00:41,  4.16it/s]     64%|██████▍   | 303/475 [01:11<00:41,  4.19it/s]     64%|██████▍   | 304/475 [01:11<00:42,  4.07it/s]     64%|██████▍   | 305/475 [01:11<00:37,  4.57it/s]     64%|██████▍   | 306/475 [01:11<00:32,  5.16it/s]     65%|██████▍   | 307/475 [01:11<00:28,  5.88it/s]     65%|██████▍   | 308/475 [01:11<00:34,  4.83it/s]     65%|██████▌   | 309/475 [01:12<01:01,  2.72it/s]     65%|██████▌   | 310/475 [01:12<00:55,  2.99it/s]     65%|██████▌   | 311/475 [01:13<01:01,  2.66it/s]     66%|██████▌   | 312/475 [01:13<01:07,  2.40it/s]     66%|██████▌   | 313/475 [01:14<00:57,  2.82it/s]     66%|██████▌   | 314/475 [01:14<00:49,  3.27it/s]     66%|██████▋   | 315/475 [01:14<00:49,  3.22it/s]     67%|██████▋   | 316/475 [01:14<00:49,  3.23it/s]     67%|██████▋   | 317/475 [01:15<00:44,  3.52it/s]     67%|██████▋   | 318/475 [01:15<00:41,  3.81it/s]     67%|██████▋   | 319/475 [01:15<00:39,  3.90it/s]     67%|██████▋   | 320/475 [01:15<00:42,  3.63it/s]     68%|██████▊   | 321/475 [01:16<00:46,  3.32it/s]     68%|██████▊   | 322/475 [01:16<00:45,  3.34it/s]     68%|██████▊   | 323/475 [01:16<00:46,  3.30it/s]     68%|██████▊   | 324/475 [01:17<00:41,  3.65it/s]     68%|██████▊   | 325/475 [01:17<00:35,  4.24it/s]     69%|██████▊   | 326/475 [01:17<00:31,  4.80it/s]     69%|██████▉   | 327/475 [01:17<00:32,  4.61it/s]     69%|██████▉   | 328/475 [01:17<00:32,  4.58it/s]     69%|██████▉   | 329/475 [01:18<00:40,  3.59it/s]     69%|██████▉   | 330/475 [01:18<00:44,  3.28it/s]     70%|██████▉   | 331/475 [01:18<00:37,  3.86it/s]     70%|██████▉   | 332/475 [01:19<00:40,  3.56it/s]     70%|███████   | 333/475 [01:19<00:40,  3.54it/s]     70%|███████   | 334/475 [01:19<00:38,  3.68it/s]     71%|███████   | 335/475 [01:19<00:35,  3.94it/s]     71%|███████   | 336/475 [01:20<00:33,  4.19it/s]     71%|███████   | 337/475 [01:20<00:35,  3.91it/s]     71%|███████   | 338/475 [01:20<00:34,  3.99it/s]     71%|███████▏  | 339/475 [01:20<00:35,  3.84it/s]     72%|███████▏  | 340/475 [01:21<00:37,  3.65it/s]     72%|███████▏  | 341/475 [01:21<00:36,  3.69it/s]     72%|███████▏  | 342/475 [01:21<00:35,  3.72it/s]     72%|███████▏  | 343/475 [01:22<00:33,  3.94it/s]     72%|███████▏  | 344/475 [01:22<00:31,  4.17it/s]     73%|███████▎  | 345/475 [01:22<00:27,  4.65it/s]     73%|███████▎  | 346/475 [01:22<00:28,  4.47it/s]     73%|███████▎  | 347/475 [01:22<00:30,  4.25it/s]     73%|███████▎  | 348/475 [01:23<00:30,  4.13it/s]     73%|███████▎  | 349/475 [01:23<00:30,  4.07it/s]     74%|███████▎  | 350/475 [01:23<00:31,  4.00it/s]     74%|███████▍  | 351/475 [01:23<00:32,  3.80it/s]     74%|███████▍  | 352/475 [01:24<00:30,  3.99it/s]     74%|███████▍  | 353/475 [01:24<00:30,  4.02it/s]     75%|███████▍  | 354/475 [01:24<00:31,  3.87it/s]     75%|███████▍  | 355/475 [01:24<00:30,  3.90it/s]     75%|███████▍  | 356/475 [01:25<00:29,  4.08it/s]     75%|███████▌  | 357/475 [01:25<00:33,  3.50it/s]     75%|███████▌  | 358/475 [01:25<00:32,  3.58it/s]     76%|███████▌  | 359/475 [01:26<00:31,  3.73it/s]     76%|███████▌  | 360/475 [01:26<00:52,  2.21it/s]     76%|███████▌  | 361/475 [01:27<00:44,  2.55it/s]     76%|███████▌  | 362/475 [01:27<00:38,  2.90it/s]     76%|███████▋  | 363/475 [01:27<00:34,  3.29it/s]     77%|███████▋  | 364/475 [01:27<00:31,  3.54it/s]     77%|███████▋  | 365/475 [01:28<00:30,  3.63it/s]     77%|███████▋  | 366/475 [01:28<00:27,  4.02it/s]     77%|███████▋  | 367/475 [01:28<00:27,  3.95it/s]     77%|███████▋  | 368/475 [01:29<00:33,  3.22it/s]     78%|███████▊  | 369/475 [01:29<00:30,  3.53it/s]     78%|███████▊  | 370/475 [01:29<00:28,  3.72it/s]     78%|███████▊  | 371/475 [01:29<00:28,  3.68it/s]     78%|███████▊  | 372/475 [01:30<00:29,  3.53it/s]     79%|███████▊  | 373/475 [01:30<00:27,  3.78it/s]     79%|███████▊  | 374/475 [01:30<00:25,  3.94it/s]     79%|███████▉  | 375/475 [01:30<00:25,  3.94it/s]     79%|███████▉  | 376/475 [01:31<00:25,  3.81it/s]     79%|███████▉  | 377/475 [01:31<00:25,  3.80it/s]     80%|███████▉  | 378/475 [01:31<00:25,  3.74it/s]     80%|███████▉  | 379/475 [01:32<00:31,  3.08it/s]     80%|████████  | 380/475 [01:32<00:27,  3.45it/s]     80%|████████  | 381/475 [01:32<00:24,  3.76it/s]     80%|████████  | 382/475 [01:32<00:23,  3.88it/s]     81%|████████  | 383/475 [01:32<00:24,  3.81it/s]     81%|████████  | 384/475 [01:33<00:22,  3.98it/s]     81%|████████  | 385/475 [01:33<00:19,  4.57it/s]     81%|████████▏ | 386/475 [01:33<00:19,  4.67it/s]     81%|████████▏ | 387/475 [01:33<00:19,  4.61it/s]     82%|████████▏ | 388/475 [01:34<00:20,  4.34it/s]     82%|████████▏ | 389/475 [01:34<00:20,  4.22it/s]     82%|████████▏ | 390/475 [01:34<00:19,  4.27it/s]     82%|████████▏ | 391/475 [01:34<00:19,  4.21it/s]     83%|████████▎ | 392/475 [01:34<00:19,  4.31it/s]     83%|████████▎ | 393/475 [01:35<00:22,  3.62it/s]     83%|████████▎ | 394/475 [01:35<00:21,  3.85it/s]     83%|████████▎ | 395/475 [01:36<00:27,  2.86it/s]     83%|████████▎ | 396/475 [01:36<00:25,  3.05it/s]     84%|████████▎ | 397/475 [01:36<00:25,  3.04it/s]     84%|████████▍ | 398/475 [01:37<00:24,  3.19it/s]     84%|████████▍ | 399/475 [01:37<00:22,  3.36it/s]     84%|████████▍ | 400/475 [01:37<00:20,  3.59it/s]     84%|████████▍ | 401/475 [01:37<00:21,  3.45it/s]     85%|████████▍ | 402/475 [01:38<00:20,  3.54it/s]     85%|████████▍ | 403/475 [01:38<00:20,  3.59it/s]     85%|████████▌ | 404/475 [01:38<00:18,  3.90it/s]     85%|████████▌ | 405/475 [01:38<00:16,  4.13it/s]     85%|████████▌ | 406/475 [01:39<00:16,  4.18it/s]     86%|████████▌ | 407/475 [01:39<00:16,  4.15it/s]     86%|████████▌ | 408/475 [01:39<00:16,  4.17it/s]     86%|████████▌ | 409/475 [01:39<00:15,  4.24it/s]     86%|████████▋ | 410/475 [01:39<00:15,  4.17it/s]     87%|████████▋ | 411/475 [01:40<00:14,  4.39it/s]     87%|████████▋ | 412/475 [01:40<00:14,  4.31it/s]     87%|████████▋ | 413/475 [01:40<00:13,  4.45it/s]     87%|████████▋ | 414/475 [01:40<00:13,  4.43it/s]     87%|████████▋ | 415/475 [01:41<00:15,  3.98it/s]     88%|████████▊ | 416/475 [01:41<00:15,  3.71it/s]     88%|████████▊ | 417/475 [01:41<00:16,  3.45it/s]     88%|████████▊ | 418/475 [01:42<00:17,  3.31it/s]     88%|████████▊ | 419/475 [01:42<00:15,  3.61it/s]     88%|████████▊ | 420/475 [01:42<00:14,  3.73it/s]     89%|████████▊ | 421/475 [01:42<00:13,  3.86it/s]     89%|████████▉ | 422/475 [01:43<00:16,  3.27it/s]     89%|████████▉ | 423/475 [01:43<00:15,  3.46it/s]     89%|████████▉ | 424/475 [01:43<00:13,  3.78it/s]     89%|████████▉ | 425/475 [01:43<00:12,  4.14it/s]     90%|████████▉ | 426/475 [01:44<00:11,  4.21it/s]     90%|████████▉ | 427/475 [01:44<00:11,  4.22it/s]     90%|█████████ | 428/475 [01:44<00:10,  4.34it/s]     90%|█████████ | 429/475 [01:44<00:10,  4.28it/s]     91%|█████████ | 430/475 [01:45<00:11,  3.86it/s]     91%|█████████ | 431/475 [01:45<00:10,  4.10it/s]     91%|█████████ | 432/475 [01:45<00:10,  4.00it/s]     91%|█████████ | 433/475 [01:46<00:15,  2.79it/s]     91%|█████████▏| 434/475 [01:46<00:14,  2.92it/s]     92%|█████████▏| 435/475 [01:46<00:13,  3.06it/s]     92%|█████████▏| 436/475 [01:47<00:12,  3.06it/s]     92%|█████████▏| 437/475 [01:47<00:11,  3.18it/s]     92%|█████████▏| 438/475 [01:47<00:10,  3.57it/s]     92%|█████████▏| 439/475 [01:47<00:09,  3.64it/s]     93%|█████████▎| 440/475 [01:48<00:08,  3.91it/s]     93%|█████████▎| 441/475 [01:48<00:08,  4.06it/s]     93%|█████████▎| 442/475 [01:48<00:07,  4.17it/s]     93%|█████████▎| 443/475 [01:48<00:07,  4.23it/s]     93%|█████████▎| 444/475 [01:49<00:07,  4.14it/s]     94%|█████████▎| 445/475 [01:49<00:06,  4.43it/s]     94%|█████████▍| 446/475 [01:49<00:06,  4.55it/s]     94%|█████████▍| 447/475 [01:49<00:06,  4.49it/s]     94%|█████████▍| 448/475 [01:49<00:06,  4.23it/s]     95%|█████████▍| 449/475 [01:50<00:06,  3.98it/s]     95%|█████████▍| 450/475 [01:50<00:06,  4.03it/s]     95%|█████████▍| 451/475 [01:50<00:06,  3.83it/s]     95%|█████████▌| 452/475 [01:50<00:05,  3.97it/s]     95%|█████████▌| 453/475 [01:51<00:05,  3.79it/s]     96%|█████████▌| 454/475 [01:51<00:05,  3.56it/s]     96%|█████████▌| 455/475 [01:51<00:05,  3.57it/s]     96%|█████████▌| 456/475 [01:52<00:05,  3.67it/s]     96%|█████████▌| 457/475 [01:52<00:04,  4.01it/s]     96%|█████████▋| 458/475 [01:52<00:04,  4.12it/s]     97%|█████████▋| 459/475 [01:52<00:03,  4.83it/s]     97%|█████████▋| 460/475 [01:52<00:02,  5.57it/s]     97%|█████████▋| 461/475 [01:52<00:02,  5.41it/s]     97%|█████████▋| 462/475 [01:53<00:02,  5.20it/s]     97%|█████████▋| 463/475 [01:53<00:02,  4.96it/s]     98%|█████████▊| 464/475 [01:53<00:02,  4.68it/s]     98%|█████████▊| 465/475 [01:53<00:02,  4.48it/s]     98%|█████████▊| 466/475 [01:54<00:02,  4.44it/s]     98%|█████████▊| 467/475 [01:54<00:01,  4.48it/s]     99%|█████████▊| 468/475 [01:54<00:01,  4.60it/s]     99%|█████████▊| 469/475 [01:54<00:01,  4.57it/s]     99%|█████████▉| 470/475 [01:55<00:01,  4.36it/s]     99%|█████████▉| 471/475 [01:55<00:00,  4.44it/s]     99%|█████████▉| 472/475 [01:55<00:00,  4.19it/s]    100%|█████████▉| 473/475 [01:55<00:00,  4.22it/s]    100%|█████████▉| 474/475 [01:56<00:00,  4.13it/s]    100%|██████████| 475/475 [01:56<00:00,  4.05it/s]    100%|██████████| 475/475 [01:56<00:00,  4.09it/s]
      0%|          | 0/475 [00:00<?, ?it/s]      0%|          | 1/475 [00:06<51:58,  6.58s/it]      0%|          | 2/475 [00:21<1:31:05, 11.56s/it]      1%|          | 3/475 [00:27<1:09:10,  8.79s/it]      1%|          | 4/475 [00:35<1:07:03,  8.54s/it]      1%|          | 5/475 [00:39<54:37,  6.97s/it]        1%|▏         | 6/475 [00:47<56:50,  7.27s/it]      1%|▏         | 7/475 [00:57<1:04:59,  8.33s/it]      2%|▏         | 8/475 [01:03<58:17,  7.49s/it]        2%|▏         | 9/475 [01:09<55:10,  7.10s/it]      2%|▏         | 10/475 [01:14<48:47,  6.30s/it]      2%|▏         | 11/475 [01:19<45:27,  5.88s/it]      3%|▎         | 12/475 [01:27<51:32,  6.68s/it]      3%|▎         | 13/475 [01:33<49:32,  6.43s/it]      3%|▎         | 14/475 [01:37<42:53,  5.58s/it]      3%|▎         | 15/475 [01:42<42:41,  5.57s/it]      3%|▎         | 16/475 [01:48<43:50,  5.73s/it]      4%|▎         | 17/475 [01:51<35:51,  4.70s/it]      4%|▍         | 18/475 [01:57<39:27,  5.18s/it]      4%|▍         | 19/475 [01:59<32:16,  4.25s/it]      4%|▍         | 20/475 [02:10<48:31,  6.40s/it]      4%|▍         | 21/475 [02:12<37:53,  5.01s/it]      5%|▍         | 22/475 [02:22<47:56,  6.35s/it]      5%|▍         | 23/475 [02:31<53:42,  7.13s/it]      5%|▌         | 24/475 [02:36<49:06,  6.53s/it]      5%|▌         | 25/475 [02:41<45:17,  6.04s/it]      5%|▌         | 26/475 [02:46<43:04,  5.76s/it]      6%|▌         | 27/475 [02:52<44:37,  5.98s/it]      6%|▌         | 28/475 [02:59<47:20,  6.36s/it]      6%|▌         | 29/475 [03:05<44:35,  6.00s/it]      6%|▋         | 30/475 [03:11<45:18,  6.11s/it]      7%|▋         | 31/475 [03:14<37:51,  5.12s/it]      7%|▋         | 32/475 [03:25<50:28,  6.84s/it]      7%|▋         | 33/475 [03:31<48:44,  6.62s/it]      7%|▋         | 34/475 [03:35<43:33,  5.93s/it]      7%|▋         | 35/475 [03:50<1:02:35,  8.54s/it]      8%|▊         | 36/475 [03:53<49:57,  6.83s/it]        8%|▊         | 37/475 [04:00<51:05,  7.00s/it]      8%|▊         | 38/475 [04:06<48:03,  6.60s/it]      8%|▊         | 39/475 [04:09<41:51,  5.76s/it]      8%|▊         | 40/475 [04:18<48:52,  6.74s/it]      9%|▊         | 41/475 [04:25<48:08,  6.65s/it]      9%|▉         | 42/475 [04:33<50:58,  7.06s/it]      9%|▉         | 43/475 [04:37<44:59,  6.25s/it]      9%|▉         | 44/475 [04:40<37:15,  5.19s/it]      9%|▉         | 45/475 [04:56<1:01:28,  8.58s/it]     10%|▉         | 46/475 [05:08<1:07:49,  9.49s/it]     10%|▉         | 47/475 [05:12<56:41,  7.95s/it]       10%|█         | 48/475 [05:29<1:14:13, 10.43s/it]     10%|█         | 49/475 [05:44<1:23:33, 11.77s/it]     11%|█         | 50/475 [05:50<1:11:04, 10.03s/it]     11%|█         | 51/475 [05:56<1:03:18,  8.96s/it]     11%|█         | 52/475 [06:01<53:49,  7.64s/it]       11%|█         | 53/475 [06:18<1:13:57, 10.52s/it]     11%|█▏        | 54/475 [06:23<1:03:12,  9.01s/it]     12%|█▏        | 55/475 [06:25<46:49,  6.69s/it]       12%|█▏        | 56/475 [06:29<43:00,  6.16s/it]     12%|█▏        | 57/475 [06:41<54:21,  7.80s/it]     12%|█▏        | 58/475 [06:45<45:38,  6.57s/it]     12%|█▏        | 59/475 [06:51<45:19,  6.54s/it]     13%|█▎        | 60/475 [06:55<40:26,  5.85s/it]     13%|█▎        | 61/475 [07:01<39:22,  5.71s/it]     13%|█▎        | 62/475 [07:12<51:10,  7.44s/it]     13%|█▎        | 63/475 [07:16<42:57,  6.26s/it]     13%|█▎        | 64/475 [07:20<39:06,  5.71s/it]     14%|█▎        | 65/475 [07:27<40:15,  5.89s/it]     14%|█▍        | 66/475 [07:35<45:19,  6.65s/it]     14%|█▍        | 67/475 [07:38<38:46,  5.70s/it]     14%|█▍        | 68/475 [07:49<47:43,  7.04s/it]     15%|█▍        | 69/475 [07:52<41:09,  6.08s/it]     15%|█▍        | 70/475 [07:56<36:24,  5.39s/it]     15%|█▍        | 71/475 [08:08<49:32,  7.36s/it]     15%|█▌        | 72/475 [08:19<55:47,  8.31s/it]     15%|█▌        | 73/475 [08:20<40:45,  6.08s/it]     16%|█▌        | 74/475 [08:21<30:41,  4.59s/it]     16%|█▌        | 75/475 [08:24<28:48,  4.32s/it]     16%|█▌        | 76/475 [08:35<41:01,  6.17s/it]     16%|█▌        | 77/475 [08:36<30:22,  4.58s/it]     16%|█▋        | 78/475 [08:53<55:41,  8.42s/it]     17%|█▋        | 79/475 [08:59<51:16,  7.77s/it]     17%|█▋        | 80/475 [09:05<46:36,  7.08s/it]     17%|█▋        | 81/475 [09:11<43:57,  6.69s/it]     17%|█▋        | 82/475 [09:23<54:39,  8.35s/it]     17%|█▋        | 83/475 [09:27<45:34,  6.98s/it]     18%|█▊        | 84/475 [09:32<42:58,  6.59s/it]     18%|█▊        | 85/475 [09:37<39:45,  6.12s/it]     18%|█▊        | 86/475 [09:46<44:59,  6.94s/it]     18%|█▊        | 87/475 [09:50<37:56,  5.87s/it]     19%|█▊        | 88/475 [09:53<33:16,  5.16s/it]     19%|█▊        | 89/475 [09:55<26:12,  4.07s/it]     19%|█▉        | 90/475 [09:55<19:35,  3.05s/it]     19%|█▉        | 91/475 [09:56<15:22,  2.40s/it]     19%|█▉        | 92/475 [09:57<12:37,  1.98s/it]     20%|█▉        | 93/475 [10:17<46:48,  7.35s/it]     20%|█▉        | 94/475 [10:23<43:15,  6.81s/it]     20%|██        | 95/475 [10:26<37:26,  5.91s/it]     20%|██        | 96/475 [10:38<47:51,  7.58s/it]     20%|██        | 97/475 [10:49<54:36,  8.67s/it]     21%|██        | 98/475 [10:54<47:56,  7.63s/it]     21%|██        | 99/475 [10:59<41:57,  6.70s/it]     21%|██        | 100/475 [11:03<36:26,  5.83s/it]     21%|██▏       | 101/475 [11:15<49:21,  7.92s/it]     21%|██▏       | 102/475 [11:22<47:19,  7.61s/it]     22%|██▏       | 103/475 [11:29<46:04,  7.43s/it]     22%|██▏       | 104/475 [11:37<45:29,  7.36s/it]     22%|██▏       | 105/475 [11:41<40:27,  6.56s/it]     22%|██▏       | 106/475 [11:47<38:44,  6.30s/it]     23%|██▎       | 107/475 [11:50<32:26,  5.29s/it]     23%|██▎       | 108/475 [11:51<24:56,  4.08s/it]     23%|██▎       | 109/475 [11:52<18:30,  3.03s/it]     23%|██▎       | 110/475 [11:53<14:51,  2.44s/it]     23%|██▎       | 111/475 [11:53<11:37,  1.92s/it]     24%|██▎       | 112/475 [11:55<11:22,  1.88s/it]     24%|██▍       | 113/475 [11:57<11:38,  1.93s/it]     24%|██▍       | 114/475 [12:03<17:54,  2.98s/it]     24%|██▍       | 115/475 [12:06<18:07,  3.02s/it]     24%|██▍       | 116/475 [12:17<33:25,  5.59s/it]     25%|██▍       | 117/475 [12:40<1:04:09, 10.75s/it]     25%|██▍       | 118/475 [12:46<55:39,  9.35s/it]       25%|██▌       | 119/475 [13:01<1:05:31, 11.04s/it]     25%|██▌       | 120/475 [13:08<58:22,  9.87s/it]       25%|██▌       | 121/475 [13:16<54:59,  9.32s/it]     26%|██▌       | 122/475 [13:26<54:59,  9.35s/it]     26%|██▌       | 123/475 [13:35<53:55,  9.19s/it]     26%|██▌       | 124/475 [13:39<45:56,  7.85s/it]     26%|██▋       | 125/475 [13:52<54:28,  9.34s/it]     27%|██▋       | 126/475 [13:53<40:05,  6.89s/it]     27%|██▋       | 127/475 [13:54<29:31,  5.09s/it]     27%|██▋       | 128/475 [13:56<23:02,  3.99s/it]     27%|██▋       | 129/475 [13:57<18:16,  3.17s/it]     27%|██▋       | 130/475 [13:58<14:32,  2.53s/it]     28%|██▊       | 131/475 [14:10<30:14,  5.27s/it]     28%|██▊       | 132/475 [14:18<34:51,  6.10s/it]     28%|██▊       | 133/475 [14:39<1:01:33, 10.80s/it]     28%|██▊       | 134/475 [14:56<1:11:14, 12.54s/it]     28%|██▊       | 135/475 [15:01<58:09, 10.26s/it]       29%|██▊       | 136/475 [15:26<1:23:21, 14.75s/it]     29%|██▉       | 137/475 [15:30<1:04:33, 11.46s/it]     29%|██▉       | 138/475 [15:50<1:18:52, 14.04s/it]     29%|██▉       | 139/475 [15:55<1:02:35, 11.18s/it]     29%|██▉       | 140/475 [16:00<52:00,  9.32s/it]       30%|██▉       | 141/475 [16:03<41:40,  7.49s/it]     30%|██▉       | 142/475 [16:06<33:49,  6.09s/it]     30%|███       | 143/475 [16:07<25:18,  4.57s/it]     30%|███       | 144/475 [16:12<26:36,  4.82s/it]     31%|███       | 145/475 [16:13<20:01,  3.64s/it]     31%|███       | 146/475 [16:14<15:05,  2.75s/it]     31%|███       | 147/475 [16:14<11:32,  2.11s/it]     31%|███       | 148/475 [16:15<09:50,  1.81s/it]     31%|███▏      | 149/475 [16:17<10:19,  1.90s/it]     32%|███▏      | 150/475 [16:26<20:46,  3.84s/it]     32%|███▏      | 151/475 [16:34<27:02,  5.01s/it]     32%|███▏      | 152/475 [16:39<27:14,  5.06s/it]     32%|███▏      | 153/475 [16:50<36:43,  6.84s/it]     32%|███▏      | 154/475 [16:55<34:00,  6.36s/it]     33%|███▎      | 155/475 [17:15<56:29, 10.59s/it]     33%|███▎      | 156/475 [17:19<45:16,  8.52s/it]     33%|███▎      | 157/475 [17:26<43:11,  8.15s/it]     33%|███▎      | 158/475 [17:35<43:50,  8.30s/it]     33%|███▎      | 159/475 [17:39<37:27,  7.11s/it]     34%|███▎      | 160/475 [17:43<31:43,  6.04s/it]     34%|███▍      | 161/475 [17:50<33:51,  6.47s/it]     34%|███▍      | 162/475 [17:56<33:09,  6.36s/it]     34%|███▍      | 163/475 [18:00<29:14,  5.62s/it]     35%|███▍      | 164/475 [18:06<29:25,  5.68s/it]     35%|███▍      | 165/475 [18:08<23:27,  4.54s/it]     35%|███▍      | 166/475 [18:09<17:35,  3.41s/it]     35%|███▌      | 167/475 [18:10<14:05,  2.74s/it]     35%|███▌      | 168/475 [18:22<27:57,  5.46s/it]     36%|███▌      | 169/475 [18:32<35:25,  6.95s/it]     36%|███▌      | 170/475 [18:43<41:04,  8.08s/it]     36%|███▌      | 171/475 [18:46<33:42,  6.65s/it]     36%|███▌      | 172/475 [18:56<38:33,  7.63s/it]     36%|███▋      | 173/475 [19:01<34:15,  6.81s/it]     37%|███▋      | 174/475 [19:06<32:00,  6.38s/it]     37%|███▋      | 175/475 [19:10<28:10,  5.64s/it]     37%|███▋      | 176/475 [19:18<31:39,  6.35s/it]     37%|███▋      | 177/475 [19:22<27:17,  5.49s/it]     37%|███▋      | 178/475 [19:28<28:25,  5.74s/it]     38%|███▊      | 179/475 [19:31<23:41,  4.80s/it]     38%|███▊      | 180/475 [19:36<23:38,  4.81s/it]     38%|███▊      | 181/475 [19:46<32:21,  6.60s/it]     38%|███▊      | 182/475 [19:54<33:53,  6.94s/it]     39%|███▊      | 183/475 [19:56<26:31,  5.45s/it]     39%|███▊      | 184/475 [19:57<20:23,  4.20s/it]     39%|███▉      | 185/475 [19:59<15:53,  3.29s/it]     39%|███▉      | 186/475 [20:00<13:18,  2.76s/it]     39%|███▉      | 187/475 [20:08<20:19,  4.23s/it]     40%|███▉      | 188/475 [20:10<17:17,  3.62s/it]     40%|███▉      | 189/475 [20:16<21:10,  4.44s/it]     40%|████      | 190/475 [20:18<17:23,  3.66s/it]     40%|████      | 191/475 [20:24<20:25,  4.32s/it]     40%|████      | 192/475 [20:35<29:35,  6.28s/it]     41%|████      | 193/475 [20:41<28:38,  6.09s/it]     41%|████      | 194/475 [20:45<26:07,  5.58s/it]     41%|████      | 195/475 [20:59<38:19,  8.21s/it]     41%|████▏     | 196/475 [21:03<31:30,  6.78s/it]     41%|████▏     | 197/475 [21:11<33:56,  7.32s/it]     42%|████▏     | 198/475 [21:18<32:37,  7.07s/it]     42%|████▏     | 199/475 [21:21<27:39,  6.01s/it]     42%|████▏     | 200/475 [21:24<22:29,  4.91s/it]     42%|████▏     | 201/475 [21:25<17:04,  3.74s/it]     43%|████▎     | 202/475 [21:26<13:09,  2.89s/it]     43%|████▎     | 203/475 [21:26<10:19,  2.28s/it]     43%|████▎     | 204/475 [21:27<08:11,  1.81s/it]     43%|████▎     | 205/475 [21:28<07:14,  1.61s/it]     43%|████▎     | 206/475 [21:30<07:05,  1.58s/it]     44%|████▎     | 207/475 [21:34<11:13,  2.51s/it]     44%|████▍     | 208/475 [21:44<19:58,  4.49s/it]     44%|████▍     | 209/475 [21:50<22:32,  5.08s/it]     44%|████▍     | 210/475 [22:05<34:57,  7.92s/it]     44%|████▍     | 211/475 [22:18<41:41,  9.48s/it]     45%|████▍     | 212/475 [22:26<39:26,  9.00s/it]     45%|████▍     | 213/475 [22:32<35:28,  8.12s/it]     45%|████▌     | 214/475 [22:36<30:09,  6.93s/it]     45%|████▌     | 215/475 [22:43<30:31,  7.04s/it]     45%|████▌     | 216/475 [22:49<28:28,  6.60s/it]     46%|████▌     | 217/475 [22:54<26:36,  6.19s/it]     46%|████▌     | 218/475 [22:58<24:24,  5.70s/it]     46%|████▌     | 219/475 [23:01<19:50,  4.65s/it]     46%|████▋     | 220/475 [23:09<24:51,  5.85s/it]     47%|████▋     | 221/475 [23:14<22:54,  5.41s/it]     47%|████▋     | 222/475 [23:15<17:20,  4.11s/it]     47%|████▋     | 223/475 [23:16<13:37,  3.25s/it]     47%|████▋     | 224/475 [23:17<10:32,  2.52s/it]     47%|████▋     | 225/475 [23:17<08:04,  1.94s/it]     48%|████▊     | 226/475 [23:27<17:23,  4.19s/it]     48%|████▊     | 227/475 [23:31<17:12,  4.16s/it]     48%|████▊     | 228/475 [23:36<18:07,  4.40s/it]     48%|████▊     | 229/475 [23:49<28:08,  6.86s/it]     48%|████▊     | 230/475 [23:57<29:24,  7.20s/it]     49%|████▊     | 231/475 [24:08<34:50,  8.57s/it]     49%|████▉     | 232/475 [24:14<30:44,  7.59s/it]     49%|████▉     | 233/475 [24:24<34:06,  8.46s/it]     49%|████▉     | 234/475 [24:28<27:57,  6.96s/it]     49%|████▉     | 235/475 [24:34<27:49,  6.96s/it]     50%|████▉     | 236/475 [24:46<32:37,  8.19s/it]     50%|████▉     | 237/475 [24:50<28:34,  7.20s/it]     50%|█████     | 238/475 [24:57<27:21,  6.93s/it]     50%|█████     | 239/475 [25:00<23:02,  5.86s/it]     51%|█████     | 240/475 [25:05<21:43,  5.55s/it]     51%|█████     | 241/475 [25:12<23:05,  5.92s/it]     51%|█████     | 242/475 [25:18<23:09,  5.96s/it]     51%|█████     | 243/475 [25:19<17:32,  4.54s/it]     51%|█████▏    | 244/475 [25:20<13:07,  3.41s/it]     52%|█████▏    | 245/475 [25:25<15:43,  4.10s/it]     52%|█████▏    | 246/475 [25:27<13:05,  3.43s/it]     52%|█████▏    | 247/475 [25:39<22:48,  6.00s/it]     52%|█████▏    | 248/475 [25:49<26:19,  6.96s/it]     52%|█████▏    | 249/475 [26:10<42:54, 11.39s/it]     53%|█████▎    | 250/475 [26:22<42:36, 11.36s/it]     53%|█████▎    | 251/475 [26:41<51:30, 13.80s/it]     53%|█████▎    | 252/475 [26:43<38:22, 10.32s/it]     53%|█████▎    | 253/475 [26:51<35:06,  9.49s/it]     53%|█████▎    | 254/475 [26:56<29:56,  8.13s/it]     54%|█████▎    | 255/475 [26:58<22:55,  6.25s/it]     54%|█████▍    | 256/475 [27:09<28:28,  7.80s/it]     54%|█████▍    | 257/475 [27:14<25:05,  6.90s/it]     54%|█████▍    | 258/475 [27:22<25:52,  7.15s/it]     55%|█████▍    | 259/475 [27:25<21:23,  5.94s/it]     55%|█████▍    | 260/475 [27:31<21:08,  5.90s/it]     55%|█████▍    | 261/475 [27:35<20:03,  5.62s/it]     55%|█████▌    | 262/475 [27:44<23:18,  6.57s/it]     55%|█████▌    | 263/475 [27:47<18:58,  5.37s/it]     56%|█████▌    | 264/475 [27:48<14:46,  4.20s/it]     56%|█████▌    | 265/475 [27:53<14:51,  4.25s/it]     56%|█████▌    | 266/475 [27:57<14:40,  4.21s/it]     56%|█████▌    | 267/475 [28:04<18:08,  5.23s/it]     56%|█████▋    | 268/475 [28:18<26:57,  7.81s/it]     57%|█████▋    | 269/475 [28:34<35:05, 10.22s/it]     57%|█████▋    | 270/475 [28:40<30:00,  8.78s/it]     57%|█████▋    | 271/475 [28:41<22:16,  6.55s/it]     57%|█████▋    | 272/475 [28:55<29:40,  8.77s/it]     57%|█████▋    | 273/475 [28:57<22:36,  6.71s/it]     58%|█████▊    | 274/475 [29:03<21:54,  6.54s/it]     58%|█████▊    | 275/475 [29:09<21:02,  6.31s/it]     58%|█████▊    | 276/475 [29:18<24:24,  7.36s/it]     58%|█████▊    | 277/475 [29:20<19:00,  5.76s/it]     59%|█████▊    | 278/475 [29:23<15:19,  4.67s/it]     59%|█████▊    | 279/475 [29:25<12:52,  3.94s/it]     59%|█████▉    | 280/475 [29:30<13:35,  4.18s/it]     59%|█████▉    | 281/475 [29:38<17:31,  5.42s/it]     59%|█████▉    | 282/475 [29:48<22:19,  6.94s/it]     60%|█████▉    | 283/475 [29:52<18:48,  5.88s/it]     60%|█████▉    | 284/475 [29:56<17:13,  5.41s/it]     60%|██████    | 285/475 [29:59<14:38,  4.62s/it]     60%|██████    | 286/475 [30:16<26:08,  8.30s/it]     60%|██████    | 287/475 [30:20<22:34,  7.20s/it]     61%|██████    | 288/475 [30:27<21:32,  6.91s/it]     61%|██████    | 289/475 [30:32<20:25,  6.59s/it]     61%|██████    | 290/475 [30:36<17:08,  5.56s/it]     61%|██████▏   | 291/475 [30:45<20:31,  6.69s/it]     61%|██████▏   | 292/475 [30:51<19:38,  6.44s/it]     62%|██████▏   | 293/475 [30:55<17:34,  5.79s/it]     62%|██████▏   | 294/475 [31:00<16:25,  5.44s/it]     62%|██████▏   | 295/475 [31:09<19:59,  6.67s/it]     62%|██████▏   | 296/475 [31:14<18:06,  6.07s/it]     63%|██████▎   | 297/475 [31:20<17:35,  5.93s/it]     63%|██████▎   | 298/475 [31:24<15:55,  5.40s/it]     63%|██████▎   | 299/475 [31:32<18:40,  6.37s/it]     63%|██████▎   | 300/475 [31:37<17:26,  5.98s/it]     63%|██████▎   | 301/475 [31:44<18:11,  6.27s/it]     64%|██████▎   | 302/475 [31:49<16:58,  5.89s/it]     64%|██████▍   | 303/475 [31:53<14:57,  5.22s/it]     64%|██████▍   | 304/475 [31:55<11:47,  4.14s/it]     64%|██████▍   | 305/475 [31:58<11:18,  3.99s/it]     64%|██████▍   | 306/475 [32:02<10:57,  3.89s/it]     65%|██████▍   | 307/475 [32:05<10:23,  3.71s/it]     65%|██████▍   | 308/475 [32:12<12:59,  4.67s/it]     65%|██████▌   | 309/475 [32:16<12:37,  4.56s/it]     65%|██████▌   | 310/475 [32:25<16:07,  5.86s/it]     65%|██████▌   | 311/475 [32:30<14:58,  5.48s/it]     66%|██████▌   | 312/475 [32:36<15:21,  5.65s/it]     66%|██████▌   | 313/475 [32:41<14:31,  5.38s/it]     66%|██████▌   | 314/475 [32:46<14:00,  5.22s/it]     66%|██████▋   | 315/475 [32:54<16:34,  6.22s/it]     67%|██████▋   | 316/475 [32:59<15:26,  5.83s/it]     67%|██████▋   | 317/475 [33:08<18:08,  6.89s/it]     67%|██████▋   | 318/475 [33:12<15:45,  6.02s/it]     67%|██████▋   | 319/475 [33:18<15:29,  5.96s/it]     67%|██████▋   | 320/475 [33:20<11:55,  4.62s/it]     68%|██████▊   | 321/475 [33:21<09:27,  3.68s/it]     68%|██████▊   | 322/475 [33:23<08:00,  3.14s/it]     68%|██████▊   | 323/475 [33:25<07:02,  2.78s/it]     68%|██████▊   | 324/475 [33:31<09:29,  3.77s/it]     68%|██████▊   | 325/475 [33:37<11:07,  4.45s/it]     69%|██████▊   | 326/475 [33:44<13:11,  5.31s/it]     69%|██████▉   | 327/475 [33:50<13:21,  5.41s/it]     69%|██████▉   | 328/475 [33:56<13:37,  5.56s/it]     69%|██████▉   | 329/475 [33:59<11:40,  4.80s/it]     69%|██████▉   | 330/475 [34:02<10:30,  4.35s/it]     70%|██████▉   | 331/475 [34:08<11:19,  4.72s/it]     70%|██████▉   | 332/475 [34:20<16:42,  7.01s/it]     70%|███████   | 333/475 [34:30<18:31,  7.83s/it]     70%|███████   | 334/475 [34:35<16:28,  7.01s/it]     71%|███████   | 335/475 [34:47<19:40,  8.44s/it]     71%|███████   | 336/475 [34:50<16:01,  6.92s/it]     71%|███████   | 337/475 [34:56<15:19,  6.66s/it]     71%|███████   | 338/475 [35:03<15:13,  6.67s/it]     71%|███████▏  | 339/475 [35:06<12:49,  5.66s/it]     72%|███████▏  | 340/475 [35:12<12:40,  5.64s/it]     72%|███████▏  | 341/475 [35:22<15:26,  6.92s/it]     72%|███████▏  | 342/475 [35:30<16:24,  7.40s/it]     72%|███████▏  | 343/475 [35:35<14:13,  6.47s/it]     72%|███████▏  | 344/475 [35:49<19:18,  8.84s/it]     73%|███████▎  | 345/475 [35:57<18:41,  8.63s/it]     73%|███████▎  | 346/475 [36:00<15:07,  7.04s/it]     73%|███████▎  | 347/475 [36:08<15:34,  7.30s/it]     73%|███████▎  | 348/475 [36:15<14:47,  6.99s/it]     73%|███████▎  | 349/475 [36:20<13:51,  6.60s/it]     74%|███████▎  | 350/475 [36:31<16:31,  7.93s/it]     74%|███████▍  | 351/475 [36:39<16:22,  7.93s/it]     74%|███████▍  | 352/475 [36:44<14:28,  7.06s/it]     74%|███████▍  | 353/475 [36:49<12:55,  6.36s/it]     75%|███████▍  | 354/475 [36:54<11:47,  5.85s/it]     75%|███████▍  | 355/475 [37:15<20:48, 10.40s/it]     75%|███████▍  | 356/475 [37:22<19:03,  9.61s/it]     75%|███████▌  | 357/475 [37:26<15:20,  7.80s/it]     75%|███████▌  | 358/475 [37:28<11:40,  5.99s/it]     76%|███████▌  | 359/475 [37:34<11:53,  6.15s/it]     76%|███████▌  | 360/475 [37:37<09:44,  5.09s/it]     76%|███████▌  | 361/475 [37:41<08:49,  4.64s/it]     76%|███████▌  | 362/475 [37:47<09:59,  5.30s/it]     76%|███████▋  | 363/475 [37:51<08:59,  4.82s/it]     77%|███████▋  | 364/475 [37:58<10:00,  5.41s/it]     77%|███████▋  | 365/475 [38:02<09:00,  4.91s/it]     77%|███████▋  | 366/475 [38:06<08:32,  4.70s/it]     77%|███████▋  | 367/475 [38:19<13:03,  7.26s/it]     77%|███████▋  | 368/475 [38:24<11:36,  6.51s/it]     78%|███████▊  | 369/475 [38:29<10:48,  6.11s/it]     78%|███████▊  | 370/475 [38:34<10:03,  5.75s/it]     78%|███████▊  | 371/475 [38:38<09:00,  5.19s/it]     78%|███████▊  | 372/475 [38:43<09:10,  5.35s/it]     79%|███████▊  | 373/475 [38:47<08:05,  4.76s/it]     79%|███████▊  | 374/475 [38:52<08:01,  4.77s/it]     79%|███████▉  | 375/475 [39:00<09:51,  5.92s/it]     79%|███████▉  | 376/475 [39:11<11:58,  7.25s/it]     79%|███████▉  | 377/475 [39:14<10:02,  6.15s/it]     80%|███████▉  | 378/475 [39:20<09:46,  6.04s/it]     80%|███████▉  | 379/475 [39:25<09:07,  5.71s/it]     80%|████████  | 380/475 [39:29<08:12,  5.18s/it]     80%|████████  | 381/475 [39:33<07:27,  4.76s/it]     80%|████████  | 382/475 [39:38<07:28,  4.82s/it]     81%|████████  | 383/475 [39:40<06:10,  4.02s/it]     81%|████████  | 384/475 [39:43<05:53,  3.88s/it]     81%|████████  | 385/475 [39:52<08:00,  5.34s/it]     81%|████████▏ | 386/475 [39:57<07:36,  5.12s/it]     81%|████████▏ | 387/475 [40:09<10:44,  7.33s/it]     82%|████████▏ | 388/475 [40:16<10:37,  7.33s/it]     82%|████████▏ | 389/475 [40:26<11:27,  7.99s/it]     82%|████████▏ | 390/475 [40:32<10:39,  7.53s/it]     82%|████████▏ | 391/475 [40:40<10:34,  7.55s/it]     83%|████████▎ | 392/475 [40:52<12:05,  8.74s/it]     83%|████████▎ | 393/475 [40:56<10:13,  7.49s/it]     83%|████████▎ | 394/475 [41:01<08:51,  6.56s/it]     83%|████████▎ | 395/475 [41:05<07:53,  5.92s/it]     83%|████████▎ | 396/475 [41:20<11:21,  8.63s/it]     84%|████████▎ | 397/475 [41:28<10:51,  8.35s/it]     84%|████████▍ | 398/475 [41:38<11:32,  9.00s/it]     84%|████████▍ | 399/475 [41:52<13:12, 10.43s/it]     84%|████████▍ | 400/475 [41:59<11:51,  9.48s/it]     84%|████████▍ | 401/475 [42:09<11:52,  9.63s/it]     85%|████████▍ | 402/475 [42:13<09:42,  7.98s/it]     85%|████████▍ | 403/475 [42:21<09:26,  7.87s/it]     85%|████████▌ | 404/475 [42:27<08:34,  7.24s/it]     85%|████████▌ | 405/475 [42:31<07:18,  6.26s/it]     85%|████████▌ | 406/475 [42:38<07:38,  6.65s/it]     86%|████████▌ | 407/475 [42:44<07:20,  6.48s/it]     86%|████████▌ | 408/475 [42:47<05:49,  5.22s/it]     86%|████████▌ | 409/475 [42:55<06:39,  6.05s/it]     86%|████████▋ | 410/475 [42:59<06:03,  5.59s/it]     87%|████████▋ | 411/475 [43:07<06:37,  6.22s/it]     87%|████████▋ | 412/475 [43:16<07:28,  7.12s/it]     87%|████████▋ | 413/475 [43:22<07:07,  6.89s/it]     87%|████████▋ | 414/475 [43:29<06:56,  6.82s/it]     87%|████████▋ | 415/475 [43:37<07:02,  7.04s/it]     88%|████████▊ | 416/475 [43:45<07:27,  7.58s/it]     88%|████████▊ | 417/475 [43:48<05:51,  6.07s/it]     88%|████████▊ | 418/475 [43:59<07:08,  7.51s/it]     88%|████████▊ | 419/475 [44:02<05:50,  6.26s/it]     88%|████████▊ | 420/475 [44:11<06:23,  6.97s/it]     89%|████████▊ | 421/475 [44:12<04:49,  5.36s/it]     89%|████████▉ | 422/475 [44:16<04:10,  4.74s/it]     89%|████████▉ | 423/475 [44:21<04:12,  4.85s/it]     89%|████████▉ | 424/475 [44:24<03:47,  4.47s/it]     89%|████████▉ | 425/475 [44:28<03:31,  4.23s/it]     90%|████████▉ | 426/475 [44:32<03:25,  4.19s/it]     90%|████████▉ | 427/475 [44:35<03:03,  3.82s/it]     90%|█████████ | 428/475 [44:51<05:48,  7.41s/it]     90%|█████████ | 429/475 [44:56<05:08,  6.71s/it]     91%|█████████ | 430/475 [45:05<05:35,  7.46s/it]     91%|█████████ | 431/475 [45:09<04:37,  6.31s/it]     91%|█████████ | 432/475 [45:41<10:11, 14.22s/it]     91%|█████████ | 433/475 [45:48<08:16, 11.83s/it]     91%|█████████▏| 434/475 [46:10<10:15, 15.02s/it]     92%|█████████▏| 435/475 [46:19<08:51, 13.29s/it]     92%|█████████▏| 436/475 [46:23<06:41, 10.30s/it]     92%|█████████▏| 437/475 [46:29<05:40,  8.95s/it]     92%|█████████▏| 438/475 [46:33<04:41,  7.60s/it]     92%|█████████▏| 439/475 [46:38<04:07,  6.87s/it]     93%|█████████▎| 440/475 [46:50<04:52,  8.34s/it]     93%|█████████▎| 441/475 [46:58<04:42,  8.31s/it]     93%|█████████▎| 442/475 [47:04<04:08,  7.52s/it]     93%|█████████▎| 443/475 [47:15<04:30,  8.47s/it]     93%|█████████▎| 444/475 [47:23<04:21,  8.44s/it]     94%|█████████▎| 445/475 [47:30<03:59,  7.99s/it]     94%|█████████▍| 446/475 [47:35<03:23,  7.02s/it]     94%|█████████▍| 447/475 [47:41<03:12,  6.88s/it]     94%|█████████▍| 448/475 [47:45<02:42,  6.03s/it]     95%|█████████▍| 449/475 [47:54<03:00,  6.94s/it]     95%|█████████▍| 450/475 [48:00<02:46,  6.65s/it]     95%|█████████▍| 451/475 [48:22<04:25, 11.04s/it]     95%|█████████▌| 452/475 [48:25<03:20,  8.70s/it]     95%|█████████▌| 453/475 [48:35<03:18,  9.04s/it]     96%|█████████▌| 454/475 [48:42<03:02,  8.68s/it]     96%|█████████▌| 455/475 [49:01<03:52, 11.64s/it]     96%|█████████▌| 456/475 [49:08<03:12, 10.12s/it]     96%|█████████▌| 457/475 [49:12<02:30,  8.34s/it]     96%|█████████▋| 458/475 [49:17<02:07,  7.52s/it]     97%|█████████▋| 459/475 [49:26<02:04,  7.75s/it]     97%|█████████▋| 460/475 [49:42<02:35, 10.39s/it]     97%|█████████▋| 461/475 [50:05<03:16, 14.04s/it]     97%|█████████▋| 462/475 [50:18<02:57, 13.66s/it]     97%|█████████▋| 463/475 [50:26<02:24, 12.02s/it]     98%|█████████▊| 464/475 [50:28<01:41,  9.21s/it]     98%|█████████▊| 465/475 [50:41<01:43, 10.39s/it]     98%|█████████▊| 466/475 [51:01<01:57, 13.10s/it]     98%|█████████▊| 467/475 [51:11<01:37, 12.22s/it]     99%|█████████▊| 468/475 [51:16<01:09,  9.97s/it]     99%|█████████▊| 469/475 [51:25<00:58,  9.68s/it]     99%|█████████▉| 470/475 [51:31<00:42,  8.60s/it]     99%|█████████▉| 471/475 [51:35<00:28,  7.13s/it]     99%|█████████▉| 472/475 [51:41<00:21,  7.04s/it]    100%|█████████▉| 473/475 [51:50<00:14,  7.48s/it]    100%|█████████▉| 474/475 [51:57<00:07,  7.23s/it]    100%|██████████| 475/475 [52:03<00:00,  6.95s/it]    100%|██████████| 475/475 [52:03<00:00,  6.58s/it]




.. GENERATED FROM PYTHON SOURCE LINES 174-179

From the fitted models we will first illustrate the estimation of q-space
indices. We will compare the estimation using only Laplacian regularization
(MAPL), using only the global positivity constraint (MAP+), using only
positivity in discrete points (CMAP), or using both Laplacian regularization and
positivity in discrete points (CMAPL). We first show the RTOP [Ozarslan2013]_.

.. GENERATED FROM PYTHON SOURCE LINES 179-184

.. code-block:: default



    compare_maps(fits, maps=['rtop'], fit_labels=fit_labels, map_labels=['RTOP'],
                 filename='MAPMRI_rtop.png')




.. image-sg:: /examples_built/reconstruction/images/sphx_glr_reconst_mapmri_001.png
   :alt: reconst mapmri
   :srcset: /examples_built/reconstruction/images/sphx_glr_reconst_mapmri_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 185-194

.. figure:: MAPMRI_rtop.png
   :align: center

It can be seen that all maps appear quite smooth and similar, although it is
clear that the global positivity constraints provide smoother maps than the
discrete constraints. Higher Laplacian weights also produce smoother maps, but
tend to suppress the estimated RTOP values. The similarity and differences in
reconstruction can be further illustrated by visualizing the analytic norm of
the Laplacian of the fitted signal.

.. GENERATED FROM PYTHON SOURCE LINES 194-201

.. code-block:: default



    compare_maps(fits, maps=['norm_of_laplacian_signal'], fit_labels=fit_labels,
                 map_labels=['Norm of Laplacian'],
                 map_kwargs={'vmin': 0, 'vmax': 3},
                 filename='MAPMRI_norm_laplacian.png')




.. image-sg:: /examples_built/reconstruction/images/sphx_glr_reconst_mapmri_002.png
   :alt: reconst mapmri
   :srcset: /examples_built/reconstruction/images/sphx_glr_reconst_mapmri_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 202-215

.. figure:: MAPMRI_norm_laplacian.png
   :align: center

A high Laplacian norm indicates that the gradient in the three-dimensional
signal reconstruction changes a lot -- something that may indicate spurious
oscillations. In the Laplacian reconstruction (left) we see that there are some
isolated voxels that have a higher norm than the rest. In the positivity
constrained reconstruction the norm is already smoother. When both methods are
used together the overall norm gets smoother still, since both smoothness of the
signal and positivity of the propagator are imposed.

From now on we will just use the combined approach and the globally constrained
approach, show all maps we can generate, and explain their significance.

.. GENERATED FROM PYTHON SOURCE LINES 215-225

.. code-block:: default



    fits = fits[2:]
    fit_labels = fit_labels[2:]

    compare_maps(fits, maps=['msd', 'qiv', 'rtop', 'rtap', 'rtpp'],
                 fit_labels=fit_labels,
                 map_labels=['MSD', 'QIV', 'RTOP', 'RTAP', 'RTPP'],
                 filename='MAPMRI_maps.png')




.. image-sg:: /examples_built/reconstruction/images/sphx_glr_reconst_mapmri_003.png
   :alt: reconst mapmri
   :srcset: /examples_built/reconstruction/images/sphx_glr_reconst_mapmri_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 226-262

.. figure:: MAPMRI_maps.png
   :align: center

From left to right:

- Mean squared displacement (MSD) is a measure for how far protons are able to
  diffuse. a decrease in MSD indicates protons are hindered/restricted more,
  as can be seen by the high MSD in the CSF, but low in the white matter.
- Q-space Inverse Variance (QIV) is a measure of variance in the signal, which
  is said to have higher contrast to white matter than the MSD
  [Hosseinbor2013]_. QIV has also been shown to have high sensitivity to tissue
  composition change in a simulation study [Fick2016b]_.
- Return-to-origin probability (RTOP) quantifies the probability that a proton
  will be at the same position at the first and second diffusion gradient
  pulse. A higher RTOP indicates that the volume a spin is inside of is
  smaller, meaning more overall restriction. This is illustrated by the low
  values in CSF and high values in white matter.
- Return-to-axis probability (RTAP) is a directional index that quantifies
  the probability that a proton will be along the axis of the main eigenvector
  of a diffusion tensor during both diffusion gradient pulses. RTAP has been
  related to the apparent axon diameter [Ozarslan2013]_ [Fick2016a]_ under
  several strong assumptions on the tissue composition and acquisition
  protocol.
- Return-to-plane probability (RTPP) is a directional index that quantifies the
  probability that a proton will be on the plane perpendicular to the main
  eigenvector of a diffusion tensor during both gradient pulses. RTPP is
  related to the length of a pore [Ozarslan2013]_ but in practice should be
  similar to that of Gaussian diffusion.

It is also possible to estimate the amount of non-Gaussian diffusion in every
voxel [Ozarslan2013]_. This quantity is estimated through the ratio between
Gaussian volume (MAP-MRI's first basis function) and the non-Gaussian volume
(all other basis functions) of the fitted signal. For this value to be
physically meaningful we must use a b-value threshold in the MAP-MRI model. This
threshold makes the scale estimation in MAP-MRI use only samples that
realistically describe Gaussian diffusion, i.e., at low b-values.

.. GENERATED FROM PYTHON SOURCE LINES 262-286

.. code-block:: default



    map_model_both_ng = mapmri.MapmriModel(gtab, radial_order=radial_order,
                                           laplacian_regularization=True,
                                           laplacian_weighting=.05,
                                           positivity_constraint=True,
                                           bval_threshold=2000)

    map_model_plus_ng = mapmri.MapmriModel(gtab, radial_order=radial_order,
                                           positivity_constraint=True,
                                           global_constraints=True,
                                           bval_threshold=2000)

    mapfit_both_ng = map_model_both_ng.fit(data_small)
    mapfit_plus_ng = map_model_plus_ng.fit(data_small)

    fits = [mapfit_both_ng, mapfit_plus_ng]
    fit_labels = ['CMAPL', 'MAP+']

    compare_maps(fits, maps=['ng', 'ng_perpendicular', 'ng_parallel'],
                 fit_labels=fit_labels,
                 map_labels=['NG', 'NG perpendicular', 'NG parallel'],
                 filename='MAPMRI_ng.png')




.. image-sg:: /examples_built/reconstruction/images/sphx_glr_reconst_mapmri_004.png
   :alt: reconst mapmri
   :srcset: /examples_built/reconstruction/images/sphx_glr_reconst_mapmri_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/475 [00:00<?, ?it/s]      0%|          | 1/475 [00:00<01:25,  5.53it/s]      0%|          | 2/475 [00:00<01:09,  6.82it/s]      1%|          | 3/475 [00:00<01:24,  5.57it/s]      1%|          | 4/475 [00:00<01:26,  5.46it/s]      1%|          | 5/475 [00:00<01:21,  5.74it/s]      1%|▏         | 6/475 [00:01<01:42,  4.59it/s]      1%|▏         | 7/475 [00:01<01:39,  4.72it/s]      2%|▏         | 8/475 [00:01<02:28,  3.15it/s]      2%|▏         | 9/475 [00:02<03:05,  2.51it/s]      2%|▏         | 10/475 [00:02<03:00,  2.58it/s]      2%|▏         | 11/475 [00:03<02:32,  3.05it/s]      3%|▎         | 12/475 [00:03<02:09,  3.56it/s]      3%|▎         | 13/475 [00:03<02:02,  3.77it/s]      3%|▎         | 14/475 [00:03<01:58,  3.90it/s]      3%|▎         | 15/475 [00:03<01:57,  3.91it/s]      3%|▎         | 16/475 [00:04<01:53,  4.05it/s]      4%|▎         | 17/475 [00:04<01:47,  4.28it/s]      4%|▍         | 18/475 [00:04<01:54,  3.97it/s]      4%|▍         | 19/475 [00:04<01:49,  4.15it/s]      4%|▍         | 20/475 [00:05<01:36,  4.73it/s]      4%|▍         | 21/475 [00:05<01:23,  5.42it/s]      5%|▍         | 22/475 [00:05<01:48,  4.16it/s]      5%|▍         | 23/475 [00:05<01:57,  3.86it/s]      5%|▌         | 24/475 [00:06<01:53,  3.97it/s]      5%|▌         | 25/475 [00:06<02:17,  3.26it/s]      5%|▌         | 26/475 [00:06<02:18,  3.23it/s]      6%|▌         | 27/475 [00:07<02:05,  3.56it/s]      6%|▌         | 28/475 [00:07<02:26,  3.04it/s]      6%|▌         | 29/475 [00:07<02:41,  2.76it/s]      6%|▋         | 30/475 [00:08<02:20,  3.18it/s]      7%|▋         | 31/475 [00:08<02:08,  3.45it/s]      7%|▋         | 32/475 [00:08<02:09,  3.42it/s]      7%|▋         | 33/475 [00:08<01:57,  3.76it/s]      7%|▋         | 34/475 [00:09<02:04,  3.54it/s]      7%|▋         | 35/475 [00:09<01:54,  3.85it/s]      8%|▊         | 36/475 [00:09<01:42,  4.26it/s]      8%|▊         | 37/475 [00:09<01:38,  4.45it/s]      8%|▊         | 38/475 [00:10<01:49,  4.01it/s]      8%|▊         | 39/475 [00:10<01:41,  4.28it/s]      9%|▊         | 41/475 [00:10<01:19,  5.45it/s]      9%|▉         | 42/475 [00:10<01:14,  5.80it/s]      9%|▉         | 43/475 [00:10<01:17,  5.61it/s]      9%|▉         | 44/475 [00:11<01:29,  4.80it/s]      9%|▉         | 45/475 [00:11<02:05,  3.42it/s]     10%|▉         | 46/475 [00:11<02:01,  3.53it/s]     10%|▉         | 47/475 [00:12<02:03,  3.46it/s]     10%|█         | 48/475 [00:12<01:57,  3.64it/s]     10%|█         | 49/475 [00:12<01:57,  3.62it/s]     11%|█         | 50/475 [00:13<02:06,  3.36it/s]     11%|█         | 51/475 [00:13<01:56,  3.65it/s]     11%|█         | 52/475 [00:13<01:59,  3.54it/s]     11%|█         | 53/475 [00:13<01:56,  3.62it/s]     11%|█▏        | 54/475 [00:13<01:41,  4.16it/s]     12%|█▏        | 55/475 [00:14<01:23,  5.04it/s]     12%|█▏        | 56/475 [00:14<01:23,  5.02it/s]     12%|█▏        | 57/475 [00:14<01:38,  4.24it/s]     12%|█▏        | 58/475 [00:14<01:41,  4.12it/s]     13%|█▎        | 60/475 [00:15<01:21,  5.08it/s]     13%|█▎        | 61/475 [00:15<01:30,  4.58it/s]     13%|█▎        | 62/475 [00:15<01:55,  3.56it/s]     13%|█▎        | 63/475 [00:16<01:48,  3.79it/s]     13%|█▎        | 64/475 [00:16<02:18,  2.96it/s]     14%|█▎        | 65/475 [00:17<02:36,  2.62it/s]     14%|█▍        | 66/475 [00:17<02:21,  2.89it/s]     14%|█▍        | 67/475 [00:17<02:12,  3.08it/s]     14%|█▍        | 68/475 [00:17<02:03,  3.30it/s]     15%|█▍        | 69/475 [00:18<01:53,  3.57it/s]     15%|█▍        | 70/475 [00:18<01:44,  3.89it/s]     15%|█▍        | 71/475 [00:18<01:36,  4.19it/s]     15%|█▌        | 72/475 [00:18<01:23,  4.82it/s]     16%|█▌        | 74/475 [00:18<01:02,  6.37it/s]     16%|█▌        | 75/475 [00:19<01:05,  6.08it/s]     16%|█▌        | 76/475 [00:19<01:08,  5.84it/s]     16%|█▌        | 77/475 [00:19<01:02,  6.41it/s]     16%|█▋        | 78/475 [00:19<00:57,  6.85it/s]     17%|█▋        | 79/475 [00:19<01:02,  6.31it/s]     17%|█▋        | 80/475 [00:19<01:05,  6.02it/s]     17%|█▋        | 81/475 [00:20<01:17,  5.06it/s]     17%|█▋        | 82/475 [00:20<01:29,  4.37it/s]     17%|█▋        | 83/475 [00:20<01:31,  4.29it/s]     18%|█▊        | 84/475 [00:20<01:29,  4.36it/s]     18%|█▊        | 85/475 [00:21<01:22,  4.70it/s]     18%|█▊        | 86/475 [00:21<01:23,  4.68it/s]     18%|█▊        | 87/475 [00:21<01:24,  4.57it/s]     19%|█▊        | 88/475 [00:21<01:20,  4.81it/s]     19%|█▊        | 89/475 [00:21<01:09,  5.52it/s]     19%|█▉        | 90/475 [00:21<01:01,  6.30it/s]     19%|█▉        | 91/475 [00:22<00:55,  6.87it/s]     19%|█▉        | 92/475 [00:22<00:51,  7.46it/s]     20%|█▉        | 93/475 [00:22<00:48,  7.90it/s]     20%|█▉        | 94/475 [00:22<00:52,  7.27it/s]     20%|██        | 95/475 [00:22<01:04,  5.88it/s]     20%|██        | 96/475 [00:22<00:59,  6.37it/s]     20%|██        | 97/475 [00:22<00:54,  6.87it/s]     21%|██        | 98/475 [00:23<00:59,  6.37it/s]     21%|██        | 99/475 [00:23<01:03,  5.97it/s]     21%|██        | 100/475 [00:23<01:04,  5.77it/s]     21%|██▏       | 101/475 [00:23<01:10,  5.32it/s]     21%|██▏       | 102/475 [00:23<01:14,  4.99it/s]     22%|██▏       | 103/475 [00:24<01:16,  4.87it/s]     22%|██▏       | 104/475 [00:24<01:16,  4.82it/s]     22%|██▏       | 105/475 [00:24<01:15,  4.90it/s]     22%|██▏       | 106/475 [00:24<01:05,  5.64it/s]     23%|██▎       | 107/475 [00:24<00:57,  6.40it/s]     23%|██▎       | 108/475 [00:24<00:51,  7.07it/s]     23%|██▎       | 109/475 [00:24<00:48,  7.61it/s]     23%|██▎       | 110/475 [00:25<00:45,  7.97it/s]     23%|██▎       | 111/475 [00:25<00:43,  8.29it/s]     24%|██▎       | 112/475 [00:25<00:42,  8.51it/s]     24%|██▍       | 113/475 [00:25<00:54,  6.68it/s]     24%|██▍       | 114/475 [00:25<01:00,  5.94it/s]     24%|██▍       | 115/475 [00:26<01:22,  4.36it/s]     24%|██▍       | 116/475 [00:26<01:14,  4.80it/s]     25%|██▍       | 117/475 [00:26<01:08,  5.25it/s]     25%|██▍       | 118/475 [00:26<01:07,  5.28it/s]     25%|██▌       | 119/475 [00:26<01:07,  5.25it/s]     25%|██▌       | 120/475 [00:27<01:32,  3.84it/s]     25%|██▌       | 121/475 [00:27<01:28,  4.01it/s]     26%|██▌       | 122/475 [00:27<01:15,  4.68it/s]     26%|██▌       | 123/475 [00:27<01:08,  5.11it/s]     26%|██▌       | 124/475 [00:27<01:00,  5.77it/s]     26%|██▋       | 125/475 [00:28<00:55,  6.32it/s]     27%|██▋       | 126/475 [00:28<00:50,  6.98it/s]     27%|██▋       | 127/475 [00:28<00:45,  7.59it/s]     27%|██▋       | 128/475 [00:28<00:44,  7.86it/s]     27%|██▋       | 129/475 [00:28<00:42,  8.05it/s]     27%|██▋       | 130/475 [00:28<00:41,  8.25it/s]     28%|██▊       | 131/475 [00:28<00:50,  6.87it/s]     28%|██▊       | 132/475 [00:29<01:21,  4.22it/s]     28%|██▊       | 133/475 [00:29<01:20,  4.25it/s]     28%|██▊       | 134/475 [00:29<01:14,  4.61it/s]     28%|██▊       | 135/475 [00:29<01:19,  4.26it/s]     29%|██▊       | 136/475 [00:30<01:13,  4.60it/s]     29%|██▉       | 137/475 [00:30<01:07,  4.99it/s]     29%|██▉       | 138/475 [00:30<01:09,  4.86it/s]     29%|██▉       | 139/475 [00:30<01:11,  4.68it/s]     29%|██▉       | 140/475 [00:30<01:15,  4.45it/s]     30%|██▉       | 141/475 [00:31<01:08,  4.91it/s]     30%|██▉       | 142/475 [00:31<01:00,  5.52it/s]     30%|███       | 143/475 [00:31<00:52,  6.31it/s]     30%|███       | 144/475 [00:31<00:47,  6.96it/s]     31%|███       | 145/475 [00:31<00:43,  7.54it/s]     31%|███       | 146/475 [00:31<00:40,  8.08it/s]     31%|███       | 147/475 [00:31<00:39,  8.35it/s]     31%|███       | 148/475 [00:31<00:38,  8.47it/s]     31%|███▏      | 149/475 [00:31<00:37,  8.79it/s]     32%|███▏      | 150/475 [00:32<00:44,  7.26it/s]     32%|███▏      | 151/475 [00:32<00:50,  6.41it/s]     32%|███▏      | 152/475 [00:32<00:56,  5.71it/s]     32%|███▏      | 153/475 [00:32<00:51,  6.29it/s]     32%|███▏      | 154/475 [00:32<00:47,  6.69it/s]     33%|███▎      | 155/475 [00:32<00:44,  7.16it/s]     33%|███▎      | 156/475 [00:33<00:42,  7.59it/s]     33%|███▎      | 157/475 [00:33<00:41,  7.61it/s]     33%|███▎      | 158/475 [00:33<00:43,  7.26it/s]     33%|███▎      | 159/475 [00:33<00:49,  6.38it/s]     34%|███▎      | 160/475 [00:33<00:47,  6.60it/s]     34%|███▍      | 161/475 [00:33<00:48,  6.49it/s]     34%|███▍      | 162/475 [00:34<00:51,  6.03it/s]     34%|███▍      | 163/475 [00:34<00:52,  5.94it/s]     35%|███▍      | 164/475 [00:34<00:47,  6.51it/s]     35%|███▍      | 165/475 [00:34<00:43,  7.20it/s]     35%|███▍      | 166/475 [00:34<00:40,  7.68it/s]     35%|███▌      | 167/475 [00:34<00:37,  8.16it/s]     35%|███▌      | 168/475 [00:34<00:38,  7.92it/s]     36%|███▌      | 169/475 [00:35<00:47,  6.41it/s]     36%|███▌      | 170/475 [00:35<00:54,  5.59it/s]     36%|███▌      | 171/475 [00:35<00:48,  6.24it/s]     36%|███▌      | 172/475 [00:35<00:46,  6.53it/s]     36%|███▋      | 173/475 [00:35<00:45,  6.58it/s]     37%|███▋      | 174/475 [00:35<00:46,  6.44it/s]     37%|███▋      | 175/475 [00:35<00:47,  6.37it/s]     37%|███▋      | 176/475 [00:36<00:47,  6.36it/s]     37%|███▋      | 177/475 [00:36<01:08,  4.35it/s]     37%|███▋      | 178/475 [00:36<00:58,  5.03it/s]     38%|███▊      | 179/475 [00:36<00:55,  5.34it/s]     38%|███▊      | 180/475 [00:36<00:49,  6.02it/s]     38%|███▊      | 181/475 [00:37<00:56,  5.20it/s]     38%|███▊      | 182/475 [00:37<00:55,  5.28it/s]     39%|███▊      | 183/475 [00:37<00:51,  5.62it/s]     39%|███▊      | 184/475 [00:37<00:45,  6.45it/s]     39%|███▉      | 186/475 [00:37<00:37,  7.69it/s]     39%|███▉      | 187/475 [00:37<00:40,  7.15it/s]     40%|███▉      | 188/475 [00:38<00:43,  6.55it/s]     40%|███▉      | 189/475 [00:38<00:48,  5.91it/s]     40%|████      | 190/475 [00:38<00:50,  5.62it/s]     40%|████      | 191/475 [00:38<00:53,  5.28it/s]     40%|████      | 192/475 [00:39<00:56,  5.03it/s]     41%|████      | 193/475 [00:39<00:53,  5.25it/s]     41%|████      | 194/475 [00:39<00:55,  5.08it/s]     41%|████      | 195/475 [00:39<00:55,  5.03it/s]     41%|████▏     | 196/475 [00:39<01:00,  4.64it/s]     41%|████▏     | 197/475 [00:40<01:02,  4.43it/s]     42%|████▏     | 198/475 [00:40<00:55,  5.00it/s]     42%|████▏     | 199/475 [00:40<00:58,  4.68it/s]     42%|████▏     | 200/475 [00:40<00:53,  5.14it/s]     42%|████▏     | 201/475 [00:40<00:48,  5.64it/s]     43%|████▎     | 202/475 [00:40<00:43,  6.26it/s]     43%|████▎     | 203/475 [00:41<00:40,  6.79it/s]     43%|████▎     | 204/475 [00:41<00:36,  7.34it/s]     43%|████▎     | 205/475 [00:41<00:34,  7.87it/s]     44%|████▎     | 207/475 [00:41<00:37,  7.13it/s]     44%|████▍     | 208/475 [00:41<00:39,  6.76it/s]     44%|████▍     | 209/475 [00:41<00:44,  5.98it/s]     44%|████▍     | 210/475 [00:42<00:40,  6.49it/s]     44%|████▍     | 211/475 [00:42<00:42,  6.19it/s]     45%|████▍     | 212/475 [00:42<00:46,  5.70it/s]     45%|████▍     | 213/475 [00:42<00:49,  5.28it/s]     45%|████▌     | 214/475 [00:42<00:51,  5.04it/s]     45%|████▌     | 215/475 [00:43<00:56,  4.60it/s]     45%|████▌     | 216/475 [00:43<00:58,  4.39it/s]     46%|████▌     | 217/475 [00:43<00:58,  4.38it/s]     46%|████▌     | 218/475 [00:43<00:58,  4.42it/s]     46%|████▌     | 219/475 [00:44<01:10,  3.61it/s]     46%|████▋     | 220/475 [00:44<01:04,  3.94it/s]     47%|████▋     | 221/475 [00:44<00:54,  4.70it/s]     47%|████▋     | 222/475 [00:44<00:45,  5.56it/s]     47%|████▋     | 223/475 [00:44<00:39,  6.36it/s]     47%|████▋     | 225/475 [00:44<00:32,  7.67it/s]     48%|████▊     | 226/475 [00:45<00:36,  6.78it/s]     48%|████▊     | 227/475 [00:45<00:41,  6.03it/s]     48%|████▊     | 228/475 [00:45<00:47,  5.22it/s]     48%|████▊     | 229/475 [00:45<00:44,  5.48it/s]     48%|████▊     | 230/475 [00:45<00:42,  5.71it/s]     49%|████▊     | 231/475 [00:46<00:46,  5.20it/s]     49%|████▉     | 232/475 [00:46<00:50,  4.79it/s]     49%|████▉     | 233/475 [00:46<00:58,  4.16it/s]     49%|████▉     | 234/475 [00:47<01:03,  3.82it/s]     49%|████▉     | 235/475 [00:47<01:00,  3.96it/s]     50%|████▉     | 236/475 [00:47<00:59,  4.02it/s]     50%|████▉     | 237/475 [00:47<00:53,  4.43it/s]     50%|█████     | 238/475 [00:47<00:50,  4.68it/s]     50%|█████     | 239/475 [00:48<00:51,  4.56it/s]     51%|█████     | 240/475 [00:48<00:51,  4.60it/s]     51%|█████     | 241/475 [00:48<00:45,  5.10it/s]     51%|█████     | 242/475 [00:48<00:39,  5.92it/s]     51%|█████     | 243/475 [00:48<00:34,  6.64it/s]     51%|█████▏    | 244/475 [00:48<00:32,  7.16it/s]     52%|█████▏    | 245/475 [00:48<00:30,  7.48it/s]     52%|█████▏    | 246/475 [00:49<00:37,  6.15it/s]     52%|█████▏    | 247/475 [00:49<00:43,  5.30it/s]     52%|█████▏    | 248/475 [00:49<00:39,  5.68it/s]     52%|█████▏    | 249/475 [00:49<00:36,  6.18it/s]     53%|█████▎    | 250/475 [00:49<00:41,  5.42it/s]     53%|█████▎    | 251/475 [00:50<00:44,  5.01it/s]     53%|█████▎    | 252/475 [00:50<01:02,  3.55it/s]     53%|█████▎    | 253/475 [00:50<01:00,  3.69it/s]     53%|█████▎    | 254/475 [00:51<01:08,  3.24it/s]     54%|█████▎    | 255/475 [00:51<01:04,  3.40it/s]     54%|█████▍    | 256/475 [00:51<00:59,  3.70it/s]     54%|█████▍    | 257/475 [00:52<00:58,  3.75it/s]     54%|█████▍    | 258/475 [00:52<00:58,  3.68it/s]     55%|█████▍    | 259/475 [00:52<01:02,  3.46it/s]     55%|█████▍    | 260/475 [00:52<00:58,  3.67it/s]     55%|█████▍    | 261/475 [00:53<00:54,  3.91it/s]     55%|█████▌    | 262/475 [00:53<00:49,  4.32it/s]     55%|█████▌    | 263/475 [00:53<00:40,  5.17it/s]     56%|█████▌    | 264/475 [00:53<00:35,  5.90it/s]     56%|█████▌    | 265/475 [00:53<00:35,  5.91it/s]     56%|█████▌    | 266/475 [00:53<00:36,  5.65it/s]     56%|█████▌    | 267/475 [00:54<00:41,  5.06it/s]     56%|█████▋    | 268/475 [00:54<00:35,  5.91it/s]     57%|█████▋    | 269/475 [00:54<00:37,  5.48it/s]     57%|█████▋    | 270/475 [00:54<00:52,  3.88it/s]     57%|█████▋    | 271/475 [00:55<01:07,  3.04it/s]     57%|█████▋    | 272/475 [00:55<01:03,  3.19it/s]     57%|█████▋    | 273/475 [00:56<01:10,  2.88it/s]     58%|█████▊    | 274/475 [00:56<01:19,  2.53it/s]     58%|█████▊    | 275/475 [00:57<01:24,  2.36it/s]     58%|█████▊    | 276/475 [00:57<01:16,  2.59it/s]     58%|█████▊    | 277/475 [00:57<01:07,  2.92it/s]     59%|█████▊    | 278/475 [00:57<01:02,  3.13it/s]     59%|█████▊    | 279/475 [00:58<00:55,  3.54it/s]     59%|█████▉    | 280/475 [00:58<00:54,  3.58it/s]     59%|█████▉    | 281/475 [00:58<00:52,  3.73it/s]     59%|█████▉    | 282/475 [00:58<00:47,  4.06it/s]     60%|█████▉    | 283/475 [00:58<00:39,  4.86it/s]     60%|█████▉    | 284/475 [00:59<00:36,  5.24it/s]     60%|██████    | 285/475 [00:59<00:38,  4.88it/s]     60%|██████    | 286/475 [00:59<00:36,  5.17it/s]     60%|██████    | 287/475 [00:59<00:31,  5.99it/s]     61%|██████    | 288/475 [00:59<00:31,  5.94it/s]     61%|██████    | 289/475 [01:00<00:40,  4.57it/s]     61%|██████    | 290/475 [01:00<00:42,  4.31it/s]     61%|██████▏   | 291/475 [01:00<00:39,  4.72it/s]     61%|██████▏   | 292/475 [01:00<00:40,  4.56it/s]     62%|██████▏   | 293/475 [01:00<00:39,  4.63it/s]     62%|██████▏   | 294/475 [01:01<00:40,  4.42it/s]     62%|██████▏   | 295/475 [01:01<00:43,  4.11it/s]     62%|██████▏   | 296/475 [01:01<00:43,  4.14it/s]     63%|██████▎   | 297/475 [01:01<00:44,  3.97it/s]     63%|██████▎   | 298/475 [01:02<00:44,  3.99it/s]     63%|██████▎   | 299/475 [01:02<00:43,  4.05it/s]     63%|██████▎   | 300/475 [01:02<00:43,  4.01it/s]     63%|██████▎   | 301/475 [01:02<00:42,  4.13it/s]     64%|██████▎   | 302/475 [01:03<00:38,  4.50it/s]     64%|██████▍   | 303/475 [01:03<00:35,  4.78it/s]     64%|██████▍   | 304/475 [01:03<00:35,  4.79it/s]     64%|██████▍   | 305/475 [01:03<00:32,  5.31it/s]     64%|██████▍   | 306/475 [01:03<00:27,  6.08it/s]     65%|██████▍   | 307/475 [01:03<00:26,  6.43it/s]     65%|██████▍   | 308/475 [01:04<00:29,  5.72it/s]     65%|██████▌   | 309/475 [01:04<00:29,  5.71it/s]     65%|██████▌   | 310/475 [01:04<00:31,  5.27it/s]     65%|██████▌   | 311/475 [01:04<00:38,  4.21it/s]     66%|██████▌   | 312/475 [01:05<00:44,  3.70it/s]     66%|██████▌   | 313/475 [01:05<00:36,  4.39it/s]     66%|██████▌   | 314/475 [01:05<00:34,  4.70it/s]     66%|██████▋   | 315/475 [01:05<00:38,  4.17it/s]     67%|██████▋   | 316/475 [01:06<00:38,  4.18it/s]     67%|██████▋   | 317/475 [01:06<00:35,  4.43it/s]     67%|██████▋   | 318/475 [01:06<00:34,  4.53it/s]     67%|██████▋   | 319/475 [01:06<00:35,  4.36it/s]     67%|██████▋   | 320/475 [01:06<00:36,  4.29it/s]     68%|██████▊   | 321/475 [01:07<00:36,  4.20it/s]     68%|██████▊   | 322/475 [01:07<00:39,  3.90it/s]     68%|██████▊   | 323/475 [01:07<00:38,  3.91it/s]     68%|██████▊   | 324/475 [01:07<00:36,  4.11it/s]     68%|██████▊   | 325/475 [01:08<00:30,  4.85it/s]     69%|██████▊   | 326/475 [01:08<00:27,  5.48it/s]     69%|██████▉   | 327/475 [01:08<00:34,  4.32it/s]     69%|██████▉   | 328/475 [01:09<00:44,  3.30it/s]     69%|██████▉   | 329/475 [01:09<00:38,  3.80it/s]     69%|██████▉   | 330/475 [01:09<00:36,  3.98it/s]     70%|██████▉   | 331/475 [01:09<00:32,  4.49it/s]     70%|██████▉   | 332/475 [01:09<00:30,  4.70it/s]     70%|███████   | 333/475 [01:09<00:31,  4.49it/s]     70%|███████   | 334/475 [01:10<00:33,  4.25it/s]     71%|███████   | 335/475 [01:10<00:31,  4.51it/s]     71%|███████   | 336/475 [01:10<00:30,  4.59it/s]     71%|███████   | 337/475 [01:10<00:30,  4.54it/s]     71%|███████   | 338/475 [01:11<00:30,  4.53it/s]     71%|███████▏  | 339/475 [01:11<00:31,  4.35it/s]     72%|███████▏  | 340/475 [01:11<00:30,  4.37it/s]     72%|███████▏  | 341/475 [01:11<00:30,  4.45it/s]     72%|███████▏  | 342/475 [01:12<00:29,  4.47it/s]     72%|███████▏  | 343/475 [01:12<00:31,  4.25it/s]     72%|███████▏  | 344/475 [01:12<00:29,  4.42it/s]     73%|███████▎  | 345/475 [01:12<00:27,  4.72it/s]     73%|███████▎  | 346/475 [01:12<00:26,  4.92it/s]     73%|███████▎  | 347/475 [01:13<00:25,  4.98it/s]     73%|███████▎  | 348/475 [01:13<00:26,  4.88it/s]     73%|███████▎  | 349/475 [01:13<00:26,  4.80it/s]     74%|███████▎  | 350/475 [01:13<00:27,  4.60it/s]     74%|███████▍  | 351/475 [01:13<00:28,  4.43it/s]     74%|███████▍  | 352/475 [01:14<00:29,  4.16it/s]     74%|███████▍  | 353/475 [01:14<00:29,  4.20it/s]     75%|███████▍  | 354/475 [01:14<00:29,  4.10it/s]     75%|███████▍  | 355/475 [01:14<00:28,  4.15it/s]     75%|███████▍  | 356/475 [01:15<00:29,  4.10it/s]     75%|███████▌  | 357/475 [01:15<00:28,  4.10it/s]     75%|███████▌  | 358/475 [01:15<00:27,  4.19it/s]     76%|███████▌  | 359/475 [01:15<00:27,  4.27it/s]     76%|███████▌  | 360/475 [01:16<00:27,  4.19it/s]     76%|███████▌  | 361/475 [01:16<00:25,  4.45it/s]     76%|███████▌  | 362/475 [01:16<00:25,  4.47it/s]     76%|███████▋  | 363/475 [01:16<00:24,  4.54it/s]     77%|███████▋  | 364/475 [01:17<00:25,  4.38it/s]     77%|███████▋  | 365/475 [01:17<00:24,  4.41it/s]     77%|███████▋  | 366/475 [01:17<00:22,  4.91it/s]     77%|███████▋  | 367/475 [01:17<00:22,  4.71it/s]     77%|███████▋  | 368/475 [01:17<00:23,  4.54it/s]     78%|███████▊  | 369/475 [01:18<00:24,  4.31it/s]     78%|███████▊  | 370/475 [01:18<00:24,  4.36it/s]     78%|███████▊  | 371/475 [01:18<00:25,  4.14it/s]     78%|███████▊  | 372/475 [01:18<00:25,  4.07it/s]     79%|███████▊  | 373/475 [01:19<00:24,  4.11it/s]     79%|███████▊  | 374/475 [01:19<00:30,  3.29it/s]     79%|███████▉  | 375/475 [01:19<00:27,  3.59it/s]     79%|███████▉  | 376/475 [01:20<00:26,  3.78it/s]     79%|███████▉  | 377/475 [01:20<00:25,  3.92it/s]     80%|███████▉  | 378/475 [01:20<00:24,  3.99it/s]     80%|███████▉  | 379/475 [01:20<00:27,  3.49it/s]     80%|████████  | 380/475 [01:21<00:25,  3.77it/s]     80%|████████  | 381/475 [01:21<00:24,  3.84it/s]     80%|████████  | 382/475 [01:21<00:22,  4.09it/s]     81%|████████  | 383/475 [01:21<00:21,  4.24it/s]     81%|████████  | 384/475 [01:21<00:20,  4.39it/s]     81%|████████  | 385/475 [01:22<00:20,  4.43it/s]     81%|████████▏ | 386/475 [01:22<00:19,  4.54it/s]     81%|████████▏ | 387/475 [01:22<00:19,  4.57it/s]     82%|████████▏ | 388/475 [01:22<00:20,  4.22it/s]     82%|████████▏ | 389/475 [01:23<00:20,  4.18it/s]     82%|████████▏ | 390/475 [01:23<00:19,  4.32it/s]     82%|████████▏ | 391/475 [01:23<00:18,  4.63it/s]     83%|████████▎ | 392/475 [01:23<00:22,  3.65it/s]     83%|████████▎ | 393/475 [01:24<00:26,  3.07it/s]     83%|████████▎ | 394/475 [01:24<00:23,  3.43it/s]     83%|████████▎ | 395/475 [01:25<00:27,  2.94it/s]     83%|████████▎ | 396/475 [01:25<00:24,  3.22it/s]     84%|████████▎ | 397/475 [01:25<00:22,  3.42it/s]     84%|████████▍ | 398/475 [01:25<00:21,  3.57it/s]     84%|████████▍ | 399/475 [01:26<00:20,  3.62it/s]     84%|████████▍ | 400/475 [01:26<00:18,  4.03it/s]     84%|████████▍ | 401/475 [01:26<00:21,  3.50it/s]     85%|████████▍ | 402/475 [01:26<00:22,  3.25it/s]     85%|████████▍ | 403/475 [01:27<00:19,  3.67it/s]     85%|████████▌ | 404/475 [01:27<00:17,  4.04it/s]     85%|████████▌ | 405/475 [01:27<00:16,  4.25it/s]     85%|████████▌ | 406/475 [01:27<00:15,  4.42it/s]     86%|████████▌ | 407/475 [01:28<00:15,  4.26it/s]     86%|████████▌ | 408/475 [01:28<00:16,  4.07it/s]     86%|████████▌ | 409/475 [01:28<00:15,  4.18it/s]     86%|████████▋ | 410/475 [01:28<00:15,  4.28it/s]     87%|████████▋ | 411/475 [01:28<00:14,  4.43it/s]     87%|████████▋ | 412/475 [01:29<00:14,  4.46it/s]     87%|████████▋ | 413/475 [01:29<00:14,  4.40it/s]     87%|████████▋ | 414/475 [01:29<00:14,  4.16it/s]     87%|████████▋ | 415/475 [01:29<00:14,  4.26it/s]     88%|████████▊ | 416/475 [01:30<00:13,  4.38it/s]     88%|████████▊ | 417/475 [01:30<00:14,  3.92it/s]     88%|████████▊ | 418/475 [01:30<00:14,  3.91it/s]     88%|████████▊ | 419/475 [01:30<00:13,  4.22it/s]     88%|████████▊ | 420/475 [01:31<00:12,  4.46it/s]     89%|████████▊ | 421/475 [01:31<00:11,  4.74it/s]     89%|████████▉ | 422/475 [01:31<00:12,  4.17it/s]     89%|████████▉ | 423/475 [01:31<00:11,  4.63it/s]     89%|████████▉ | 424/475 [01:31<00:10,  4.83it/s]     89%|████████▉ | 425/475 [01:32<00:10,  4.75it/s]     90%|████████▉ | 426/475 [01:32<00:10,  4.74it/s]     90%|████████▉ | 427/475 [01:32<00:10,  4.56it/s]     90%|█████████ | 428/475 [01:32<00:10,  4.69it/s]     90%|█████████ | 429/475 [01:32<00:09,  4.76it/s]     91%|█████████ | 430/475 [01:33<00:10,  4.26it/s]     91%|█████████ | 431/475 [01:33<00:10,  4.32it/s]     91%|█████████ | 432/475 [01:33<00:09,  4.33it/s]     91%|█████████ | 433/475 [01:34<00:11,  3.58it/s]     91%|█████████▏| 434/475 [01:34<00:11,  3.58it/s]     92%|█████████▏| 435/475 [01:34<00:10,  3.77it/s]     92%|█████████▏| 436/475 [01:34<00:10,  3.88it/s]     92%|█████████▏| 437/475 [01:35<00:10,  3.74it/s]     92%|█████████▏| 438/475 [01:35<00:09,  3.95it/s]     92%|█████████▏| 439/475 [01:35<00:08,  4.16it/s]     93%|█████████▎| 440/475 [01:35<00:07,  4.41it/s]     93%|█████████▎| 441/475 [01:35<00:07,  4.47it/s]     93%|█████████▎| 442/475 [01:36<00:07,  4.53it/s]     93%|█████████▎| 443/475 [01:36<00:07,  4.31it/s]     93%|█████████▎| 444/475 [01:36<00:07,  3.99it/s]     94%|█████████▎| 445/475 [01:36<00:07,  4.25it/s]     94%|█████████▍| 446/475 [01:37<00:06,  4.57it/s]     94%|█████████▍| 447/475 [01:37<00:06,  4.58it/s]     94%|█████████▍| 448/475 [01:37<00:06,  4.40it/s]     95%|█████████▍| 449/475 [01:37<00:05,  4.47it/s]     95%|█████████▍| 450/475 [01:38<00:05,  4.41it/s]     95%|█████████▍| 451/475 [01:38<00:05,  4.17it/s]     95%|█████████▌| 452/475 [01:38<00:05,  4.47it/s]     95%|█████████▌| 453/475 [01:38<00:05,  4.37it/s]     96%|█████████▌| 454/475 [01:38<00:04,  4.49it/s]     96%|█████████▌| 455/475 [01:39<00:04,  4.52it/s]     96%|█████████▌| 456/475 [01:39<00:04,  4.56it/s]     96%|█████████▌| 457/475 [01:39<00:03,  4.68it/s]     96%|█████████▋| 458/475 [01:39<00:03,  4.78it/s]     97%|█████████▋| 459/475 [01:39<00:02,  5.47it/s]     97%|█████████▋| 460/475 [01:40<00:02,  6.06it/s]     97%|█████████▋| 461/475 [01:40<00:02,  5.93it/s]     97%|█████████▋| 462/475 [01:40<00:02,  5.82it/s]     97%|█████████▋| 463/475 [01:40<00:02,  5.13it/s]     98%|█████████▊| 464/475 [01:40<00:02,  4.79it/s]     98%|█████████▊| 465/475 [01:41<00:02,  4.73it/s]     98%|█████████▊| 466/475 [01:41<00:01,  4.76it/s]     98%|█████████▊| 467/475 [01:41<00:01,  4.73it/s]     99%|█████████▊| 468/475 [01:41<00:01,  4.76it/s]     99%|█████████▊| 469/475 [01:41<00:01,  4.74it/s]     99%|█████████▉| 470/475 [01:42<00:01,  4.68it/s]     99%|█████████▉| 471/475 [01:42<00:00,  4.54it/s]     99%|█████████▉| 472/475 [01:42<00:00,  4.39it/s]    100%|█████████▉| 473/475 [01:42<00:00,  4.51it/s]    100%|█████████▉| 474/475 [01:43<00:00,  4.37it/s]    100%|██████████| 475/475 [01:43<00:00,  4.67it/s]    100%|██████████| 475/475 [01:43<00:00,  4.60it/s]
      0%|          | 0/475 [00:00<?, ?it/s]      0%|          | 1/475 [00:06<53:16,  6.74s/it]      0%|          | 2/475 [00:26<1:53:00, 14.34s/it]      1%|          | 3/475 [00:33<1:27:44, 11.15s/it]      1%|          | 4/475 [00:37<1:04:21,  8.20s/it]      1%|          | 5/475 [00:45<1:04:47,  8.27s/it]      1%|▏         | 6/475 [00:51<57:18,  7.33s/it]        1%|▏         | 7/475 [01:06<1:16:00,  9.74s/it]      2%|▏         | 8/475 [01:11<1:04:51,  8.33s/it]      2%|▏         | 9/475 [01:18<1:02:23,  8.03s/it]      2%|▏         | 10/475 [01:21<50:28,  6.51s/it]       2%|▏         | 11/475 [01:26<45:05,  5.83s/it]      3%|▎         | 12/475 [01:34<51:05,  6.62s/it]      3%|▎         | 13/475 [01:38<44:40,  5.80s/it]      3%|▎         | 14/475 [01:42<41:31,  5.41s/it]      3%|▎         | 15/475 [01:47<38:52,  5.07s/it]      3%|▎         | 16/475 [01:54<44:15,  5.78s/it]      4%|▎         | 17/475 [01:57<36:58,  4.84s/it]      4%|▍         | 18/475 [02:05<45:05,  5.92s/it]      4%|▍         | 19/475 [02:12<47:47,  6.29s/it]      4%|▍         | 20/475 [02:23<57:18,  7.56s/it]      4%|▍         | 21/475 [02:27<49:20,  6.52s/it]      5%|▍         | 22/475 [02:36<53:56,  7.15s/it]      5%|▍         | 23/475 [02:48<1:05:43,  8.72s/it]      5%|▌         | 24/475 [03:01<1:14:53,  9.96s/it]      5%|▌         | 25/475 [03:10<1:13:18,  9.78s/it]      5%|▌         | 26/475 [03:14<1:00:15,  8.05s/it]      6%|▌         | 27/475 [03:20<55:13,  7.40s/it]        6%|▌         | 28/475 [03:28<56:38,  7.60s/it]      6%|▌         | 29/475 [03:36<57:06,  7.68s/it]      6%|▋         | 30/475 [03:45<1:00:43,  8.19s/it]      7%|▋         | 31/475 [03:49<49:36,  6.70s/it]        7%|▋         | 32/475 [03:52<42:54,  5.81s/it]      7%|▋         | 33/475 [03:59<44:42,  6.07s/it]      7%|▋         | 34/475 [04:02<37:27,  5.10s/it]      7%|▋         | 35/475 [04:16<56:44,  7.74s/it]      8%|▊         | 36/475 [04:19<46:04,  6.30s/it]      8%|▊         | 37/475 [04:34<1:05:59,  9.04s/it]      8%|▊         | 38/475 [04:39<57:33,  7.90s/it]        8%|▊         | 39/475 [04:48<59:17,  8.16s/it]      8%|▊         | 40/475 [04:51<46:42,  6.44s/it]      9%|▊         | 41/475 [04:55<43:06,  5.96s/it]      9%|▉         | 42/475 [05:04<47:55,  6.64s/it]      9%|▉         | 43/475 [05:09<44:18,  6.15s/it]      9%|▉         | 44/475 [05:12<38:33,  5.37s/it]      9%|▉         | 45/475 [05:21<45:23,  6.33s/it]     10%|▉         | 46/475 [05:28<46:44,  6.54s/it]     10%|▉         | 47/475 [05:33<42:40,  5.98s/it]     10%|█         | 48/475 [05:45<56:09,  7.89s/it]     10%|█         | 49/475 [05:50<49:31,  6.98s/it]     11%|█         | 50/475 [05:52<39:40,  5.60s/it]     11%|█         | 51/475 [05:58<40:32,  5.74s/it]     11%|█         | 52/475 [06:02<37:17,  5.29s/it]     11%|█         | 53/475 [06:08<38:34,  5.48s/it]     11%|█▏        | 54/475 [06:15<41:04,  5.85s/it]     12%|█▏        | 55/475 [06:16<31:01,  4.43s/it]     12%|█▏        | 56/475 [06:19<28:20,  4.06s/it]     12%|█▏        | 57/475 [06:23<26:29,  3.80s/it]     12%|█▏        | 58/475 [06:29<30:57,  4.45s/it]     12%|█▏        | 59/475 [06:36<37:55,  5.47s/it]     13%|█▎        | 60/475 [06:43<39:31,  5.71s/it]     13%|█▎        | 61/475 [06:48<38:29,  5.58s/it]     13%|█▎        | 62/475 [07:01<54:11,  7.87s/it]     13%|█▎        | 63/475 [07:05<44:41,  6.51s/it]     13%|█▎        | 64/475 [07:09<40:05,  5.85s/it]     14%|█▎        | 65/475 [07:20<50:45,  7.43s/it]     14%|█▍        | 66/475 [07:33<1:02:28,  9.16s/it]     14%|█▍        | 67/475 [07:36<50:22,  7.41s/it]       14%|█▍        | 68/475 [07:48<58:20,  8.60s/it]     15%|█▍        | 69/475 [07:54<53:41,  7.94s/it]     15%|█▍        | 70/475 [07:57<43:14,  6.41s/it]     15%|█▍        | 71/475 [08:09<53:43,  7.98s/it]     15%|█▌        | 72/475 [08:11<43:05,  6.41s/it]     15%|█▌        | 73/475 [08:12<31:34,  4.71s/it]     16%|█▌        | 74/475 [08:13<23:26,  3.51s/it]     16%|█▌        | 75/475 [08:15<21:27,  3.22s/it]     16%|█▌        | 76/475 [08:21<26:31,  3.99s/it]     16%|█▌        | 77/475 [08:22<20:10,  3.04s/it]     16%|█▋        | 78/475 [08:25<19:20,  2.92s/it]     17%|█▋        | 79/475 [08:33<29:12,  4.42s/it]     17%|█▋        | 80/475 [08:38<30:16,  4.60s/it]     17%|█▋        | 81/475 [08:45<35:03,  5.34s/it]     17%|█▋        | 82/475 [08:54<42:41,  6.52s/it]     17%|█▋        | 83/475 [09:00<41:53,  6.41s/it]     18%|█▊        | 84/475 [09:03<35:31,  5.45s/it]     18%|█▊        | 85/475 [09:13<43:33,  6.70s/it]     18%|█▊        | 86/475 [09:20<44:22,  6.84s/it]     18%|█▊        | 87/475 [09:23<35:58,  5.56s/it]     19%|█▊        | 88/475 [09:25<29:52,  4.63s/it]     19%|█▊        | 89/475 [09:27<23:23,  3.63s/it]     19%|█▉        | 90/475 [09:27<17:58,  2.80s/it]     19%|█▉        | 91/475 [09:28<13:39,  2.13s/it]     19%|█▉        | 92/475 [09:29<10:39,  1.67s/it]     20%|█▉        | 93/475 [09:33<16:41,  2.62s/it]     20%|█▉        | 94/475 [09:37<18:15,  2.88s/it]     20%|██        | 95/475 [09:44<26:41,  4.21s/it]     20%|██        | 96/475 [09:56<40:30,  6.41s/it]     20%|██        | 97/475 [10:01<37:40,  5.98s/it]     21%|██        | 98/475 [10:08<39:19,  6.26s/it]     21%|██        | 99/475 [10:12<35:29,  5.66s/it]     21%|██        | 100/475 [10:19<37:47,  6.05s/it]     21%|██▏       | 101/475 [10:26<38:59,  6.25s/it]     21%|██▏       | 102/475 [10:30<35:19,  5.68s/it]     22%|██▏       | 103/475 [10:37<38:32,  6.22s/it]     22%|██▏       | 104/475 [10:45<41:59,  6.79s/it]     22%|██▏       | 105/475 [10:55<46:17,  7.51s/it]     22%|██▏       | 106/475 [10:58<38:30,  6.26s/it]     23%|██▎       | 107/475 [10:59<28:32,  4.65s/it]     23%|██▎       | 108/475 [11:00<21:28,  3.51s/it]     23%|██▎       | 109/475 [11:00<16:06,  2.64s/it]     23%|██▎       | 110/475 [11:01<12:12,  2.01s/it]     23%|██▎       | 111/475 [11:02<09:45,  1.61s/it]     24%|██▎       | 112/475 [11:08<17:47,  2.94s/it]     24%|██▍       | 113/475 [11:12<20:08,  3.34s/it]     24%|██▍       | 114/475 [11:21<31:17,  5.20s/it]     24%|██▍       | 115/475 [11:22<23:31,  3.92s/it]     24%|██▍       | 116/475 [11:36<40:43,  6.81s/it]     25%|██▍       | 117/475 [11:43<40:29,  6.79s/it]     25%|██▍       | 118/475 [11:49<39:21,  6.62s/it]     25%|██▌       | 119/475 [11:56<40:47,  6.87s/it]     25%|██▌       | 120/475 [12:08<49:49,  8.42s/it]     25%|██▌       | 121/475 [12:14<45:02,  7.63s/it]     26%|██▌       | 122/475 [12:25<50:53,  8.65s/it]     26%|██▌       | 123/475 [12:35<53:08,  9.06s/it]     26%|██▌       | 124/475 [12:37<40:38,  6.95s/it]     26%|██▋       | 125/475 [12:42<36:15,  6.22s/it]     27%|██▋       | 126/475 [12:43<26:43,  4.59s/it]     27%|██▋       | 127/475 [12:43<19:40,  3.39s/it]     27%|██▋       | 128/475 [12:44<14:46,  2.55s/it]     27%|██▋       | 129/475 [12:44<11:15,  1.95s/it]     27%|██▋       | 130/475 [12:45<08:52,  1.54s/it]     28%|██▊       | 131/475 [12:51<16:10,  2.82s/it]     28%|██▊       | 132/475 [12:56<20:24,  3.57s/it]     28%|██▊       | 133/475 [13:05<29:13,  5.13s/it]     28%|██▊       | 134/475 [13:23<52:13,  9.19s/it]     28%|██▊       | 135/475 [13:30<48:22,  8.54s/it]     29%|██▊       | 136/475 [13:40<49:06,  8.69s/it]     29%|██▉       | 137/475 [13:44<41:11,  7.31s/it]     29%|██▉       | 138/475 [13:51<41:04,  7.31s/it]     29%|██▉       | 139/475 [13:56<36:29,  6.52s/it]     29%|██▉       | 140/475 [13:58<28:52,  5.17s/it]     30%|██▉       | 141/475 [14:03<29:15,  5.26s/it]     30%|██▉       | 142/475 [14:05<23:02,  4.15s/it]     30%|███       | 143/475 [14:05<17:20,  3.13s/it]     30%|███       | 144/475 [14:10<19:27,  3.53s/it]     31%|███       | 145/475 [14:11<15:07,  2.75s/it]     31%|███       | 146/475 [14:11<11:33,  2.11s/it]     31%|███       | 147/475 [14:12<09:11,  1.68s/it]     31%|███       | 148/475 [14:13<07:22,  1.35s/it]     31%|███▏      | 149/475 [14:15<08:24,  1.55s/it]     32%|███▏      | 150/475 [14:25<22:24,  4.14s/it]     32%|███▏      | 151/475 [14:31<25:35,  4.74s/it]     32%|███▏      | 152/475 [14:35<24:59,  4.64s/it]     32%|███▏      | 153/475 [14:41<26:49,  5.00s/it]     32%|███▏      | 154/475 [14:52<35:20,  6.61s/it]     33%|███▎      | 155/475 [14:57<34:05,  6.39s/it]     33%|███▎      | 156/475 [15:01<29:08,  5.48s/it]     33%|███▎      | 157/475 [15:03<23:58,  4.52s/it]     33%|███▎      | 158/475 [15:09<26:43,  5.06s/it]     33%|███▎      | 159/475 [15:21<37:03,  7.03s/it]     34%|███▎      | 160/475 [15:31<41:35,  7.92s/it]     34%|███▍      | 161/475 [15:35<34:59,  6.69s/it]     34%|███▍      | 162/475 [15:41<34:40,  6.65s/it]     34%|███▍      | 163/475 [15:46<31:26,  6.05s/it]     35%|███▍      | 164/475 [15:53<33:00,  6.37s/it]     35%|███▍      | 165/475 [15:54<24:32,  4.75s/it]     35%|███▍      | 166/475 [15:55<18:19,  3.56s/it]     35%|███▌      | 167/475 [15:56<13:50,  2.70s/it]     35%|███▌      | 168/475 [16:02<18:55,  3.70s/it]     36%|███▌      | 169/475 [16:16<35:38,  6.99s/it]     36%|███▌      | 170/475 [16:24<35:59,  7.08s/it]     36%|███▌      | 171/475 [16:30<35:20,  6.98s/it]     36%|███▌      | 172/475 [16:35<31:35,  6.26s/it]     36%|███▋      | 173/475 [16:47<40:30,  8.05s/it]     37%|███▋      | 174/475 [17:06<56:04, 11.18s/it]     37%|███▋      | 175/475 [17:14<52:06, 10.42s/it]     37%|███▋      | 176/475 [17:37<1:10:01, 14.05s/it]     37%|███▋      | 177/475 [17:42<57:06, 11.50s/it]       37%|███▋      | 178/475 [17:50<50:55, 10.29s/it]     38%|███▊      | 179/475 [17:55<43:14,  8.76s/it]     38%|███▊      | 180/475 [17:59<35:43,  7.27s/it]     38%|███▊      | 181/475 [18:07<37:36,  7.67s/it]     38%|███▊      | 182/475 [18:10<30:31,  6.25s/it]     39%|███▊      | 183/475 [18:12<23:19,  4.79s/it]     39%|███▊      | 184/475 [18:13<18:01,  3.72s/it]     39%|███▉      | 185/475 [18:14<13:41,  2.83s/it]     39%|███▉      | 186/475 [18:14<10:32,  2.19s/it]     39%|███▉      | 187/475 [18:19<14:00,  2.92s/it]     40%|███▉      | 188/475 [18:23<15:20,  3.21s/it]     40%|███▉      | 189/475 [18:33<25:08,  5.27s/it]     40%|████      | 190/475 [18:36<21:39,  4.56s/it]     40%|████      | 191/475 [18:42<23:16,  4.92s/it]     40%|████      | 192/475 [18:53<32:55,  6.98s/it]     41%|████      | 193/475 [19:00<32:22,  6.89s/it]     41%|████      | 194/475 [19:10<36:26,  7.78s/it]     41%|████      | 195/475 [19:25<45:50,  9.82s/it]     41%|████▏     | 196/475 [19:32<41:55,  9.02s/it]     41%|████▏     | 197/475 [19:38<38:33,  8.32s/it]     42%|████▏     | 198/475 [19:47<38:10,  8.27s/it]     42%|████▏     | 199/475 [19:50<31:07,  6.77s/it]     42%|████▏     | 200/475 [19:52<24:32,  5.36s/it]     42%|████▏     | 201/475 [19:53<18:20,  4.02s/it]     43%|████▎     | 202/475 [19:54<13:53,  3.05s/it]     43%|████▎     | 203/475 [19:54<10:53,  2.40s/it]     43%|████▎     | 204/475 [19:55<08:24,  1.86s/it]     43%|████▎     | 205/475 [19:57<08:45,  1.95s/it]     43%|████▎     | 206/475 [19:59<08:18,  1.85s/it]     44%|████▎     | 207/475 [20:04<12:40,  2.84s/it]     44%|████▍     | 208/475 [20:19<28:54,  6.50s/it]     44%|████▍     | 209/475 [20:26<30:04,  6.78s/it]     44%|████▍     | 210/475 [20:35<32:57,  7.46s/it]     44%|████▍     | 211/475 [20:48<39:00,  8.86s/it]     45%|████▍     | 212/475 [20:54<35:44,  8.15s/it]     45%|████▍     | 213/475 [21:00<32:23,  7.42s/it]     45%|████▌     | 214/475 [21:05<29:38,  6.81s/it]     45%|████▌     | 215/475 [21:10<26:51,  6.20s/it]     45%|████▌     | 216/475 [21:17<28:25,  6.58s/it]     46%|████▌     | 217/475 [21:20<22:50,  5.31s/it]     46%|████▌     | 218/475 [21:25<22:54,  5.35s/it]     46%|████▌     | 219/475 [21:27<18:29,  4.34s/it]     46%|████▋     | 220/475 [21:33<19:41,  4.64s/it]     47%|████▋     | 221/475 [21:34<16:07,  3.81s/it]     47%|████▋     | 222/475 [21:35<12:29,  2.96s/it]     47%|████▋     | 223/475 [21:36<09:28,  2.26s/it]     47%|████▋     | 224/475 [21:37<07:24,  1.77s/it]     47%|████▋     | 225/475 [21:38<06:36,  1.58s/it]     48%|████▊     | 226/475 [21:49<18:09,  4.38s/it]     48%|████▊     | 227/475 [21:53<18:31,  4.48s/it]     48%|████▊     | 228/475 [22:09<32:29,  7.89s/it]     48%|████▊     | 229/475 [22:21<37:38,  9.18s/it]     48%|████▊     | 230/475 [22:27<32:38,  7.99s/it]     49%|████▊     | 231/475 [22:40<38:45,  9.53s/it]     49%|████▉     | 232/475 [22:45<33:23,  8.25s/it]     49%|████▉     | 233/475 [22:58<39:08,  9.70s/it]     49%|████▉     | 234/475 [23:09<39:52,  9.93s/it]     49%|████▉     | 235/475 [23:21<42:49, 10.71s/it]     50%|████▉     | 236/475 [23:35<45:49, 11.50s/it]     50%|████▉     | 237/475 [23:44<42:58, 10.83s/it]     50%|█████     | 238/475 [23:46<32:51,  8.32s/it]     50%|█████     | 239/475 [23:50<27:26,  6.98s/it]     51%|█████     | 240/475 [23:52<21:51,  5.58s/it]     51%|█████     | 241/475 [23:56<19:41,  5.05s/it]     51%|█████     | 242/475 [23:57<14:52,  3.83s/it]     51%|█████     | 243/475 [23:58<11:45,  3.04s/it]     51%|█████▏    | 244/475 [23:59<08:54,  2.31s/it]     52%|█████▏    | 245/475 [24:02<09:18,  2.43s/it]     52%|█████▏    | 246/475 [24:07<12:37,  3.31s/it]     52%|█████▏    | 247/475 [24:17<19:36,  5.16s/it]     52%|█████▏    | 248/475 [24:40<39:57, 10.56s/it]     52%|█████▏    | 249/475 [24:56<46:28, 12.34s/it]     53%|█████▎    | 250/475 [25:03<40:21, 10.76s/it]     53%|█████▎    | 251/475 [25:24<50:59, 13.66s/it]     53%|█████▎    | 252/475 [25:31<43:22, 11.67s/it]     53%|█████▎    | 253/475 [25:41<41:21, 11.18s/it]     53%|█████▎    | 254/475 [25:45<33:01,  8.97s/it]     54%|█████▎    | 255/475 [25:51<29:36,  8.07s/it]     54%|█████▍    | 256/475 [26:07<38:34, 10.57s/it]     54%|█████▍    | 257/475 [26:13<33:56,  9.34s/it]     54%|█████▍    | 258/475 [26:18<28:39,  7.92s/it]     55%|█████▍    | 259/475 [26:21<22:45,  6.32s/it]     55%|█████▍    | 260/475 [26:24<19:28,  5.43s/it]     55%|█████▍    | 261/475 [26:37<27:54,  7.83s/it]     55%|█████▌    | 262/475 [26:46<28:55,  8.15s/it]     55%|█████▌    | 263/475 [26:48<21:52,  6.19s/it]     56%|█████▌    | 264/475 [26:49<16:04,  4.57s/it]     56%|█████▌    | 265/475 [26:53<15:34,  4.45s/it]     56%|█████▌    | 266/475 [26:56<13:42,  3.93s/it]     56%|█████▌    | 267/475 [27:04<18:34,  5.36s/it]     56%|█████▋    | 268/475 [27:22<30:57,  8.97s/it]     57%|█████▋    | 269/475 [27:28<27:34,  8.03s/it]     57%|█████▋    | 270/475 [27:31<23:12,  6.79s/it]     57%|█████▋    | 271/475 [27:33<17:46,  5.23s/it]     57%|█████▋    | 272/475 [27:38<17:31,  5.18s/it]     57%|█████▋    | 273/475 [27:44<18:11,  5.40s/it]     58%|█████▊    | 274/475 [27:50<18:48,  5.61s/it]     58%|█████▊    | 275/475 [27:59<21:32,  6.46s/it]     58%|█████▊    | 276/475 [28:05<21:18,  6.42s/it]     58%|█████▊    | 277/475 [28:10<19:54,  6.03s/it]     59%|█████▊    | 278/475 [28:12<15:47,  4.81s/it]     59%|█████▊    | 279/475 [28:29<27:57,  8.56s/it]     59%|█████▉    | 280/475 [28:33<23:20,  7.18s/it]     59%|█████▉    | 281/475 [28:41<24:06,  7.46s/it]     59%|█████▉    | 282/475 [28:47<22:29,  6.99s/it]     60%|█████▉    | 283/475 [28:49<17:02,  5.33s/it]     60%|█████▉    | 284/475 [28:54<16:46,  5.27s/it]     60%|██████    | 285/475 [29:00<17:24,  5.50s/it]     60%|██████    | 286/475 [29:08<19:50,  6.30s/it]     60%|██████    | 287/475 [29:13<18:01,  5.75s/it]     61%|██████    | 288/475 [29:18<17:31,  5.62s/it]     61%|██████    | 289/475 [29:27<20:53,  6.74s/it]     61%|██████    | 290/475 [29:32<19:13,  6.24s/it]     61%|██████▏   | 291/475 [29:45<25:05,  8.18s/it]     61%|██████▏   | 292/475 [29:58<29:24,  9.64s/it]     62%|██████▏   | 293/475 [30:02<23:58,  7.90s/it]     62%|██████▏   | 294/475 [30:05<19:35,  6.50s/it]     62%|██████▏   | 295/475 [30:11<18:35,  6.20s/it]     62%|██████▏   | 296/475 [30:15<16:40,  5.59s/it]     63%|██████▎   | 297/475 [30:20<16:40,  5.62s/it]     63%|██████▎   | 298/475 [30:26<16:38,  5.64s/it]     63%|██████▎   | 299/475 [30:36<20:00,  6.82s/it]     63%|██████▎   | 300/475 [30:39<17:07,  5.87s/it]     63%|██████▎   | 301/475 [30:47<18:24,  6.35s/it]     64%|██████▎   | 302/475 [30:53<18:02,  6.26s/it]     64%|██████▍   | 303/475 [30:58<16:53,  5.89s/it]     64%|██████▍   | 304/475 [31:01<14:27,  5.07s/it]     64%|██████▍   | 305/475 [31:13<20:10,  7.12s/it]     64%|██████▍   | 306/475 [31:21<21:15,  7.54s/it]     65%|██████▍   | 307/475 [31:25<17:55,  6.40s/it]     65%|██████▍   | 308/475 [31:32<18:03,  6.49s/it]     65%|██████▌   | 309/475 [31:37<17:01,  6.16s/it]     65%|██████▌   | 310/475 [31:48<20:30,  7.46s/it]     65%|██████▌   | 311/475 [31:54<19:36,  7.17s/it]     66%|██████▌   | 312/475 [32:00<18:15,  6.72s/it]     66%|██████▌   | 313/475 [32:05<16:55,  6.27s/it]     66%|██████▌   | 314/475 [32:08<14:21,  5.35s/it]     66%|██████▋   | 315/475 [32:14<14:09,  5.31s/it]     67%|██████▋   | 316/475 [32:20<14:51,  5.61s/it]     67%|██████▋   | 317/475 [32:27<15:36,  5.93s/it]     67%|██████▋   | 318/475 [32:31<14:09,  5.41s/it]     67%|██████▋   | 319/475 [32:36<13:57,  5.37s/it]     67%|██████▋   | 320/475 [32:42<13:55,  5.39s/it]     68%|██████▊   | 321/475 [32:45<12:26,  4.85s/it]     68%|██████▊   | 322/475 [32:48<10:52,  4.27s/it]     68%|██████▊   | 323/475 [32:55<12:42,  5.02s/it]     68%|██████▊   | 324/475 [32:59<12:03,  4.79s/it]     68%|██████▊   | 325/475 [33:06<13:47,  5.52s/it]     69%|██████▊   | 326/475 [33:10<12:19,  4.96s/it]     69%|██████▉   | 327/475 [33:14<11:54,  4.83s/it]     69%|██████▉   | 328/475 [33:22<13:59,  5.71s/it]     69%|██████▉   | 329/475 [33:27<13:14,  5.44s/it]     69%|██████▉   | 330/475 [33:33<13:24,  5.55s/it]     70%|██████▉   | 331/475 [33:38<12:47,  5.33s/it]     70%|██████▉   | 332/475 [33:46<14:35,  6.12s/it]     70%|███████   | 333/475 [33:49<12:38,  5.35s/it]     70%|███████   | 334/475 [33:55<13:10,  5.61s/it]     71%|███████   | 335/475 [34:05<15:35,  6.68s/it]     71%|███████   | 336/475 [34:09<13:56,  6.02s/it]     71%|███████   | 337/475 [34:15<13:43,  5.97s/it]     71%|███████   | 338/475 [34:22<14:44,  6.46s/it]     71%|███████▏  | 339/475 [34:29<14:34,  6.43s/it]     72%|███████▏  | 340/475 [34:38<16:15,  7.23s/it]     72%|███████▏  | 341/475 [34:48<18:22,  8.23s/it]     72%|███████▏  | 342/475 [34:56<17:43,  7.99s/it]     72%|███████▏  | 343/475 [35:01<15:49,  7.19s/it]     72%|███████▏  | 344/475 [35:13<18:23,  8.42s/it]     73%|███████▎  | 345/475 [35:26<21:21,  9.86s/it]     73%|███████▎  | 346/475 [35:30<17:47,  8.28s/it]     73%|███████▎  | 347/475 [35:37<16:39,  7.81s/it]     73%|███████▎  | 348/475 [35:41<13:45,  6.50s/it]     73%|███████▎  | 349/475 [35:45<12:20,  5.88s/it]     74%|███████▎  | 350/475 [35:54<14:17,  6.86s/it]     74%|███████▍  | 351/475 [36:02<14:33,  7.05s/it]     74%|███████▍  | 352/475 [36:11<15:56,  7.78s/it]     74%|███████▍  | 353/475 [36:16<13:53,  6.83s/it]     75%|███████▍  | 354/475 [36:19<11:55,  5.91s/it]     75%|███████▍  | 355/475 [36:30<14:48,  7.41s/it]     75%|███████▍  | 356/475 [36:38<14:58,  7.55s/it]     75%|███████▌  | 357/475 [36:44<14:03,  7.15s/it]     75%|███████▌  | 358/475 [36:51<13:27,  6.90s/it]     76%|███████▌  | 359/475 [36:57<13:11,  6.82s/it]     76%|███████▌  | 360/475 [37:01<11:20,  5.92s/it]     76%|███████▌  | 361/475 [37:10<12:57,  6.82s/it]     76%|███████▌  | 362/475 [37:17<12:52,  6.83s/it]     76%|███████▋  | 363/475 [37:24<12:36,  6.75s/it]     77%|███████▋  | 364/475 [37:34<14:17,  7.72s/it]     77%|███████▋  | 365/475 [37:39<12:52,  7.03s/it]     77%|███████▋  | 366/475 [37:43<11:21,  6.25s/it]     77%|███████▋  | 367/475 [37:59<16:13,  9.02s/it]     77%|███████▋  | 368/475 [38:02<13:08,  7.37s/it]     78%|███████▊  | 369/475 [38:09<12:44,  7.21s/it]     78%|███████▊  | 370/475 [38:13<10:51,  6.20s/it]     78%|███████▊  | 371/475 [38:21<11:23,  6.57s/it]     78%|███████▊  | 372/475 [38:26<10:39,  6.21s/it]     79%|███████▊  | 373/475 [38:29<09:13,  5.42s/it]     79%|███████▊  | 374/475 [38:33<08:14,  4.90s/it]     79%|███████▉  | 375/475 [38:43<10:35,  6.35s/it]     79%|███████▉  | 376/475 [38:56<13:38,  8.27s/it]     79%|███████▉  | 377/475 [38:59<10:58,  6.72s/it]     80%|███████▉  | 378/475 [39:12<13:54,  8.60s/it]     80%|███████▉  | 379/475 [39:19<13:17,  8.31s/it]     80%|████████  | 380/475 [39:24<11:25,  7.22s/it]     80%|████████  | 381/475 [39:29<10:05,  6.44s/it]     80%|████████  | 382/475 [39:33<09:12,  5.94s/it]     81%|████████  | 383/475 [39:36<07:27,  4.87s/it]     81%|████████  | 384/475 [39:40<06:55,  4.57s/it]     81%|████████  | 385/475 [39:45<07:25,  4.95s/it]     81%|████████▏ | 386/475 [39:49<06:51,  4.63s/it]     81%|████████▏ | 387/475 [40:05<11:38,  7.94s/it]     82%|████████▏ | 388/475 [40:12<10:52,  7.50s/it]     82%|████████▏ | 389/475 [40:20<11:16,  7.87s/it]     82%|████████▏ | 390/475 [40:26<10:15,  7.24s/it]     82%|████████▏ | 391/475 [40:31<09:05,  6.49s/it]     83%|████████▎ | 392/475 [40:42<11:06,  8.03s/it]     83%|████████▎ | 393/475 [40:50<10:37,  7.78s/it]     83%|████████▎ | 394/475 [40:54<09:12,  6.82s/it]     83%|████████▎ | 395/475 [40:58<07:59,  5.99s/it]     83%|████████▎ | 396/475 [41:13<11:15,  8.56s/it]     84%|████████▎ | 397/475 [41:20<10:28,  8.05s/it]     84%|████████▍ | 398/475 [41:23<08:28,  6.60s/it]     84%|████████▍ | 399/475 [41:43<13:28, 10.64s/it]     84%|████████▍ | 400/475 [41:47<10:43,  8.59s/it]     84%|████████▍ | 401/475 [41:58<11:34,  9.38s/it]     85%|████████▍ | 402/475 [42:03<09:58,  8.20s/it]     85%|████████▍ | 403/475 [42:07<08:09,  6.80s/it]     85%|████████▌ | 404/475 [42:13<07:41,  6.51s/it]     85%|████████▌ | 405/475 [42:20<07:59,  6.85s/it]     85%|████████▌ | 406/475 [42:29<08:20,  7.26s/it]     86%|████████▌ | 407/475 [42:39<09:25,  8.31s/it]     86%|████████▌ | 408/475 [42:44<08:10,  7.32s/it]     86%|████████▌ | 409/475 [42:48<06:50,  6.23s/it]     86%|████████▋ | 410/475 [42:53<06:16,  5.80s/it]     87%|████████▋ | 411/475 [43:00<06:41,  6.28s/it]     87%|████████▋ | 412/475 [43:08<07:06,  6.77s/it]     87%|████████▋ | 413/475 [43:13<06:15,  6.06s/it]     87%|████████▋ | 414/475 [43:17<05:32,  5.45s/it]     87%|████████▋ | 415/475 [43:24<06:09,  6.16s/it]     88%|████████▊ | 416/475 [43:32<06:29,  6.61s/it]     88%|████████▊ | 417/475 [43:42<07:26,  7.70s/it]     88%|████████▊ | 418/475 [43:49<06:56,  7.31s/it]     88%|████████▊ | 419/475 [43:52<05:49,  6.23s/it]     88%|████████▊ | 420/475 [43:57<05:08,  5.60s/it]     89%|████████▊ | 421/475 [44:02<04:58,  5.53s/it]     89%|████████▉ | 422/475 [44:10<05:30,  6.23s/it]     89%|████████▉ | 423/475 [44:15<05:12,  6.01s/it]     89%|████████▉ | 424/475 [44:21<04:56,  5.81s/it]     89%|████████▉ | 425/475 [44:25<04:23,  5.27s/it]     90%|████████▉ | 426/475 [44:28<03:45,  4.61s/it]     90%|████████▉ | 427/475 [44:31<03:22,  4.22s/it]     90%|█████████ | 428/475 [44:48<06:18,  8.05s/it]     90%|█████████ | 429/475 [44:54<05:37,  7.34s/it]     91%|█████████ | 430/475 [45:05<06:22,  8.50s/it]     91%|█████████ | 431/475 [45:11<05:47,  7.89s/it]     91%|█████████ | 432/475 [45:38<09:43, 13.56s/it]     91%|█████████ | 433/475 [45:48<08:40, 12.39s/it]     91%|█████████▏| 434/475 [46:16<11:44, 17.17s/it]     92%|█████████▏| 435/475 [46:23<09:19, 13.99s/it]     92%|█████████▏| 436/475 [46:28<07:24, 11.39s/it]     92%|█████████▏| 437/475 [46:39<07:07, 11.25s/it]     92%|█████████▏| 438/475 [46:45<06:02,  9.80s/it]     92%|█████████▏| 439/475 [46:50<04:54,  8.19s/it]     93%|█████████▎| 440/475 [47:05<05:59, 10.28s/it]     93%|█████████▎| 441/475 [47:16<05:53, 10.40s/it]     93%|█████████▎| 442/475 [47:22<05:07,  9.31s/it]     93%|█████████▎| 443/475 [47:37<05:43, 10.75s/it]     93%|█████████▎| 444/475 [47:49<05:53, 11.41s/it]     94%|█████████▎| 445/475 [47:56<05:01, 10.04s/it]     94%|█████████▍| 446/475 [48:02<04:10,  8.63s/it]     94%|█████████▍| 447/475 [48:11<04:08,  8.87s/it]     94%|█████████▍| 448/475 [48:31<05:28, 12.15s/it]     95%|█████████▍| 449/475 [48:40<04:48, 11.10s/it]     95%|█████████▍| 450/475 [48:45<03:52,  9.32s/it]     95%|█████████▍| 451/475 [48:58<04:09, 10.41s/it]     95%|█████████▌| 452/475 [49:02<03:17,  8.57s/it]     95%|█████████▌| 453/475 [49:26<04:50, 13.22s/it]     96%|█████████▌| 454/475 [49:37<04:23, 12.55s/it]     96%|█████████▌| 455/475 [49:43<03:31, 10.59s/it]     96%|█████████▌| 456/475 [49:50<02:59,  9.43s/it]     96%|█████████▌| 457/475 [49:56<02:32,  8.46s/it]     96%|█████████▋| 458/475 [50:01<02:07,  7.50s/it]     97%|█████████▋| 459/475 [50:11<02:09,  8.11s/it]     97%|█████████▋| 460/475 [50:14<01:41,  6.76s/it]     97%|█████████▋| 461/475 [50:27<01:57,  8.41s/it]     97%|█████████▋| 462/475 [50:32<01:38,  7.59s/it]     97%|█████████▋| 463/475 [50:45<01:49,  9.12s/it]     98%|█████████▊| 464/475 [50:52<01:32,  8.44s/it]     98%|█████████▊| 465/475 [51:10<01:54, 11.43s/it]     98%|█████████▊| 466/475 [51:26<01:54, 12.73s/it]     98%|█████████▊| 467/475 [51:34<01:30, 11.33s/it]     99%|█████████▊| 468/475 [51:39<01:05,  9.40s/it]     99%|█████████▊| 469/475 [51:47<00:53,  9.00s/it]     99%|█████████▉| 470/475 [51:57<00:45,  9.16s/it]     99%|█████████▉| 471/475 [51:59<00:28,  7.13s/it]     99%|█████████▉| 472/475 [52:22<00:36, 12.00s/it]    100%|█████████▉| 473/475 [52:32<00:22, 11.16s/it]    100%|█████████▉| 474/475 [52:39<00:10, 10.03s/it]    100%|██████████| 475/475 [52:42<00:00,  8.00s/it]    100%|██████████| 475/475 [52:42<00:00,  6.66s/it]




.. GENERATED FROM PYTHON SOURCE LINES 287-309

.. figure:: MAPMRI_ng.png
   :align: center

On the left we see the overall NG and on the right the directional perpendicular
NG and parallel NG. The NG ranges from 1 (completely non-Gaussian) to 0
(completely Gaussian). The overall NG of a voxel is always higher or equal than
each of its components. It can be seen that NG has low values in the CSF and
higher in the white matter.

Increases or decreases in these values do not point to a specific
microstructural change, but can indicate clues as to what is happening, similar
to fractional anisotropy. An initial simulation study that quantifies the added
value of q-space indices over DTI indices is given in [Fick2016b]_.

The MAP-MRI framework also allows for the estimation of orientation distribution
functions (ODFs). We recommend to use the isotropic implementation for this
purpose, as the anisotropic implementation has a bias towards smaller crossing
angles.

For the isotropic basis we recommend to use a ``radial_order`` of 8, as the
basis needs more generic and needs more basis functions to approximate the
signal.

.. GENERATED FROM PYTHON SOURCE LINES 309-320

.. code-block:: default



    radial_order = 8
    map_model_both_iso = mapmri.MapmriModel(gtab, radial_order=radial_order,
                                            laplacian_regularization=True,
                                            laplacian_weighting=.1,
                                            positivity_constraint=True,
                                            anisotropic_scaling=False)

    mapfit_both_iso = map_model_both_iso.fit(data_small)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/475 [00:00<?, ?it/s]      0%|          | 1/475 [00:00<02:22,  3.32it/s]      0%|          | 2/475 [00:00<02:52,  2.74it/s]      1%|          | 3/475 [00:01<03:51,  2.04it/s]      1%|          | 4/475 [00:01<04:06,  1.91it/s]      1%|          | 5/475 [00:02<04:32,  1.72it/s]      1%|▏         | 6/475 [00:03<05:09,  1.52it/s]      1%|▏         | 7/475 [00:04<05:02,  1.55it/s]      2%|▏         | 8/475 [00:04<04:58,  1.57it/s]      2%|▏         | 9/475 [00:05<05:04,  1.53it/s]      2%|▏         | 10/475 [00:06<05:14,  1.48it/s]      2%|▏         | 11/475 [00:06<04:35,  1.69it/s]      3%|▎         | 12/475 [00:06<04:03,  1.90it/s]      3%|▎         | 13/475 [00:07<04:03,  1.90it/s]      3%|▎         | 14/475 [00:07<04:07,  1.86it/s]      3%|▎         | 15/475 [00:08<04:23,  1.75it/s]      3%|▎         | 16/475 [00:09<04:06,  1.86it/s]      4%|▎         | 17/475 [00:09<03:34,  2.13it/s]      4%|▍         | 18/475 [00:09<03:41,  2.07it/s]      4%|▍         | 19/475 [00:10<03:42,  2.05it/s]      4%|▍         | 20/475 [00:10<03:31,  2.15it/s]      4%|▍         | 21/475 [00:11<03:49,  1.98it/s]      5%|▍         | 22/475 [00:11<03:58,  1.90it/s]      5%|▍         | 23/475 [00:12<03:38,  2.07it/s]      5%|▌         | 24/475 [00:12<03:25,  2.20it/s]      5%|▌         | 25/475 [00:13<04:24,  1.70it/s]      5%|▌         | 26/475 [00:14<04:35,  1.63it/s]      6%|▌         | 27/475 [00:14<04:29,  1.66it/s]      6%|▌         | 28/475 [00:15<04:51,  1.53it/s]      6%|▌         | 29/475 [00:17<07:48,  1.05s/it]      6%|▋         | 30/475 [00:18<07:06,  1.04it/s]      7%|▋         | 31/475 [00:18<06:16,  1.18it/s]      7%|▋         | 32/475 [00:20<07:20,  1.01it/s]      7%|▋         | 33/475 [00:20<05:47,  1.27it/s]      7%|▋         | 34/475 [00:21<05:36,  1.31it/s]      7%|▋         | 35/475 [00:21<04:53,  1.50it/s]      8%|▊         | 36/475 [00:22<04:12,  1.74it/s]      8%|▊         | 37/475 [00:22<04:08,  1.76it/s]      8%|▊         | 38/475 [00:22<03:36,  2.02it/s]      8%|▊         | 39/475 [00:23<02:59,  2.43it/s]      8%|▊         | 40/475 [00:23<03:19,  2.18it/s]      9%|▊         | 41/475 [00:24<03:20,  2.17it/s]      9%|▉         | 42/475 [00:24<03:26,  2.10it/s]      9%|▉         | 43/475 [00:25<03:24,  2.11it/s]      9%|▉         | 44/475 [00:26<04:34,  1.57it/s]      9%|▉         | 45/475 [00:27<04:57,  1.45it/s]     10%|▉         | 46/475 [00:27<05:04,  1.41it/s]     10%|▉         | 47/475 [00:28<04:39,  1.53it/s]     10%|█         | 48/475 [00:28<04:03,  1.75it/s]     10%|█         | 49/475 [00:29<03:55,  1.81it/s]     11%|█         | 50/475 [00:29<04:06,  1.72it/s]     11%|█         | 51/475 [00:30<03:22,  2.10it/s]     11%|█         | 52/475 [00:30<03:32,  1.99it/s]     11%|█         | 53/475 [00:31<03:51,  1.82it/s]     11%|█▏        | 54/475 [00:31<03:31,  1.99it/s]     12%|█▏        | 55/475 [00:31<02:45,  2.54it/s]     12%|█▏        | 56/475 [00:32<02:22,  2.93it/s]     12%|█▏        | 57/475 [00:32<03:06,  2.24it/s]     12%|█▏        | 58/475 [00:33<02:57,  2.36it/s]     12%|█▏        | 59/475 [00:33<02:25,  2.86it/s]     13%|█▎        | 60/475 [00:33<02:12,  3.13it/s]     13%|█▎        | 61/475 [00:34<03:21,  2.06it/s]     13%|█▎        | 62/475 [00:34<03:15,  2.12it/s]     13%|█▎        | 63/475 [00:35<03:58,  1.73it/s]     13%|█▎        | 64/475 [00:36<03:38,  1.88it/s]     14%|█▎        | 65/475 [00:36<03:48,  1.80it/s]     14%|█▍        | 66/475 [00:37<03:32,  1.93it/s]     14%|█▍        | 67/475 [00:37<04:03,  1.68it/s]     14%|█▍        | 68/475 [00:38<03:33,  1.90it/s]     15%|█▍        | 69/475 [00:38<03:11,  2.12it/s]     15%|█▍        | 70/475 [00:38<02:38,  2.55it/s]     15%|█▍        | 71/475 [00:39<02:39,  2.53it/s]     15%|█▌        | 72/475 [00:39<02:30,  2.68it/s]     15%|█▌        | 73/475 [00:39<02:02,  3.28it/s]     16%|█▌        | 74/475 [00:39<01:43,  3.88it/s]     16%|█▌        | 75/475 [00:40<02:15,  2.95it/s]     16%|█▌        | 76/475 [00:40<02:31,  2.63it/s]     16%|█▌        | 77/475 [00:41<02:26,  2.72it/s]     16%|█▋        | 78/475 [00:41<02:11,  3.02it/s]     17%|█▋        | 79/475 [00:41<02:00,  3.30it/s]     17%|█▋        | 80/475 [00:42<02:01,  3.25it/s]     17%|█▋        | 81/475 [00:42<02:56,  2.23it/s]     17%|█▋        | 82/475 [00:43<03:01,  2.16it/s]     17%|█▋        | 83/475 [00:44<03:29,  1.87it/s]     18%|█▊        | 84/475 [00:44<03:45,  1.74it/s]     18%|█▊        | 85/475 [00:45<03:15,  1.99it/s]     18%|█▊        | 86/475 [00:45<02:59,  2.17it/s]     18%|█▊        | 87/475 [00:45<02:39,  2.44it/s]     19%|█▊        | 88/475 [00:45<02:20,  2.75it/s]     19%|█▊        | 89/475 [00:46<01:57,  3.28it/s]     19%|█▉        | 90/475 [00:46<01:44,  3.68it/s]     19%|█▉        | 91/475 [00:46<01:30,  4.26it/s]     19%|█▉        | 92/475 [00:46<01:19,  4.81it/s]     20%|█▉        | 93/475 [00:47<01:48,  3.51it/s]     20%|█▉        | 94/475 [00:47<01:50,  3.45it/s]     20%|██        | 95/475 [00:47<02:13,  2.84it/s]     20%|██        | 96/475 [00:48<02:15,  2.80it/s]     20%|██        | 97/475 [00:48<02:07,  2.96it/s]     21%|██        | 98/475 [00:49<02:36,  2.41it/s]     21%|██        | 99/475 [00:49<02:35,  2.42it/s]     21%|██        | 100/475 [00:50<02:59,  2.09it/s]     21%|██▏       | 101/475 [00:50<02:33,  2.44it/s]     21%|██▏       | 102/475 [00:50<02:25,  2.57it/s]     22%|██▏       | 103/475 [00:51<02:23,  2.60it/s]     22%|██▏       | 104/475 [00:51<02:23,  2.59it/s]     22%|██▏       | 105/475 [00:52<03:04,  2.00it/s]     22%|██▏       | 106/475 [00:52<03:05,  1.99it/s]     23%|██▎       | 107/475 [00:52<02:31,  2.42it/s]     23%|██▎       | 108/475 [00:53<02:01,  3.02it/s]     23%|██▎       | 109/475 [00:53<01:43,  3.52it/s]     23%|██▎       | 110/475 [00:53<01:32,  3.96it/s]     23%|██▎       | 111/475 [00:53<01:23,  4.36it/s]     24%|██▎       | 112/475 [00:54<01:47,  3.39it/s]     24%|██▍       | 113/475 [00:54<01:53,  3.19it/s]     24%|██▍       | 114/475 [00:55<02:39,  2.26it/s]     24%|██▍       | 115/475 [00:55<02:19,  2.58it/s]     24%|██▍       | 116/475 [00:55<02:05,  2.87it/s]     25%|██▍       | 117/475 [00:55<01:54,  3.13it/s]     25%|██▍       | 118/475 [00:56<02:01,  2.94it/s]     25%|██▌       | 119/475 [00:56<02:09,  2.74it/s]     25%|██▌       | 120/475 [00:57<02:13,  2.67it/s]     25%|██▌       | 121/475 [00:57<02:55,  2.02it/s]     26%|██▌       | 122/475 [00:58<03:13,  1.82it/s]     26%|██▌       | 123/475 [00:58<02:40,  2.20it/s]     26%|██▌       | 124/475 [00:59<02:17,  2.56it/s]     26%|██▋       | 125/475 [00:59<01:56,  3.01it/s]     27%|██▋       | 126/475 [00:59<01:38,  3.53it/s]     27%|██▋       | 127/475 [00:59<01:23,  4.18it/s]     27%|██▋       | 128/475 [00:59<01:15,  4.62it/s]     27%|██▋       | 129/475 [00:59<01:10,  4.90it/s]     27%|██▋       | 130/475 [01:00<01:10,  4.91it/s]     28%|██▊       | 131/475 [01:00<01:18,  4.39it/s]     28%|██▊       | 132/475 [01:00<01:43,  3.31it/s]     28%|██▊       | 133/475 [01:01<01:56,  2.93it/s]     28%|██▊       | 134/475 [01:01<02:06,  2.69it/s]     28%|██▊       | 135/475 [01:02<02:08,  2.64it/s]     29%|██▊       | 136/475 [01:02<02:13,  2.53it/s]     29%|██▉       | 137/475 [01:03<02:22,  2.37it/s]     29%|██▉       | 138/475 [01:03<02:18,  2.43it/s]     29%|██▉       | 139/475 [01:04<03:07,  1.79it/s]     29%|██▉       | 140/475 [01:04<02:51,  1.96it/s]     30%|██▉       | 141/475 [01:05<02:34,  2.16it/s]     30%|██▉       | 142/475 [01:05<02:11,  2.54it/s]     30%|███       | 143/475 [01:05<01:48,  3.06it/s]     30%|███       | 144/475 [01:05<01:33,  3.54it/s]     31%|███       | 145/475 [01:05<01:19,  4.15it/s]     31%|███       | 146/475 [01:05<01:10,  4.65it/s]     31%|███       | 147/475 [01:06<01:07,  4.89it/s]     31%|███       | 148/475 [01:06<01:01,  5.30it/s]     31%|███▏      | 149/475 [01:06<01:05,  4.99it/s]     32%|███▏      | 150/475 [01:06<01:11,  4.54it/s]     32%|███▏      | 151/475 [01:07<01:27,  3.72it/s]     32%|███▏      | 152/475 [01:07<01:35,  3.40it/s]     32%|███▏      | 153/475 [01:07<01:23,  3.87it/s]     32%|███▏      | 154/475 [01:07<01:12,  4.40it/s]     33%|███▎      | 155/475 [01:08<01:07,  4.71it/s]     33%|███▎      | 156/475 [01:08<01:06,  4.76it/s]     33%|███▎      | 157/475 [01:08<01:10,  4.52it/s]     33%|███▎      | 158/475 [01:09<01:50,  2.86it/s]     33%|███▎      | 159/475 [01:09<01:44,  3.02it/s]     34%|███▎      | 160/475 [01:09<01:46,  2.95it/s]     34%|███▍      | 161/475 [01:10<01:41,  3.09it/s]     34%|███▍      | 162/475 [01:10<01:37,  3.21it/s]     34%|███▍      | 163/475 [01:10<01:44,  2.99it/s]     35%|███▍      | 164/475 [01:11<01:41,  3.05it/s]     35%|███▍      | 165/475 [01:11<01:25,  3.63it/s]     35%|███▍      | 166/475 [01:11<01:12,  4.29it/s]     35%|███▌      | 167/475 [01:11<01:04,  4.81it/s]     35%|███▌      | 168/475 [01:11<01:06,  4.60it/s]     36%|███▌      | 169/475 [01:12<01:31,  3.35it/s]     36%|███▌      | 170/475 [01:12<01:47,  2.83it/s]     36%|███▌      | 171/475 [01:13<02:07,  2.39it/s]     36%|███▌      | 172/475 [01:13<01:54,  2.65it/s]     36%|███▋      | 173/475 [01:13<01:42,  2.95it/s]     37%|███▋      | 174/475 [01:14<01:42,  2.94it/s]     37%|███▋      | 175/475 [01:14<01:44,  2.87it/s]     37%|███▋      | 176/475 [01:15<02:07,  2.35it/s]     37%|███▋      | 177/475 [01:15<02:23,  2.08it/s]     37%|███▋      | 178/475 [01:16<02:41,  1.84it/s]     38%|███▊      | 179/475 [01:16<02:13,  2.21it/s]     38%|███▊      | 180/475 [01:17<02:01,  2.42it/s]     38%|███▊      | 181/475 [01:17<01:55,  2.54it/s]     38%|███▊      | 182/475 [01:17<01:47,  2.73it/s]     39%|███▊      | 183/475 [01:17<01:40,  2.91it/s]     39%|███▊      | 184/475 [01:18<01:26,  3.35it/s]     39%|███▉      | 185/475 [01:18<01:14,  3.90it/s]     39%|███▉      | 186/475 [01:18<01:03,  4.53it/s]     39%|███▉      | 187/475 [01:18<01:32,  3.12it/s]     40%|███▉      | 188/475 [01:19<01:38,  2.90it/s]     40%|███▉      | 189/475 [01:20<02:20,  2.03it/s]     40%|████      | 190/475 [01:20<02:21,  2.01it/s]     40%|████      | 191/475 [01:21<02:31,  1.87it/s]     40%|████      | 192/475 [01:21<02:13,  2.12it/s]     41%|████      | 193/475 [01:22<02:08,  2.19it/s]     41%|████      | 194/475 [01:22<02:19,  2.02it/s]     41%|████      | 195/475 [01:23<02:08,  2.18it/s]     41%|████▏     | 196/475 [01:23<01:58,  2.35it/s]     41%|████▏     | 197/475 [01:23<01:49,  2.53it/s]     42%|████▏     | 198/475 [01:24<02:13,  2.07it/s]     42%|████▏     | 199/475 [01:24<01:52,  2.45it/s]     42%|████▏     | 200/475 [01:24<01:41,  2.72it/s]     42%|████▏     | 201/475 [01:25<01:29,  3.07it/s]     43%|████▎     | 202/475 [01:25<01:14,  3.68it/s]     43%|████▎     | 203/475 [01:25<01:08,  3.99it/s]     43%|████▎     | 204/475 [01:25<00:58,  4.61it/s]     43%|████▎     | 205/475 [01:25<00:54,  4.96it/s]     43%|████▎     | 206/475 [01:25<00:50,  5.28it/s]     44%|████▎     | 207/475 [01:27<02:06,  2.11it/s]     44%|████▍     | 208/475 [01:27<01:53,  2.34it/s]     44%|████▍     | 209/475 [01:27<01:45,  2.52it/s]     44%|████▍     | 210/475 [01:28<01:40,  2.63it/s]     44%|████▍     | 211/475 [01:28<01:42,  2.58it/s]     45%|████▍     | 212/475 [01:28<01:45,  2.50it/s]     45%|████▍     | 213/475 [01:29<01:42,  2.56it/s]     45%|████▌     | 214/475 [01:29<01:42,  2.54it/s]     45%|████▌     | 215/475 [01:30<01:50,  2.35it/s]     45%|████▌     | 216/475 [01:30<01:48,  2.38it/s]     46%|████▌     | 217/475 [01:30<01:46,  2.42it/s]     46%|████▌     | 218/475 [01:31<01:37,  2.65it/s]     46%|████▌     | 219/475 [01:31<01:31,  2.81it/s]     46%|████▋     | 220/475 [01:32<01:58,  2.16it/s]     47%|████▋     | 221/475 [01:32<01:43,  2.46it/s]     47%|████▋     | 222/475 [01:32<01:23,  3.02it/s]     47%|████▋     | 223/475 [01:32<01:10,  3.58it/s]     47%|████▋     | 224/475 [01:33<00:59,  4.20it/s]     47%|████▋     | 225/475 [01:33<00:52,  4.79it/s]     48%|████▊     | 226/475 [01:33<01:09,  3.60it/s]     48%|████▊     | 227/475 [01:34<01:19,  3.11it/s]     48%|████▊     | 228/475 [01:34<01:47,  2.29it/s]     48%|████▊     | 229/475 [01:35<01:44,  2.36it/s]     48%|████▊     | 230/475 [01:35<01:46,  2.29it/s]     49%|████▊     | 231/475 [01:36<01:43,  2.35it/s]     49%|████▉     | 232/475 [01:36<01:39,  2.45it/s]     49%|████▉     | 233/475 [01:37<02:07,  1.90it/s]     49%|████▉     | 234/475 [01:37<02:06,  1.91it/s]     49%|████▉     | 235/475 [01:38<02:14,  1.78it/s]     50%|████▉     | 236/475 [01:38<02:14,  1.78it/s]     50%|████▉     | 237/475 [01:39<02:09,  1.84it/s]     50%|█████     | 238/475 [01:39<01:53,  2.08it/s]     50%|█████     | 239/475 [01:40<01:40,  2.34it/s]     51%|█████     | 240/475 [01:40<01:55,  2.03it/s]     51%|█████     | 241/475 [01:40<01:36,  2.42it/s]     51%|█████     | 242/475 [01:41<01:17,  3.02it/s]     51%|█████     | 243/475 [01:41<01:04,  3.58it/s]     51%|█████▏    | 244/475 [01:41<00:57,  4.00it/s]     52%|█████▏    | 245/475 [01:41<00:50,  4.55it/s]     52%|█████▏    | 246/475 [01:42<01:25,  2.68it/s]     52%|█████▏    | 247/475 [01:42<01:27,  2.62it/s]     52%|█████▏    | 248/475 [01:42<01:18,  2.88it/s]     52%|█████▏    | 249/475 [01:43<01:17,  2.93it/s]     53%|█████▎    | 250/475 [01:44<01:55,  1.95it/s]     53%|█████▎    | 251/475 [01:45<02:27,  1.52it/s]     53%|█████▎    | 252/475 [01:45<02:15,  1.64it/s]     53%|█████▎    | 253/475 [01:46<02:24,  1.54it/s]     53%|█████▎    | 254/475 [01:47<02:32,  1.45it/s]     54%|█████▎    | 255/475 [01:47<02:26,  1.50it/s]     54%|█████▍    | 256/475 [01:48<02:07,  1.71it/s]     54%|█████▍    | 257/475 [01:48<02:12,  1.64it/s]     54%|█████▍    | 258/475 [01:49<02:01,  1.78it/s]     55%|█████▍    | 259/475 [01:49<01:52,  1.93it/s]     55%|█████▍    | 260/475 [01:50<01:44,  2.05it/s]     55%|█████▍    | 261/475 [01:50<01:36,  2.23it/s]     55%|█████▌    | 262/475 [01:50<01:33,  2.28it/s]     55%|█████▌    | 263/475 [01:51<01:18,  2.71it/s]     56%|█████▌    | 264/475 [01:51<01:04,  3.29it/s]     56%|█████▌    | 265/475 [01:51<01:04,  3.26it/s]     56%|█████▌    | 266/475 [01:52<01:10,  2.95it/s]     56%|█████▌    | 267/475 [01:52<01:08,  3.02it/s]     56%|█████▋    | 268/475 [01:52<00:58,  3.57it/s]     57%|█████▋    | 269/475 [01:53<01:25,  2.41it/s]     57%|█████▋    | 270/475 [01:53<01:30,  2.27it/s]     57%|█████▋    | 271/475 [01:54<01:38,  2.08it/s]     57%|█████▋    | 272/475 [01:55<02:01,  1.67it/s]     57%|█████▋    | 273/475 [01:55<02:04,  1.63it/s]     58%|█████▊    | 274/475 [01:56<02:05,  1.61it/s]     58%|█████▊    | 275/475 [01:56<01:54,  1.74it/s]     58%|█████▊    | 276/475 [01:57<02:04,  1.59it/s]     58%|█████▊    | 277/475 [01:58<02:18,  1.43it/s]     59%|█████▊    | 278/475 [01:59<02:27,  1.34it/s]     59%|█████▊    | 279/475 [01:59<02:14,  1.45it/s]     59%|█████▉    | 280/475 [02:00<01:55,  1.68it/s]     59%|█████▉    | 281/475 [02:00<01:48,  1.79it/s]     59%|█████▉    | 282/475 [02:01<01:41,  1.90it/s]     60%|█████▉    | 283/475 [02:01<01:20,  2.37it/s]     60%|█████▉    | 284/475 [02:01<01:12,  2.62it/s]     60%|██████    | 285/475 [02:02<01:11,  2.66it/s]     60%|██████    | 286/475 [02:02<01:04,  2.93it/s]     60%|██████    | 287/475 [02:02<01:07,  2.80it/s]     61%|██████    | 288/475 [02:03<01:04,  2.90it/s]     61%|██████    | 289/475 [02:03<01:01,  3.01it/s]     61%|██████    | 290/475 [02:03<01:04,  2.88it/s]     61%|██████▏   | 291/475 [02:04<01:30,  2.03it/s]     61%|██████▏   | 292/475 [02:05<02:06,  1.45it/s]     62%|██████▏   | 293/475 [02:06<01:51,  1.63it/s]     62%|██████▏   | 294/475 [02:07<02:11,  1.37it/s]     62%|██████▏   | 295/475 [02:07<02:00,  1.50it/s]     62%|██████▏   | 296/475 [02:08<01:56,  1.53it/s]     63%|██████▎   | 297/475 [02:09<02:02,  1.45it/s]     63%|██████▎   | 298/475 [02:10<02:16,  1.30it/s]     63%|██████▎   | 299/475 [02:10<02:13,  1.32it/s]     63%|██████▎   | 300/475 [02:11<02:03,  1.42it/s]     63%|██████▎   | 301/475 [02:11<01:43,  1.68it/s]     64%|██████▎   | 302/475 [02:12<01:44,  1.66it/s]     64%|██████▍   | 303/475 [02:12<01:38,  1.75it/s]     64%|██████▍   | 304/475 [02:13<01:27,  1.95it/s]     64%|██████▍   | 305/475 [02:13<01:18,  2.16it/s]     64%|██████▍   | 306/475 [02:13<01:12,  2.34it/s]     65%|██████▍   | 307/475 [02:14<01:00,  2.77it/s]     65%|██████▍   | 308/475 [02:14<01:01,  2.74it/s]     65%|██████▌   | 309/475 [02:14<00:57,  2.91it/s]     65%|██████▌   | 310/475 [02:15<01:06,  2.47it/s]     65%|██████▌   | 311/475 [02:16<01:22,  1.98it/s]     66%|██████▌   | 312/475 [02:16<01:19,  2.06it/s]     66%|██████▌   | 313/475 [02:17<01:23,  1.95it/s]     66%|██████▌   | 314/475 [02:17<01:31,  1.76it/s]     66%|██████▋   | 315/475 [02:18<01:16,  2.10it/s]     67%|██████▋   | 316/475 [02:18<01:19,  2.00it/s]     67%|██████▋   | 317/475 [02:18<01:14,  2.13it/s]     67%|██████▋   | 318/475 [02:19<01:10,  2.24it/s]     67%|██████▋   | 319/475 [02:19<01:18,  1.99it/s]     67%|██████▋   | 320/475 [02:20<01:15,  2.05it/s]     68%|██████▊   | 321/475 [02:20<01:14,  2.08it/s]     68%|██████▊   | 322/475 [02:21<01:10,  2.18it/s]     68%|██████▊   | 323/475 [02:21<01:06,  2.27it/s]     68%|██████▊   | 324/475 [02:22<01:04,  2.35it/s]     68%|██████▊   | 325/475 [02:22<01:05,  2.31it/s]     69%|██████▊   | 326/475 [02:22<01:00,  2.48it/s]     69%|██████▉   | 327/475 [02:23<01:05,  2.27it/s]     69%|██████▉   | 328/475 [02:23<01:02,  2.35it/s]     69%|██████▉   | 329/475 [02:24<01:11,  2.04it/s]     69%|██████▉   | 330/475 [02:25<01:31,  1.59it/s]     70%|██████▉   | 331/475 [02:25<01:25,  1.68it/s]     70%|██████▉   | 332/475 [02:26<01:30,  1.58it/s]     70%|███████   | 333/475 [02:27<01:24,  1.69it/s]     70%|███████   | 334/475 [02:27<01:06,  2.11it/s]     71%|███████   | 335/475 [02:28<01:21,  1.72it/s]     71%|███████   | 336/475 [02:28<01:19,  1.76it/s]     71%|███████   | 337/475 [02:29<01:19,  1.74it/s]     71%|███████   | 338/475 [02:29<01:08,  2.01it/s]     71%|███████▏  | 339/475 [02:29<01:02,  2.18it/s]     72%|███████▏  | 340/475 [02:30<00:57,  2.36it/s]     72%|███████▏  | 341/475 [02:30<00:52,  2.55it/s]     72%|███████▏  | 342/475 [02:30<00:47,  2.78it/s]     72%|███████▏  | 343/475 [02:31<00:49,  2.65it/s]     72%|███████▏  | 344/475 [02:31<00:49,  2.67it/s]     73%|███████▎  | 345/475 [02:31<00:43,  3.02it/s]     73%|███████▎  | 346/475 [02:32<00:45,  2.83it/s]     73%|███████▎  | 347/475 [02:32<00:49,  2.60it/s]     73%|███████▎  | 348/475 [02:33<01:04,  1.96it/s]     73%|███████▎  | 349/475 [02:34<01:01,  2.04it/s]     74%|███████▎  | 350/475 [02:34<01:15,  1.65it/s]     74%|███████▍  | 351/475 [02:35<01:21,  1.53it/s]     74%|███████▍  | 352/475 [02:36<01:15,  1.64it/s]     74%|███████▍  | 353/475 [02:36<01:00,  2.00it/s]     75%|███████▍  | 354/475 [02:36<00:58,  2.07it/s]     75%|███████▍  | 355/475 [02:37<00:50,  2.39it/s]     75%|███████▍  | 356/475 [02:37<00:46,  2.58it/s]     75%|███████▌  | 357/475 [02:38<01:19,  1.49it/s]     75%|███████▌  | 358/475 [02:39<01:07,  1.72it/s]     76%|███████▌  | 359/475 [02:39<00:56,  2.04it/s]     76%|███████▌  | 360/475 [02:40<01:02,  1.84it/s]     76%|███████▌  | 361/475 [02:40<00:53,  2.13it/s]     76%|███████▌  | 362/475 [02:40<00:48,  2.31it/s]     76%|███████▋  | 363/475 [02:41<00:46,  2.43it/s]     77%|███████▋  | 364/475 [02:41<00:40,  2.75it/s]     77%|███████▋  | 365/475 [02:41<00:35,  3.10it/s]     77%|███████▋  | 366/475 [02:41<00:34,  3.14it/s]     77%|███████▋  | 367/475 [02:42<00:34,  3.09it/s]     77%|███████▋  | 368/475 [02:42<00:34,  3.10it/s]     78%|███████▊  | 369/475 [02:42<00:34,  3.05it/s]     78%|███████▊  | 370/475 [02:43<00:49,  2.10it/s]     78%|███████▊  | 371/475 [02:43<00:42,  2.46it/s]     78%|███████▊  | 372/475 [02:44<00:46,  2.19it/s]     79%|███████▊  | 373/475 [02:44<00:43,  2.35it/s]     79%|███████▊  | 374/475 [02:45<00:41,  2.41it/s]     79%|███████▉  | 375/475 [02:45<00:38,  2.58it/s]     79%|███████▉  | 376/475 [02:45<00:35,  2.80it/s]     79%|███████▉  | 377/475 [02:46<00:32,  2.99it/s]     80%|███████▉  | 378/475 [02:46<00:33,  2.89it/s]     80%|███████▉  | 379/475 [02:47<00:50,  1.90it/s]     80%|████████  | 380/475 [02:47<00:43,  2.16it/s]     80%|████████  | 381/475 [02:48<00:36,  2.58it/s]     80%|████████  | 382/475 [02:48<00:35,  2.60it/s]     81%|████████  | 383/475 [02:49<00:41,  2.20it/s]     81%|████████  | 384/475 [02:49<00:42,  2.16it/s]     81%|████████  | 385/475 [02:49<00:40,  2.22it/s]     81%|████████▏ | 386/475 [02:50<00:39,  2.25it/s]     81%|████████▏ | 387/475 [02:50<00:39,  2.25it/s]     82%|████████▏ | 388/475 [02:51<00:37,  2.30it/s]     82%|████████▏ | 389/475 [02:51<00:45,  1.90it/s]     82%|████████▏ | 390/475 [02:52<00:39,  2.14it/s]     82%|████████▏ | 391/475 [02:52<00:39,  2.15it/s]     83%|████████▎ | 392/475 [02:53<00:39,  2.12it/s]     83%|████████▎ | 393/475 [02:53<00:35,  2.33it/s]     83%|████████▎ | 394/475 [02:53<00:31,  2.60it/s]     83%|████████▎ | 395/475 [02:54<00:30,  2.60it/s]     83%|████████▎ | 396/475 [02:54<00:29,  2.70it/s]     84%|████████▎ | 397/475 [02:54<00:29,  2.64it/s]     84%|████████▍ | 398/475 [02:55<00:31,  2.47it/s]     84%|████████▍ | 399/475 [02:55<00:30,  2.52it/s]     84%|████████▍ | 400/475 [02:56<00:34,  2.20it/s]     84%|████████▍ | 401/475 [02:56<00:35,  2.11it/s]     85%|████████▍ | 402/475 [02:57<00:37,  1.96it/s]     85%|████████▍ | 403/475 [02:57<00:33,  2.12it/s]     85%|████████▌ | 404/475 [02:58<00:32,  2.20it/s]     85%|████████▌ | 405/475 [02:58<00:30,  2.31it/s]     85%|████████▌ | 406/475 [02:59<00:29,  2.38it/s]     86%|████████▌ | 407/475 [02:59<00:28,  2.42it/s]     86%|████████▌ | 408/475 [02:59<00:27,  2.42it/s]     86%|████████▌ | 409/475 [03:00<00:25,  2.57it/s]     86%|████████▋ | 410/475 [03:00<00:24,  2.64it/s]     87%|████████▋ | 411/475 [03:01<00:31,  2.06it/s]     87%|████████▋ | 412/475 [03:01<00:26,  2.41it/s]     87%|████████▋ | 413/475 [03:01<00:23,  2.69it/s]     87%|████████▋ | 414/475 [03:02<00:24,  2.48it/s]     87%|████████▋ | 415/475 [03:02<00:23,  2.61it/s]     88%|████████▊ | 416/475 [03:03<00:27,  2.12it/s]     88%|████████▊ | 417/475 [03:04<00:33,  1.74it/s]     88%|████████▊ | 418/475 [03:04<00:33,  1.72it/s]     88%|████████▊ | 419/475 [03:05<00:32,  1.74it/s]     88%|████████▊ | 420/475 [03:05<00:29,  1.85it/s]     89%|████████▊ | 421/475 [03:06<00:27,  1.98it/s]     89%|████████▉ | 422/475 [03:06<00:28,  1.83it/s]     89%|████████▉ | 423/475 [03:07<00:23,  2.24it/s]     89%|████████▉ | 424/475 [03:07<00:20,  2.54it/s]     89%|████████▉ | 425/475 [03:07<00:22,  2.19it/s]     90%|████████▉ | 426/475 [03:08<00:24,  2.02it/s]     90%|████████▉ | 427/475 [03:08<00:19,  2.42it/s]     90%|█████████ | 428/475 [03:08<00:17,  2.75it/s]     90%|█████████ | 429/475 [03:09<00:16,  2.73it/s]     91%|█████████ | 430/475 [03:09<00:19,  2.26it/s]     91%|█████████ | 431/475 [03:10<00:19,  2.31it/s]     91%|█████████ | 432/475 [03:10<00:17,  2.52it/s]     91%|█████████ | 433/475 [03:11<00:18,  2.30it/s]     91%|█████████▏| 434/475 [03:11<00:19,  2.07it/s]     92%|█████████▏| 435/475 [03:12<00:18,  2.12it/s]     92%|█████████▏| 436/475 [03:12<00:18,  2.12it/s]     92%|█████████▏| 437/475 [03:13<00:19,  1.97it/s]     92%|█████████▏| 438/475 [03:13<00:16,  2.31it/s]     92%|█████████▏| 439/475 [03:13<00:15,  2.34it/s]     93%|█████████▎| 440/475 [03:14<00:14,  2.36it/s]     93%|█████████▎| 441/475 [03:14<00:14,  2.28it/s]     93%|█████████▎| 442/475 [03:15<00:13,  2.40it/s]     93%|█████████▎| 443/475 [03:15<00:12,  2.56it/s]     93%|█████████▎| 444/475 [03:15<00:11,  2.60it/s]     94%|█████████▎| 445/475 [03:16<00:12,  2.40it/s]     94%|█████████▍| 446/475 [03:16<00:11,  2.62it/s]     94%|█████████▍| 447/475 [03:17<00:10,  2.72it/s]     94%|█████████▍| 448/475 [03:17<00:09,  2.99it/s]     95%|█████████▍| 449/475 [03:17<00:09,  2.79it/s]     95%|█████████▍| 450/475 [03:18<00:09,  2.76it/s]     95%|█████████▍| 451/475 [03:18<00:08,  2.87it/s]     95%|█████████▌| 452/475 [03:19<00:10,  2.20it/s]     95%|█████████▌| 453/475 [03:20<00:13,  1.69it/s]     96%|█████████▌| 454/475 [03:20<00:11,  1.87it/s]     96%|█████████▌| 455/475 [03:20<00:09,  2.08it/s]     96%|█████████▌| 456/475 [03:21<00:08,  2.34it/s]     96%|█████████▌| 457/475 [03:21<00:06,  2.57it/s]     96%|█████████▋| 458/475 [03:21<00:06,  2.58it/s]     97%|█████████▋| 459/475 [03:22<00:06,  2.66it/s]     97%|█████████▋| 460/475 [03:22<00:05,  2.83it/s]     97%|█████████▋| 461/475 [03:22<00:05,  2.75it/s]     97%|█████████▋| 462/475 [03:23<00:04,  2.64it/s]     97%|█████████▋| 463/475 [03:23<00:04,  2.87it/s]     98%|█████████▊| 464/475 [03:23<00:03,  2.84it/s]     98%|█████████▊| 465/475 [03:24<00:03,  2.97it/s]     98%|█████████▊| 466/475 [03:24<00:03,  2.79it/s]     98%|█████████▊| 467/475 [03:24<00:02,  2.82it/s]     99%|█████████▊| 468/475 [03:25<00:02,  2.84it/s]     99%|█████████▊| 469/475 [03:25<00:02,  2.81it/s]     99%|█████████▉| 470/475 [03:25<00:01,  2.86it/s]     99%|█████████▉| 471/475 [03:26<00:01,  2.32it/s]     99%|█████████▉| 472/475 [03:27<00:01,  1.81it/s]    100%|█████████▉| 473/475 [03:27<00:00,  2.01it/s]    100%|█████████▉| 474/475 [03:28<00:00,  1.90it/s]    100%|██████████| 475/475 [03:28<00:00,  1.81it/s]    100%|██████████| 475/475 [03:28<00:00,  2.27it/s]




.. GENERATED FROM PYTHON SOURCE LINES 321-322

Load an ODF reconstruction sphere.

.. GENERATED FROM PYTHON SOURCE LINES 322-326

.. code-block:: default



    sphere = get_sphere('repulsion724')








.. GENERATED FROM PYTHON SOURCE LINES 327-331

Compute the ODFs.

The radial order ``s`` can be increased to sharpen the results, but it might
also make the ODFs noisier. Always check the results visually.

.. GENERATED FROM PYTHON SOURCE LINES 331-336

.. code-block:: default



    odf = mapfit_both_iso.odf(sphere, s=2)
    print('odf.shape (%d, %d, %d, %d)' % odf.shape)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    odf.shape (25, 1, 19, 724)




.. GENERATED FROM PYTHON SOURCE LINES 337-338

Display the ODFs.

.. GENERATED FROM PYTHON SOURCE LINES 338-352

.. code-block:: default



    # Enables/disables interactive visualization
    interactive = False

    scene = window.Scene()
    sfu = actor.odf_slicer(odf, sphere=sphere, colormap='plasma', scale=0.5)
    sfu.display(y=0)
    sfu.RotateX(-90)
    scene.add(sfu)
    window.record(scene, out_path='odfs.png', size=(600, 600))
    if interactive:
        window.show(scene)




.. image-sg:: /examples_built/reconstruction/images/sphx_glr_reconst_mapmri_005.png
   :alt: reconst mapmri
   :srcset: /examples_built/reconstruction/images/sphx_glr_reconst_mapmri_005.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 353-387

.. figure:: odfs.png
   :align: center

   Orientation distribution functions (ODFs).

References
----------

.. [Ozarslan2013] Ozarslan E. et al., "Mean apparent propagator (MAP) MRI: A
   novel diffusion imaging method for mapping tissue microstructure",
   NeuroImage, 2013.

.. [Fick2016a] Fick, Rutger HJ, et al. "MAPL: Tissue microstructure estimation
   using Laplacian-regularized MAP-MRI and its application to HCP data."
   NeuroImage (2016).

.. [Craven1978] Craven et al. "Smoothing Noisy Data with Spline Functions."
   NUMER MATH 31.4 (1978): 377-403.

.. [Hosseinbor2013] Hosseinbor et al. "Bessel fourier orientation
   reconstruction (bfor): an analytical diffusion propagator reconstruction
   for hybrid diffusion imaging and computation of q-space indices. NeuroImage
   64, 650-670.

.. [Fick2016b] Fick et al. "A sensitivity analysis of Q-space indices with
   respect to changes in axonal diameter, dispersion and tissue composition.
   ISBI 2016.

.. [DelaHaije2020] Dela Haije et al. "Enforcing necessary non-negativity
   constraints for common diffusion MRI models using sum of squares
   programming". NeuroImage 209, 2020, 116405.

.. include:: ../links_names.inc


.. GENERATED FROM PYTHON SOURCE LINES 389-391

.. include:: ../../links_names.inc



.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (115 minutes 11.473 seconds)


.. _sphx_glr_download_examples_built_reconstruction_reconst_mapmri.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: reconst_mapmri.py <reconst_mapmri.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: reconst_mapmri.ipynb <reconst_mapmri.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
