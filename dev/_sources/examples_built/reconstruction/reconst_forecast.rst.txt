
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples_built/reconstruction/reconst_forecast.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_built_reconstruction_reconst_forecast.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_built_reconstruction_reconst_forecast.py:


==============================================================
Crossing invariant fiber response function with FORECAST model
==============================================================

We show how to obtain a voxel specific response function in the form of
axially symmetric tensor and the fODF using the FORECAST model from
[Anderson2005]_ , [Kaden2016]_ and [Zucchelli2017]_.

First import the necessary modules:

.. GENERATED FROM PYTHON SOURCE LINES 12-22

.. code-block:: Python


    import numpy as np
    import matplotlib.pyplot as plt
    from dipy.reconst.forecast import ForecastModel
    from dipy.viz import actor, window
    from dipy.data import fetch_hbn, get_sphere
    import nibabel as nib
    import os.path as op
    from dipy.core.gradients import gradient_table








.. GENERATED FROM PYTHON SOURCE LINES 23-28

Download and read the data for this tutorial. Our implementation of FORECAST
requires multi-shell `data.fetch_hbn()` provides data that was acquired using
b-values of 1000 and 2000 as part of the Healthy Brain Network study
[Alexander2017]_ and was preprocessed and quality controlled in the HBN-POD2
dataset [RichieHalford2022]_.

.. GENERATED FROM PYTHON SOURCE LINES 28-52

.. code-block:: Python


    data_path = fetch_hbn(["NDARAA948VFH"])[1]
    dwi_path = op.join(
           data_path, "derivatives", "qsiprep", "sub-NDARAA948VFH",
           "ses-HBNsiteRU", "dwi")

    img = nib.load(op.join(
           dwi_path,
           "sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.nii.gz"))

    gtab = gradient_table(
           op.join(dwi_path,
    "sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bval"),
           op.join(dwi_path,
    "sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-preproc_dwi.bvec"))

    data = np.asarray(img.dataobj)

    mask_img = nib.load(
           op.join(dwi_path,
    "sub-NDARAA948VFH_ses-HBNsiteRU_acq-64dir_space-T1w_desc-brain_mask.nii.gz"))

    brain_mask = mask_img.get_fdata()








.. GENERATED FROM PYTHON SOURCE LINES 53-54

Let us consider only a single slice for the FORECAST fitting

.. GENERATED FROM PYTHON SOURCE LINES 54-58

.. code-block:: Python


    data_small = data[:, :, 50:51]
    mask_small = brain_mask[:, :, 50:51]








.. GENERATED FROM PYTHON SOURCE LINES 59-66

Instantiate the FORECAST Model.

"sh_order_max" is the spherical harmonics order (l) used for the fODF.

dec_alg is the spherical deconvolution algorithm used for the FORECAST basis
fitting, in this case we used the Constrained Spherical Deconvolution (CSD)
algorithm.

.. GENERATED FROM PYTHON SOURCE LINES 66-69

.. code-block:: Python


    fm = ForecastModel(gtab, sh_order_max=6, dec_alg='CSD')








.. GENERATED FROM PYTHON SOURCE LINES 70-71

Fit the FORECAST to the data

.. GENERATED FROM PYTHON SOURCE LINES 71-74

.. code-block:: Python


    f_fit = fm.fit(data_small, mask_small)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/5148.0 [00:00<?, ?it/s]      0%|          | 2/5148.0 [00:00<04:39, 18.41it/s]      0%|          | 14/5148.0 [00:00<01:11, 71.76it/s]      0%|          | 22/5148.0 [00:00<01:32, 55.46it/s]      1%|▏         | 71/5148.0 [00:00<00:26, 191.29it/s]      2%|▏         | 94/5148.0 [00:00<00:27, 182.25it/s]      2%|▏         | 115/5148.0 [00:00<00:34, 143.99it/s]      3%|▎         | 132/5148.0 [00:01<00:37, 133.82it/s]      3%|▎         | 148/5148.0 [00:01<00:43, 114.53it/s]      3%|▎         | 161/5148.0 [00:01<01:15, 65.91it/s]       3%|▎         | 171/5148.0 [00:01<01:21, 60.71it/s]      3%|▎         | 180/5148.0 [00:01<01:16, 64.68it/s]      4%|▎         | 189/5148.0 [00:02<01:31, 54.16it/s]      4%|▍         | 196/5148.0 [00:02<01:39, 49.54it/s]      4%|▍         | 208/5148.0 [00:02<01:21, 60.70it/s]      4%|▍         | 227/5148.0 [00:02<00:58, 83.57it/s]      5%|▍         | 238/5148.0 [00:03<01:24, 58.00it/s]      5%|▍         | 247/5148.0 [00:03<01:57, 41.88it/s]      5%|▍         | 254/5148.0 [00:03<02:10, 37.45it/s]      5%|▌         | 260/5148.0 [00:03<02:01, 40.14it/s]      5%|▌         | 270/5148.0 [00:03<01:38, 49.43it/s]      5%|▌         | 278/5148.0 [00:04<01:29, 54.55it/s]      6%|▌         | 285/5148.0 [00:04<01:25, 56.56it/s]      6%|▌         | 297/5148.0 [00:04<01:17, 62.96it/s]      6%|▌         | 305/5148.0 [00:04<01:26, 55.79it/s]      6%|▋         | 326/5148.0 [00:04<00:54, 88.13it/s]      7%|▋         | 337/5148.0 [00:04<00:51, 92.71it/s]      7%|▋         | 352/5148.0 [00:04<00:46, 103.34it/s]      7%|▋         | 364/5148.0 [00:04<00:50, 95.20it/s]       7%|▋         | 375/5148.0 [00:05<00:48, 98.80it/s]      8%|▊         | 389/5148.0 [00:05<00:43, 108.89it/s]      8%|▊         | 401/5148.0 [00:05<00:44, 107.84it/s]      8%|▊         | 413/5148.0 [00:05<01:01, 77.32it/s]       8%|▊         | 423/5148.0 [00:05<00:59, 78.84it/s]      9%|▊         | 439/5148.0 [00:05<00:49, 94.36it/s]      9%|▊         | 450/5148.0 [00:06<01:15, 62.06it/s]      9%|▉         | 460/5148.0 [00:06<01:10, 66.17it/s]      9%|▉         | 473/5148.0 [00:06<01:10, 65.88it/s]      9%|▉         | 483/5148.0 [00:06<01:07, 69.33it/s]     10%|▉         | 492/5148.0 [00:06<01:03, 72.90it/s]     10%|▉         | 507/5148.0 [00:06<00:54, 84.83it/s]     10%|█         | 517/5148.0 [00:06<01:04, 72.03it/s]     10%|█         | 530/5148.0 [00:07<00:57, 80.38it/s]     10%|█         | 539/5148.0 [00:07<01:08, 67.71it/s]     11%|█         | 576/5148.0 [00:07<00:35, 130.41it/s]     12%|█▏        | 608/5148.0 [00:07<00:26, 172.02it/s]     12%|█▏        | 629/5148.0 [00:07<00:38, 118.20it/s]     13%|█▎        | 646/5148.0 [00:07<00:39, 115.18it/s]     13%|█▎        | 661/5148.0 [00:08<00:54, 82.74it/s]      13%|█▎        | 673/5148.0 [00:08<01:06, 67.56it/s]     13%|█▎        | 683/5148.0 [00:08<01:11, 62.15it/s]     13%|█▎        | 691/5148.0 [00:08<01:09, 64.02it/s]     14%|█▎        | 699/5148.0 [00:09<01:06, 66.81it/s]     14%|█▍        | 710/5148.0 [00:09<00:58, 75.29it/s]     14%|█▍        | 719/5148.0 [00:09<01:19, 55.45it/s]     14%|█▍        | 731/5148.0 [00:09<01:06, 66.72it/s]     14%|█▍        | 740/5148.0 [00:09<01:07, 64.88it/s]     15%|█▍        | 749/5148.0 [00:09<01:03, 69.47it/s]     15%|█▍        | 762/5148.0 [00:09<00:52, 82.99it/s]     15%|█▍        | 772/5148.0 [00:09<00:51, 85.57it/s]     15%|█▌        | 782/5148.0 [00:10<00:51, 84.91it/s]     15%|█▌        | 792/5148.0 [00:10<01:39, 43.71it/s]     16%|█▌        | 810/5148.0 [00:10<01:07, 64.68it/s]     16%|█▌        | 821/5148.0 [00:10<01:01, 70.89it/s]     16%|█▌        | 832/5148.0 [00:11<02:12, 32.61it/s]     16%|█▋        | 840/5148.0 [00:12<02:41, 26.75it/s]     16%|█▋        | 846/5148.0 [00:12<02:30, 28.55it/s]     17%|█▋        | 854/5148.0 [00:12<02:04, 34.54it/s]     17%|█▋        | 861/5148.0 [00:12<01:53, 37.93it/s]     17%|█▋        | 867/5148.0 [00:12<01:50, 38.73it/s]     17%|█▋        | 873/5148.0 [00:12<02:16, 31.24it/s]     17%|█▋        | 878/5148.0 [00:13<02:14, 31.86it/s]     17%|█▋        | 884/5148.0 [00:13<02:03, 34.59it/s]     17%|█▋        | 893/5148.0 [00:13<01:36, 44.29it/s]     18%|█▊        | 907/5148.0 [00:13<01:05, 64.26it/s]     18%|█▊        | 915/5148.0 [00:13<01:47, 39.39it/s]     18%|█▊        | 922/5148.0 [00:13<01:37, 43.56it/s]     18%|█▊        | 929/5148.0 [00:14<01:47, 39.20it/s]     18%|█▊        | 935/5148.0 [00:14<02:49, 24.90it/s]     19%|█▊        | 956/5148.0 [00:14<01:26, 48.30it/s]     19%|█▊        | 965/5148.0 [00:14<01:22, 50.71it/s]     19%|█▉        | 979/5148.0 [00:15<01:03, 65.58it/s]     19%|█▉        | 989/5148.0 [00:15<01:16, 54.72it/s]     19%|█▉        | 1001/5148.0 [00:15<01:03, 65.57it/s]     20%|█▉        | 1011/5148.0 [00:15<00:59, 69.92it/s]     20%|█▉        | 1020/5148.0 [00:15<01:00, 68.35it/s]     20%|█▉        | 1029/5148.0 [00:15<01:08, 60.25it/s]     20%|██        | 1040/5148.0 [00:15<00:58, 70.35it/s]     20%|██        | 1051/5148.0 [00:16<00:52, 78.35it/s]     21%|██        | 1060/5148.0 [00:16<00:51, 79.97it/s]     21%|██        | 1069/5148.0 [00:16<01:24, 48.39it/s]     21%|██        | 1087/5148.0 [00:16<01:00, 67.64it/s]     21%|██▏       | 1096/5148.0 [00:16<01:07, 60.35it/s]     21%|██▏       | 1104/5148.0 [00:17<01:19, 50.77it/s]     22%|██▏       | 1115/5148.0 [00:17<01:06, 61.08it/s]     22%|██▏       | 1123/5148.0 [00:17<01:07, 59.68it/s]     22%|██▏       | 1131/5148.0 [00:17<01:10, 56.93it/s]     23%|██▎       | 1183/5148.0 [00:17<00:25, 153.63it/s]     23%|██▎       | 1204/5148.0 [00:18<00:42, 92.62it/s]      24%|██▎       | 1220/5148.0 [00:18<00:43, 91.08it/s]     24%|██▍       | 1234/5148.0 [00:18<00:53, 73.55it/s]     24%|██▍       | 1249/5148.0 [00:18<00:46, 83.23it/s]     24%|██▍       | 1261/5148.0 [00:19<01:09, 56.00it/s]     25%|██▍       | 1270/5148.0 [00:19<01:17, 49.77it/s]     25%|██▍       | 1278/5148.0 [00:19<01:28, 43.92it/s]     25%|██▌       | 1287/5148.0 [00:19<01:17, 49.53it/s]     25%|██▌       | 1295/5148.0 [00:19<01:11, 53.80it/s]     25%|██▌       | 1304/5148.0 [00:19<01:03, 60.44it/s]     26%|██▌       | 1314/5148.0 [00:20<00:56, 67.41it/s]     26%|██▌       | 1322/5148.0 [00:20<00:56, 67.64it/s]     26%|██▌       | 1333/5148.0 [00:20<00:49, 77.63it/s]     26%|██▌       | 1342/5148.0 [00:20<00:47, 80.37it/s]     26%|██▋       | 1353/5148.0 [00:20<00:45, 84.19it/s]     26%|██▋       | 1364/5148.0 [00:20<00:42, 89.58it/s]     27%|██▋       | 1374/5148.0 [00:20<00:59, 63.83it/s]     27%|██▋       | 1382/5148.0 [00:21<00:58, 64.06it/s]     27%|██▋       | 1394/5148.0 [00:21<00:49, 75.95it/s]     27%|██▋       | 1409/5148.0 [00:21<00:43, 86.35it/s]     28%|██▊       | 1419/5148.0 [00:21<00:42, 87.90it/s]     28%|██▊       | 1429/5148.0 [00:21<00:41, 90.33it/s]     28%|██▊       | 1442/5148.0 [00:21<00:37, 98.24it/s]     28%|██▊       | 1453/5148.0 [00:21<00:46, 78.86it/s]     28%|██▊       | 1462/5148.0 [00:22<00:57, 63.77it/s]     29%|██▊       | 1470/5148.0 [00:22<00:55, 66.87it/s]     29%|██▊       | 1478/5148.0 [00:22<01:22, 44.53it/s]     29%|██▉       | 1484/5148.0 [00:22<01:28, 41.62it/s]     29%|██▉       | 1496/5148.0 [00:22<01:06, 54.93it/s]     29%|██▉       | 1504/5148.0 [00:22<01:00, 59.92it/s]     29%|██▉       | 1513/5148.0 [00:22<00:56, 63.86it/s]     30%|██▉       | 1521/5148.0 [00:23<01:12, 49.90it/s]     30%|██▉       | 1533/5148.0 [00:23<00:58, 62.15it/s]     30%|██▉       | 1541/5148.0 [00:23<01:01, 58.99it/s]     30%|███       | 1548/5148.0 [00:23<00:58, 61.34it/s]     30%|███       | 1559/5148.0 [00:23<00:49, 71.82it/s]     31%|███       | 1579/5148.0 [00:23<00:35, 99.37it/s]     31%|███       | 1590/5148.0 [00:23<00:37, 94.91it/s]     31%|███       | 1600/5148.0 [00:24<00:58, 60.72it/s]     31%|███▏      | 1615/5148.0 [00:24<00:46, 76.34it/s]     32%|███▏      | 1625/5148.0 [00:24<00:45, 78.22it/s]     32%|███▏      | 1635/5148.0 [00:24<00:59, 58.78it/s]     32%|███▏      | 1643/5148.0 [00:24<01:05, 53.48it/s]     32%|███▏      | 1650/5148.0 [00:25<01:41, 34.35it/s]     32%|███▏      | 1656/5148.0 [00:25<02:17, 25.41it/s]     32%|███▏      | 1660/5148.0 [00:26<02:11, 26.53it/s]     32%|███▏      | 1669/5148.0 [00:26<01:38, 35.37it/s]     33%|███▎      | 1675/5148.0 [00:26<02:08, 27.09it/s]     33%|███▎      | 1680/5148.0 [00:26<03:00, 19.26it/s]     33%|███▎      | 1684/5148.0 [00:27<03:10, 18.16it/s]     33%|███▎      | 1687/5148.0 [00:27<03:37, 15.90it/s]     33%|███▎      | 1690/5148.0 [00:27<03:39, 15.77it/s]     33%|███▎      | 1693/5148.0 [00:27<03:45, 15.31it/s]     33%|███▎      | 1695/5148.0 [00:28<03:44, 15.35it/s]     33%|███▎      | 1698/5148.0 [00:28<03:18, 17.42it/s]     33%|███▎      | 1701/5148.0 [00:28<03:33, 16.15it/s]     33%|███▎      | 1704/5148.0 [00:28<03:06, 18.48it/s]     33%|███▎      | 1708/5148.0 [00:28<02:33, 22.46it/s]     33%|███▎      | 1719/5148.0 [00:28<01:23, 41.02it/s]     34%|███▎      | 1729/5148.0 [00:28<01:03, 53.46it/s]     34%|███▍      | 1742/5148.0 [00:29<00:51, 66.48it/s]     34%|███▍      | 1750/5148.0 [00:29<01:31, 37.19it/s]     34%|███▍      | 1756/5148.0 [00:29<01:50, 30.75it/s]     34%|███▍      | 1763/5148.0 [00:29<01:36, 35.24it/s]     34%|███▍      | 1775/5148.0 [00:29<01:08, 49.13it/s]     35%|███▍      | 1782/5148.0 [00:30<01:24, 39.80it/s]     35%|███▍      | 1792/5148.0 [00:30<01:09, 48.45it/s]     35%|███▍      | 1799/5148.0 [00:30<01:08, 48.73it/s]     35%|███▌      | 1805/5148.0 [00:30<01:22, 40.60it/s]     35%|███▌      | 1812/5148.0 [00:30<01:13, 45.56it/s]     35%|███▌      | 1822/5148.0 [00:31<01:03, 52.19it/s]     36%|███▌      | 1828/5148.0 [00:31<01:08, 48.80it/s]     36%|███▌      | 1841/5148.0 [00:31<00:50, 65.51it/s]     36%|███▌      | 1852/5148.0 [00:31<00:45, 73.21it/s]     36%|███▌      | 1861/5148.0 [00:31<00:48, 67.83it/s]     36%|███▋      | 1869/5148.0 [00:31<01:09, 47.05it/s]     36%|███▋      | 1875/5148.0 [00:32<01:22, 39.47it/s]     37%|███▋      | 1880/5148.0 [00:32<01:39, 33.00it/s]     37%|███▋      | 1885/5148.0 [00:32<01:38, 32.99it/s]     37%|███▋      | 1889/5148.0 [00:32<01:48, 30.14it/s]     37%|███▋      | 1893/5148.0 [00:32<01:56, 27.89it/s]     37%|███▋      | 1901/5148.0 [00:33<01:43, 31.51it/s]     37%|███▋      | 1911/5148.0 [00:33<01:15, 42.83it/s]     37%|███▋      | 1916/5148.0 [00:33<01:27, 36.96it/s]     37%|███▋      | 1925/5148.0 [00:33<01:09, 46.09it/s]     38%|███▊      | 1931/5148.0 [00:33<01:09, 46.61it/s]     38%|███▊      | 1937/5148.0 [00:33<01:05, 48.82it/s]     38%|███▊      | 1945/5148.0 [00:33<00:59, 53.56it/s]     38%|███▊      | 1955/5148.0 [00:33<00:49, 64.51it/s]     38%|███▊      | 1962/5148.0 [00:34<00:54, 58.28it/s]     38%|███▊      | 1969/5148.0 [00:34<00:55, 57.15it/s]     39%|███▊      | 1982/5148.0 [00:34<00:43, 72.55it/s]     39%|███▊      | 1990/5148.0 [00:34<00:44, 71.46it/s]     39%|███▉      | 1998/5148.0 [00:34<00:44, 70.16it/s]     39%|███▉      | 2006/5148.0 [00:34<00:46, 67.37it/s]     39%|███▉      | 2013/5148.0 [00:35<01:13, 42.60it/s]     39%|███▉      | 2019/5148.0 [00:35<01:25, 36.70it/s]     39%|███▉      | 2024/5148.0 [00:35<01:23, 37.40it/s]     39%|███▉      | 2029/5148.0 [00:35<01:37, 31.93it/s]     40%|███▉      | 2034/5148.0 [00:35<01:37, 32.00it/s]     40%|███▉      | 2038/5148.0 [00:36<02:26, 21.30it/s]     40%|███▉      | 2043/5148.0 [00:36<02:02, 25.26it/s]     40%|███▉      | 2048/5148.0 [00:36<01:52, 27.44it/s]     40%|███▉      | 2052/5148.0 [00:36<01:46, 28.96it/s]     40%|███▉      | 2056/5148.0 [00:36<01:56, 26.56it/s]     40%|████      | 2060/5148.0 [00:36<02:10, 23.73it/s]     40%|████      | 2078/5148.0 [00:37<00:57, 53.12it/s]     41%|████      | 2086/5148.0 [00:37<00:57, 53.44it/s]     41%|████      | 2095/5148.0 [00:37<00:49, 61.18it/s]     41%|████      | 2107/5148.0 [00:37<00:41, 73.44it/s]     41%|████      | 2116/5148.0 [00:37<00:48, 61.95it/s]     41%|████▏     | 2124/5148.0 [00:37<00:46, 65.61it/s]     41%|████▏     | 2133/5148.0 [00:37<00:49, 60.99it/s]     42%|████▏     | 2140/5148.0 [00:37<00:48, 61.56it/s]     42%|████▏     | 2149/5148.0 [00:38<00:44, 67.19it/s]     42%|████▏     | 2157/5148.0 [00:38<00:52, 56.53it/s]     42%|████▏     | 2174/5148.0 [00:38<00:36, 81.51it/s]     42%|████▏     | 2186/5148.0 [00:38<00:33, 89.00it/s]     43%|████▎     | 2196/5148.0 [00:38<00:32, 89.66it/s]     43%|████▎     | 2206/5148.0 [00:38<00:51, 56.79it/s]     43%|████▎     | 2215/5148.0 [00:39<00:46, 62.90it/s]     43%|████▎     | 2224/5148.0 [00:39<00:53, 54.31it/s]     44%|████▎     | 2240/5148.0 [00:39<00:41, 70.53it/s]     44%|████▎     | 2250/5148.0 [00:39<00:38, 76.24it/s]     44%|████▍     | 2259/5148.0 [00:39<00:45, 63.04it/s]     44%|████▍     | 2267/5148.0 [00:39<00:44, 65.10it/s]     44%|████▍     | 2275/5148.0 [00:39<00:49, 58.26it/s]     44%|████▍     | 2282/5148.0 [00:40<00:56, 50.84it/s]     45%|████▍     | 2296/5148.0 [00:40<00:44, 63.82it/s]     45%|████▍     | 2305/5148.0 [00:40<00:41, 68.34it/s]     45%|████▍     | 2313/5148.0 [00:40<00:51, 54.94it/s]     45%|████▌     | 2320/5148.0 [00:40<00:57, 49.56it/s]     45%|████▌     | 2326/5148.0 [00:41<01:06, 42.71it/s]     45%|████▌     | 2333/5148.0 [00:41<01:00, 46.27it/s]     45%|████▌     | 2339/5148.0 [00:41<01:11, 39.12it/s]     46%|████▌     | 2344/5148.0 [00:41<01:31, 30.78it/s]     46%|████▌     | 2376/5148.0 [00:41<00:34, 79.37it/s]     47%|████▋     | 2394/5148.0 [00:41<00:28, 96.70it/s]     47%|████▋     | 2408/5148.0 [00:42<00:32, 83.47it/s]     47%|████▋     | 2420/5148.0 [00:42<00:33, 80.80it/s]     47%|████▋     | 2431/5148.0 [00:42<00:31, 86.41it/s]     47%|████▋     | 2442/5148.0 [00:42<00:30, 87.85it/s]     48%|████▊     | 2458/5148.0 [00:42<00:25, 104.56it/s]     48%|████▊     | 2470/5148.0 [00:42<00:27, 97.89it/s]      48%|████▊     | 2484/5148.0 [00:42<00:26, 102.40it/s]     49%|████▊     | 2500/5148.0 [00:42<00:22, 115.89it/s]     49%|████▉     | 2513/5148.0 [00:43<00:22, 117.21it/s]     49%|████▉     | 2526/5148.0 [00:43<00:22, 118.66it/s]     49%|████▉     | 2539/5148.0 [00:43<00:24, 104.37it/s]     50%|████▉     | 2561/5148.0 [00:43<00:19, 130.55it/s]     50%|█████     | 2578/5148.0 [00:43<00:18, 136.11it/s]     50%|█████     | 2594/5148.0 [00:43<00:18, 136.16it/s]     51%|█████     | 2611/5148.0 [00:43<00:19, 131.52it/s]     51%|█████     | 2626/5148.0 [00:43<00:19, 132.36it/s]     51%|█████▏    | 2640/5148.0 [00:44<00:19, 128.08it/s]     52%|█████▏    | 2653/5148.0 [00:44<00:21, 118.14it/s]     52%|█████▏    | 2665/5148.0 [00:44<00:22, 111.31it/s]     52%|█████▏    | 2683/5148.0 [00:44<00:19, 126.93it/s]     52%|█████▏    | 2696/5148.0 [00:44<00:22, 111.18it/s]     53%|█████▎    | 2708/5148.0 [00:44<00:34, 71.00it/s]      53%|█████▎    | 2720/5148.0 [00:45<00:31, 77.34it/s]     53%|█████▎    | 2730/5148.0 [00:45<00:33, 72.00it/s]     53%|█████▎    | 2739/5148.0 [00:45<00:31, 75.43it/s]     53%|█████▎    | 2752/5148.0 [00:45<00:27, 86.34it/s]     54%|█████▍    | 2768/5148.0 [00:45<00:23, 99.56it/s]     54%|█████▍    | 2779/5148.0 [00:45<00:27, 87.62it/s]     54%|█████▍    | 2796/5148.0 [00:45<00:26, 88.78it/s]     55%|█████▍    | 2806/5148.0 [00:46<00:27, 84.90it/s]     55%|█████▍    | 2816/5148.0 [00:46<00:27, 85.23it/s]     55%|█████▍    | 2825/5148.0 [00:46<00:29, 77.59it/s]     55%|█████▌    | 2833/5148.0 [00:46<00:33, 69.89it/s]     55%|█████▌    | 2841/5148.0 [00:46<00:48, 47.60it/s]     55%|█████▌    | 2847/5148.0 [00:46<00:58, 39.61it/s]     55%|█████▌    | 2853/5148.0 [00:47<00:53, 42.65it/s]     56%|█████▌    | 2866/5148.0 [00:47<00:38, 58.63it/s]     56%|█████▌    | 2878/5148.0 [00:47<00:31, 71.62it/s]     56%|█████▌    | 2887/5148.0 [00:47<00:43, 52.52it/s]     56%|█████▋    | 2900/5148.0 [00:47<00:33, 66.59it/s]     57%|█████▋    | 2957/5148.0 [00:47<00:12, 171.48it/s]     58%|█████▊    | 2980/5148.0 [00:48<00:16, 133.86it/s]     58%|█████▊    | 2999/5148.0 [00:48<00:16, 131.27it/s]     59%|█████▊    | 3016/5148.0 [00:48<00:27, 78.80it/s]      59%|█████▉    | 3048/5148.0 [00:48<00:18, 111.64it/s]     60%|█████▉    | 3067/5148.0 [00:49<00:19, 109.11it/s]     60%|█████▉    | 3083/5148.0 [00:49<00:22, 90.42it/s]      60%|██████    | 3096/5148.0 [00:49<00:25, 80.87it/s]     60%|██████    | 3107/5148.0 [00:49<00:24, 84.76it/s]     61%|██████    | 3118/5148.0 [00:49<00:23, 86.07it/s]     61%|██████    | 3129/5148.0 [00:49<00:24, 82.71it/s]     61%|██████    | 3139/5148.0 [00:49<00:23, 84.03it/s]     61%|██████    | 3149/5148.0 [00:50<00:23, 86.42it/s]     61%|██████▏   | 3159/5148.0 [00:50<00:24, 81.96it/s]     62%|██████▏   | 3168/5148.0 [00:50<00:30, 65.86it/s]     62%|██████▏   | 3176/5148.0 [00:50<00:32, 60.14it/s]     62%|██████▏   | 3183/5148.0 [00:50<00:34, 57.22it/s]     62%|██████▏   | 3193/5148.0 [00:50<00:33, 58.55it/s]     62%|██████▏   | 3202/5148.0 [00:51<00:31, 61.82it/s]     62%|██████▏   | 3209/5148.0 [00:51<00:42, 45.29it/s]     62%|██████▏   | 3217/5148.0 [00:51<00:38, 50.23it/s]     63%|██████▎   | 3223/5148.0 [00:52<01:17, 24.98it/s]     63%|██████▎   | 3228/5148.0 [00:52<02:03, 15.60it/s]     63%|██████▎   | 3232/5148.0 [00:53<02:31, 12.65it/s]     63%|██████▎   | 3235/5148.0 [00:53<02:39, 12.03it/s]     63%|██████▎   | 3238/5148.0 [00:54<02:59, 10.66it/s]     63%|██████▎   | 3240/5148.0 [00:54<02:53, 11.01it/s]     63%|██████▎   | 3242/5148.0 [00:54<03:11,  9.94it/s]     63%|██████▎   | 3245/5148.0 [00:54<02:46, 11.40it/s]     63%|██████▎   | 3247/5148.0 [00:54<02:42, 11.73it/s]     63%|██████▎   | 3249/5148.0 [00:55<02:47, 11.35it/s]     63%|██████▎   | 3251/5148.0 [00:55<02:55, 10.81it/s]     63%|██████▎   | 3253/5148.0 [00:55<02:36, 12.14it/s]     63%|██████▎   | 3255/5148.0 [00:55<02:31, 12.48it/s]     63%|██████▎   | 3257/5148.0 [00:55<02:21, 13.39it/s]     63%|██████▎   | 3259/5148.0 [00:55<02:24, 13.04it/s]     63%|██████▎   | 3261/5148.0 [00:55<02:17, 13.77it/s]     63%|██████▎   | 3264/5148.0 [00:56<01:50, 17.07it/s]     63%|██████▎   | 3266/5148.0 [00:56<02:24, 13.00it/s]     63%|██████▎   | 3268/5148.0 [00:56<02:45, 11.35it/s]     64%|██████▎   | 3270/5148.0 [00:56<03:12,  9.76it/s]     64%|██████▎   | 3272/5148.0 [00:56<03:06, 10.03it/s]     64%|██████▎   | 3274/5148.0 [00:57<03:10,  9.81it/s]     64%|██████▎   | 3276/5148.0 [00:57<03:17,  9.49it/s]     64%|██████▎   | 3278/5148.0 [00:57<03:50,  8.10it/s]     64%|██████▎   | 3279/5148.0 [00:58<04:27,  6.99it/s]     64%|██████▎   | 3280/5148.0 [00:58<04:32,  6.86it/s]     64%|██████▍   | 3282/5148.0 [00:58<04:03,  7.66it/s]     64%|██████▍   | 3284/5148.0 [00:58<03:36,  8.61it/s]     64%|██████▍   | 3286/5148.0 [00:58<03:14,  9.59it/s]     64%|██████▍   | 3288/5148.0 [00:58<02:50, 10.92it/s]     64%|██████▍   | 3290/5148.0 [00:58<02:31, 12.29it/s]     64%|██████▍   | 3292/5148.0 [00:59<02:37, 11.76it/s]     64%|██████▍   | 3294/5148.0 [00:59<02:46, 11.12it/s]     64%|██████▍   | 3296/5148.0 [00:59<02:46, 11.10it/s]     64%|██████▍   | 3298/5148.0 [00:59<02:52, 10.70it/s]     64%|██████▍   | 3300/5148.0 [00:59<02:46, 11.11it/s]     64%|██████▍   | 3302/5148.0 [01:00<02:28, 12.41it/s]     64%|██████▍   | 3305/5148.0 [01:00<02:21, 13.07it/s]     64%|██████▍   | 3307/5148.0 [01:00<02:19, 13.22it/s]     64%|██████▍   | 3309/5148.0 [01:00<02:21, 13.00it/s]     64%|██████▍   | 3311/5148.0 [01:00<02:13, 13.75it/s]     64%|██████▍   | 3313/5148.0 [01:00<02:28, 12.33it/s]     64%|██████▍   | 3315/5148.0 [01:01<02:45, 11.09it/s]     64%|██████▍   | 3317/5148.0 [01:01<02:42, 11.29it/s]     64%|██████▍   | 3319/5148.0 [01:01<02:47, 10.91it/s]     65%|██████▍   | 3321/5148.0 [01:01<02:46, 10.97it/s]     65%|██████▍   | 3323/5148.0 [01:01<02:30, 12.09it/s]     65%|██████▍   | 3325/5148.0 [01:01<02:20, 12.95it/s]     65%|██████▍   | 3327/5148.0 [01:02<02:41, 11.29it/s]     65%|██████▍   | 3329/5148.0 [01:02<03:10,  9.54it/s]     65%|██████▍   | 3331/5148.0 [01:02<02:55, 10.33it/s]     65%|██████▍   | 3333/5148.0 [01:02<03:42,  8.15it/s]     65%|██████▍   | 3334/5148.0 [01:03<03:38,  8.30it/s]     65%|██████▍   | 3335/5148.0 [01:03<03:33,  8.49it/s]     65%|██████▍   | 3336/5148.0 [01:03<03:31,  8.55it/s]     65%|██████▍   | 3337/5148.0 [01:03<03:53,  7.75it/s]     65%|██████▍   | 3339/5148.0 [01:03<03:15,  9.28it/s]     65%|██████▍   | 3341/5148.0 [01:03<02:56, 10.26it/s]     65%|██████▍   | 3343/5148.0 [01:03<03:08,  9.56it/s]     65%|██████▍   | 3344/5148.0 [01:04<03:17,  9.15it/s]     65%|██████▍   | 3346/5148.0 [01:04<02:39, 11.31it/s]     65%|██████▌   | 3348/5148.0 [01:04<02:33, 11.73it/s]     65%|██████▌   | 3350/5148.0 [01:04<02:28, 12.12it/s]     65%|██████▌   | 3352/5148.0 [01:04<02:36, 11.49it/s]     65%|██████▌   | 3354/5148.0 [01:04<02:32, 11.76it/s]     65%|██████▌   | 3356/5148.0 [01:05<02:35, 11.51it/s]     65%|██████▌   | 3358/5148.0 [01:05<02:53, 10.35it/s]     65%|██████▌   | 3360/5148.0 [01:05<03:06,  9.59it/s]     65%|██████▌   | 3361/5148.0 [01:05<03:19,  8.97it/s]     65%|██████▌   | 3363/5148.0 [01:05<03:14,  9.18it/s]     65%|██████▌   | 3365/5148.0 [01:06<03:08,  9.44it/s]     65%|██████▌   | 3367/5148.0 [01:06<02:38, 11.22it/s]     65%|██████▌   | 3369/5148.0 [01:06<02:42, 10.95it/s]     65%|██████▌   | 3371/5148.0 [01:06<02:29, 11.86it/s]     66%|██████▌   | 3373/5148.0 [01:06<02:19, 12.69it/s]     66%|██████▌   | 3375/5148.0 [01:06<02:27, 12.00it/s]     66%|██████▌   | 3377/5148.0 [01:06<02:09, 13.64it/s]     66%|██████▌   | 3379/5148.0 [01:07<02:40, 11.05it/s]     66%|██████▌   | 3381/5148.0 [01:07<02:30, 11.76it/s]     66%|██████▌   | 3383/5148.0 [01:07<02:16, 12.90it/s]     66%|██████▌   | 3386/5148.0 [01:07<01:57, 14.97it/s]     66%|██████▌   | 3388/5148.0 [01:07<02:04, 14.11it/s]     66%|██████▌   | 3390/5148.0 [01:07<02:05, 14.05it/s]     66%|██████▌   | 3392/5148.0 [01:08<02:12, 13.21it/s]     66%|██████▌   | 3394/5148.0 [01:08<02:08, 13.63it/s]     66%|██████▌   | 3396/5148.0 [01:08<01:57, 14.90it/s]     66%|██████▌   | 3398/5148.0 [01:08<02:53, 10.06it/s]     66%|██████▌   | 3400/5148.0 [01:09<03:55,  7.44it/s]     66%|██████▌   | 3402/5148.0 [01:09<04:31,  6.44it/s]     66%|██████▌   | 3404/5148.0 [01:09<03:53,  7.46it/s]     66%|██████▌   | 3406/5148.0 [01:09<03:21,  8.67it/s]     66%|██████▌   | 3409/5148.0 [01:10<02:46, 10.46it/s]     66%|██████▋   | 3411/5148.0 [01:10<02:36, 11.13it/s]     66%|██████▋   | 3413/5148.0 [01:10<02:41, 10.75it/s]     66%|██████▋   | 3415/5148.0 [01:10<02:29, 11.56it/s]     66%|██████▋   | 3417/5148.0 [01:10<02:31, 11.40it/s]     66%|██████▋   | 3419/5148.0 [01:10<02:24, 11.96it/s]     66%|██████▋   | 3421/5148.0 [01:11<02:47, 10.29it/s]     66%|██████▋   | 3423/5148.0 [01:11<02:50, 10.11it/s]     67%|██████▋   | 3425/5148.0 [01:11<02:27, 11.68it/s]     67%|██████▋   | 3427/5148.0 [01:11<02:25, 11.86it/s]     67%|██████▋   | 3429/5148.0 [01:11<02:10, 13.20it/s]     67%|██████▋   | 3431/5148.0 [01:11<02:19, 12.33it/s]     67%|██████▋   | 3433/5148.0 [01:12<02:43, 10.50it/s]     67%|██████▋   | 3435/5148.0 [01:12<02:51,  9.98it/s]     67%|██████▋   | 3437/5148.0 [01:12<02:49, 10.10it/s]     67%|██████▋   | 3439/5148.0 [01:12<02:55,  9.72it/s]     67%|██████▋   | 3441/5148.0 [01:12<02:38, 10.75it/s]     67%|██████▋   | 3443/5148.0 [01:13<02:27, 11.52it/s]     67%|██████▋   | 3445/5148.0 [01:13<02:28, 11.49it/s]     67%|██████▋   | 3448/5148.0 [01:13<02:07, 13.35it/s]     67%|██████▋   | 3450/5148.0 [01:13<02:14, 12.64it/s]     67%|██████▋   | 3452/5148.0 [01:13<02:20, 12.06it/s]     67%|██████▋   | 3454/5148.0 [01:13<02:09, 13.08it/s]     67%|██████▋   | 3456/5148.0 [01:14<02:20, 12.01it/s]     67%|██████▋   | 3458/5148.0 [01:14<02:41, 10.43it/s]     67%|██████▋   | 3460/5148.0 [01:14<02:34, 10.95it/s]     67%|██████▋   | 3462/5148.0 [01:14<02:36, 10.80it/s]     67%|██████▋   | 3464/5148.0 [01:14<02:41, 10.41it/s]     67%|██████▋   | 3466/5148.0 [01:15<03:08,  8.92it/s]     67%|██████▋   | 3467/5148.0 [01:15<03:24,  8.21it/s]     67%|██████▋   | 3469/5148.0 [01:15<03:11,  8.76it/s]     67%|██████▋   | 3471/5148.0 [01:15<02:40, 10.47it/s]     67%|██████▋   | 3473/5148.0 [01:15<02:20, 11.91it/s]     68%|██████▊   | 3475/5148.0 [01:15<02:13, 12.51it/s]     68%|██████▊   | 3478/5148.0 [01:16<01:56, 14.38it/s]     68%|██████▊   | 3482/5148.0 [01:16<01:24, 19.62it/s]     68%|██████▊   | 3485/5148.0 [01:16<01:54, 14.52it/s]     68%|██████▊   | 3487/5148.0 [01:16<01:58, 14.00it/s]     68%|██████▊   | 3490/5148.0 [01:16<01:38, 16.91it/s]     68%|██████▊   | 3493/5148.0 [01:16<01:31, 18.11it/s]     68%|██████▊   | 3496/5148.0 [01:17<01:37, 17.02it/s]     68%|██████▊   | 3498/5148.0 [01:17<01:53, 14.52it/s]     68%|██████▊   | 3500/5148.0 [01:17<02:18, 11.87it/s]     68%|██████▊   | 3502/5148.0 [01:17<02:26, 11.25it/s]     68%|██████▊   | 3504/5148.0 [01:18<02:34, 10.63it/s]     68%|██████▊   | 3506/5148.0 [01:18<02:49,  9.70it/s]     68%|██████▊   | 3508/5148.0 [01:18<03:02,  9.00it/s]     68%|██████▊   | 3510/5148.0 [01:18<02:34, 10.62it/s]     68%|██████▊   | 3512/5148.0 [01:18<02:18, 11.77it/s]     68%|██████▊   | 3514/5148.0 [01:18<02:10, 12.51it/s]     68%|██████▊   | 3517/5148.0 [01:19<02:00, 13.54it/s]     68%|██████▊   | 3519/5148.0 [01:19<02:14, 12.08it/s]     68%|██████▊   | 3521/5148.0 [01:19<02:35, 10.47it/s]     68%|██████▊   | 3523/5148.0 [01:19<03:09,  8.58it/s]     68%|██████▊   | 3524/5148.0 [01:20<03:18,  8.17it/s]     68%|██████▊   | 3525/5148.0 [01:20<03:49,  7.08it/s]     69%|██████▊   | 3527/5148.0 [01:20<03:29,  7.73it/s]     69%|██████▊   | 3528/5148.0 [01:20<03:28,  7.79it/s]     69%|██████▊   | 3530/5148.0 [01:20<02:43,  9.87it/s]     69%|██████▊   | 3532/5148.0 [01:21<03:15,  8.25it/s]     69%|██████▊   | 3534/5148.0 [01:21<02:55,  9.20it/s]     69%|██████▊   | 3536/5148.0 [01:21<03:21,  7.99it/s]     69%|██████▊   | 3538/5148.0 [01:21<02:48,  9.53it/s]     69%|██████▉   | 3540/5148.0 [01:21<02:36, 10.28it/s]     69%|██████▉   | 3542/5148.0 [01:21<02:25, 11.07it/s]     69%|██████▉   | 3544/5148.0 [01:22<02:32, 10.55it/s]     69%|██████▉   | 3546/5148.0 [01:22<02:27, 10.83it/s]     69%|██████▉   | 3548/5148.0 [01:22<02:11, 12.16it/s]     69%|██████▉   | 3550/5148.0 [01:22<02:16, 11.73it/s]     69%|██████▉   | 3552/5148.0 [01:22<02:28, 10.76it/s]     69%|██████▉   | 3554/5148.0 [01:23<02:21, 11.27it/s]     69%|██████▉   | 3556/5148.0 [01:23<02:42,  9.79it/s]     69%|██████▉   | 3558/5148.0 [01:23<02:25, 10.96it/s]     69%|██████▉   | 3560/5148.0 [01:23<02:35, 10.19it/s]     69%|██████▉   | 3562/5148.0 [01:23<02:23, 11.02it/s]     69%|██████▉   | 3564/5148.0 [01:23<02:26, 10.83it/s]     69%|██████▉   | 3566/5148.0 [01:24<02:06, 12.49it/s]     69%|██████▉   | 3568/5148.0 [01:24<02:04, 12.70it/s]     69%|██████▉   | 3570/5148.0 [01:24<02:17, 11.49it/s]     69%|██████▉   | 3572/5148.0 [01:24<02:03, 12.72it/s]     69%|██████▉   | 3574/5148.0 [01:24<02:22, 11.07it/s]     69%|██████▉   | 3576/5148.0 [01:25<02:53,  9.08it/s]     70%|██████▉   | 3578/5148.0 [01:25<02:49,  9.26it/s]     70%|██████▉   | 3580/5148.0 [01:25<03:19,  7.85it/s]     70%|██████▉   | 3581/5148.0 [01:25<03:27,  7.56it/s]     70%|██████▉   | 3582/5148.0 [01:25<03:35,  7.27it/s]     70%|██████▉   | 3583/5148.0 [01:26<03:29,  7.47it/s]     70%|██████▉   | 3585/5148.0 [01:26<03:27,  7.54it/s]     70%|██████▉   | 3587/5148.0 [01:26<02:45,  9.43it/s]     70%|██████▉   | 3589/5148.0 [01:26<02:21, 11.01it/s]     70%|██████▉   | 3591/5148.0 [01:26<02:20, 11.09it/s]     70%|██████▉   | 3593/5148.0 [01:26<02:03, 12.62it/s]     70%|██████▉   | 3595/5148.0 [01:27<02:56,  8.78it/s]     70%|██████▉   | 3597/5148.0 [01:27<03:26,  7.51it/s]     70%|██████▉   | 3598/5148.0 [01:27<03:36,  7.15it/s]     70%|██████▉   | 3599/5148.0 [01:28<04:00,  6.45it/s]     70%|██████▉   | 3600/5148.0 [01:28<04:22,  5.90it/s]     70%|██████▉   | 3601/5148.0 [01:28<04:26,  5.79it/s]     70%|██████▉   | 3602/5148.0 [01:28<04:13,  6.10it/s]     70%|██████▉   | 3603/5148.0 [01:28<04:14,  6.06it/s]     70%|███████   | 3604/5148.0 [01:28<04:21,  5.90it/s]     70%|███████   | 3605/5148.0 [01:29<03:56,  6.53it/s]     70%|███████   | 3606/5148.0 [01:29<03:45,  6.84it/s]     70%|███████   | 3608/5148.0 [01:29<02:47,  9.18it/s]     70%|███████   | 3611/5148.0 [01:29<02:13, 11.55it/s]     70%|███████   | 3613/5148.0 [01:29<03:07,  8.18it/s]     70%|███████   | 3615/5148.0 [01:30<02:53,  8.84it/s]     70%|███████   | 3617/5148.0 [01:30<03:06,  8.20it/s]     70%|███████   | 3618/5148.0 [01:30<03:13,  7.91it/s]     70%|███████   | 3619/5148.0 [01:30<03:23,  7.51it/s]     70%|███████   | 3620/5148.0 [01:30<03:55,  6.48it/s]     70%|███████   | 3621/5148.0 [01:31<04:00,  6.35it/s]     70%|███████   | 3622/5148.0 [01:31<04:06,  6.19it/s]     70%|███████   | 3623/5148.0 [01:31<03:47,  6.70it/s]     70%|███████   | 3625/5148.0 [01:31<03:05,  8.23it/s]     70%|███████   | 3626/5148.0 [01:31<03:10,  7.97it/s]     70%|███████   | 3628/5148.0 [01:31<03:09,  8.03it/s]     71%|███████   | 3630/5148.0 [01:32<03:00,  8.40it/s]     71%|███████   | 3632/5148.0 [01:32<02:25, 10.38it/s]     71%|███████   | 3634/5148.0 [01:32<03:15,  7.74it/s]     71%|███████   | 3636/5148.0 [01:32<03:44,  6.72it/s]     71%|███████   | 3637/5148.0 [01:33<04:02,  6.23it/s]     71%|███████   | 3638/5148.0 [01:33<04:05,  6.15it/s]     71%|███████   | 3640/5148.0 [01:33<03:18,  7.59it/s]     71%|███████   | 3641/5148.0 [01:33<03:27,  7.27it/s]     71%|███████   | 3643/5148.0 [01:34<03:50,  6.53it/s]     71%|███████   | 3644/5148.0 [01:34<03:53,  6.45it/s]     71%|███████   | 3645/5148.0 [01:34<04:06,  6.10it/s]     71%|███████   | 3646/5148.0 [01:34<03:57,  6.33it/s]     71%|███████   | 3647/5148.0 [01:34<04:00,  6.24it/s]     71%|███████   | 3648/5148.0 [01:34<03:55,  6.37it/s]     71%|███████   | 3649/5148.0 [01:34<03:40,  6.81it/s]     71%|███████   | 3651/5148.0 [01:35<03:49,  6.52it/s]     71%|███████   | 3652/5148.0 [01:35<04:02,  6.16it/s]     71%|███████   | 3653/5148.0 [01:35<03:55,  6.34it/s]     71%|███████   | 3654/5148.0 [01:35<04:13,  5.89it/s]     71%|███████   | 3655/5148.0 [01:36<06:05,  4.09it/s]     71%|███████   | 3656/5148.0 [01:36<05:32,  4.49it/s]     71%|███████   | 3657/5148.0 [01:36<05:39,  4.40it/s]     71%|███████   | 3658/5148.0 [01:36<05:33,  4.46it/s]     71%|███████   | 3659/5148.0 [01:37<05:32,  4.48it/s]     71%|███████   | 3661/5148.0 [01:37<03:43,  6.65it/s]     71%|███████   | 3663/5148.0 [01:37<03:02,  8.14it/s]     71%|███████   | 3665/5148.0 [01:37<02:32,  9.71it/s]     71%|███████   | 3667/5148.0 [01:37<02:09, 11.43it/s]     71%|███████▏  | 3669/5148.0 [01:37<02:40,  9.23it/s]     71%|███████▏  | 3671/5148.0 [01:38<02:38,  9.32it/s]     71%|███████▏  | 3673/5148.0 [01:38<02:35,  9.50it/s]     71%|███████▏  | 3675/5148.0 [01:38<02:25, 10.13it/s]     71%|███████▏  | 3677/5148.0 [01:38<02:50,  8.63it/s]     71%|███████▏  | 3679/5148.0 [01:39<02:43,  8.97it/s]     71%|███████▏  | 3680/5148.0 [01:39<03:12,  7.62it/s]     72%|███████▏  | 3681/5148.0 [01:39<03:13,  7.56it/s]     72%|███████▏  | 3682/5148.0 [01:39<03:15,  7.49it/s]     72%|███████▏  | 3683/5148.0 [01:39<03:54,  6.25it/s]     72%|███████▏  | 3684/5148.0 [01:39<03:39,  6.66it/s]     72%|███████▏  | 3685/5148.0 [01:40<04:04,  5.99it/s]     72%|███████▏  | 3687/5148.0 [01:40<03:01,  8.07it/s]     72%|███████▏  | 3689/5148.0 [01:40<02:38,  9.23it/s]     72%|███████▏  | 3690/5148.0 [01:40<02:37,  9.28it/s]     72%|███████▏  | 3692/5148.0 [01:40<02:42,  8.98it/s]     72%|███████▏  | 3693/5148.0 [01:40<02:56,  8.22it/s]     72%|███████▏  | 3694/5148.0 [01:41<02:58,  8.14it/s]     72%|███████▏  | 3696/5148.0 [01:41<02:31,  9.57it/s]     72%|███████▏  | 3697/5148.0 [01:41<02:38,  9.14it/s]     72%|███████▏  | 3698/5148.0 [01:41<02:48,  8.59it/s]     72%|███████▏  | 3699/5148.0 [01:41<03:06,  7.76it/s]     72%|███████▏  | 3700/5148.0 [01:41<03:47,  6.36it/s]     72%|███████▏  | 3702/5148.0 [01:41<02:43,  8.83it/s]     72%|███████▏  | 3705/5148.0 [01:42<02:50,  8.48it/s]     72%|███████▏  | 3706/5148.0 [01:42<03:05,  7.77it/s]     72%|███████▏  | 3707/5148.0 [01:42<03:10,  7.56it/s]     72%|███████▏  | 3709/5148.0 [01:42<02:45,  8.68it/s]     72%|███████▏  | 3710/5148.0 [01:43<03:11,  7.49it/s]     72%|███████▏  | 3711/5148.0 [01:43<03:42,  6.45it/s]     72%|███████▏  | 3712/5148.0 [01:43<03:35,  6.67it/s]     72%|███████▏  | 3713/5148.0 [01:43<03:32,  6.75it/s]     72%|███████▏  | 3714/5148.0 [01:43<03:37,  6.58it/s]     72%|███████▏  | 3715/5148.0 [01:43<03:49,  6.25it/s]     72%|███████▏  | 3716/5148.0 [01:44<03:45,  6.35it/s]     72%|███████▏  | 3717/5148.0 [01:44<04:38,  5.14it/s]     72%|███████▏  | 3721/5148.0 [01:44<03:00,  7.92it/s]     72%|███████▏  | 3722/5148.0 [01:44<03:40,  6.46it/s]     72%|███████▏  | 3723/5148.0 [01:45<04:16,  5.56it/s]     72%|███████▏  | 3724/5148.0 [01:45<03:55,  6.04it/s]     72%|███████▏  | 3725/5148.0 [01:45<04:06,  5.78it/s]     72%|███████▏  | 3726/5148.0 [01:45<04:38,  5.11it/s]     72%|███████▏  | 3727/5148.0 [01:46<04:38,  5.10it/s]     72%|███████▏  | 3728/5148.0 [01:46<04:18,  5.50it/s]     72%|███████▏  | 3729/5148.0 [01:46<04:22,  5.40it/s]     72%|███████▏  | 3730/5148.0 [01:46<04:30,  5.24it/s]     72%|███████▏  | 3731/5148.0 [01:46<04:21,  5.42it/s]     72%|███████▏  | 3732/5148.0 [01:46<04:17,  5.49it/s]     73%|███████▎  | 3733/5148.0 [01:47<04:22,  5.39it/s]     73%|███████▎  | 3734/5148.0 [01:47<04:00,  5.89it/s]     73%|███████▎  | 3735/5148.0 [01:47<04:18,  5.46it/s]     73%|███████▎  | 3736/5148.0 [01:47<04:02,  5.83it/s]     73%|███████▎  | 3737/5148.0 [01:47<03:33,  6.59it/s]     73%|███████▎  | 3739/5148.0 [01:47<02:53,  8.13it/s]     73%|███████▎  | 3740/5148.0 [01:48<03:21,  6.98it/s]     73%|███████▎  | 3741/5148.0 [01:48<04:16,  5.48it/s]     73%|███████▎  | 3743/5148.0 [01:48<03:19,  7.03it/s]     73%|███████▎  | 3745/5148.0 [01:48<02:48,  8.35it/s]     73%|███████▎  | 3747/5148.0 [01:48<02:23,  9.78it/s]     73%|███████▎  | 3749/5148.0 [01:49<02:12, 10.58it/s]     73%|███████▎  | 3751/5148.0 [01:49<02:29,  9.35it/s]     73%|███████▎  | 3753/5148.0 [01:49<02:16, 10.22it/s]     73%|███████▎  | 3755/5148.0 [01:49<02:28,  9.39it/s]     73%|███████▎  | 3757/5148.0 [01:49<02:23,  9.67it/s]     73%|███████▎  | 3759/5148.0 [01:49<02:03, 11.21it/s]     73%|███████▎  | 3761/5148.0 [01:50<02:03, 11.27it/s]     73%|███████▎  | 3763/5148.0 [01:50<01:51, 12.47it/s]     73%|███████▎  | 3765/5148.0 [01:50<02:00, 11.46it/s]     73%|███████▎  | 3767/5148.0 [01:50<01:59, 11.59it/s]     73%|███████▎  | 3769/5148.0 [01:50<01:45, 13.13it/s]     73%|███████▎  | 3771/5148.0 [01:50<02:01, 11.36it/s]     73%|███████▎  | 3773/5148.0 [01:51<02:07, 10.78it/s]     73%|███████▎  | 3775/5148.0 [01:51<02:06, 10.85it/s]     73%|███████▎  | 3777/5148.0 [01:51<02:31,  9.04it/s]     73%|███████▎  | 3780/5148.0 [01:51<02:08, 10.67it/s]     73%|███████▎  | 3783/5148.0 [01:52<01:43, 13.15it/s]     74%|███████▎  | 3786/5148.0 [01:52<01:29, 15.15it/s]     74%|███████▎  | 3788/5148.0 [01:52<01:57, 11.61it/s]     74%|███████▎  | 3790/5148.0 [01:52<02:22,  9.55it/s]     74%|███████▎  | 3792/5148.0 [01:52<02:07, 10.65it/s]     74%|███████▎  | 3794/5148.0 [01:53<02:14, 10.07it/s]     74%|███████▎  | 3796/5148.0 [01:53<02:22,  9.50it/s]     74%|███████▍  | 3798/5148.0 [01:53<02:31,  8.93it/s]     74%|███████▍  | 3799/5148.0 [01:53<02:43,  8.26it/s]     74%|███████▍  | 3800/5148.0 [01:53<02:45,  8.16it/s]     74%|███████▍  | 3801/5148.0 [01:54<03:12,  7.01it/s]     74%|███████▍  | 3805/5148.0 [01:54<02:02, 10.95it/s]     74%|███████▍  | 3811/5148.0 [01:54<01:10, 19.01it/s]     74%|███████▍  | 3820/5148.0 [01:54<00:40, 32.43it/s]     74%|███████▍  | 3825/5148.0 [01:54<00:37, 35.23it/s]     75%|███████▍  | 3841/5148.0 [01:54<00:21, 60.40it/s]     75%|███████▍  | 3848/5148.0 [01:54<00:23, 55.15it/s]     75%|███████▌  | 3861/5148.0 [01:55<00:17, 72.33it/s]     75%|███████▌  | 3878/5148.0 [01:55<00:13, 96.16it/s]     76%|███████▌  | 3890/5148.0 [01:55<00:12, 101.50it/s]     76%|███████▌  | 3901/5148.0 [01:55<00:14, 87.29it/s]      76%|███████▌  | 3911/5148.0 [01:55<00:13, 88.88it/s]     76%|███████▌  | 3924/5148.0 [01:55<00:13, 93.24it/s]     76%|███████▋  | 3935/5148.0 [01:55<00:13, 91.53it/s]     77%|███████▋  | 3945/5148.0 [01:55<00:16, 74.56it/s]     77%|███████▋  | 3954/5148.0 [01:56<00:16, 74.15it/s]     77%|███████▋  | 3966/5148.0 [01:56<00:14, 80.90it/s]     77%|███████▋  | 3975/5148.0 [01:56<00:14, 80.23it/s]     77%|███████▋  | 3984/5148.0 [01:56<00:23, 48.82it/s]     78%|███████▊  | 3997/5148.0 [01:56<00:19, 59.93it/s]     78%|███████▊  | 4005/5148.0 [01:58<01:03, 17.96it/s]     78%|███████▊  | 4011/5148.0 [01:58<01:15, 15.02it/s]     78%|███████▊  | 4018/5148.0 [01:59<01:01, 18.41it/s]     78%|███████▊  | 4023/5148.0 [01:59<01:01, 18.21it/s]     78%|███████▊  | 4032/5148.0 [01:59<00:44, 25.02it/s]     78%|███████▊  | 4038/5148.0 [02:00<01:00, 18.21it/s]     79%|███████▊  | 4044/5148.0 [02:00<00:56, 19.71it/s]     79%|███████▊  | 4048/5148.0 [02:01<01:43, 10.64it/s]     79%|███████▊  | 4051/5148.0 [02:01<02:01,  9.01it/s]     79%|███████▊  | 4053/5148.0 [02:02<02:14,  8.14it/s]     79%|███████▉  | 4055/5148.0 [02:02<02:20,  7.77it/s]     79%|███████▉  | 4057/5148.0 [02:02<02:29,  7.27it/s]     79%|███████▉  | 4059/5148.0 [02:03<02:15,  8.04it/s]     79%|███████▉  | 4061/5148.0 [02:03<02:22,  7.64it/s]     79%|███████▉  | 4062/5148.0 [02:03<02:42,  6.69it/s]     79%|███████▉  | 4063/5148.0 [02:04<03:15,  5.55it/s]     79%|███████▉  | 4064/5148.0 [02:04<03:15,  5.53it/s]     79%|███████▉  | 4065/5148.0 [02:04<03:35,  5.03it/s]     79%|███████▉  | 4066/5148.0 [02:04<03:48,  4.73it/s]     79%|███████▉  | 4067/5148.0 [02:05<04:26,  4.06it/s]     79%|███████▉  | 4068/5148.0 [02:05<04:31,  3.98it/s]     79%|███████▉  | 4069/5148.0 [02:05<03:47,  4.73it/s]     79%|███████▉  | 4080/5148.0 [02:05<00:52, 20.49it/s]     79%|███████▉  | 4084/5148.0 [02:05<00:56, 18.70it/s]     79%|███████▉  | 4088/5148.0 [02:05<00:50, 20.99it/s]     79%|███████▉  | 4091/5148.0 [02:06<00:58, 17.95it/s]     80%|███████▉  | 4099/5148.0 [02:06<00:37, 28.22it/s]     80%|███████▉  | 4103/5148.0 [02:06<00:50, 20.62it/s]     80%|███████▉  | 4113/5148.0 [02:06<00:32, 31.99it/s]     80%|███████▉  | 4118/5148.0 [02:07<00:43, 23.88it/s]     80%|████████  | 4122/5148.0 [02:07<00:42, 24.17it/s]     80%|████████  | 4126/5148.0 [02:07<00:50, 20.12it/s]     80%|████████  | 4134/5148.0 [02:07<00:38, 26.21it/s]     80%|████████  | 4138/5148.0 [02:08<00:44, 22.47it/s]     81%|████████  | 4145/5148.0 [02:08<00:34, 29.37it/s]     81%|████████  | 4152/5148.0 [02:08<00:33, 30.17it/s]     81%|████████  | 4156/5148.0 [02:08<00:34, 29.17it/s]     81%|████████  | 4166/5148.0 [02:08<00:23, 41.95it/s]     81%|████████  | 4172/5148.0 [02:09<00:35, 27.61it/s]     81%|████████  | 4177/5148.0 [02:09<00:45, 21.36it/s]     81%|████████  | 4181/5148.0 [02:09<00:42, 22.86it/s]     81%|████████▏ | 4185/5148.0 [02:10<00:55, 17.28it/s]     81%|████████▏ | 4188/5148.0 [02:10<00:54, 17.71it/s]     81%|████████▏ | 4191/5148.0 [02:10<01:04, 14.73it/s]     82%|████████▏ | 4203/5148.0 [02:10<00:33, 28.09it/s]     82%|████████▏ | 4210/5148.0 [02:10<00:34, 27.38it/s]     82%|████████▏ | 4214/5148.0 [02:11<00:34, 27.42it/s]     82%|████████▏ | 4224/5148.0 [02:11<00:25, 36.86it/s]     82%|████████▏ | 4229/5148.0 [02:11<00:50, 18.16it/s]     82%|████████▏ | 4233/5148.0 [02:12<01:03, 14.50it/s]     82%|████████▏ | 4236/5148.0 [02:12<01:09, 13.21it/s]     82%|████████▏ | 4239/5148.0 [02:13<01:16, 11.91it/s]     82%|████████▏ | 4241/5148.0 [02:13<01:13, 12.34it/s]     82%|████████▏ | 4243/5148.0 [02:13<01:25, 10.64it/s]     82%|████████▏ | 4245/5148.0 [02:13<01:16, 11.73it/s]     82%|████████▏ | 4247/5148.0 [02:13<01:17, 11.60it/s]     83%|████████▎ | 4249/5148.0 [02:14<01:32,  9.69it/s]     83%|████████▎ | 4251/5148.0 [02:14<01:37,  9.17it/s]     83%|████████▎ | 4253/5148.0 [02:14<01:29,  9.95it/s]     83%|████████▎ | 4260/5148.0 [02:14<00:55, 16.11it/s]     83%|████████▎ | 4262/5148.0 [02:15<01:14, 11.94it/s]     83%|████████▎ | 4265/5148.0 [02:15<01:02, 14.23it/s]     83%|████████▎ | 4277/5148.0 [02:15<00:27, 31.50it/s]     83%|████████▎ | 4285/5148.0 [02:15<00:24, 35.22it/s]     83%|████████▎ | 4290/5148.0 [02:15<00:30, 27.71it/s]     83%|████████▎ | 4296/5148.0 [02:15<00:26, 31.87it/s]     84%|████████▎ | 4302/5148.0 [02:16<00:24, 34.62it/s]     84%|████████▎ | 4307/5148.0 [02:16<00:32, 25.91it/s]     84%|████████▍ | 4324/5148.0 [02:16<00:17, 47.44it/s]     84%|████████▍ | 4331/5148.0 [02:16<00:23, 35.19it/s]     85%|████████▍ | 4351/5148.0 [02:16<00:13, 59.44it/s]     85%|████████▍ | 4361/5148.0 [02:17<00:12, 64.50it/s]     85%|████████▍ | 4370/5148.0 [02:17<00:16, 47.97it/s]     85%|████████▌ | 4378/5148.0 [02:17<00:17, 44.77it/s]     85%|████████▌ | 4385/5148.0 [02:17<00:16, 47.24it/s]     85%|████████▌ | 4391/5148.0 [02:18<00:20, 36.25it/s]     85%|████████▌ | 4401/5148.0 [02:18<00:16, 45.82it/s]     86%|████████▌ | 4408/5148.0 [02:18<00:15, 47.62it/s]     86%|████████▌ | 4420/5148.0 [02:18<00:13, 54.88it/s]     86%|████████▌ | 4427/5148.0 [02:18<00:17, 42.27it/s]     86%|████████▋ | 4441/5148.0 [02:18<00:12, 56.30it/s]     86%|████████▋ | 4452/5148.0 [02:18<00:11, 63.04it/s]     87%|████████▋ | 4460/5148.0 [02:19<00:14, 46.65it/s]     87%|████████▋ | 4470/5148.0 [02:19<00:12, 53.41it/s]     87%|████████▋ | 4477/5148.0 [02:19<00:12, 55.43it/s]     87%|████████▋ | 4484/5148.0 [02:19<00:19, 34.30it/s]     87%|████████▋ | 4490/5148.0 [02:20<00:20, 31.93it/s]     87%|████████▋ | 4495/5148.0 [02:20<00:24, 26.74it/s]     87%|████████▋ | 4499/5148.0 [02:20<00:28, 22.66it/s]     87%|████████▋ | 4503/5148.0 [02:20<00:27, 23.86it/s]     88%|████████▊ | 4506/5148.0 [02:21<00:34, 18.78it/s]     88%|████████▊ | 4510/5148.0 [02:21<00:30, 21.16it/s]     88%|████████▊ | 4519/5148.0 [02:21<00:19, 32.08it/s]     88%|████████▊ | 4528/5148.0 [02:21<00:14, 42.39it/s]     88%|████████▊ | 4534/5148.0 [02:21<00:19, 31.06it/s]     88%|████████▊ | 4547/5148.0 [02:21<00:12, 46.87it/s]     89%|████████▊ | 4557/5148.0 [02:22<00:10, 54.67it/s]     89%|████████▊ | 4565/5148.0 [02:22<00:16, 35.91it/s]     89%|████████▉ | 4573/5148.0 [02:22<00:13, 41.67it/s]     89%|████████▉ | 4579/5148.0 [02:22<00:12, 43.97it/s]     89%|████████▉ | 4585/5148.0 [02:22<00:12, 45.70it/s]     89%|████████▉ | 4591/5148.0 [02:23<00:18, 30.70it/s]     89%|████████▉ | 4605/5148.0 [02:23<00:11, 47.59it/s]     90%|████████▉ | 4612/5148.0 [02:23<00:15, 34.33it/s]     90%|████████▉ | 4618/5148.0 [02:23<00:14, 35.48it/s]     90%|████████▉ | 4629/5148.0 [02:23<00:11, 46.52it/s]     90%|█████████ | 4639/5148.0 [02:24<00:09, 55.48it/s]     90%|█████████ | 4647/5148.0 [02:24<00:12, 39.55it/s]     90%|█████████ | 4653/5148.0 [02:24<00:12, 40.89it/s]     91%|█████████ | 4665/5148.0 [02:24<00:08, 54.20it/s]     91%|█████████ | 4673/5148.0 [02:25<00:12, 37.20it/s]     91%|█████████ | 4685/5148.0 [02:25<00:09, 46.77it/s]     91%|█████████ | 4692/5148.0 [02:25<00:15, 28.77it/s]     91%|█████████ | 4697/5148.0 [02:26<00:16, 26.70it/s]     91%|█████████▏| 4702/5148.0 [02:26<00:19, 22.98it/s]     91%|█████████▏| 4709/5148.0 [02:26<00:15, 28.69it/s]     92%|█████████▏| 4718/5148.0 [02:26<00:11, 37.88it/s]     92%|█████████▏| 4735/5148.0 [02:26<00:06, 60.22it/s]     92%|█████████▏| 4744/5148.0 [02:26<00:06, 64.36it/s]     92%|█████████▏| 4760/5148.0 [02:27<00:06, 59.32it/s]     93%|█████████▎| 4768/5148.0 [02:27<00:07, 50.92it/s]     93%|█████████▎| 4780/5148.0 [02:27<00:05, 61.47it/s]     93%|█████████▎| 4788/5148.0 [02:27<00:07, 46.89it/s]     93%|█████████▎| 4804/5148.0 [02:27<00:05, 64.85it/s]     94%|█████████▎| 4815/5148.0 [02:28<00:05, 60.69it/s]     94%|█████████▎| 4823/5148.0 [02:29<00:15, 21.15it/s]     94%|█████████▍| 4829/5148.0 [02:29<00:14, 21.42it/s]     94%|█████████▍| 4834/5148.0 [02:30<00:18, 16.65it/s]     94%|█████████▍| 4838/5148.0 [02:30<00:20, 14.77it/s]     94%|█████████▍| 4841/5148.0 [02:30<00:19, 15.57it/s]     94%|█████████▍| 4849/5148.0 [02:30<00:13, 21.95it/s]     94%|█████████▍| 4853/5148.0 [02:30<00:13, 21.62it/s]     94%|█████████▍| 4857/5148.0 [02:31<00:13, 21.98it/s]     94%|█████████▍| 4860/5148.0 [02:31<00:15, 18.97it/s]     94%|█████████▍| 4863/5148.0 [02:31<00:14, 19.66it/s]     95%|█████████▍| 4866/5148.0 [02:31<00:17, 16.14it/s]     95%|█████████▍| 4872/5148.0 [02:31<00:12, 21.42it/s]     95%|█████████▍| 4875/5148.0 [02:32<00:14, 18.40it/s]     95%|█████████▍| 4880/5148.0 [02:32<00:11, 23.06it/s]     95%|█████████▍| 4883/5148.0 [02:32<00:14, 18.56it/s]     95%|█████████▍| 4886/5148.0 [02:32<00:17, 14.65it/s]     95%|█████████▍| 4888/5148.0 [02:33<00:20, 12.52it/s]     95%|█████████▌| 4897/5148.0 [02:33<00:10, 23.69it/s]     95%|█████████▌| 4901/5148.0 [02:33<00:10, 22.53it/s]     95%|█████████▌| 4905/5148.0 [02:33<00:10, 23.85it/s]     95%|█████████▌| 4909/5148.0 [02:33<00:11, 19.93it/s]     96%|█████████▌| 4920/5148.0 [02:34<00:07, 29.45it/s]     96%|█████████▌| 4924/5148.0 [02:34<00:08, 27.06it/s]     96%|█████████▌| 4930/5148.0 [02:34<00:06, 31.85it/s]     96%|█████████▌| 4934/5148.0 [02:34<00:08, 26.14it/s]     96%|█████████▌| 4942/5148.0 [02:34<00:06, 33.67it/s]     96%|█████████▌| 4946/5148.0 [02:35<00:06, 29.27it/s]     96%|█████████▌| 4952/5148.0 [02:35<00:07, 27.93it/s]     96%|█████████▋| 4956/5148.0 [02:35<00:08, 23.68it/s]     96%|█████████▋| 4959/5148.0 [02:35<00:12, 15.48it/s]     96%|█████████▋| 4964/5148.0 [02:36<00:09, 19.14it/s]     96%|█████████▋| 4967/5148.0 [02:36<00:11, 16.15it/s]     97%|█████████▋| 4971/5148.0 [02:36<00:09, 18.58it/s]     97%|█████████▋| 4974/5148.0 [02:36<00:10, 16.14it/s]     97%|█████████▋| 4978/5148.0 [02:36<00:09, 17.42it/s]     97%|█████████▋| 4981/5148.0 [02:37<00:09, 17.24it/s]     97%|█████████▋| 4989/5148.0 [02:37<00:08, 19.73it/s]     97%|█████████▋| 4997/5148.0 [02:37<00:05, 26.71it/s]     97%|█████████▋| 5001/5148.0 [02:37<00:05, 24.54it/s]     97%|█████████▋| 5007/5148.0 [02:38<00:05, 25.57it/s]     97%|█████████▋| 5010/5148.0 [02:38<00:05, 23.69it/s]     97%|█████████▋| 5013/5148.0 [02:38<00:06, 20.13it/s]     98%|█████████▊| 5053/5148.0 [02:38<00:01, 84.52it/s]     99%|█████████▉| 5111/5148.0 [02:38<00:00, 119.51it/s]    100%|█████████▉| 5126/5148.0 [02:39<00:00, 55.47it/s]     100%|█████████▉| 5137/5148.0 [02:40<00:00, 36.14it/s]    100%|█████████▉| 5145/5148.0 [02:41<00:00, 33.85it/s]    100%|██████████| 5148/5148.0 [02:41<00:00, 31.97it/s]




.. GENERATED FROM PYTHON SOURCE LINES 75-78

Calculate the crossing invariant tensor indices [Kaden2016]_ : the parallel
diffusivity, the perpendicular diffusivity, the fractional anisotropy and
the mean diffusivity.

.. GENERATED FROM PYTHON SOURCE LINES 78-84

.. code-block:: Python


    d_par = f_fit.dpar
    d_perp = f_fit.dperp
    fa = f_fit.fractional_anisotropy()
    md = f_fit.mean_diffusivity()








.. GENERATED FROM PYTHON SOURCE LINES 85-86

Show the indices and save them in FORECAST_indices.png.

.. GENERATED FROM PYTHON SOURCE LINES 86-110

.. code-block:: Python


    fig = plt.figure(figsize=(6, 6))
    ax1 = fig.add_subplot(2, 2, 1, title='parallel diffusivity')
    ax1.set_axis_off()
    ind = ax1.imshow(d_par[:, :, 0].T, interpolation='nearest',
                     origin='lower', cmap=plt.cm.gray)
    plt.colorbar(ind, shrink=0.6)
    ax2 = fig.add_subplot(2, 2, 2, title='perpendicular diffusivity')
    ax2.set_axis_off()
    ind = ax2.imshow(d_perp[:, :, 0].T, interpolation='nearest',
                     origin='lower', cmap=plt.cm.gray)
    plt.colorbar(ind, shrink=0.6)
    ax3 = fig.add_subplot(2, 2, 3, title='fractional anisotropy')
    ax3.set_axis_off()
    ind = ax3.imshow(fa[:, :, 0].T, interpolation='nearest',
                     origin='lower', cmap=plt.cm.gray)
    plt.colorbar(ind, shrink=0.6)
    ax4 = fig.add_subplot(2, 2, 4, title='mean diffusivity')
    ax4.set_axis_off()
    ind = ax4.imshow(md[:, :, 0].T, interpolation='nearest',
                     origin='lower', cmap=plt.cm.gray)
    plt.colorbar(ind, shrink=0.6)
    plt.savefig('FORECAST_indices.png', dpi=300, bbox_inches='tight')




.. image-sg:: /examples_built/reconstruction/images/sphx_glr_reconst_forecast_001.png
   :alt: reconst forecast
   :srcset: /examples_built/reconstruction/images/sphx_glr_reconst_forecast_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 111-117

.. rst-class:: centered small fst-italic fw-semibold

FORECAST scalar indices.


Load an ODF reconstruction sphere

.. GENERATED FROM PYTHON SOURCE LINES 117-120

.. code-block:: Python


    sphere = get_sphere('repulsion724')








.. GENERATED FROM PYTHON SOURCE LINES 121-122

Compute the fODFs.

.. GENERATED FROM PYTHON SOURCE LINES 122-126

.. code-block:: Python


    odf = f_fit.odf(sphere)
    print('fODF.shape (%d, %d, %d, %d)' % odf.shape)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    fODF.shape (108, 129, 1, 724)




.. GENERATED FROM PYTHON SOURCE LINES 127-128

Display a part of the fODFs

.. GENERATED FROM PYTHON SOURCE LINES 128-135

.. code-block:: Python


    odf_actor = actor.odf_slicer(odf[30:60, 30:60, :], sphere=sphere,
                                 colormap='plasma', scale=0.6)
    scene = window.Scene()
    scene.add(odf_actor)
    window.record(scene, out_path='fODFs.png', size=(600, 600), magnification=4)




.. image-sg:: /examples_built/reconstruction/images/sphx_glr_reconst_forecast_002.png
   :alt: reconst forecast
   :srcset: /examples_built/reconstruction/images/sphx_glr_reconst_forecast_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 136-163

.. rst-class:: centered small fst-italic fw-semibold

Fiber Orientation Distribution Functions, in a small ROI of the brain.


References
----------

.. [Anderson2005] Anderson A. W., "Measurement of Fiber Orientation
       Distributions Using High Angular Resolution Diffusion Imaging",
       Magnetic Resonance in Medicine, 2005.

.. [Kaden2016] Kaden E. et al., "Quantitative Mapping of the Per-Axon
       Diffusion Coefficients in Brain White Matter", Magnetic Resonance
       in Medicine, 2016.

.. [Zucchelli2017] Zucchelli E. et al., "A generalized SMT-based framework
       for Diffusion MRI microstructural model estimation", MICCAI Workshop
       on Computational DIFFUSION MRI (CDMRI), 2017.

.. [Alexander2017] Alexander LM, Escalera J, Ai L, et al. An open resource
       for transdiagnostic research in pediatric mental health and learning
       disorders. Sci Data. 2017;4:170181.

.. [RichieHalford2022] Richie-Halford A, Cieslak M, Ai L, et al. An
       analysis-ready and quality controlled resource for pediatric brain
       white-matter research. Scientific Data. 2022;9(1):1-27.

.. GENERATED FROM PYTHON SOURCE LINES 165-167

.. include:: ../../links_names.inc



.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (3 minutes 36.057 seconds)


.. _sphx_glr_download_examples_built_reconstruction_reconst_forecast.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: reconst_forecast.ipynb <reconst_forecast.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: reconst_forecast.py <reconst_forecast.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
