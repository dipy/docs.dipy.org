
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples_built/reconstruction/reconst_mcsd.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_built_reconstruction_reconst_mcsd.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_built_reconstruction_reconst_mcsd.py:


.. _reconst-mcsd:

================================================
Reconstruction with Multi-Shell Multi-Tissue CSD
================================================

This example shows how to use Multi-Shell Multi-Tissue Constrained Spherical
Deconvolution (MSMT-CSD) introduced by Tournier et al. [Jeurissen2014]_. This
tutorial goes through the steps involved in implementing the method.

This method provides improved White Matter(WM), Grey Matter (GM), and
Cerebrospinal fluid (CSF) volume fraction maps, which is otherwise
overestimated in the standard CSD (SSST-CSD). This is done by using b-value
dependencies of the different tissue types to estimate ODFs. This method thus
extends the SSST-CSD introduced in [Tournier2007]_.

The reconstruction of the fiber orientation distribution function
(fODF) in MSMT-CSD involves the following steps:
    1. Generate a mask using Median Otsu (optional step)
    2. Denoise the data using MP-PCA (optional step)
    3. Generate  Anisotropic Powermap (if T1 unavailable)
    4. Fit DTI model to the data
    5. Tissue Classification (needs to be at least two classes of tissues)
    6. Estimation of the fiber response function
    7. Use the response function to reconstruct the fODF

First, we import all the modules we need from dipy as follows:

.. GENERATED FROM PYTHON SOURCE LINES 31-52

.. code-block:: Python


    import numpy as np
    import dipy.reconst.shm as shm
    import dipy.direction.peaks as dp
    import matplotlib.pyplot as plt

    from dipy.denoise.localpca import mppca
    from dipy.core.gradients import gradient_table, unique_bvals_tolerance
    from dipy.io.gradients import read_bvals_bvecs
    from dipy.io.image import load_nifti
    from dipy.segment.mask import median_otsu
    from dipy.reconst.mcsd import (auto_response_msmt,
                                   mask_for_response_msmt,
                                   response_from_mask_msmt)
    from dipy.segment.tissue import TissueClassifierHMRF
    from dipy.reconst.mcsd import MultiShellDeconvModel, multi_shell_fiber_response
    from dipy.viz import window, actor

    from dipy.data import get_sphere, get_fnames
    sphere = get_sphere('symmetric724')








.. GENERATED FROM PYTHON SOURCE LINES 53-57

For this example, we use fetch to download a multi-shell dataset which was
kindly provided by Hansen and Jespersen (more details about the data are
provided in their paper [Hansen2016]_). The total size of the downloaded
data is 192 MBytes, however you only need to fetch it once.

.. GENERATED FROM PYTHON SOURCE LINES 57-64

.. code-block:: Python


    fraw, fbval, fbvec, t1_fname = get_fnames('cfin_multib')

    data, affine = load_nifti(fraw)
    bvals, bvecs = read_bvals_bvecs(fbval, fbvec)
    gtab = gradient_table(bvals, bvecs)








.. GENERATED FROM PYTHON SOURCE LINES 65-67

For the sake of simplicity, we only select two non-zero b-values for this
example.

.. GENERATED FROM PYTHON SOURCE LINES 67-74

.. code-block:: Python


    bvals = gtab.bvals
    bvecs = gtab.bvecs

    sel_b = np.logical_or(np.logical_or(bvals == 0, bvals == 1000), bvals == 2000)
    data = data[..., sel_b]








.. GENERATED FROM PYTHON SOURCE LINES 75-77

The gradient table is also selected to have the selected b-values (0, 1000
and 2000)

.. GENERATED FROM PYTHON SOURCE LINES 77-80

.. code-block:: Python


    gtab = gradient_table(bvals[sel_b], bvecs[sel_b])








.. GENERATED FROM PYTHON SOURCE LINES 81-83

We make use of the ``median_otsu`` method to generate the mask for the data
as follows:

.. GENERATED FROM PYTHON SOURCE LINES 83-88

.. code-block:: Python


    b0_mask, mask = median_otsu(data, median_radius=2, numpass=1, vol_idx=[0, 1])

    print(data.shape)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    (96, 96, 19, 67)




.. GENERATED FROM PYTHON SOURCE LINES 89-92

As one can see from its shape, the selected data contains a total of 67
volumes of images corresponding to all the diffusion gradient directions
of the selected b-values and call the ``mppca`` as follows:

.. GENERATED FROM PYTHON SOURCE LINES 92-95

.. code-block:: Python


    denoised_arr = mppca(data, mask=mask, patch_radius=2)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/skoudoro/devel/dipy-release/dipy/denoise/localpca.py:379: RuntimeWarning: invalid value encountered in divide
      denoised_arr = thetax / theta




.. GENERATED FROM PYTHON SOURCE LINES 96-101

Now we will use the denoised array (``denoised_arr``) obtained from ``mppca``
in the rest of the steps in the tutorial.

As for the next step, we generate the anisotropic powermap introduced by
[DellAcqua2014]_. To do so, we make use of the Q-ball Model as follows:

.. GENERATED FROM PYTHON SOURCE LINES 101-104

.. code-block:: Python


    qball_model = shm.QballModel(gtab, 8)








.. GENERATED FROM PYTHON SOURCE LINES 105-106

We generate the peaks from the ``qball_model`` as follows:

.. GENERATED FROM PYTHON SOURCE LINES 106-118

.. code-block:: Python


    peaks = dp.peaks_from_model(model=qball_model, data=denoised_arr,
                                relative_peak_threshold=.5,
                                min_separation_angle=25,
                                sphere=sphere, mask=mask)

    ap = shm.anisotropic_power(peaks.shm_coeff)

    plt.matshow(np.rot90(ap[:, :, 10]), cmap=plt.cm.bone)
    plt.savefig("anisotropic_power_map.png")
    plt.close()




.. image-sg:: /examples_built/reconstruction/images/sphx_glr_reconst_mcsd_001.png
   :alt: reconst mcsd
   :srcset: /examples_built/reconstruction/images/sphx_glr_reconst_mcsd_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 119-122

.. rst-class:: centered small fst-italic fw-semibold

Anisotropic Power Map (Axial Slice)

.. GENERATED FROM PYTHON SOURCE LINES 122-125

.. code-block:: Python


    print(ap.shape)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    (96, 96, 19)




.. GENERATED FROM PYTHON SOURCE LINES 126-137

The above figure is a visualization of the axial slice of the Anisotropic
Power Map. It can be treated as a pseudo-T1 for classification purposes
using the Hidden Markov Random Fields (HMRF) classifier, if the T1 image
is not available.

As we can see from the shape of the Anisotropic Power Map, it is 3D and can
be used for tissue classification using HMRF. The
HMRF needs the specification of the number of classes. For the case of
MSMT-CSD the ``nclass`` parameter needs to be ``>=2``. In our case, we set
it to 3: namely corticospinal fluid (csf), white matter (wm) and gray
matter (gm).

.. GENERATED FROM PYTHON SOURCE LINES 137-140

.. code-block:: Python


    nclass = 3








.. GENERATED FROM PYTHON SOURCE LINES 141-143

Then, the smoothness factor of the segmentation. Good performance is achieved
with values between 0 and 0.5.

.. GENERATED FROM PYTHON SOURCE LINES 143-146

.. code-block:: Python


    beta = 0.1








.. GENERATED FROM PYTHON SOURCE LINES 147-149

We then call the ``TissueClassifierHMRF`` with the parameters specified as
above:

.. GENERATED FROM PYTHON SOURCE LINES 149-153

.. code-block:: Python


    hmrf = TissueClassifierHMRF()
    initial_segmentation, final_segmentation, PVE = hmrf.classify(ap, nclass, beta)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    >> Iteration: 0
    >> Iteration: 1
    >> Iteration: 2
    >> Iteration: 3
    >> Iteration: 4
    >> Iteration: 5
    >> Iteration: 6
    >> Iteration: 7
    >> Iteration: 8
    >> Iteration: 9
    >> Iteration: 10
    >> Iteration: 11
    >> Iteration: 12
    >> Iteration: 13
    >> Iteration: 14
    >> Iteration: 15
    >> Iteration: 16
    >> Iteration: 17
    >> Iteration: 18
    >> Iteration: 19
    >> Iteration: 20
    >> Iteration: 21
    >> Iteration: 22
    >> Iteration: 23




.. GENERATED FROM PYTHON SOURCE LINES 154-155

Then, we get the tissues segmentation from the final_segmentation.

.. GENERATED FROM PYTHON SOURCE LINES 155-160

.. code-block:: Python


    csf = np.where(final_segmentation == 1, 1, 0)
    gm = np.where(final_segmentation == 2, 1, 0)
    wm = np.where(final_segmentation == 3, 1, 0)








.. GENERATED FROM PYTHON SOURCE LINES 161-175

Now, we want the response function for each of the three tissues and for each
bvalues. This can be achieved in two different ways. If the case that tissue
segmentation is available or that one wants to see the tissue masks used to
compute the response functions, a combination of the functions
``mask_for_response_msmt`` and ``response_from_mask`` is needed.

The ``mask_for_response_msmt`` function will return a mask of voxels within a
cuboid ROI and that meet some threshold constraints, for each tissue and
bvalue. More precisely, the WM mask must have a FA value above a given
threshold. The GM mask and CSF mask must have a FA below given thresholds
and a MD below other thresholds.

Note that for ``mask_for_response_msmt``, the gtab and data should be for
bvalues under 1200, for optimal tensor fit.

.. GENERATED FROM PYTHON SOURCE LINES 175-183

.. code-block:: Python


    mask_wm, mask_gm, mask_csf = mask_for_response_msmt(gtab, data, roi_radii=10,
                                                        wm_fa_thr=0.7,
                                                        gm_fa_thr=0.3,
                                                        csf_fa_thr=0.15,
                                                        gm_md_thr=0.001,
                                                        csf_md_thr=0.0032)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/skoudoro/devel/dipy-release/dipy/reconst/mcsd.py:616: UserWarning: Some b-values are higher than 1200.
            The DTI fit might be affected.
      warnings.warn(msg_bvals, UserWarning)




.. GENERATED FROM PYTHON SOURCE LINES 184-187

If one wants to use the previously computed tissue segmentation in addition
to the threshold method, it is possible by simply multiplying both masks
together.

.. GENERATED FROM PYTHON SOURCE LINES 187-192

.. code-block:: Python


    mask_wm *= wm
    mask_gm *= gm
    mask_csf *= csf








.. GENERATED FROM PYTHON SOURCE LINES 193-194

The masks can also be used to calculate the number of voxels for each tissue.

.. GENERATED FROM PYTHON SOURCE LINES 194-201

.. code-block:: Python


    nvoxels_wm = np.sum(mask_wm)
    nvoxels_gm = np.sum(mask_gm)
    nvoxels_csf = np.sum(mask_csf)

    print(nvoxels_wm)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    1407




.. GENERATED FROM PYTHON SOURCE LINES 202-204

Then, the ``response_from_mask`` function will return the msmt response
functions using precalculated tissue masks.

.. GENERATED FROM PYTHON SOURCE LINES 204-210

.. code-block:: Python


    response_wm, response_gm, response_csf = response_from_mask_msmt(gtab, data,
                                                                     mask_wm,
                                                                     mask_gm,
                                                                     mask_csf)








.. GENERATED FROM PYTHON SOURCE LINES 211-216

Note that we can also get directly the response functions by calling the
``auto_response_msmt`` function, which internally calls
``mask_for_response_msmt`` followed by ``response_from_mask``. By doing so,
we don't have access to the masks and we might have problems with high
bvalues tensor fit.

.. GENERATED FROM PYTHON SOURCE LINES 216-220

.. code-block:: Python


    auto_response_wm, auto_response_gm, auto_response_csf = \
        auto_response_msmt(gtab, data, roi_radii=10)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/skoudoro/devel/dipy-release/dipy/reconst/mcsd.py:810: UserWarning: Some b-values are higher than 1200.
            The DTI fit might be affected. It is advised to use
            mask_for_response_msmt with bvalues lower than 1200, followed by
            response_from_mask_msmt with all bvalues to overcome this.
      warnings.warn(msg_bvals, UserWarning)




.. GENERATED FROM PYTHON SOURCE LINES 221-223

As we can see below, adding the tissue segmentation can change the results
of the response functions.

.. GENERATED FROM PYTHON SOURCE LINES 223-233

.. code-block:: Python


    print("Responses")
    print(response_wm)
    print(response_gm)
    print(response_csf)
    print("Auto responses")
    print(auto_response_wm)
    print(auto_response_gm)
    print(auto_response_csf)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Responses
    [[1.56692320e-03 4.46085143e-04 4.46085143e-04 1.62131485e+02]
     [1.34276461e-03 3.52534556e-04 3.52534556e-04 1.62131485e+02]]
    [[9.71997238e-04 8.03193240e-04 8.03193240e-04 1.83911565e+02]
     [8.84828549e-04 7.24057454e-04 7.24057454e-04 1.83911565e+02]]
    [[1.48173768e-03 1.33583578e-03 1.33583578e-03 2.54048426e+02]
     [1.19247972e-03 1.03434085e-03 1.03434085e-03 2.54048426e+02]]
    Auto responses
    [[1.70814058e-03 5.99497542e-04 5.99497542e-04 1.66589967e+02]
     [1.37647490e-03 4.22844899e-04 4.22844899e-04 1.66589967e+02]]
    [[1.02876747e-03 8.64284096e-04 8.64284096e-04 1.90155949e+02]
     [9.05450074e-04 7.52760292e-04 7.52760292e-04 1.90155949e+02]]
    [[1.33298612e-03 1.19461602e-03 1.19461602e-03 2.31346774e+02]
     [1.09567957e-03 9.48548376e-04 9.48548376e-04 2.31346774e+02]]




.. GENERATED FROM PYTHON SOURCE LINES 234-241

At this point, there are two options on how to use those response functions.
We want to create a MultiShellDeconvModel, which takes a response function as
input. This response function can either be directly in the current format,
or it can be a MultiShellResponse format, as produced by the
``multi_shell_fiber_response`` method. This function assumes a 3 compartments
model (wm, gm, csf) and takes one response function per tissue per bvalue. It
is important to note that the bvalues must be unique for this function.

.. GENERATED FROM PYTHON SOURCE LINES 241-249

.. code-block:: Python


    ubvals = unique_bvals_tolerance(gtab.bvals)
    response_mcsd = multi_shell_fiber_response(sh_order_max=8,
                                               bvals=ubvals,
                                               wm_rf=response_wm,
                                               gm_rf=response_gm,
                                               csf_rf=response_csf)








.. GENERATED FROM PYTHON SOURCE LINES 250-256

As mentioned, we can also build the model directly and it will call
``multi_shell_fiber_response`` internally. Important note here, the function
``unique_bvals_tolerance`` is used to keep only unique bvalues from the gtab
given to the model, as input for ``multi_shell_fiber_response``. This may
introduce differences between the calculated response of each method,
depending on the bvalues given to ``multi_shell_fiber_response`` externally.

.. GENERATED FROM PYTHON SOURCE LINES 256-262

.. code-block:: Python


    response = np.array([response_wm, response_gm, response_csf])
    mcsd_model_simple_response = MultiShellDeconvModel(gtab,
                                                       response,
                                                       sh_order_max=8)








.. GENERATED FROM PYTHON SOURCE LINES 263-269

Note that this technique only works for a 3 compartments model (wm, gm, csf).
If one wants more compartments, a custom MultiShellResponse object must be
used. It can be inspired by the ``multi_shell_fiber_response`` method.

Now we build the MSMT-CSD model with the ``response_mcsd`` as input. We then
call the ``fit`` function to fit one slice of the 3D data and visualize it.

.. GENERATED FROM PYTHON SOURCE LINES 269-273

.. code-block:: Python


    mcsd_model = MultiShellDeconvModel(gtab, response_mcsd)
    mcsd_fit = mcsd_model.fit(denoised_arr[:, :, 10:11])





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/9216 [00:00<?, ?it/s]      0%|          | 20/9216 [00:00<00:48, 191.32it/s]      0%|          | 40/9216 [00:00<00:47, 193.64it/s]      1%|          | 60/9216 [00:00<00:47, 192.38it/s]      1%|          | 80/9216 [00:00<00:47, 193.09it/s]      1%|          | 100/9216 [00:00<00:46, 194.01it/s]      1%|▏         | 120/9216 [00:00<00:46, 194.54it/s]      2%|▏         | 140/9216 [00:00<00:46, 195.19it/s]      2%|▏         | 160/9216 [00:00<00:46, 193.60it/s]      2%|▏         | 181/9216 [00:00<00:46, 196.26it/s]      2%|▏         | 202/9216 [00:01<00:45, 198.38it/s]      2%|▏         | 223/9216 [00:01<00:45, 199.47it/s]      3%|▎         | 244/9216 [00:01<00:44, 200.07it/s]      3%|▎         | 265/9216 [00:01<00:44, 199.71it/s]      3%|▎         | 286/9216 [00:01<00:44, 199.86it/s]      3%|▎         | 307/9216 [00:01<00:44, 199.94it/s]      4%|▎         | 328/9216 [00:01<00:44, 200.41it/s]      4%|▍         | 349/9216 [00:01<00:44, 201.00it/s]      4%|▍         | 370/9216 [00:01<00:43, 201.48it/s]      4%|▍         | 391/9216 [00:01<00:43, 201.77it/s]      4%|▍         | 412/9216 [00:02<00:43, 201.88it/s]      5%|▍         | 433/9216 [00:02<00:43, 202.09it/s]      5%|▍         | 454/9216 [00:02<00:43, 202.22it/s]      5%|▌         | 475/9216 [00:02<00:43, 202.33it/s]      5%|▌         | 496/9216 [00:02<00:43, 202.38it/s]      6%|▌         | 517/9216 [00:02<00:42, 202.38it/s]      6%|▌         | 538/9216 [00:02<00:42, 202.48it/s]      6%|▌         | 559/9216 [00:02<00:42, 202.37it/s]      6%|▋         | 580/9216 [00:02<00:43, 199.22it/s]      7%|▋         | 601/9216 [00:03<00:43, 200.10it/s]      7%|▋         | 622/9216 [00:03<00:42, 200.64it/s]      7%|▋         | 643/9216 [00:03<00:42, 201.03it/s]      7%|▋         | 664/9216 [00:03<00:42, 201.40it/s]      7%|▋         | 685/9216 [00:03<00:42, 200.57it/s]      8%|▊         | 706/9216 [00:03<00:42, 201.10it/s]      8%|▊         | 727/9216 [00:03<00:42, 201.47it/s]      8%|▊         | 748/9216 [00:03<00:41, 201.77it/s]      8%|▊         | 769/9216 [00:03<00:41, 201.90it/s]      9%|▊         | 790/9216 [00:03<00:41, 202.07it/s]      9%|▉         | 811/9216 [00:04<00:41, 202.21it/s]      9%|▉         | 832/9216 [00:04<00:41, 202.28it/s]      9%|▉         | 853/9216 [00:04<00:41, 202.26it/s]      9%|▉         | 874/9216 [00:04<00:41, 201.02it/s]     10%|▉         | 895/9216 [00:04<00:41, 201.34it/s]     10%|▉         | 916/9216 [00:04<00:41, 201.61it/s]     10%|█         | 937/9216 [00:04<00:41, 201.84it/s]     10%|█         | 958/9216 [00:04<00:40, 202.00it/s]     11%|█         | 979/9216 [00:04<00:40, 201.26it/s]     11%|█         | 1000/9216 [00:04<00:41, 198.96it/s]     11%|█         | 1020/9216 [00:05<00:41, 195.40it/s]     11%|█▏        | 1040/9216 [00:05<00:42, 192.15it/s]     12%|█▏        | 1060/9216 [00:05<00:43, 188.86it/s]     12%|█▏        | 1079/9216 [00:05<00:43, 185.22it/s]     12%|█▏        | 1098/9216 [00:05<00:44, 184.46it/s]     12%|█▏        | 1117/9216 [00:05<00:43, 185.06it/s]     12%|█▏        | 1136/9216 [00:05<00:43, 184.37it/s]     13%|█▎        | 1155/9216 [00:05<00:43, 184.78it/s]     13%|█▎        | 1175/9216 [00:05<00:42, 187.90it/s]     13%|█▎        | 1196/9216 [00:06<00:41, 191.68it/s]     13%|█▎        | 1216/9216 [00:06<00:41, 193.99it/s]     13%|█▎        | 1237/9216 [00:06<00:40, 196.08it/s]     14%|█▎        | 1258/9216 [00:06<00:40, 197.66it/s]     14%|█▍        | 1279/9216 [00:06<00:39, 198.63it/s]     14%|█▍        | 1300/9216 [00:06<00:39, 199.10it/s]     14%|█▍        | 1320/9216 [00:06<00:39, 199.19it/s]     15%|█▍        | 1341/9216 [00:06<00:39, 199.56it/s]     15%|█▍        | 1362/9216 [00:06<00:39, 199.96it/s]     15%|█▍        | 1382/9216 [00:06<00:39, 197.15it/s]     15%|█▌        | 1402/9216 [00:07<00:39, 197.51it/s]     15%|█▌        | 1422/9216 [00:07<00:39, 197.91it/s]     16%|█▌        | 1442/9216 [00:07<00:39, 198.20it/s]     16%|█▌        | 1462/9216 [00:07<00:39, 198.37it/s]     16%|█▌        | 1482/9216 [00:07<00:39, 197.31it/s]     16%|█▋        | 1502/9216 [00:07<00:39, 197.79it/s]     17%|█▋        | 1522/9216 [00:07<00:38, 198.28it/s]     17%|█▋        | 1542/9216 [00:07<00:38, 198.62it/s]     17%|█▋        | 1562/9216 [00:07<00:38, 198.74it/s]     17%|█▋        | 1582/9216 [00:07<00:38, 198.74it/s]     17%|█▋        | 1602/9216 [00:08<00:38, 198.99it/s]     18%|█▊        | 1622/9216 [00:08<00:38, 199.03it/s]     18%|█▊        | 1642/9216 [00:08<00:38, 197.58it/s]     18%|█▊        | 1662/9216 [00:08<00:38, 196.06it/s]     18%|█▊        | 1682/9216 [00:08<00:38, 195.41it/s]     18%|█▊        | 1702/9216 [00:08<00:38, 194.79it/s]     19%|█▊        | 1722/9216 [00:08<00:38, 194.86it/s]     19%|█▉        | 1742/9216 [00:08<00:38, 194.63it/s]     19%|█▉        | 1762/9216 [00:08<00:38, 194.50it/s]     19%|█▉        | 1782/9216 [00:09<00:38, 192.12it/s]     20%|█▉        | 1802/9216 [00:09<00:38, 191.46it/s]     20%|█▉        | 1822/9216 [00:09<00:38, 191.93it/s]     20%|█▉        | 1842/9216 [00:09<00:38, 192.68it/s]     20%|██        | 1862/9216 [00:09<00:38, 192.87it/s]     20%|██        | 1882/9216 [00:09<00:38, 192.16it/s]     21%|██        | 1902/9216 [00:09<00:38, 191.46it/s]     21%|██        | 1922/9216 [00:09<00:38, 191.34it/s]     21%|██        | 1942/9216 [00:09<00:37, 191.60it/s]     21%|██▏       | 1962/9216 [00:09<00:37, 191.29it/s]     22%|██▏       | 1982/9216 [00:10<00:37, 192.42it/s]     22%|██▏       | 2002/9216 [00:10<00:37, 194.21it/s]     22%|██▏       | 2022/9216 [00:10<00:36, 195.89it/s]     22%|██▏       | 2042/9216 [00:10<00:36, 196.53it/s]     22%|██▏       | 2062/9216 [00:10<00:36, 194.19it/s]     23%|██▎       | 2082/9216 [00:10<00:37, 191.03it/s]     23%|██▎       | 2102/9216 [00:10<00:37, 188.84it/s]     23%|██▎       | 2121/9216 [00:10<00:37, 188.50it/s]     23%|██▎       | 2141/9216 [00:10<00:37, 190.12it/s]     23%|██▎       | 2161/9216 [00:11<00:40, 172.98it/s]     24%|██▎       | 2180/9216 [00:11<00:39, 177.59it/s]     24%|██▍       | 2201/9216 [00:11<00:38, 184.10it/s]     24%|██▍       | 2221/9216 [00:11<00:37, 188.54it/s]     24%|██▍       | 2241/9216 [00:11<00:36, 191.71it/s]     25%|██▍       | 2261/9216 [00:11<00:51, 135.44it/s]     25%|██▍       | 2281/9216 [00:11<00:46, 149.66it/s]     25%|██▍       | 2301/9216 [00:11<00:42, 161.78it/s]     25%|██▌       | 2321/9216 [00:11<00:40, 171.60it/s]     25%|██▌       | 2340/9216 [00:12<00:43, 158.72it/s]     26%|██▌       | 2358/9216 [00:12<00:58, 117.89it/s]     26%|██▌       | 2373/9216 [00:12<00:55, 124.38it/s]     26%|██▌       | 2393/9216 [00:12<00:48, 141.69it/s]     26%|██▌       | 2414/9216 [00:12<00:43, 156.64it/s]     26%|██▋       | 2432/9216 [00:12<00:44, 153.82it/s]     27%|██▋       | 2449/9216 [00:13<00:56, 119.01it/s]     27%|██▋       | 2463/9216 [00:13<01:01, 109.39it/s]     27%|██▋       | 2483/9216 [00:13<00:52, 128.52it/s]     27%|██▋       | 2504/9216 [00:13<00:45, 146.11it/s]     27%|██▋       | 2523/9216 [00:13<00:42, 156.44it/s]     28%|██▊       | 2540/9216 [00:13<00:56, 117.55it/s]     28%|██▊       | 2554/9216 [00:13<01:03, 104.22it/s]     28%|██▊       | 2567/9216 [00:14<01:01, 107.87it/s]     28%|██▊       | 2588/9216 [00:14<00:51, 129.66it/s]     28%|██▊       | 2608/9216 [00:14<00:45, 145.64it/s]     28%|██▊       | 2624/9216 [00:14<00:45, 143.45it/s]     29%|██▊       | 2640/9216 [00:14<01:13, 89.79it/s]      29%|██▉       | 2653/9216 [00:15<01:38, 66.35it/s]     29%|██▉       | 2663/9216 [00:15<01:43, 63.30it/s]     29%|██▉       | 2684/9216 [00:15<01:15, 86.44it/s]     29%|██▉       | 2705/9216 [00:15<00:59, 108.68it/s]     30%|██▉       | 2720/9216 [00:15<01:23, 77.72it/s]      30%|██▉       | 2732/9216 [00:16<01:46, 61.05it/s]     30%|██▉       | 2742/9216 [00:16<02:11, 49.34it/s]     30%|██▉       | 2750/9216 [00:16<02:28, 43.44it/s]     30%|██▉       | 2757/9216 [00:16<02:18, 46.58it/s]     30%|███       | 2776/9216 [00:16<01:33, 69.24it/s]     30%|███       | 2797/9216 [00:17<01:07, 94.60it/s]     31%|███       | 2811/9216 [00:17<01:02, 101.72it/s]     31%|███       | 2824/9216 [00:17<02:02, 52.23it/s]      31%|███       | 2834/9216 [00:17<02:03, 51.73it/s]     31%|███       | 2843/9216 [00:18<02:13, 47.79it/s]     31%|███       | 2850/9216 [00:18<03:03, 34.69it/s]     31%|███       | 2856/9216 [00:18<02:59, 35.47it/s]     31%|███       | 2876/9216 [00:18<01:47, 58.97it/s]     31%|███▏      | 2896/9216 [00:18<01:16, 82.88it/s]     32%|███▏      | 2909/9216 [00:19<01:37, 64.79it/s]     32%|███▏      | 2920/9216 [00:19<02:32, 41.27it/s]     32%|███▏      | 2928/9216 [00:20<02:29, 41.97it/s]     32%|███▏      | 2935/9216 [00:20<02:18, 45.34it/s]     32%|███▏      | 2942/9216 [00:20<03:07, 33.38it/s]     32%|███▏      | 2948/9216 [00:20<03:27, 30.16it/s]     32%|███▏      | 2953/9216 [00:20<03:31, 29.58it/s]     32%|███▏      | 2973/9216 [00:21<01:54, 54.66it/s]     32%|███▏      | 2992/9216 [00:21<01:19, 77.93it/s]     33%|███▎      | 3004/9216 [00:21<01:38, 63.31it/s]     33%|███▎      | 3014/9216 [00:21<02:38, 39.04it/s]     33%|███▎      | 3022/9216 [00:22<02:25, 42.58it/s]     33%|███▎      | 3029/9216 [00:22<02:15, 45.57it/s]     33%|███▎      | 3036/9216 [00:22<02:28, 41.74it/s]     33%|███▎      | 3042/9216 [00:22<03:03, 33.60it/s]     33%|███▎      | 3047/9216 [00:22<03:16, 31.35it/s]     33%|███▎      | 3058/9216 [00:23<02:21, 43.53it/s]     33%|███▎      | 3079/9216 [00:23<01:23, 73.53it/s]     34%|███▎      | 3093/9216 [00:23<01:11, 85.99it/s]     34%|███▎      | 3105/9216 [00:23<01:41, 60.37it/s]     34%|███▍      | 3114/9216 [00:23<02:14, 45.38it/s]     34%|███▍      | 3121/9216 [00:24<02:18, 44.00it/s]     34%|███▍      | 3128/9216 [00:24<02:27, 41.29it/s]     34%|███▍      | 3136/9216 [00:24<02:08, 47.43it/s]     34%|███▍      | 3143/9216 [00:24<03:27, 29.23it/s]     34%|███▍      | 3148/9216 [00:25<03:14, 31.18it/s]     34%|███▍      | 3169/9216 [00:25<01:43, 58.51it/s]     35%|███▍      | 3187/9216 [00:25<01:15, 80.20it/s]     35%|███▍      | 3199/9216 [00:25<01:56, 51.58it/s]     35%|███▍      | 3209/9216 [00:26<02:43, 36.75it/s]     35%|███▍      | 3216/9216 [00:26<02:44, 36.41it/s]     35%|███▍      | 3222/9216 [00:26<02:35, 38.60it/s]     35%|███▌      | 3229/9216 [00:26<02:20, 42.57it/s]     35%|███▌      | 3235/9216 [00:27<03:16, 30.43it/s]     35%|███▌      | 3240/9216 [00:27<03:06, 32.00it/s]     35%|███▌      | 3245/9216 [00:27<02:53, 34.38it/s]     35%|███▌      | 3266/9216 [00:27<01:29, 66.80it/s]     36%|███▌      | 3282/9216 [00:27<01:13, 81.02it/s]     36%|███▌      | 3293/9216 [00:28<02:20, 42.23it/s]     36%|███▌      | 3301/9216 [00:28<02:32, 38.69it/s]     36%|███▌      | 3308/9216 [00:28<02:53, 34.12it/s]     36%|███▌      | 3315/9216 [00:28<02:36, 37.75it/s]     36%|███▌      | 3323/9216 [00:28<02:14, 43.86it/s]     36%|███▌      | 3329/9216 [00:29<02:16, 43.24it/s]     36%|███▌      | 3335/9216 [00:29<03:14, 30.19it/s]     36%|███▌      | 3340/9216 [00:29<03:22, 28.99it/s]     36%|███▋      | 3360/9216 [00:29<01:44, 55.92it/s]     37%|███▋      | 3377/9216 [00:29<01:22, 70.57it/s]     37%|███▋      | 3387/9216 [00:30<02:04, 46.87it/s]     37%|███▋      | 3395/9216 [00:30<02:50, 34.18it/s]     37%|███▋      | 3401/9216 [00:31<03:32, 27.39it/s]     37%|███▋      | 3409/9216 [00:31<02:56, 32.88it/s]     37%|███▋      | 3415/9216 [00:31<02:41, 35.92it/s]     37%|███▋      | 3421/9216 [00:31<02:29, 38.88it/s]     37%|███▋      | 3427/9216 [00:31<03:07, 30.94it/s]     37%|███▋      | 3432/9216 [00:32<03:22, 28.59it/s]     37%|███▋      | 3448/9216 [00:32<01:56, 49.55it/s]     38%|███▊      | 3467/9216 [00:32<01:15, 75.68it/s]     38%|███▊      | 3478/9216 [00:32<02:21, 40.47it/s]     38%|███▊      | 3487/9216 [00:33<02:49, 33.78it/s]     38%|███▊      | 3494/9216 [00:33<02:57, 32.30it/s]     38%|███▊      | 3500/9216 [00:33<03:45, 25.37it/s]     38%|███▊      | 3505/9216 [00:34<04:24, 21.62it/s]     38%|███▊      | 3509/9216 [00:34<05:32, 17.15it/s]     38%|███▊      | 3512/9216 [00:34<05:21, 17.75it/s]     38%|███▊      | 3518/9216 [00:34<04:11, 22.67it/s]     38%|███▊      | 3522/9216 [00:35<04:13, 22.44it/s]     38%|███▊      | 3525/9216 [00:35<05:54, 16.07it/s]     38%|███▊      | 3528/9216 [00:35<05:41, 16.65it/s]     38%|███▊      | 3541/9216 [00:35<02:48, 33.58it/s]     39%|███▊      | 3562/9216 [00:35<01:28, 64.10it/s]     39%|███▉      | 3572/9216 [00:36<01:35, 58.90it/s]     39%|███▉      | 3581/9216 [00:36<03:31, 26.65it/s]     39%|███▉      | 3588/9216 [00:37<03:39, 25.65it/s]     39%|███▉      | 3593/9216 [00:37<03:56, 23.78it/s]     39%|███▉      | 3598/9216 [00:37<04:38, 20.15it/s]     39%|███▉      | 3602/9216 [00:38<05:10, 18.10it/s]     39%|███▉      | 3605/9216 [00:38<05:31, 16.93it/s]     39%|███▉      | 3608/9216 [00:38<05:50, 15.98it/s]     39%|███▉      | 3615/9216 [00:38<04:17, 21.76it/s]     39%|███▉      | 3618/9216 [00:39<05:39, 16.47it/s]     39%|███▉      | 3621/9216 [00:39<05:45, 16.21it/s]     39%|███▉      | 3627/9216 [00:39<04:17, 21.67it/s]     39%|███▉      | 3638/9216 [00:39<02:33, 36.22it/s]     40%|███▉      | 3658/9216 [00:39<01:23, 66.86it/s]     40%|███▉      | 3668/9216 [00:39<01:23, 66.15it/s]     40%|███▉      | 3677/9216 [00:40<02:22, 38.85it/s]     40%|███▉      | 3684/9216 [00:40<02:26, 37.85it/s]     40%|████      | 3690/9216 [00:40<02:52, 31.97it/s]     40%|████      | 3695/9216 [00:41<03:07, 29.40it/s]     40%|████      | 3699/9216 [00:41<03:14, 28.37it/s]     40%|████      | 3703/9216 [00:41<03:09, 29.08it/s]     40%|████      | 3707/9216 [00:41<04:14, 21.64it/s]     40%|████      | 3710/9216 [00:42<05:36, 16.35it/s]     40%|████      | 3713/9216 [00:42<05:40, 16.16it/s]     40%|████      | 3715/9216 [00:42<05:49, 15.76it/s]     40%|████      | 3718/9216 [00:42<05:49, 15.75it/s]     40%|████      | 3720/9216 [00:42<05:50, 15.70it/s]     40%|████      | 3723/9216 [00:42<05:54, 15.51it/s]     40%|████      | 3726/9216 [00:43<05:03, 18.10it/s]     41%|████      | 3737/9216 [00:43<02:28, 36.98it/s]     41%|████      | 3756/9216 [00:43<01:16, 71.47it/s]     41%|████      | 3765/9216 [00:43<01:30, 59.97it/s]     41%|████      | 3773/9216 [00:43<02:16, 39.75it/s]     41%|████      | 3779/9216 [00:44<02:21, 38.53it/s]     41%|████      | 3785/9216 [00:44<02:22, 37.98it/s]     41%|████      | 3790/9216 [00:44<02:44, 32.96it/s]     41%|████      | 3794/9216 [00:44<02:50, 31.73it/s]     41%|████      | 3798/9216 [00:44<03:56, 22.87it/s]     41%|████      | 3801/9216 [00:45<03:49, 23.59it/s]     41%|████▏     | 3804/9216 [00:45<04:06, 21.99it/s]     41%|████▏     | 3807/9216 [00:45<04:27, 20.23it/s]     41%|████▏     | 3810/9216 [00:45<05:10, 17.39it/s]     41%|████▏     | 3812/9216 [00:45<05:30, 16.33it/s]     41%|████▏     | 3814/9216 [00:45<06:02, 14.89it/s]     41%|████▏     | 3816/9216 [00:46<06:59, 12.88it/s]     41%|████▏     | 3818/9216 [00:46<06:50, 13.16it/s]     42%|████▏     | 3829/9216 [00:46<02:49, 31.72it/s]     42%|████▏     | 3850/9216 [00:46<01:17, 69.38it/s]     42%|████▏     | 3860/9216 [00:46<01:21, 65.37it/s]     42%|████▏     | 3869/9216 [00:47<01:55, 46.32it/s]     42%|████▏     | 3876/9216 [00:47<02:07, 41.85it/s]     42%|████▏     | 3882/9216 [00:47<02:41, 33.04it/s]     42%|████▏     | 3887/9216 [00:47<03:14, 27.36it/s]     42%|████▏     | 3891/9216 [00:47<03:10, 27.97it/s]     42%|████▏     | 3895/9216 [00:48<03:11, 27.76it/s]     42%|████▏     | 3899/9216 [00:48<03:40, 24.15it/s]     42%|████▏     | 3902/9216 [00:48<04:34, 19.39it/s]     42%|████▏     | 3905/9216 [00:48<05:06, 17.32it/s]     42%|████▏     | 3907/9216 [00:49<05:57, 14.84it/s]     42%|████▏     | 3909/9216 [00:49<06:10, 14.34it/s]     42%|████▏     | 3911/9216 [00:49<06:02, 14.64it/s]     42%|████▏     | 3913/9216 [00:49<05:59, 14.74it/s]     43%|████▎     | 3918/9216 [00:49<04:54, 18.02it/s]     43%|████▎     | 3925/9216 [00:49<03:09, 27.96it/s]     43%|████▎     | 3945/9216 [00:49<01:21, 64.94it/s]     43%|████▎     | 3954/9216 [00:50<01:37, 54.07it/s]     43%|████▎     | 3961/9216 [00:50<02:17, 38.21it/s]     43%|████▎     | 3969/9216 [00:50<02:15, 38.67it/s]     43%|████▎     | 3975/9216 [00:51<02:44, 31.80it/s]     43%|████▎     | 3980/9216 [00:51<03:29, 25.02it/s]     43%|████▎     | 3984/9216 [00:51<04:20, 20.06it/s]     43%|████▎     | 3987/9216 [00:51<04:12, 20.69it/s]     43%|████▎     | 3990/9216 [00:52<04:37, 18.81it/s]     43%|████▎     | 3993/9216 [00:52<04:27, 19.52it/s]     43%|████▎     | 3997/9216 [00:52<04:11, 20.76it/s]     43%|████▎     | 4000/9216 [00:52<05:50, 14.89it/s]     43%|████▎     | 4002/9216 [00:52<06:08, 14.16it/s]     43%|████▎     | 4005/9216 [00:53<05:31, 15.73it/s]     43%|████▎     | 4007/9216 [00:53<06:57, 12.48it/s]     44%|████▎     | 4009/9216 [00:53<08:46,  9.90it/s]     44%|████▎     | 4011/9216 [00:53<08:49,  9.84it/s]     44%|████▎     | 4013/9216 [00:54<08:33, 10.13it/s]     44%|████▎     | 4015/9216 [00:54<07:30, 11.55it/s]     44%|████▍     | 4032/9216 [00:54<02:08, 40.49it/s]     44%|████▍     | 4046/9216 [00:54<01:37, 53.21it/s]     44%|████▍     | 4053/9216 [00:54<02:53, 29.67it/s]     44%|████▍     | 4058/9216 [00:55<03:25, 25.15it/s]     44%|████▍     | 4062/9216 [00:55<03:13, 26.68it/s]     44%|████▍     | 4066/9216 [00:55<03:08, 27.25it/s]     44%|████▍     | 4070/9216 [00:55<03:03, 27.97it/s]     44%|████▍     | 4074/9216 [00:55<03:46, 22.69it/s]     44%|████▍     | 4077/9216 [00:56<04:39, 18.37it/s]     44%|████▍     | 4080/9216 [00:56<05:21, 15.97it/s]     44%|████▍     | 4084/9216 [00:56<04:34, 18.67it/s]     44%|████▍     | 4088/9216 [00:56<03:51, 22.12it/s]     44%|████▍     | 4095/9216 [00:56<02:46, 30.80it/s]     44%|████▍     | 4099/9216 [00:57<03:37, 23.48it/s]     45%|████▍     | 4103/9216 [00:57<04:32, 18.74it/s]     45%|████▍     | 4106/9216 [00:57<06:26, 13.23it/s]     45%|████▍     | 4108/9216 [00:58<06:45, 12.59it/s]     45%|████▍     | 4110/9216 [00:58<07:34, 11.23it/s]     45%|████▍     | 4124/9216 [00:58<02:55, 29.04it/s]     45%|████▍     | 4141/9216 [00:58<01:41, 50.21it/s]     45%|████▌     | 4149/9216 [00:59<02:48, 30.08it/s]     45%|████▌     | 4155/9216 [00:59<03:08, 26.85it/s]     45%|████▌     | 4160/9216 [00:59<03:08, 26.87it/s]     45%|████▌     | 4165/9216 [00:59<03:37, 23.21it/s]     45%|████▌     | 4169/9216 [01:00<03:35, 23.45it/s]     45%|████▌     | 4173/9216 [01:00<04:24, 19.03it/s]     45%|████▌     | 4176/9216 [01:00<05:02, 16.64it/s]     45%|████▌     | 4180/9216 [01:00<04:45, 17.61it/s]     45%|████▌     | 4183/9216 [01:01<04:20, 19.34it/s]     45%|████▌     | 4190/9216 [01:01<03:04, 27.17it/s]     46%|████▌     | 4194/9216 [01:01<03:29, 23.97it/s]     46%|████▌     | 4199/9216 [01:01<03:05, 27.08it/s]     46%|████▌     | 4203/9216 [01:01<04:28, 18.70it/s]     46%|████▌     | 4208/9216 [01:02<03:35, 23.22it/s]     46%|████▌     | 4228/9216 [01:02<01:32, 54.15it/s]     46%|████▌     | 4239/9216 [01:02<01:17, 64.39it/s]     46%|████▌     | 4248/9216 [01:02<02:11, 37.64it/s]     46%|████▌     | 4256/9216 [01:02<02:17, 35.95it/s]     46%|████▌     | 4262/9216 [01:03<03:12, 25.80it/s]     46%|████▋     | 4267/9216 [01:03<03:53, 21.23it/s]     46%|████▋     | 4271/9216 [01:04<04:11, 19.65it/s]     46%|████▋     | 4274/9216 [01:04<04:34, 18.00it/s]     46%|████▋     | 4277/9216 [01:04<04:26, 18.51it/s]     46%|████▋     | 4282/9216 [01:04<03:43, 22.05it/s]     47%|████▋     | 4287/9216 [01:04<03:07, 26.29it/s]     47%|████▋     | 4291/9216 [01:05<03:56, 20.85it/s]     47%|████▋     | 4297/9216 [01:05<03:33, 23.06it/s]     47%|████▋     | 4300/9216 [01:05<03:26, 23.83it/s]     47%|████▋     | 4316/9216 [01:05<01:39, 49.29it/s]     47%|████▋     | 4334/9216 [01:05<01:04, 76.08it/s]     47%|████▋     | 4344/9216 [01:05<01:47, 45.51it/s]     47%|████▋     | 4352/9216 [01:06<01:40, 48.50it/s]     47%|████▋     | 4360/9216 [01:06<02:12, 36.68it/s]     47%|████▋     | 4366/9216 [01:07<03:28, 23.30it/s]     47%|████▋     | 4371/9216 [01:07<04:10, 19.31it/s]     48%|████▊     | 4381/9216 [01:07<02:57, 27.31it/s]     48%|████▊     | 4387/9216 [01:07<03:16, 24.53it/s]     48%|████▊     | 4393/9216 [01:08<03:00, 26.69it/s]     48%|████▊     | 4397/9216 [01:08<03:11, 25.17it/s]     48%|████▊     | 4412/9216 [01:08<01:49, 43.70it/s]     48%|████▊     | 4430/9216 [01:08<01:11, 67.39it/s]     48%|████▊     | 4441/9216 [01:08<01:26, 55.46it/s]     48%|████▊     | 4450/9216 [01:09<01:58, 40.06it/s]     48%|████▊     | 4457/9216 [01:09<02:16, 34.80it/s]     48%|████▊     | 4463/9216 [01:09<02:14, 35.43it/s]     48%|████▊     | 4468/9216 [01:09<02:21, 33.45it/s]     49%|████▊     | 4477/9216 [01:09<01:51, 42.49it/s]     49%|████▊     | 4483/9216 [01:10<02:06, 37.53it/s]     49%|████▊     | 4489/9216 [01:10<01:55, 41.03it/s]     49%|████▉     | 4494/9216 [01:10<01:59, 39.39it/s]     49%|████▉     | 4505/9216 [01:10<01:27, 53.93it/s]     49%|████▉     | 4525/9216 [01:10<00:53, 87.10it/s]     49%|████▉     | 4536/9216 [01:11<01:34, 49.52it/s]     49%|████▉     | 4544/9216 [01:11<02:02, 38.22it/s]     49%|████▉     | 4551/9216 [01:11<02:18, 33.57it/s]     49%|████▉     | 4557/9216 [01:11<02:16, 34.20it/s]     50%|████▉     | 4562/9216 [01:12<02:56, 26.41it/s]     50%|████▉     | 4572/9216 [01:12<02:12, 35.10it/s]     50%|████▉     | 4577/9216 [01:12<02:19, 33.22it/s]     50%|████▉     | 4583/9216 [01:12<02:03, 37.53it/s]     50%|████▉     | 4590/9216 [01:12<01:47, 43.10it/s]     50%|█████     | 4610/9216 [01:12<01:00, 75.67it/s]     50%|█████     | 4623/9216 [01:12<00:52, 88.02it/s]     50%|█████     | 4634/9216 [01:13<01:02, 73.46it/s]     50%|█████     | 4643/9216 [01:13<01:18, 58.18it/s]     50%|█████     | 4651/9216 [01:13<01:42, 44.42it/s]     51%|█████     | 4658/9216 [01:13<01:46, 42.83it/s]     51%|█████     | 4664/9216 [01:14<01:41, 44.99it/s]     51%|█████     | 4670/9216 [01:14<01:43, 43.73it/s]     51%|█████     | 4675/9216 [01:14<01:43, 43.88it/s]     51%|█████     | 4689/9216 [01:14<01:10, 64.64it/s]     51%|█████     | 4709/9216 [01:14<00:46, 96.69it/s]     51%|█████     | 4722/9216 [01:14<00:46, 96.74it/s]     51%|█████▏    | 4733/9216 [01:14<00:49, 91.08it/s]     51%|█████▏    | 4743/9216 [01:15<01:15, 59.58it/s]     52%|█████▏    | 4751/9216 [01:15<01:30, 49.61it/s]     52%|█████▏    | 4758/9216 [01:15<02:11, 33.86it/s]     52%|█████▏    | 4766/9216 [01:15<01:56, 38.16it/s]     52%|█████▏    | 4772/9216 [01:16<01:51, 39.87it/s]     52%|█████▏    | 4779/9216 [01:16<01:39, 44.64it/s]     52%|█████▏    | 4799/9216 [01:16<00:59, 74.71it/s]     52%|█████▏    | 4814/9216 [01:16<00:48, 90.26it/s]     52%|█████▏    | 4826/9216 [01:16<00:51, 85.37it/s]     52%|█████▏    | 4836/9216 [01:16<01:06, 66.19it/s]     53%|█████▎    | 4845/9216 [01:17<01:18, 55.76it/s]     53%|█████▎    | 4852/9216 [01:17<02:02, 35.55it/s]     53%|█████▎    | 4861/9216 [01:17<01:44, 41.49it/s]     53%|█████▎    | 4867/9216 [01:17<02:17, 31.69it/s]     53%|█████▎    | 4872/9216 [01:18<02:08, 33.93it/s]     53%|█████▎    | 4881/9216 [01:18<01:41, 42.85it/s]     53%|█████▎    | 4902/9216 [01:18<00:58, 73.86it/s]     53%|█████▎    | 4913/9216 [01:18<01:16, 56.50it/s]     53%|█████▎    | 4922/9216 [01:18<01:18, 54.62it/s]     53%|█████▎    | 4930/9216 [01:19<01:30, 47.16it/s]     54%|█████▎    | 4937/9216 [01:19<01:36, 44.35it/s]     54%|█████▎    | 4943/9216 [01:19<03:05, 22.99it/s]     54%|█████▎    | 4947/9216 [01:20<04:16, 16.66it/s]     54%|█████▎    | 4952/9216 [01:20<03:39, 19.47it/s]     54%|█████▍    | 4957/9216 [01:20<03:05, 22.94it/s]     54%|█████▍    | 4961/9216 [01:20<03:41, 19.23it/s]     54%|█████▍    | 4965/9216 [01:21<03:13, 21.94it/s]     54%|█████▍    | 4969/9216 [01:21<03:06, 22.75it/s]     54%|█████▍    | 4975/9216 [01:21<02:26, 28.96it/s]     54%|█████▍    | 4994/9216 [01:21<01:09, 60.45it/s]     54%|█████▍    | 5007/9216 [01:21<01:03, 66.71it/s]/opt/homebrew/Caskroom/miniforge/base/envs/py311-release/lib/python3.11/site-packages/cvxpy/problems/problem.py:1403: UserWarning: Solution may be inaccurate. Try another solver, adjusting the solver settings, or solve with verbose=True for more information.
      warnings.warn(
     54%|█████▍    | 5016/9216 [01:22<02:08, 32.57it/s]     55%|█████▍    | 5023/9216 [01:22<01:55, 36.37it/s]     55%|█████▍    | 5030/9216 [01:22<02:29, 28.07it/s]     55%|█████▍    | 5035/9216 [01:23<03:19, 20.91it/s]     55%|█████▍    | 5039/9216 [01:23<04:03, 17.12it/s]     55%|█████▍    | 5042/9216 [01:23<04:11, 16.60it/s]     55%|█████▍    | 5045/9216 [01:24<04:13, 16.46it/s]     55%|█████▍    | 5048/9216 [01:24<03:52, 17.94it/s]     55%|█████▍    | 5054/9216 [01:24<03:00, 23.02it/s]     55%|█████▍    | 5057/9216 [01:24<03:27, 20.03it/s]     55%|█████▍    | 5060/9216 [01:24<03:17, 21.00it/s]     55%|█████▍    | 5063/9216 [01:24<03:27, 20.05it/s]     55%|█████▍    | 5066/9216 [01:25<03:23, 20.38it/s]     55%|█████▌    | 5069/9216 [01:25<03:15, 21.19it/s]     55%|█████▌    | 5075/9216 [01:25<02:21, 29.31it/s]     55%|█████▌    | 5096/9216 [01:25<00:58, 70.88it/s]     55%|█████▌    | 5105/9216 [01:25<01:03, 64.94it/s]     55%|█████▌    | 5113/9216 [01:25<01:28, 46.59it/s]     56%|█████▌    | 5120/9216 [01:25<01:27, 46.94it/s]     56%|█████▌    | 5126/9216 [01:26<01:50, 37.14it/s]     56%|█████▌    | 5131/9216 [01:26<02:47, 24.39it/s]     56%|█████▌    | 5135/9216 [01:27<03:20, 20.35it/s]     56%|█████▌    | 5138/9216 [01:27<03:29, 19.49it/s]     56%|█████▌    | 5141/9216 [01:27<03:30, 19.39it/s]     56%|█████▌    | 5144/9216 [01:27<03:21, 20.21it/s]     56%|█████▌    | 5147/9216 [01:27<03:18, 20.46it/s]     56%|█████▌    | 5151/9216 [01:27<02:50, 23.80it/s]     56%|█████▌    | 5154/9216 [01:27<03:11, 21.21it/s]     56%|█████▌    | 5157/9216 [01:28<04:10, 16.18it/s]     56%|█████▌    | 5162/9216 [01:28<03:30, 19.30it/s]     56%|█████▌    | 5165/9216 [01:28<03:21, 20.11it/s]     56%|█████▌    | 5177/9216 [01:28<01:43, 38.96it/s]     56%|█████▋    | 5196/9216 [01:28<00:57, 70.04it/s]     56%|█████▋    | 5205/9216 [01:29<01:17, 51.67it/s]     57%|█████▋    | 5213/9216 [01:29<01:47, 37.32it/s]     57%|█████▋    | 5219/9216 [01:29<02:04, 32.13it/s]     57%|█████▋    | 5224/9216 [01:29<02:07, 31.42it/s]     57%|█████▋    | 5229/9216 [01:30<02:57, 22.47it/s]     57%|█████▋    | 5233/9216 [01:30<03:28, 19.14it/s]     57%|█████▋    | 5236/9216 [01:30<03:21, 19.75it/s]     57%|█████▋    | 5239/9216 [01:30<03:14, 20.41it/s]     57%|█████▋    | 5242/9216 [01:31<03:06, 21.36it/s]     57%|█████▋    | 5247/9216 [01:31<02:41, 24.64it/s]     57%|█████▋    | 5250/9216 [01:31<03:03, 21.61it/s]     57%|█████▋    | 5253/9216 [01:31<03:10, 20.77it/s]     57%|█████▋    | 5256/9216 [01:31<02:56, 22.43it/s]     57%|█████▋    | 5259/9216 [01:31<03:31, 18.71it/s]     57%|█████▋    | 5263/9216 [01:32<03:13, 20.41it/s]     57%|█████▋    | 5281/9216 [01:32<01:15, 52.22it/s]     57%|█████▋    | 5295/9216 [01:32<00:54, 71.54it/s]     58%|█████▊    | 5305/9216 [01:32<01:32, 42.34it/s]     58%|█████▊    | 5312/9216 [01:32<01:50, 35.43it/s]     58%|█████▊    | 5318/9216 [01:33<02:10, 29.91it/s]     58%|█████▊    | 5323/9216 [01:33<02:28, 26.18it/s]     58%|█████▊    | 5327/9216 [01:33<02:41, 24.14it/s]     58%|█████▊    | 5331/9216 [01:33<02:35, 24.94it/s]     58%|█████▊    | 5335/9216 [01:34<02:32, 25.41it/s]     58%|█████▊    | 5338/9216 [01:34<02:44, 23.52it/s]     58%|█████▊    | 5341/9216 [01:34<02:46, 23.22it/s]     58%|█████▊    | 5344/9216 [01:34<03:31, 18.30it/s]     58%|█████▊    | 5347/9216 [01:35<04:59, 12.91it/s]     58%|█████▊    | 5349/9216 [01:35<05:40, 11.36it/s]     58%|█████▊    | 5351/9216 [01:35<06:00, 10.71it/s]     58%|█████▊    | 5353/9216 [01:35<06:53,  9.33it/s]     58%|█████▊    | 5355/9216 [01:36<06:28,  9.94it/s]     58%|█████▊    | 5359/9216 [01:36<04:26, 14.49it/s]     58%|█████▊    | 5372/9216 [01:36<01:49, 35.10it/s]     58%|█████▊    | 5390/9216 [01:36<01:00, 62.73it/s]     59%|█████▊    | 5399/9216 [01:36<01:18, 48.37it/s]     59%|█████▊    | 5406/9216 [01:36<01:46, 35.66it/s]     59%|█████▊    | 5412/9216 [01:37<02:07, 29.88it/s]     59%|█████▉    | 5417/9216 [01:37<02:05, 30.38it/s]     59%|█████▉    | 5421/9216 [01:37<02:16, 27.88it/s]     59%|█████▉    | 5425/9216 [01:37<02:10, 29.01it/s]     59%|█████▉    | 5429/9216 [01:37<02:10, 29.03it/s]     59%|█████▉    | 5433/9216 [01:38<02:15, 27.82it/s]     59%|█████▉    | 5437/9216 [01:38<02:47, 22.57it/s]     59%|█████▉    | 5441/9216 [01:38<02:54, 21.58it/s]     59%|█████▉    | 5444/9216 [01:38<03:37, 17.32it/s]     59%|█████▉    | 5446/9216 [01:39<03:55, 15.98it/s]     59%|█████▉    | 5448/9216 [01:39<04:57, 12.65it/s]     59%|█████▉    | 5450/9216 [01:39<05:17, 11.87it/s]     59%|█████▉    | 5452/9216 [01:39<05:17, 11.86it/s]     59%|█████▉    | 5455/9216 [01:39<04:33, 13.77it/s]     59%|█████▉    | 5464/9216 [01:39<02:15, 27.74it/s]     60%|█████▉    | 5485/9216 [01:40<00:58, 64.11it/s]     60%|█████▉    | 5494/9216 [01:40<01:44, 35.72it/s]     60%|█████▉    | 5501/9216 [01:40<01:54, 32.46it/s]     60%|█████▉    | 5507/9216 [01:41<02:04, 29.90it/s]     60%|█████▉    | 5512/9216 [01:41<02:02, 30.25it/s]     60%|█████▉    | 5516/9216 [01:41<02:00, 30.80it/s]     60%|█████▉    | 5520/9216 [01:41<01:56, 31.64it/s]     60%|█████▉    | 5524/9216 [01:41<02:23, 25.70it/s]     60%|█████▉    | 5528/9216 [01:41<02:34, 23.83it/s]     60%|██████    | 5531/9216 [01:42<02:43, 22.56it/s]     60%|██████    | 5534/9216 [01:42<02:56, 20.82it/s]     60%|██████    | 5537/9216 [01:42<03:25, 17.93it/s]     60%|██████    | 5539/9216 [01:42<04:03, 15.13it/s]     60%|██████    | 5541/9216 [01:42<04:51, 12.63it/s]     60%|██████    | 5543/9216 [01:43<05:22, 11.40it/s]     60%|██████    | 5545/9216 [01:43<05:50, 10.46it/s]     60%|██████    | 5548/9216 [01:43<04:51, 12.57it/s]     60%|██████    | 5550/9216 [01:43<05:06, 11.95it/s]     60%|██████    | 5552/9216 [01:43<04:54, 12.45it/s]     60%|██████    | 5573/9216 [01:44<01:13, 49.60it/s]     61%|██████    | 5585/9216 [01:44<00:57, 63.24it/s]     61%|██████    | 5594/9216 [01:44<01:32, 39.20it/s]     61%|██████    | 5601/9216 [01:44<01:51, 32.31it/s]     61%|██████    | 5609/9216 [01:45<01:41, 35.62it/s]     61%|██████    | 5614/9216 [01:45<02:03, 29.16it/s]     61%|██████    | 5619/9216 [01:45<02:12, 27.21it/s]     61%|██████    | 5623/9216 [01:45<02:10, 27.46it/s]     61%|██████    | 5627/9216 [01:46<03:08, 18.99it/s]     61%|██████    | 5630/9216 [01:46<03:33, 16.81it/s]     61%|██████    | 5633/9216 [01:46<03:40, 16.23it/s]     61%|██████    | 5635/9216 [01:46<03:52, 15.39it/s]     61%|██████    | 5637/9216 [01:46<03:49, 15.60it/s]     61%|██████    | 5639/9216 [01:47<04:38, 12.87it/s]     61%|██████    | 5641/9216 [01:47<05:20, 11.14it/s]     61%|██████    | 5643/9216 [01:47<05:48, 10.26it/s]     61%|██████▏   | 5654/9216 [01:47<02:18, 25.75it/s]     62%|██████▏   | 5674/9216 [01:47<01:01, 57.46it/s]     62%|██████▏   | 5683/9216 [01:48<01:20, 43.78it/s]     62%|██████▏   | 5690/9216 [01:48<01:39, 35.32it/s]     62%|██████▏   | 5696/9216 [01:48<01:47, 32.89it/s]     62%|██████▏   | 5701/9216 [01:48<01:51, 31.40it/s]     62%|██████▏   | 5706/9216 [01:49<02:28, 23.62it/s]     62%|██████▏   | 5710/9216 [01:49<02:55, 20.00it/s]     62%|██████▏   | 5713/9216 [01:49<02:49, 20.62it/s]     62%|██████▏   | 5716/9216 [01:49<02:46, 21.07it/s]     62%|██████▏   | 5719/9216 [01:50<03:15, 17.89it/s]     62%|██████▏   | 5722/9216 [01:50<03:14, 17.94it/s]     62%|██████▏   | 5727/9216 [01:50<02:28, 23.44it/s]     62%|██████▏   | 5730/9216 [01:50<03:01, 19.22it/s]     62%|██████▏   | 5733/9216 [01:51<04:20, 13.35it/s]     62%|██████▏   | 5736/9216 [01:51<03:45, 15.45it/s]     62%|██████▏   | 5740/9216 [01:51<03:03, 18.91it/s]     62%|██████▏   | 5757/9216 [01:51<01:14, 46.65it/s]     63%|██████▎   | 5775/9216 [01:51<00:46, 73.45it/s]     63%|██████▎   | 5785/9216 [01:52<01:51, 30.67it/s]     63%|██████▎   | 5793/9216 [01:52<02:31, 22.55it/s]     63%|██████▎   | 5799/9216 [01:53<02:42, 20.97it/s]     63%|██████▎   | 5804/9216 [01:53<02:44, 20.72it/s]     63%|██████▎   | 5808/9216 [01:54<03:47, 14.95it/s]     63%|██████▎   | 5811/9216 [01:54<03:47, 14.96it/s]     63%|██████▎   | 5814/9216 [01:54<04:19, 13.13it/s]     63%|██████▎   | 5819/9216 [01:54<03:19, 17.02it/s]     63%|██████▎   | 5824/9216 [01:54<02:53, 19.60it/s]     63%|██████▎   | 5827/9216 [01:55<03:17, 17.13it/s]     63%|██████▎   | 5830/9216 [01:55<03:12, 17.62it/s]     63%|██████▎   | 5833/9216 [01:55<03:11, 17.70it/s]     63%|██████▎   | 5844/9216 [01:55<01:40, 33.51it/s]     64%|██████▎   | 5865/9216 [01:55<00:49, 67.84it/s]     64%|██████▎   | 5875/9216 [01:55<00:48, 68.72it/s]     64%|██████▍   | 5884/9216 [01:56<01:40, 33.03it/s]     64%|██████▍   | 5891/9216 [01:56<01:43, 32.26it/s]     64%|██████▍   | 5897/9216 [01:57<02:26, 22.73it/s]     64%|██████▍   | 5902/9216 [01:57<02:11, 25.29it/s]     64%|██████▍   | 5907/9216 [01:57<01:58, 27.95it/s]     64%|██████▍   | 5914/9216 [01:57<01:38, 33.62it/s]     64%|██████▍   | 5919/9216 [01:57<01:50, 29.96it/s]     64%|██████▍   | 5924/9216 [01:58<02:19, 23.66it/s]     64%|██████▍   | 5928/9216 [01:58<02:06, 25.93it/s]     64%|██████▍   | 5932/9216 [01:58<01:59, 27.47it/s]     65%|██████▍   | 5949/9216 [01:58<00:59, 54.89it/s]     65%|██████▍   | 5968/9216 [01:58<00:43, 75.30it/s]     65%|██████▍   | 5977/9216 [01:59<01:45, 30.74it/s]     65%|██████▍   | 5984/9216 [02:00<02:11, 24.60it/s]     65%|██████▍   | 5990/9216 [02:00<02:31, 21.26it/s]     65%|██████▌   | 5994/9216 [02:00<02:21, 22.70it/s]     65%|██████▌   | 5998/9216 [02:00<02:45, 19.46it/s]     65%|██████▌   | 6002/9216 [02:01<02:28, 21.66it/s]     65%|██████▌   | 6009/9216 [02:01<01:52, 28.52it/s]     65%|██████▌   | 6016/9216 [02:01<01:32, 34.51it/s]     65%|██████▌   | 6021/9216 [02:01<02:25, 21.93it/s]     65%|██████▌   | 6025/9216 [02:01<02:14, 23.72it/s]     65%|██████▌   | 6029/9216 [02:01<02:04, 25.53it/s]     66%|██████▌   | 6049/9216 [02:02<00:55, 56.98it/s]     66%|██████▌   | 6066/9216 [02:02<00:40, 78.52it/s]     66%|██████▌   | 6077/9216 [02:02<01:07, 46.54it/s]     66%|██████▌   | 6086/9216 [02:03<01:44, 29.88it/s]     66%|██████▌   | 6093/9216 [02:03<02:03, 25.32it/s]     66%|██████▌   | 6098/9216 [02:03<01:53, 27.43it/s]     66%|██████▌   | 6105/9216 [02:03<01:35, 32.46it/s]     66%|██████▋   | 6112/9216 [02:04<01:22, 37.53it/s]     66%|██████▋   | 6118/9216 [02:04<02:16, 22.66it/s]     66%|██████▋   | 6123/9216 [02:05<02:50, 18.18it/s]     67%|██████▋   | 6132/9216 [02:05<01:59, 25.86it/s]     67%|██████▋   | 6153/9216 [02:05<01:01, 49.99it/s]     67%|██████▋   | 6164/9216 [02:05<00:53, 57.47it/s]     67%|██████▋   | 6174/9216 [02:06<01:32, 32.98it/s]     67%|██████▋   | 6182/9216 [02:06<02:11, 23.15it/s]     67%|██████▋   | 6188/9216 [02:06<01:57, 25.72it/s]     67%|██████▋   | 6196/9216 [02:06<01:36, 31.18it/s]     67%|██████▋   | 6202/9216 [02:07<01:26, 34.75it/s]     67%|██████▋   | 6208/9216 [02:07<01:28, 34.03it/s]     67%|██████▋   | 6213/9216 [02:07<02:02, 24.56it/s]     67%|██████▋   | 6220/9216 [02:07<01:39, 30.25it/s]     68%|██████▊   | 6240/9216 [02:07<00:51, 57.36it/s]     68%|██████▊   | 6259/9216 [02:07<00:37, 79.14it/s]     68%|██████▊   | 6270/9216 [02:08<01:02, 47.05it/s]     68%|██████▊   | 6279/9216 [02:08<01:28, 33.25it/s]     68%|██████▊   | 6286/9216 [02:09<01:20, 36.42it/s]     68%|██████▊   | 6293/9216 [02:09<01:20, 36.38it/s]     68%|██████▊   | 6299/9216 [02:09<01:30, 32.09it/s]     68%|██████▊   | 6305/9216 [02:09<01:23, 34.72it/s]     68%|██████▊   | 6310/9216 [02:10<01:47, 27.15it/s]     69%|██████▊   | 6320/9216 [02:10<01:17, 37.58it/s]     69%|██████▉   | 6341/9216 [02:10<00:43, 66.74it/s]     69%|██████▉   | 6360/9216 [02:10<00:36, 77.38it/s]     69%|██████▉   | 6370/9216 [02:10<01:00, 46.90it/s]     69%|██████▉   | 6378/9216 [02:11<01:26, 32.80it/s]     69%|██████▉   | 6384/9216 [02:11<01:22, 34.14it/s]     69%|██████▉   | 6390/9216 [02:11<01:24, 33.27it/s]     69%|██████▉   | 6395/9216 [02:12<01:56, 24.29it/s]     69%|██████▉   | 6399/9216 [02:12<01:50, 25.48it/s]     69%|██████▉   | 6403/9216 [02:12<02:06, 22.27it/s]     70%|██████▉   | 6406/9216 [02:12<02:15, 20.69it/s]     70%|██████▉   | 6419/9216 [02:12<01:15, 37.15it/s]     70%|██████▉   | 6440/9216 [02:12<00:41, 67.59it/s]     70%|███████   | 6455/9216 [02:13<00:36, 74.87it/s]     70%|███████   | 6465/9216 [02:13<00:46, 59.02it/s]     70%|███████   | 6473/9216 [02:13<01:20, 33.90it/s]     70%|███████   | 6480/9216 [02:14<01:12, 37.69it/s]     70%|███████   | 6487/9216 [02:14<01:39, 27.56it/s]     70%|███████   | 6492/9216 [02:14<01:35, 28.63it/s]     70%|███████   | 6497/9216 [02:14<01:28, 30.57it/s]     71%|███████   | 6502/9216 [02:15<01:44, 26.05it/s]     71%|███████   | 6506/9216 [02:15<01:38, 27.40it/s]     71%|███████   | 6527/9216 [02:15<00:45, 58.53it/s]     71%|███████   | 6548/9216 [02:15<00:30, 87.72it/s]     71%|███████   | 6560/9216 [02:15<00:40, 65.09it/s]     71%|███████▏  | 6570/9216 [02:16<01:07, 39.39it/s]     71%|███████▏  | 6578/9216 [02:16<00:59, 44.32it/s]     71%|███████▏  | 6586/9216 [02:16<01:07, 38.71it/s]     72%|███████▏  | 6593/9216 [02:16<01:12, 36.29it/s]     72%|███████▏  | 6599/9216 [02:17<01:08, 38.22it/s]     72%|███████▏  | 6617/9216 [02:17<00:42, 61.84it/s]     72%|███████▏  | 6638/9216 [02:17<00:28, 89.80it/s]     72%|███████▏  | 6651/9216 [02:17<00:29, 87.98it/s]     72%|███████▏  | 6663/9216 [02:18<01:01, 41.26it/s]     72%|███████▏  | 6672/9216 [02:18<01:10, 36.27it/s]     72%|███████▏  | 6679/9216 [02:18<01:07, 37.70it/s]     73%|███████▎  | 6686/9216 [02:18<01:06, 38.12it/s]     73%|███████▎  | 6693/9216 [02:18<00:59, 42.72it/s]     73%|███████▎  | 6711/9216 [02:19<00:37, 66.32it/s]     73%|███████▎  | 6732/9216 [02:19<00:26, 94.03it/s]     73%|███████▎  | 6747/9216 [02:19<00:23, 103.95it/s]     73%|███████▎  | 6760/9216 [02:19<00:55, 43.97it/s]      73%|███████▎  | 6770/9216 [02:20<00:58, 41.68it/s]     74%|███████▎  | 6778/9216 [02:20<01:00, 40.63it/s]     74%|███████▎  | 6785/9216 [02:20<01:03, 38.10it/s]     74%|███████▎  | 6791/9216 [02:20<01:00, 40.00it/s]     74%|███████▍  | 6812/9216 [02:20<00:35, 67.04it/s]     74%|███████▍  | 6833/9216 [02:21<00:25, 92.92it/s]     74%|███████▍  | 6847/9216 [02:21<00:23, 99.88it/s]     74%|███████▍  | 6860/9216 [02:21<00:57, 41.30it/s]     75%|███████▍  | 6870/9216 [02:22<00:51, 45.24it/s]     75%|███████▍  | 6879/9216 [02:22<00:50, 46.01it/s]     75%|███████▍  | 6896/9216 [02:22<00:36, 63.78it/s]     75%|███████▌  | 6916/9216 [02:22<00:26, 86.75it/s]     75%|███████▌  | 6936/9216 [02:22<00:20, 108.84it/s]     75%|███████▌  | 6952/9216 [02:22<00:26, 84.41it/s]      76%|███████▌  | 6965/9216 [02:23<00:33, 66.26it/s]     76%|███████▌  | 6975/9216 [02:23<00:31, 71.44it/s]     76%|███████▌  | 6996/9216 [02:23<00:23, 95.92it/s]     76%|███████▌  | 7017/9216 [02:23<00:18, 118.23it/s]     76%|███████▋  | 7037/9216 [02:23<00:15, 136.34it/s]     77%|███████▋  | 7054/9216 [02:23<00:17, 120.74it/s]     77%|███████▋  | 7069/9216 [02:23<00:19, 111.45it/s]     77%|███████▋  | 7090/9216 [02:24<00:16, 131.92it/s]     77%|███████▋  | 7111/9216 [02:24<00:14, 148.98it/s]     77%|███████▋  | 7130/9216 [02:24<00:13, 159.06it/s]     78%|███████▊  | 7148/9216 [02:24<00:14, 143.01it/s]     78%|███████▊  | 7165/9216 [02:24<00:13, 148.17it/s]     78%|███████▊  | 7185/9216 [02:24<00:12, 161.38it/s]     78%|███████▊  | 7205/9216 [02:24<00:11, 170.39it/s]     78%|███████▊  | 7224/9216 [02:24<00:11, 174.40it/s]     79%|███████▊  | 7244/9216 [02:24<00:10, 179.90it/s]     79%|███████▉  | 7264/9216 [02:25<00:10, 184.86it/s]     79%|███████▉  | 7284/9216 [02:25<00:10, 188.03it/s]     79%|███████▉  | 7304/9216 [02:25<00:10, 190.32it/s]     79%|███████▉  | 7324/9216 [02:25<00:09, 191.84it/s]     80%|███████▉  | 7344/9216 [02:25<00:09, 193.03it/s]     80%|███████▉  | 7364/9216 [02:25<00:09, 193.88it/s]     80%|████████  | 7384/9216 [02:25<00:09, 194.62it/s]     80%|████████  | 7404/9216 [02:25<00:09, 194.79it/s]     81%|████████  | 7425/9216 [02:25<00:09, 196.91it/s]     81%|████████  | 7446/9216 [02:25<00:08, 198.31it/s]     81%|████████  | 7467/9216 [02:26<00:08, 199.31it/s]     81%|████████▏ | 7488/9216 [02:26<00:08, 200.05it/s]     81%|████████▏ | 7509/9216 [02:26<00:08, 197.15it/s]     82%|████████▏ | 7530/9216 [02:26<00:08, 198.28it/s]     82%|████████▏ | 7550/9216 [02:26<00:08, 198.13it/s]     82%|████████▏ | 7571/9216 [02:26<00:08, 198.88it/s]     82%|████████▏ | 7592/9216 [02:26<00:08, 199.88it/s]     83%|████████▎ | 7613/9216 [02:26<00:07, 200.55it/s]     83%|████████▎ | 7634/9216 [02:26<00:07, 201.00it/s]     83%|████████▎ | 7655/9216 [02:27<00:07, 201.33it/s]     83%|████████▎ | 7676/9216 [02:27<00:07, 201.61it/s]     84%|████████▎ | 7697/9216 [02:27<00:07, 201.79it/s]     84%|████████▎ | 7718/9216 [02:27<00:07, 202.00it/s]     84%|████████▍ | 7739/9216 [02:27<00:07, 201.96it/s]     84%|████████▍ | 7760/9216 [02:27<00:07, 202.10it/s]     84%|████████▍ | 7781/9216 [02:27<00:07, 202.05it/s]     85%|████████▍ | 7802/9216 [02:27<00:06, 202.18it/s]     85%|████████▍ | 7823/9216 [02:27<00:06, 202.02it/s]     85%|████████▌ | 7844/9216 [02:27<00:06, 201.71it/s]     85%|████████▌ | 7865/9216 [02:28<00:06, 201.37it/s]     86%|████████▌ | 7886/9216 [02:28<00:06, 201.44it/s]     86%|████████▌ | 7907/9216 [02:28<00:06, 201.16it/s]     86%|████████▌ | 7928/9216 [02:28<00:06, 198.00it/s]     86%|████████▋ | 7949/9216 [02:28<00:06, 199.19it/s]     86%|████████▋ | 7969/9216 [02:28<00:06, 198.64it/s]     87%|████████▋ | 7990/9216 [02:28<00:06, 199.61it/s]     87%|████████▋ | 8011/9216 [02:28<00:06, 200.22it/s]     87%|████████▋ | 8032/9216 [02:28<00:05, 201.12it/s]     87%|████████▋ | 8053/9216 [02:28<00:05, 201.73it/s]     88%|████████▊ | 8074/9216 [02:29<00:05, 202.05it/s]     88%|████████▊ | 8095/9216 [02:29<00:05, 200.62it/s]     88%|████████▊ | 8116/9216 [02:29<00:05, 201.38it/s]     88%|████████▊ | 8137/9216 [02:29<00:05, 202.07it/s]     89%|████████▊ | 8158/9216 [02:29<00:05, 202.50it/s]     89%|████████▊ | 8179/9216 [02:29<00:05, 202.86it/s]     89%|████████▉ | 8200/9216 [02:29<00:05, 203.11it/s]     89%|████████▉ | 8221/9216 [02:29<00:04, 203.32it/s]     89%|████████▉ | 8242/9216 [02:29<00:04, 203.47it/s]     90%|████████▉ | 8263/9216 [02:30<00:04, 203.54it/s]     90%|████████▉ | 8284/9216 [02:30<00:04, 199.75it/s]     90%|█████████ | 8304/9216 [02:30<00:04, 195.34it/s]     90%|█████████ | 8324/9216 [02:30<00:04, 191.71it/s]     91%|█████████ | 8344/9216 [02:30<00:04, 189.86it/s]     91%|█████████ | 8364/9216 [02:30<00:04, 187.66it/s]     91%|█████████ | 8383/9216 [02:30<00:04, 186.81it/s]     91%|█████████ | 8403/9216 [02:30<00:04, 187.94it/s]     91%|█████████▏| 8424/9216 [02:30<00:04, 191.69it/s]     92%|█████████▏| 8445/9216 [02:30<00:03, 194.81it/s]     92%|█████████▏| 8465/9216 [02:31<00:03, 196.04it/s]     92%|█████████▏| 8486/9216 [02:31<00:03, 197.37it/s]     92%|█████████▏| 8507/9216 [02:31<00:03, 198.24it/s]     93%|█████████▎| 8528/9216 [02:31<00:03, 198.85it/s]     93%|█████████▎| 8549/9216 [02:31<00:03, 199.57it/s]     93%|█████████▎| 8570/9216 [02:31<00:03, 200.10it/s]     93%|█████████▎| 8591/9216 [02:31<00:03, 200.91it/s]     93%|█████████▎| 8612/9216 [02:31<00:02, 201.44it/s]     94%|█████████▎| 8633/9216 [02:31<00:02, 201.82it/s]     94%|█████████▍| 8654/9216 [02:32<00:02, 202.02it/s]     94%|█████████▍| 8675/9216 [02:32<00:02, 202.26it/s]     94%|█████████▍| 8696/9216 [02:32<00:02, 202.46it/s]     95%|█████████▍| 8717/9216 [02:32<00:02, 201.58it/s]     95%|█████████▍| 8738/9216 [02:32<00:02, 197.80it/s]     95%|█████████▌| 8758/9216 [02:32<00:02, 198.31it/s]     95%|█████████▌| 8778/9216 [02:32<00:02, 197.85it/s]     95%|█████████▌| 8799/9216 [02:32<00:02, 199.16it/s]     96%|█████████▌| 8820/9216 [02:32<00:01, 200.34it/s]     96%|█████████▌| 8841/9216 [02:32<00:01, 201.04it/s]     96%|█████████▌| 8862/9216 [02:33<00:01, 201.88it/s]     96%|█████████▋| 8883/9216 [02:33<00:01, 202.55it/s]     97%|█████████▋| 8904/9216 [02:33<00:01, 203.00it/s]     97%|█████████▋| 8925/9216 [02:33<00:01, 203.31it/s]     97%|█████████▋| 8946/9216 [02:33<00:01, 203.50it/s]     97%|█████████▋| 8967/9216 [02:33<00:01, 203.59it/s]     98%|█████████▊| 8988/9216 [02:33<00:01, 203.73it/s]     98%|█████████▊| 9009/9216 [02:33<00:01, 203.82it/s]     98%|█████████▊| 9030/9216 [02:33<00:00, 203.95it/s]     98%|█████████▊| 9051/9216 [02:33<00:00, 203.95it/s]     98%|█████████▊| 9072/9216 [02:34<00:00, 203.97it/s]     99%|█████████▊| 9093/9216 [02:34<00:00, 200.82it/s]     99%|█████████▉| 9114/9216 [02:34<00:00, 200.83it/s]     99%|█████████▉| 9135/9216 [02:34<00:00, 201.36it/s]     99%|█████████▉| 9156/9216 [02:34<00:00, 197.86it/s]    100%|█████████▉| 9176/9216 [02:34<00:00, 198.33it/s]    100%|█████████▉| 9196/9216 [02:34<00:00, 198.24it/s]    100%|██████████| 9216/9216 [02:34<00:00, 59.53it/s] 




.. GENERATED FROM PYTHON SOURCE LINES 274-278

The volume fractions of tissues for each voxel are also accessible, as well
as the sh coefficients for all tissues. One can also get each sh tissue
separately using ``all_shm_coeff`` for each compartment (isotropic) and
``shm_coeff`` for white matter.

.. GENERATED FROM PYTHON SOURCE LINES 278-285

.. code-block:: Python


    vf = mcsd_fit.volume_fractions
    sh_coeff = mcsd_fit.all_shm_coeff
    csf_sh_coeff = sh_coeff[..., 0]
    gm_sh_coeff = sh_coeff[..., 1]
    wm_sh_coeff = mcsd_fit.shm_coeff








.. GENERATED FROM PYTHON SOURCE LINES 286-288

The model allows one to predict a signal from sh coefficients. There are two
ways of doing this.

.. GENERATED FROM PYTHON SOURCE LINES 288-292

.. code-block:: Python


    mcsd_pred = mcsd_fit.predict()
    mcsd_pred = mcsd_model.predict(mcsd_fit.all_shm_coeff)








.. GENERATED FROM PYTHON SOURCE LINES 293-295

From the fit obtained in the previous step, we generate the ODFs which can be
visualized as follows:

.. GENERATED FROM PYTHON SOURCE LINES 295-316

.. code-block:: Python


    mcsd_odf = mcsd_fit.odf(sphere)

    print("ODF")
    print(mcsd_odf.shape)
    print(mcsd_odf[40, 40, 0])

    fodf_spheres = actor.odf_slicer(mcsd_odf, sphere=sphere, scale=1,
                                    norm=False, colormap='plasma')

    interactive = False
    scene = window.Scene()
    scene.add(fodf_spheres)
    scene.reset_camera_tight()

    print('Saving illustration as msdodf.png')
    window.record(scene, out_path='msdodf.png', size=(600, 600))

    if interactive:
        window.show(scene)




.. image-sg:: /examples_built/reconstruction/images/sphx_glr_reconst_mcsd_002.png
   :alt: reconst mcsd
   :srcset: /examples_built/reconstruction/images/sphx_glr_reconst_mcsd_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ODF
    (96, 96, 1, 724)
    [ 2.07825714e-03  2.48320688e-03  3.86296574e-03  5.78587170e-04
      4.13735690e-03  1.90413144e-03  2.91231786e-04  2.78762352e-03
      3.98478870e-05  3.62344531e-03  3.17122629e-03  1.22765485e-03
      1.38664442e-03  9.01082781e-05  3.16166084e-04  1.06773266e-03
      1.41480505e-03  3.65267032e-03  2.38412226e-03  9.35372242e-04
     -4.67682855e-04 -2.33196727e-04  3.37010673e-03  1.26876858e-03
      3.69441781e-03 -9.45155684e-04  7.79924130e-04 -2.77920204e-04
      1.30414334e-03  1.04371319e-03  5.12873011e-03  2.58197594e-03
      4.04074927e-03  2.23541599e-03  1.53194270e-04  1.99136992e-03
      1.66444502e-04  3.10730689e-03 -4.39150785e-04  1.84296018e-03
      1.67754591e-03  1.53366214e-02  6.37294028e-04  6.11570872e-03
      8.04505730e-04  4.97962172e-03  4.41602185e-03  5.40733046e-04
      1.15893785e-03  1.28407355e-02  9.98608252e-04  2.42820604e-03
      2.33807225e-03  3.95418963e-03  3.73769172e-02  9.12470030e-04
      4.61559671e-03  1.29336264e-03  2.62753571e-03  1.59015145e-03
      6.00676680e-04  2.11111760e-03  5.20283855e-02  5.52107559e-04
      5.07375854e-03  1.29958882e-03  3.87700865e-03  4.55472608e-02
      5.42076050e-04  2.96028375e-03  2.09408894e-02  1.07250667e-04
     -5.60013139e-04  9.08099370e-04  2.87255730e-03  1.04596989e-01
      9.93302298e-04  4.46639760e-03  9.88176082e-04  1.67566968e-03
      3.08017508e-02 -5.69246541e-05  3.03389847e-03  8.06214708e-02
      2.97455817e-04  1.01074331e-03  9.83107191e-04  2.05432765e-03
      1.29875192e-01  3.50743469e-04  2.69107948e-03  1.72161258e-02
     -1.71912972e-05  1.02315620e-02  1.61453459e-04  2.72171800e-03
      1.70710508e-01  1.20540576e-03  1.80871371e-03  3.74810860e-04
      8.37481277e-04  1.04012366e-01  6.76952950e-04  2.88628982e-03
      7.98581560e-02  1.11698750e-03  1.16370265e-03  5.02031598e-04
      9.15078161e-04  2.34125626e-01 -1.57636814e-05  4.87057751e-04
      8.08372530e-03  6.73156134e-04  5.23466158e-02  3.42254193e-03
      3.16393361e-03  1.97176333e-01  2.89462386e-03  1.01111645e-03
      9.44506317e-05  1.44825417e-05  2.17301579e-01  1.25120845e-03
      5.88156543e-04  5.43064774e-02  2.60591938e-03  1.65014580e-02
      4.62778847e-03  1.22901817e-03  3.12828243e-01  8.80152378e-04
      8.11872383e-04  1.74946717e-03  1.21786048e-03  1.36295168e-01
      9.99807838e-03  2.15505101e-03  1.70146711e-01  5.41700758e-03
      7.26276630e-03  2.32720643e-03 -3.28680221e-04  3.38750248e-01
      5.78389703e-04 -3.13442956e-04  2.47154094e-02  3.56322265e-03
      5.83758020e-02  1.77165982e-02  1.97217733e-03  3.26284263e-01
      3.84276583e-03  8.62880666e-03  1.03669802e-04  1.04120838e-03
      2.54014665e-01  1.45846373e-02 -1.01404115e-05  1.09567480e-01
      6.53773308e-03  2.48612768e-02  1.38566743e-02  4.18646811e-04
      4.19626835e-01  2.43518929e-04  7.50190348e-03  6.42733094e-03
      3.41860290e-03  1.33033575e-01  3.62874065e-02  1.10453134e-03
      2.68331457e-01  6.71118430e-03  2.43995453e-02  4.39594177e-03
      6.78945359e-04  3.73880579e-01  1.33509989e-02  3.02294699e-03
      5.02849534e-02  5.29218291e-03  5.81699502e-02  4.01333399e-02
      1.40521983e-03  4.21620846e-01  1.74911001e-03  2.81117988e-02
      6.05512944e-04  2.39219383e-03  2.33589970e-01  4.94852606e-02
     -6.97354508e-05  1.70845545e-01  6.36840692e-03  4.44512043e-02
      2.18406153e-02  1.12789423e-03  4.50548952e-01  8.25164556e-03
      2.07545195e-02  1.44507819e-02  2.95032378e-03  1.10790142e-01
      7.53192098e-02  7.05477408e-04  3.42565078e-01  3.28451785e-03
      5.63248989e-02  4.45732303e-03  1.24078865e-03  3.35111453e-01
      4.89079865e-02  6.81911446e-03  8.00037849e-02  2.98130298e-03
      6.64082879e-02  5.95458303e-02  2.06277180e-03  4.48686190e-01
      3.63461534e-03  5.62134858e-02  1.61983453e-03  1.00689115e-03
      1.80014854e-01  1.02479403e-01 -2.63986776e-04  2.19701223e-01
      2.12828761e-03  8.04013277e-02  2.31057955e-02  1.02732914e-03
      4.00853583e-01  3.63258297e-02  3.32776999e-02  2.45073241e-02
      1.48253675e-04  9.24362168e-02  1.11416894e-01  1.55594227e-03
      3.66211961e-01  8.66886607e-04  9.88707047e-02  2.61079769e-03
     -2.48963962e-04  2.50954495e-01  1.06762823e-01  7.62260204e-03
      1.05394052e-01 -1.57027962e-04  9.19017156e-02  6.53315878e-02
      1.93977986e-03  4.00634246e-01  2.04843097e-02  8.22854463e-02
      3.29006140e-03  3.35060517e-04  1.25226224e-01  1.55946751e-01
      2.97190232e-05  2.38455423e-01 -5.30405431e-04  1.29341975e-01
      1.74269074e-02 -7.73567857e-04  2.98495256e-01  8.77695478e-02
      3.76407017e-02  3.37220435e-02  1.90821002e-03  9.25568377e-02
      1.27628010e-01  2.25484024e-03  3.30601546e-01  8.83352609e-03
      1.39557189e-01  6.03764614e-04  2.02919100e-03  1.60554893e-01
      1.71033953e-01  5.54295431e-03  1.17083871e-01  2.58058228e-03
      1.33512713e-01  5.51400640e-02 -1.60319120e-04  2.99770887e-01
      5.82553416e-02  9.44161611e-02  5.13505427e-03  1.07856758e-02
      9.09364381e-02  1.87529083e-01  8.75690864e-04  2.18739736e-01
      5.57024130e-03  1.79057318e-01  9.09783747e-03  2.45253011e-03
      1.85215762e-01  1.51340946e-01  3.20780614e-02  3.84502352e-02
      1.66357823e-02  1.13090933e-01  1.16813681e-01  9.43923789e-04
      2.49644586e-01  3.33582602e-02  1.62862393e-01 -2.59266012e-04
      2.14100138e-02  9.27178993e-02  2.17189219e-01  2.94850871e-03
      1.09268151e-01  1.61374828e-02  1.80829657e-01  3.55534409e-02
      1.38498453e-03  1.84362522e-01  1.10932934e-01  8.72180943e-02
      6.07894493e-03  4.27947146e-02  8.26764599e-02  1.83527206e-01
      8.54044597e-04  1.66744918e-01  2.42317391e-02  2.12562647e-01
      2.83840281e-03  2.57695119e-02  9.48376096e-02  2.04471758e-01
      2.09779280e-02  3.60482926e-02  4.72692458e-02  1.45709255e-01
      8.54483280e-02  4.70784301e-04  1.52923050e-01  7.17282803e-02
      1.58778170e-01 -1.10633216e-04  7.06985422e-02  5.70202356e-02
      2.25659716e-01  1.15013999e-03  8.35414498e-02  3.99825768e-02
      2.17744343e-01  1.64915308e-02  2.12219560e-02  8.90813033e-02
      1.60830121e-01  6.51522181e-02  5.26438843e-03  9.78209872e-02
      9.35279596e-02  1.46778239e-01  2.07825714e-03  2.48320688e-03
      3.86296574e-03  5.78587170e-04  4.13735690e-03  1.90413144e-03
      2.91231786e-04  2.78762352e-03  3.98478870e-05  3.62344531e-03
      3.17122629e-03  1.22765485e-03  1.38664442e-03  9.01082781e-05
      3.16166084e-04  1.06773266e-03  1.41480505e-03  3.65267032e-03
      2.38412226e-03  9.35372242e-04 -4.67682855e-04 -2.33196727e-04
      3.37010673e-03  1.26876858e-03  3.69441781e-03 -9.45155684e-04
      7.79924130e-04 -2.77920204e-04  1.30414334e-03  1.04371319e-03
      5.12873011e-03  2.58197594e-03  4.04074927e-03  2.23541599e-03
      1.53194270e-04  1.99136992e-03  1.66444502e-04  3.10730689e-03
     -4.39150785e-04  1.84296018e-03  1.67754591e-03  1.53366214e-02
      6.37294028e-04  6.11570872e-03  8.04505730e-04  4.97962172e-03
      4.41602185e-03  5.40733046e-04  1.15893785e-03  1.28407355e-02
      9.98608252e-04  2.42820604e-03  2.33807225e-03  3.95418963e-03
      3.73769172e-02  9.12470030e-04  4.61559671e-03  1.29336264e-03
      2.62753571e-03  1.59015145e-03  6.00676680e-04  2.11111760e-03
      5.20283855e-02  5.52107559e-04  5.07375854e-03  1.29958882e-03
      3.87700865e-03  4.55472608e-02  5.42076050e-04  2.96028375e-03
      2.09408894e-02  1.07250667e-04 -5.60013139e-04  9.08099370e-04
      2.87255730e-03  1.04596989e-01  9.93302298e-04  4.46639760e-03
      9.88176082e-04  1.67566968e-03  3.08017508e-02 -5.69246541e-05
      3.03389847e-03  8.06214708e-02  2.97455817e-04  1.01074331e-03
      9.83107191e-04  2.05432765e-03  1.29875192e-01  3.50743469e-04
      2.69107948e-03  1.72161258e-02 -1.71912972e-05  1.02315620e-02
      1.61453459e-04  2.72171800e-03  1.70710508e-01  1.20540576e-03
      1.80871371e-03  3.74810860e-04  8.37481277e-04  1.04012366e-01
      6.76952950e-04  2.88628982e-03  7.98581560e-02  1.11698750e-03
      1.16370265e-03  5.02031598e-04  9.15078161e-04  2.34125626e-01
     -1.57636814e-05  4.87057751e-04  8.08372530e-03  6.73156134e-04
      5.23466158e-02  3.42254193e-03  3.16393361e-03  1.97176333e-01
      2.89462386e-03  1.01111645e-03  9.44506317e-05  1.44825417e-05
      2.17301579e-01  1.25120845e-03  5.88156543e-04  5.43064774e-02
      2.60591938e-03  1.65014580e-02  4.62778847e-03  1.22901817e-03
      3.12828243e-01  8.80152378e-04  8.11872383e-04  1.74946717e-03
      1.21786048e-03  1.36295168e-01  9.99807838e-03  2.15505101e-03
      1.70146711e-01  5.41700758e-03  7.26276630e-03  2.32720643e-03
     -3.28680221e-04  3.38750248e-01  5.78389703e-04 -3.13442956e-04
      2.47154094e-02  3.56322265e-03  5.83758020e-02  1.77165982e-02
      1.97217733e-03  3.26284263e-01  3.84276583e-03  8.62880666e-03
      1.03669802e-04  1.04120838e-03  2.54014665e-01  1.45846373e-02
     -1.01404115e-05  1.09567480e-01  6.53773308e-03  2.48612768e-02
      1.38566743e-02  4.18646811e-04  4.19626835e-01  2.43518929e-04
      7.50190348e-03  6.42733094e-03  3.41860290e-03  1.33033575e-01
      3.62874065e-02  1.10453134e-03  2.68331457e-01  6.71118430e-03
      2.43995453e-02  4.39594177e-03  6.78945359e-04  3.73880579e-01
      1.33509989e-02  3.02294699e-03  5.02849534e-02  5.29218291e-03
      5.81699502e-02  4.01333399e-02  1.40521983e-03  4.21620846e-01
      1.74911001e-03  2.81117988e-02  6.05512944e-04  2.39219383e-03
      2.33589970e-01  4.94852606e-02 -6.97354508e-05  1.70845545e-01
      6.36840692e-03  4.44512043e-02  2.18406153e-02  1.12789423e-03
      4.50548952e-01  8.25164556e-03  2.07545195e-02  1.44507819e-02
      2.95032378e-03  1.10790142e-01  7.53192098e-02  7.05477408e-04
      3.42565078e-01  3.28451785e-03  5.63248989e-02  4.45732303e-03
      1.24078865e-03  3.35111453e-01  4.89079865e-02  6.81911446e-03
      8.00037849e-02  2.98130298e-03  6.64082879e-02  5.95458303e-02
      2.06277180e-03  4.48686190e-01  3.63461534e-03  5.62134858e-02
      1.61983453e-03  1.00689115e-03  1.80014854e-01  1.02479403e-01
     -2.63986776e-04  2.19701223e-01  2.12828761e-03  8.04013277e-02
      2.31057955e-02  1.02732914e-03  4.00853583e-01  3.63258297e-02
      3.32776999e-02  2.45073241e-02  1.48253675e-04  9.24362168e-02
      1.11416894e-01  1.55594227e-03  3.66211961e-01  8.66886607e-04
      9.88707047e-02  2.61079769e-03 -2.48963962e-04  2.50954495e-01
      1.06762823e-01  7.62260204e-03  1.05394052e-01 -1.57027962e-04
      9.19017156e-02  6.53315878e-02  1.93977986e-03  4.00634246e-01
      2.04843097e-02  8.22854463e-02  3.29006140e-03  3.35060517e-04
      1.25226224e-01  1.55946751e-01  2.97190232e-05  2.38455423e-01
     -5.30405431e-04  1.29341975e-01  1.74269074e-02 -7.73567857e-04
      2.98495256e-01  8.77695478e-02  3.76407017e-02  3.37220435e-02
      1.90821002e-03  9.25568377e-02  1.27628010e-01  2.25484024e-03
      3.30601546e-01  8.83352609e-03  1.39557189e-01  6.03764614e-04
      2.02919100e-03  1.60554893e-01  1.71033953e-01  5.54295431e-03
      1.17083871e-01  2.58058228e-03  1.33512713e-01  5.51400640e-02
     -1.60319120e-04  2.99770887e-01  5.82553416e-02  9.44161611e-02
      5.13505427e-03  1.07856758e-02  9.09364381e-02  1.87529083e-01
      8.75690864e-04  2.18739736e-01  5.57024130e-03  1.79057318e-01
      9.09783747e-03  2.45253011e-03  1.85215762e-01  1.51340946e-01
      3.20780614e-02  3.84502352e-02  1.66357823e-02  1.13090933e-01
      1.16813681e-01  9.43923789e-04  2.49644586e-01  3.33582602e-02
      1.62862393e-01 -2.59266012e-04  2.14100138e-02  9.27178993e-02
      2.17189219e-01  2.94850871e-03  1.09268151e-01  1.61374828e-02
      1.80829657e-01  3.55534409e-02  1.38498453e-03  1.84362522e-01
      1.10932934e-01  8.72180943e-02  6.07894493e-03  4.27947146e-02
      8.26764599e-02  1.83527206e-01  8.54044597e-04  1.66744918e-01
      2.42317391e-02  2.12562647e-01  2.83840281e-03  2.57695119e-02
      9.48376096e-02  2.04471758e-01  2.09779280e-02  3.60482926e-02
      4.72692458e-02  1.45709255e-01  8.54483280e-02  4.70784301e-04
      1.52923050e-01  7.17282803e-02  1.58778170e-01 -1.10633216e-04
      7.06985422e-02  5.70202356e-02  2.25659716e-01  1.15013999e-03
      8.35414498e-02  3.99825768e-02  2.17744343e-01  1.64915308e-02
      2.12219560e-02  8.90813033e-02  1.60830121e-01  6.51522181e-02
      5.26438843e-03  9.78209872e-02  9.35279596e-02  1.46778239e-01]
    Saving illustration as msdodf.png




.. GENERATED FROM PYTHON SOURCE LINES 317-344

.. rst-class:: centered small fst-italic fw-semibold

MSMT-CSD Peaks and ODFs.


References
----------

.. [Jeurissen2014] B. Jeurissen, et al., "Multi-tissue constrained spherical
                    deconvolution for improved analysis of multi-shell
                    diffusion MRI data." NeuroImage 103 (2014): 411-426.

.. [Tournier2007] J-D. Tournier, F. Calamante and A. Connelly, "Robust
                    determination of the fibre orientation distribution in
                    diffusion MRI: Non-negativity constrained super-resolved
                    spherical deconvolution", Neuroimage, vol. 35, no. 4,
                    pp. 1459-1472, (2007).

.. [Hansen2016] B. Hansen and SN. Jespersen, " Data for evaluation of fast
                    kurtosis strategies, b-value optimization and exploration
                    of diffusion MRI contrast", Scientific Data 3: 160072
                    doi:10.1038/sdata.2016.72, (2016)

.. [DellAcqua2014] F. Dell'Acqua, et. al., "Anisotropic Power Maps: A
                    diffusion contrast to reveal low anisotropy tissues from
                    HARDI data", Proceedings of International Society for
                    Magnetic Resonance in Medicine. Milan, Italy, (2014).

.. GENERATED FROM PYTHON SOURCE LINES 346-348

.. include:: ../../links_names.inc



.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (316 minutes 15.931 seconds)


.. _sphx_glr_download_examples_built_reconstruction_reconst_mcsd.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: reconst_mcsd.ipynb <reconst_mcsd.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: reconst_mcsd.py <reconst_mcsd.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
