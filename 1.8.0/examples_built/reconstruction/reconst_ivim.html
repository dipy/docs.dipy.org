
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>DIPY &#8212; dipy 1.8.0dev0 documentation</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/dipy.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

  
<link rel="stylesheet" href="../../_static/styles/grg-sphinx-theme.css"/>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples_built/reconstruction/reconst_ivim';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

  <meta name="keywords" content="DIPY, dMRI, DTI, DSI, diffusion MRI, Tensor,
  neuroimaging, python, neuroscience, Eleftherios, Garyfallidis, tractography,
  streamlines, fiber tracking">




  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">dipy 1.8.0dev0 documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../documentation.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../stateoftheart.html">
                        A quick overview of features
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
</div>

</nav>
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../documentation.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../stateoftheart.html">
                        A quick overview of features
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">DIPY</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
<div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-built-reconstruction-reconst-ivim-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="intravoxel-incoherent-motion">
<span id="sphx-glr-examples-built-reconstruction-reconst-ivim-py"></span><h1>Intravoxel incoherent motion<a class="headerlink" href="#intravoxel-incoherent-motion" title="Permalink to this heading">#</a></h1>
<p>The intravoxel incoherent motion (IVIM) model describes diffusion
and perfusion in the signal acquired with a diffusion MRI sequence
that contains multiple low b-values. The IVIM model can be understood
as an adaptation of the work of Stejskal and Tanner <a class="reference internal" href="../../reference_cmd/dipy_fit_ivim.html#stejskal65" id="id1"><span>[Stejskal65]</span></a>
in biological tissue, and was proposed by Le Bihan <a class="reference internal" href="../../reference_cmd/dipy_fit_ivim.html#lebihan84" id="id2"><span>[LeBihan84]</span></a>.
The model assumes two compartments: a slow moving compartment,
where particles diffuse in a Brownian fashion as a consequence of thermal
energy, and a fast moving compartment (the vascular compartment), where
blood moves as a consequence of a pressure gradient. In the first compartment,
the diffusion coefficient is <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> while in the second compartment, a
pseudo diffusion term <span class="math notranslate nohighlight">\(\mathbf{D^*}\)</span> is introduced that describes the
displacement of the blood elements in an assumed randomly laid out vascular
network, at the macroscopic level. According to <a class="reference internal" href="../../reference_cmd/dipy_fit_ivim.html#lebihan84" id="id3"><span>[LeBihan84]</span></a>,
<span class="math notranslate nohighlight">\(\mathbf{D^*}\)</span> is greater than <span class="math notranslate nohighlight">\(\mathbf{D}\)</span>.</p>
<p>The IVIM model expresses the MRI signal as follows:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[S(b)=S_0(fe^{-bD^*}+(1-f)e^{-bD})\]</div>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> is the diffusion gradient weighing value (which is dependent
on the measurement parameters), <span class="math notranslate nohighlight">\(\mathbf{S_{0}}\)</span> is the signal in the absence
of diffusion gradient sensitization, <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> is the perfusion
fraction, <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> is the diffusion coefficient and <span class="math notranslate nohighlight">\(\mathbf{D^*}\)</span> is
the pseudo-diffusion constant, due to vascular contributions.</p>
<p>In the following example we show how to fit the IVIM model on a
diffusion-weighted dataset and visualize the diffusion and pseudo-diffusion
coefficients. First, we import all relevant modules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">dipy.reconst.ivim</span> <span class="kn">import</span> <span class="n">IvimModel</span>
<span class="kn">from</span> <span class="nn">dipy.core.gradients</span> <span class="kn">import</span> <span class="n">gradient_table</span>
<span class="kn">from</span> <span class="nn">dipy.data</span> <span class="kn">import</span> <span class="n">get_fnames</span>
<span class="kn">from</span> <span class="nn">dipy.io.gradients</span> <span class="kn">import</span> <span class="n">read_bvals_bvecs</span>
<span class="kn">from</span> <span class="nn">dipy.io.image</span> <span class="kn">import</span> <span class="n">load_nifti_data</span>
</pre></div>
</div>
<p>We get an IVIM dataset using <a class="reference external" href="http://dipy.org">DIPY</a>’s data fetcher <code class="docutils literal notranslate"><span class="pre">read_ivim</span></code>.
This dataset was acquired with 21 b-values in 3 different directions.
Volumes corresponding to different directions were registered to each
other, and averaged across directions. Thus, this dataset has 4 dimensions,
with the length of the last dimension corresponding to the number
of b-values. In order to use this model the data should contain signals
measured at 0 bvalue.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fraw</span><span class="p">,</span> <span class="n">fbval</span><span class="p">,</span> <span class="n">fbvec</span> <span class="o">=</span> <span class="n">get_fnames</span><span class="p">(</span><span class="s1">&#39;ivim&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The gtab contains a GradientTable object (information about the gradients e.g.
b-values and b-vectors). We get the data from the file using
<code class="docutils literal notranslate"><span class="pre">load_nifti_data</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">load_nifti_data</span><span class="p">(</span><span class="n">fraw</span><span class="p">)</span>
<span class="n">bvals</span><span class="p">,</span> <span class="n">bvecs</span> <span class="o">=</span> <span class="n">read_bvals_bvecs</span><span class="p">(</span><span class="n">fbval</span><span class="p">,</span> <span class="n">fbvec</span><span class="p">)</span>
<span class="n">gtab</span> <span class="o">=</span> <span class="n">gradient_table</span><span class="p">(</span><span class="n">bvals</span><span class="p">,</span> <span class="n">bvecs</span><span class="p">,</span> <span class="n">b0_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;data.shape (</span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>The data has 54 slices, with 256-by-256 voxels in each slice. The fourth
dimension corresponds to the b-values in the gtab. Let us visualize the data
by taking a slice midway(z=33) at <span class="math notranslate nohighlight">\(\mathbf{b} = 0\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="mi">33</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">z</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>
           <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">170</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;ivim_data_slice.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id8">
<img alt="examples_built/reconstruction/ivim_data_slice.png" src="examples_built/reconstruction/ivim_data_slice.png" />
<figcaption>
<p><span class="caption-text">Heat map of a slice of data</span><a class="headerlink" href="#id8" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The region around the intersection of the cross-hairs in the figure
contains cerebral spinal fluid (CSF), so it should have a very high
<span class="math notranslate nohighlight">\(\mathbf{f}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{D^*}\)</span>, the area just medial to that is white matter
so that should be lower, and the region more laterally contains a mixture of
gray matter and CSF. That should give us some contrast to see the
values varying across the regions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">155</span>
<span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">170</span>
<span class="n">data_slice</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x1</span><span class="p">:</span><span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">:</span><span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">x1</span><span class="p">:</span><span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">:</span><span class="n">y2</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
           <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;CSF_slice.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id9">
<img alt="examples_built/reconstruction/CSF_slice.png" src="examples_built/reconstruction/CSF_slice.png" />
<figcaption>
<p><span class="caption-text">Heat map of the CSF slice selected.</span><a class="headerlink" href="#id9" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Now that we have prepared the datasets we can go forward with
the ivim fit. We provide two methods of fitting the parameters of the IVIM
multi-exponential model explained above. We first fit the model with a simple
fitting approach by passing the option <cite>fit_method=’trr’</cite>. This method uses
a two-stage approach: first, a linear fit used to get quick initial guesses
for the parameters <span class="math notranslate nohighlight">\(\mathbf{S_{0}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> by considering b-values
greater than <code class="docutils literal notranslate"><span class="pre">split_b_D</span></code> (default: 400))and assuming a mono-exponential
signal. This is based on the assumption that at high b-values the signal can be
approximated as a mono exponential decay and by taking the logarithm of the
signal values a linear fit can be obtained. Another linear fit for <code class="docutils literal notranslate"><span class="pre">S0</span></code>
(bvals &lt; <code class="docutils literal notranslate"><span class="pre">split_b_S0</span></code> (default: 200)) follows and <code class="docutils literal notranslate"><span class="pre">f</span></code> is estimated using
<span class="math notranslate nohighlight">\(1 - S0_{prime}/S0\)</span>. Then a non-linear least-squares fitting is performed to
fit <code class="docutils literal notranslate"><span class="pre">D_star</span></code> and <code class="docutils literal notranslate"><span class="pre">f</span></code>. If the <code class="docutils literal notranslate"><span class="pre">two_stage</span></code> flag is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> while
initializing the model, a final non-linear least squares fitting is performed
for all the parameters. All initializations for the model such as <code class="docutils literal notranslate"><span class="pre">split_b_D</span></code>
are passed while creating the <code class="docutils literal notranslate"><span class="pre">IvimModel</span></code>. If you are using Scipy 0.17, you
can also set bounds by setting <code class="docutils literal notranslate"><span class="pre">bounds=([0.,</span> <span class="pre">0.,</span> <span class="pre">0.,0.],</span> <span class="pre">[np.inf,</span> <span class="pre">1.,</span> <span class="pre">1.,</span> <span class="pre">1.]))</span></code>
while initializing the <code class="docutils literal notranslate"><span class="pre">IvimModel</span></code>.</p>
<p>For brevity, we focus on a small section of the slice as selected above,
to fit the IVIM model. First, we instantiate the IvimModel object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ivimmodel</span> <span class="o">=</span> <span class="n">IvimModel</span><span class="p">(</span><span class="n">gtab</span><span class="p">,</span> <span class="n">fit_method</span><span class="o">=</span><span class="s1">&#39;trr&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To fit the model, call the <cite>fit</cite> method and pass the data for fitting.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ivimfit</span> <span class="o">=</span> <span class="n">ivimmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_slice</span><span class="p">)</span>
</pre></div>
</div>
<p>The fit method creates a IvimFit object which contains the
parameters of the model obtained after fitting. These are accessible
through the <cite>model_params</cite> attribute of the IvimFit object.
The parameters are arranged as a 4D array, corresponding to the spatial
dimensions of the data, and the last dimension (of length 4)
corresponding to the model parameters according to the following
order : <span class="math notranslate nohighlight">\(\mathbf{S_{0}, f, D^*, D}\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ivimparams</span> <span class="o">=</span> <span class="n">ivimfit</span><span class="o">.</span><span class="n">model_params</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ivimparams.shape : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ivimparams</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
<p>As we see, we have a 20x20 slice at the height z = 33. Thus we
have 400 voxels. We will now plot the parameters obtained from the
fit for a voxel and also various maps for the entire slice.
This will give us an idea about the diffusion and perfusion in
that section. Let(i, j) denote the coordinate of the voxel. We have
already fixed the z component as 33 and hence we will get a slice
which is 33 units above.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">estimated_params</span> <span class="o">=</span> <span class="n">ivimfit</span><span class="o">.</span><span class="n">model_params</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">estimated_params</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can map the perfusion and diffusion maps for the slice. We
will plot a heatmap showing the values using a colormap. It will be
useful to define a plotting function for the heatmap here since we
will use it to plot for all the IVIM parameters. We will need to specify
the lower and upper limits for our data. For example, the perfusion
fractions should be in the range (0,1). Similarly, the diffusion and
pseudo-diffusion constants are much smaller than 1. We pass an argument
called <code class="docutils literal notranslate"><span class="pre">variable</span></code> to out plotting function which gives the label for
the plot.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_map</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">limits</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">limits</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Map for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">))</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">raw_data</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">),</span>
                   <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>Let us get the various plots with <cite>fit_method = ‘trr’</cite> so that we can visualize
them in one page</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_map</span><span class="p">(</span><span class="n">ivimfit</span><span class="o">.</span><span class="n">S0_predicted</span><span class="p">,</span> <span class="s2">&quot;Predicted S0&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span> <span class="s2">&quot;predicted_S0.png&quot;</span><span class="p">)</span>
<span class="n">plot_map</span><span class="p">(</span><span class="n">data_slice</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Measured S0&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span> <span class="s2">&quot;measured_S0.png&quot;</span><span class="p">)</span>
<span class="n">plot_map</span><span class="p">(</span><span class="n">ivimfit</span><span class="o">.</span><span class="n">perfusion_fraction</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;perfusion_fraction.png&quot;</span><span class="p">)</span>
<span class="n">plot_map</span><span class="p">(</span><span class="n">ivimfit</span><span class="o">.</span><span class="n">D_star</span><span class="p">,</span> <span class="s2">&quot;D*&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="s2">&quot;perfusion_coeff.png&quot;</span><span class="p">)</span>
<span class="n">plot_map</span><span class="p">(</span><span class="n">ivimfit</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span> <span class="s2">&quot;diffusion_coeff.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we will fit the same model with a more refined optimization process with
<cite>fit_method=’VarPro’</cite> (for “Variable Projection”). The VarPro computes the IVIM
parameters using the MIX approach <a class="reference internal" href="#farooq16" id="id4"><span>[Farooq16]</span></a>. This algorithm uses three
different optimizers. It starts with a differential evolution algorithm and
fits the parameters in the power of exponentials. Then the fitted parameters in
the first step are utilized to make a linear convex problem. Using a convex
optimization, the volume fractions are determined. The last step is non-linear
least-squares fitting on all the parameters. The results of the first and
second optimizers are utilized as the initial values for the last step of the
algorithm.</p>
<p>As opposed to the <cite>‘trr’</cite> fitting method, this approach does not need to set
any thresholds on the bvals to differentiate between the perfusion
(pseudo-diffusion) and diffusion portions and fits the parameters
simultaneously. Making use of the three step optimization mentioned above
increases the convergence basin for fitting the multi-exponential functions of
microstructure models. This method has been described in further detail in
<a class="reference internal" href="#fadnavis19" id="id5"><span>[Fadnavis19]</span></a> and <a class="reference internal" href="#farooq16" id="id6"><span>[Farooq16]</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ivimmodel_vp</span> <span class="o">=</span> <span class="n">IvimModel</span><span class="p">(</span><span class="n">gtab</span><span class="p">,</span> <span class="n">fit_method</span><span class="o">=</span><span class="s1">&#39;VarPro&#39;</span><span class="p">)</span>
<span class="n">ivimfit_vp</span> <span class="o">=</span> <span class="n">ivimmodel_vp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_slice</span><span class="p">)</span>
</pre></div>
</div>
<p>Just like the <cite>‘trr’</cite> fit method, <cite>‘VarPro’</cite> creates a IvimFit object which
contains the parameters of the model obtained after fitting. These are
accessible through the <cite>model_params</cite> attribute of the IvimFit object.
The parameters are arranged as a 4D array, corresponding to the spatial
dimensions of the data, and the last dimension (of length 4)
corresponding to the model parameters according to the following
order : <span class="math notranslate nohighlight">\(\mathbf{S_{0}, f, D^*, D}\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">estimated_params</span> <span class="o">=</span> <span class="n">ivimfit_vp</span><span class="o">.</span><span class="n">model_params</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">estimated_params</span><span class="p">)</span>
</pre></div>
</div>
<p>To compare the fit using <cite>fit_method=’VarPro’</cite> and <cite>fit_method=’trr’</cite>, we can
plot one voxel’s signal and the model fit using both methods.</p>
<p>We will use the <cite>predict</cite> method of the IvimFit objects, to get the predicted
signal, based on each one of the model fit methods.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">gtab</span><span class="o">.</span><span class="n">bvals</span><span class="p">,</span> <span class="n">data_slice</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="p">:],</span>
           <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Measured signal&quot;</span><span class="p">)</span>

<span class="n">ivim_trr_predict</span> <span class="o">=</span> <span class="n">ivimfit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">gtab</span><span class="p">)[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gtab</span><span class="o">.</span><span class="n">bvals</span><span class="p">,</span> <span class="n">ivim_trr_predict</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;trr prediction&quot;</span><span class="p">)</span>

<span class="n">S0_est</span><span class="p">,</span> <span class="n">f_est</span><span class="p">,</span> <span class="n">D_star_est</span><span class="p">,</span> <span class="n">D_est</span> <span class="o">=</span> <span class="n">ivimfit</span><span class="o">.</span><span class="n">model_params</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">text_fit</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;trr param estimates: </span><span class="se">\n</span><span class="s2"> S0=</span><span class="si">{:06.3f}</span><span class="s2"> f=</span><span class="si">{:06.4f}</span><span class="se">\n</span>
<span class="s2">            D*=</span><span class="si">{:06.5f}</span><span class="s2"> D=</span><span class="si">{:06.5f}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">S0_est</span><span class="p">,</span> <span class="n">f_est</span><span class="p">,</span> <span class="n">D_star_est</span><span class="p">,</span> <span class="n">D_est</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">,</span> <span class="n">text_fit</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">ivim_predict_vp</span> <span class="o">=</span> <span class="n">ivimfit_vp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">gtab</span><span class="p">)[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gtab</span><span class="o">.</span><span class="n">bvals</span><span class="p">,</span> <span class="n">ivim_predict_vp</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;VarPro prediction&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;bvalues&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Signals&quot;</span><span class="p">)</span>

<span class="n">S0_est</span><span class="p">,</span> <span class="n">f_est</span><span class="p">,</span> <span class="n">D_star_est</span><span class="p">,</span> <span class="n">D_est</span> <span class="o">=</span> <span class="n">ivimfit_vp</span><span class="o">.</span><span class="n">model_params</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">text_fit</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;VarPro param estimates: </span><span class="se">\n</span><span class="s2"> S0=</span><span class="si">{:06.3f}</span><span class="s2"> f=</span><span class="si">{:06.4f}</span><span class="se">\n</span>
<span class="s2">            D*=</span><span class="si">{:06.5f}</span><span class="s2"> D=</span><span class="si">{:06.5f}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">S0_est</span><span class="p">,</span> <span class="n">f_est</span><span class="p">,</span> <span class="n">D_star_est</span><span class="p">,</span> <span class="n">D_est</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="n">text_fit</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;ivim_voxel_plot.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id10">
<img alt="examples_built/reconstruction/ivim_voxel_plot.png" src="examples_built/reconstruction/ivim_voxel_plot.png" />
<figcaption>
<p><span class="caption-text">Plot of the signal from one voxel.</span><a class="headerlink" href="#id10" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Let us get the various plots with <cite>fit_method = ‘VarPro’</cite> so that we can
visualize them in one page</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plot_map</span><span class="p">(</span><span class="n">ivimfit_vp</span><span class="o">.</span><span class="n">S0_predicted</span><span class="p">,</span> <span class="s2">&quot;Predicted S0&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
         <span class="s2">&quot;predicted_S0.png&quot;</span><span class="p">)</span>
<span class="n">plot_map</span><span class="p">(</span><span class="n">data_slice</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Measured S0&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span> <span class="s2">&quot;measured_S0.png&quot;</span><span class="p">)</span>
<span class="n">plot_map</span><span class="p">(</span><span class="n">ivimfit_vp</span><span class="o">.</span><span class="n">perfusion_fraction</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;perfusion_fraction.png&quot;</span><span class="p">)</span>
<span class="n">plot_map</span><span class="p">(</span><span class="n">ivimfit_vp</span><span class="o">.</span><span class="n">D_star</span><span class="p">,</span> <span class="s2">&quot;D*&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="s2">&quot;perfusion_coeff.png&quot;</span><span class="p">)</span>
<span class="n">plot_map</span><span class="p">(</span><span class="n">ivimfit_vp</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span> <span class="s2">&quot;diffusion_coeff.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id11">
<img alt="examples_built/reconstruction/predicted_S0.png" src="examples_built/reconstruction/predicted_S0.png" />
<figcaption>
<p><span class="caption-text">Heatmap of S0 predicted from the fit</span><a class="headerlink" href="#id11" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id12">
<img alt="examples_built/reconstruction/measured_S0.png" src="examples_built/reconstruction/measured_S0.png" />
<figcaption>
<p><span class="caption-text">Heatmap of measured signal at bvalue = 0.</span><a class="headerlink" href="#id12" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id13">
<img alt="examples_built/reconstruction/perfusion_fraction.png" src="examples_built/reconstruction/perfusion_fraction.png" />
<figcaption>
<p><span class="caption-text">Heatmap of perfusion fraction values predicted from the fit</span><a class="headerlink" href="#id13" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id14">
<img alt="examples_built/reconstruction/perfusion_coeff.png" src="examples_built/reconstruction/perfusion_coeff.png" />
<figcaption>
<p><span class="caption-text">Heatmap of perfusion coefficients predicted from the fit.</span><a class="headerlink" href="#id14" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id15">
<img alt="examples_built/reconstruction/diffusion_coeff.png" src="examples_built/reconstruction/diffusion_coeff.png" />
<figcaption>
<p><span class="caption-text">Heatmap of diffusion coefficients predicted from the fit</span><a class="headerlink" href="#id15" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>References:</p>
<div role="list" class="citation-list">
<div class="citation" id="stejskal65" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Stejskal65</a><span class="fn-bracket">]</span></span>
<p>Stejskal, E. O.; Tanner, J. E. (1 January 1965).
“Spin Diffusion Measurements: Spin Echoes in the Presence
of a Time-Dependent Field Gradient”. The Journal of Chemical
Physics 42 (1): 288. Bibcode: 1965JChPh..42..288S.
doi:10.1063/1.1695690.</p>
</div>
<div class="citation" id="lebihan84" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>LeBihan84<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id3">2</a>)</span>
<p>Le Bihan, Denis, et al. “Separation of diffusion
and perfusion in intravoxel incoherent motion MR
imaging.” Radiology 168.2 (1988): 497-505.</p>
</div>
<div class="citation" id="fadnavis19" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">Fadnavis19</a><span class="fn-bracket">]</span></span>
<p>Fadnavis, Shreyas et.al. “MicroLearn: Framework for machine
learning, reconstruction, optimization and microstructure
modeling, Proceedings of: International Society of Magnetic
Resonance in Medicine (ISMRM), Montreal, Canada, 2019.</p>
</div>
<div class="citation" id="farooq16" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Farooq16<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id4">1</a>,<a role="doc-backlink" href="#id6">2</a>)</span>
<p>Farooq, Hamza, et al. “Microstructure Imaging of Crossing (MIX)
White Matter Fibers from diffusion MRI.” Scientific reports 6
(2016).</p>
</div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.000 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-built-reconstruction-reconst-ivim-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/73b9103d6dfa7998533e51b180342d10/reconst_ivim.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">reconst_ivim.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e2b2882acc3e416665a51960fff85191/reconst_ivim.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">reconst_ivim.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>

<div class="section ablog__blog_comments">
  
  
</div>

                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  
<script type="module" src="../../_static/scripts/grg-sphinx-theme.js"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2008-2023, dipy developers &lt;neuroimaging@python.org&gt;.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

    <div class="copyright-text">
      <i class="fa-regular fa-copyright"></i> 
    </div>
  </footer>
  </body>
</html>