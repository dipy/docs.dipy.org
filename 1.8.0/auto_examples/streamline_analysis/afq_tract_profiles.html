
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>DIPY &#8212; dipy 1.8.0dev0 documentation</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/dipy.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

  
<link rel="stylesheet" href="../../_static/styles/grg-sphinx-theme.css"/>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/streamline_analysis/afq_tract_profiles';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

  <meta name="keywords" content="DIPY, dMRI, DTI, DSI, diffusion MRI, Tensor,
  neuroimaging, python, neuroscience, Eleftherios, Garyfallidis, tractography,
  streamlines, fiber tracking">




  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">dipy 1.8.0dev0 documentation</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../documentation.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../stateoftheart.html">
                        A quick overview of features
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

</nav>
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../documentation.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../stateoftheart.html">
                        A quick overview of features
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bundle_shape_similarity.html">BUAN Bundle Shape Similarity Score</a></li>
<li class="toctree-l1"><a class="reference internal" href="bundle_assignment_maps.html">BUAN Bundle Assignment Maps Creation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Extracting AFQ tract profiles from segmented bundles</a></li>
<li class="toctree-l1"><a class="reference internal" href="streamline_length.html">Streamline length and size reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster_confidence.html">Calculation of Outliers with Cluster Confidence Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="path_length_map.html">Calculate Path Length Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="streamline_tools.html">Connectivity Matrices, ROI Intersections and Density Maps</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">DIPY</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
<div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-streamline-analysis-afq-tract-profiles-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="extracting-afq-tract-profiles-from-segmented-bundles">
<span id="sphx-glr-auto-examples-streamline-analysis-afq-tract-profiles-py"></span><h1>Extracting AFQ tract profiles from segmented bundles<a class="headerlink" href="#extracting-afq-tract-profiles-from-segmented-bundles" title="Permalink to this heading">#</a></h1>
<p>In this example, we will extract the values of a statistic from a
volume, using the coordinates along the length of a bundle. These are called
<cite>tract profiles</cite></p>
<p>One of the challenges of extracting tract profiles is that some of the
streamlines in a bundle may diverge significantly from the bundle in some
locations. To overcome this challenge, we will use a strategy similar to that
described in <a class="reference internal" href="../../reference/dipy.stats.html#yeatman2012" id="id1"><span>[Yeatman2012]</span></a>: We will weight the contribution of each streamline
to the bundle profile based on how far this streamline is from the mean
trajectory of the bundle at that location.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dipy.stats.analysis</span> <span class="k">as</span> <span class="nn">dsa</span>
<span class="kn">import</span> <span class="nn">dipy.tracking.streamline</span> <span class="k">as</span> <span class="nn">dts</span>
<span class="kn">from</span> <span class="nn">dipy.segment.clustering</span> <span class="kn">import</span> <a href="../../reference/dipy.segment.html#dipy.segment.clustering.QuickBundles" title="dipy.segment.clustering.QuickBundles" class="sphx-glr-backref-module-dipy-segment-clustering sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">QuickBundles</span></a>
<span class="kn">from</span> <span class="nn">dipy.segment.metricspeed</span> <span class="kn">import</span> <span class="n">AveragePointwiseEuclideanMetric</span>
<span class="kn">from</span> <span class="nn">dipy.segment.featurespeed</span> <span class="kn">import</span> <span class="n">ResampleFeature</span>
<span class="kn">from</span> <span class="nn">dipy.data.fetcher</span> <span class="kn">import</span> <span class="n">get_two_hcp842_bundles</span>
<span class="kn">import</span> <span class="nn">dipy.data</span> <span class="k">as</span> <span class="nn">dpd</span>
<span class="kn">from</span> <span class="nn">dipy.io.streamline</span> <span class="kn">import</span> <a href="../../reference/dipy.io.html#dipy.io.streamline.load_trk" title="dipy.io.streamline.load_trk" class="sphx-glr-backref-module-dipy-io-streamline sphx-glr-backref-type-py-function"><span class="n">load_trk</span></a>
<span class="kn">from</span> <span class="nn">dipy.io.image</span> <span class="kn">import</span> <a href="../../reference/dipy.io.html#dipy.io.image.load_nifti" title="dipy.io.image.load_nifti" class="sphx-glr-backref-module-dipy-io-image sphx-glr-backref-type-py-function"><span class="n">load_nifti</span></a>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">op</span>
</pre></div>
</div>
<p>To get started, we will grab the bundles.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bundles_path</span> <span class="o">=</span> <span class="n">dpd</span><span class="o">.</span><span class="n">fetch_bundles_2_subjects</span><span class="p">()</span>
<span class="n">bundles_folder</span> <span class="o">=</span> <span class="n">bundles_path</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">cst_l_file</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bundles_folder</span><span class="p">,</span> <span class="s2">&quot;bundles_2_subjects&quot;</span><span class="p">,</span> <span class="s2">&quot;subj_2&quot;</span><span class="p">,</span> <span class="s2">&quot;bundles&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;bundles_cst.left.trk&quot;</span><span class="p">)</span>
<span class="n">af_l_file</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bundles_folder</span><span class="p">,</span> <span class="s2">&quot;bundles_2_subjects&quot;</span><span class="p">,</span> <span class="s2">&quot;subj_2&quot;</span><span class="p">,</span> <span class="s2">&quot;bundles&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;bundles_af.left.trk&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Either way, we can use the <cite>dipy.io</cite> API to read in the bundles from file.
<cite>load_trk</cite> returns both the streamlines, as well as header information.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cst_l</span> <span class="o">=</span> <a href="../../reference/dipy.io.html#dipy.io.streamline.load_trk" title="dipy.io.streamline.load_trk" class="sphx-glr-backref-module-dipy-io-streamline sphx-glr-backref-type-py-function"><span class="n">load_trk</span></a><span class="p">(</span><span class="n">cst_l_file</span><span class="p">,</span> <span class="s2">&quot;same&quot;</span><span class="p">,</span> <span class="n">bbox_valid_check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">streamlines</span>
<span class="n">af_l</span> <span class="o">=</span> <a href="../../reference/dipy.io.html#dipy.io.streamline.load_trk" title="dipy.io.streamline.load_trk" class="sphx-glr-backref-module-dipy-io-streamline sphx-glr-backref-type-py-function"><span class="n">load_trk</span></a><span class="p">(</span><span class="n">af_l_file</span><span class="p">,</span> <span class="s2">&quot;same&quot;</span><span class="p">,</span> <span class="n">bbox_valid_check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">streamlines</span>
</pre></div>
</div>
<p>In the next step, we need to make sure that all the streamlines in each bundle
are oriented the same way. For example, for the CST, we want to make sure that
all the bundles have their cortical termination at one end of the streamline.
This is that when we later extract values from a volume, we won’t have
different streamlines going in opposite directions.</p>
<p>To orient all the streamlines in each bundles, we will create standard
streamlines, by finding the centroids of the left AF and CST bundle models.</p>
<p>The advantage of using the model bundles is that we can use the same standard
for different subjects, which means that we’ll get roughly the same orientation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_af_l_file</span><span class="p">,</span> <span class="n">model_cst_l_file</span> <span class="o">=</span> <span class="n">get_two_hcp842_bundles</span><span class="p">()</span>

<span class="n">model_af_l</span> <span class="o">=</span> <a href="../../reference/dipy.io.html#dipy.io.streamline.load_trk" title="dipy.io.streamline.load_trk" class="sphx-glr-backref-module-dipy-io-streamline sphx-glr-backref-type-py-function"><span class="n">load_trk</span></a><span class="p">(</span><span class="n">model_af_l_file</span><span class="p">,</span> <span class="s2">&quot;same&quot;</span><span class="p">,</span>
                      <span class="n">bbox_valid_check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">streamlines</span>
<span class="n">model_cst_l</span> <span class="o">=</span> <a href="../../reference/dipy.io.html#dipy.io.streamline.load_trk" title="dipy.io.streamline.load_trk" class="sphx-glr-backref-module-dipy-io-streamline sphx-glr-backref-type-py-function"><span class="n">load_trk</span></a><span class="p">(</span><span class="n">model_cst_l_file</span><span class="p">,</span> <span class="s2">&quot;same&quot;</span><span class="p">,</span>
                       <span class="n">bbox_valid_check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">streamlines</span>


<span class="n">feature</span> <span class="o">=</span> <span class="n">ResampleFeature</span><span class="p">(</span><span class="n">nb_points</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">metric</span> <span class="o">=</span> <span class="n">AveragePointwiseEuclideanMetric</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
</pre></div>
</div>
<p>Since we are going to include all of the streamlines in the single cluster
from the streamlines, we set the threshold to <cite>np.inf</cite>. We pull out the
centroid as the standard.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qb</span> <span class="o">=</span> <a href="../../reference/dipy.segment.html#dipy.segment.clustering.QuickBundles" title="dipy.segment.clustering.QuickBundles" class="sphx-glr-backref-module-dipy-segment-clustering sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">QuickBundles</span></a><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>

<span class="n">cluster_cst_l</span> <span class="o">=</span> <span class="n">qb</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="n">model_cst_l</span><span class="p">)</span>
<span class="n">standard_cst_l</span> <span class="o">=</span> <span class="n">cluster_cst_l</span><span class="o">.</span><span class="n">centroids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">cluster_af_l</span> <span class="o">=</span> <span class="n">qb</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="n">model_af_l</span><span class="p">)</span>
<span class="n">standard_af_l</span> <span class="o">=</span> <span class="n">cluster_af_l</span><span class="o">.</span><span class="n">centroids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>We use the centroid streamline for each atlas bundle as the standard to orient
all of the streamlines in each bundle from the individual subject. Here, the
affine used is the one from the transform between the atlas and individual
tractogram. This is so that the orienting is done relative to the space of the
individual, and not relative to the atlas space.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oriented_cst_l</span> <span class="o">=</span> <a href="../../reference/dipy.tracking.html#dipy.tracking.streamline.orient_by_streamline" title="dipy.tracking.streamline.orient_by_streamline" class="sphx-glr-backref-module-dipy-tracking-streamline sphx-glr-backref-type-py-function"><span class="n">dts</span><span class="o">.</span><span class="n">orient_by_streamline</span></a><span class="p">(</span><span class="n">cst_l</span><span class="p">,</span> <span class="n">standard_cst_l</span><span class="p">)</span>
<span class="n">oriented_af_l</span> <span class="o">=</span> <a href="../../reference/dipy.tracking.html#dipy.tracking.streamline.orient_by_streamline" title="dipy.tracking.streamline.orient_by_streamline" class="sphx-glr-backref-module-dipy-tracking-streamline sphx-glr-backref-type-py-function"><span class="n">dts</span><span class="o">.</span><span class="n">orient_by_streamline</span></a><span class="p">(</span><span class="n">af_l</span><span class="p">,</span> <span class="n">standard_af_l</span><span class="p">)</span>
</pre></div>
</div>
<p>Read volumetric data from an image corresponding to this subject.</p>
<p>For the purpose of this, we’ve extracted only the FA within the bundles in
question, but in real use, this is where you would add the FA map of your
subject.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">files</span><span class="p">,</span> <span class="n">folder</span> <span class="o">=</span> <span class="n">dpd</span><span class="o">.</span><span class="n">fetch_bundle_fa_hcp</span><span class="p">()</span>

<span class="n">fa</span><span class="p">,</span> <span class="n">fa_affine</span> <span class="o">=</span> <a href="../../reference/dipy.io.html#dipy.io.image.load_nifti" title="dipy.io.image.load_nifti" class="sphx-glr-backref-module-dipy-io-image sphx-glr-backref-type-py-function"><span class="n">load_nifti</span></a><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;hcp_bundle_fa.nii.gz&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Calculate weights for each bundle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w_cst_l</span> <span class="o">=</span> <a href="../../reference/dipy.stats.html#dipy.stats.analysis.gaussian_weights" title="dipy.stats.analysis.gaussian_weights" class="sphx-glr-backref-module-dipy-stats-analysis sphx-glr-backref-type-py-function"><span class="n">dsa</span><span class="o">.</span><span class="n">gaussian_weights</span></a><span class="p">(</span><span class="n">oriented_cst_l</span><span class="p">)</span>
<span class="n">w_af_l</span> <span class="o">=</span> <a href="../../reference/dipy.stats.html#dipy.stats.analysis.gaussian_weights" title="dipy.stats.analysis.gaussian_weights" class="sphx-glr-backref-module-dipy-stats-analysis sphx-glr-backref-type-py-function"><span class="n">dsa</span><span class="o">.</span><span class="n">gaussian_weights</span></a><span class="p">(</span><span class="n">oriented_af_l</span><span class="p">)</span>
</pre></div>
</div>
<p>And then use the weights to calculate the tract profiles for each bundle</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">profile_cst_l</span> <span class="o">=</span> <a href="../../reference/dipy.stats.html#dipy.stats.analysis.afq_profile" title="dipy.stats.analysis.afq_profile" class="sphx-glr-backref-module-dipy-stats-analysis sphx-glr-backref-type-py-function"><span class="n">dsa</span><span class="o">.</span><span class="n">afq_profile</span></a><span class="p">(</span><span class="n">fa</span><span class="p">,</span> <span class="n">oriented_cst_l</span><span class="p">,</span> <span class="n">fa_affine</span><span class="p">,</span>
                                <span class="n">weights</span><span class="o">=</span><span class="n">w_cst_l</span><span class="p">)</span>

<span class="n">profile_af_l</span> <span class="o">=</span> <a href="../../reference/dipy.stats.html#dipy.stats.analysis.afq_profile" title="dipy.stats.analysis.afq_profile" class="sphx-glr-backref-module-dipy-stats-analysis sphx-glr-backref-type-py-function"><span class="n">dsa</span><span class="o">.</span><span class="n">afq_profile</span></a><span class="p">(</span><span class="n">fa</span><span class="p">,</span> <span class="n">oriented_af_l</span><span class="p">,</span> <span class="n">fa_affine</span><span class="p">,</span>
                               <span class="n">weights</span><span class="o">=</span><span class="n">w_af_l</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">profile_cst_l</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fractional anisotropy&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Node along CST&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">profile_af_l</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Node along AF&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;tract_profiles&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id3">
<img alt="auto_examples/streamline_analysis/tract_profiles.png" src="auto_examples/streamline_analysis/tract_profiles.png" />
<figcaption>
<p><span class="caption-text">Bundle profiles for the fractional anisotropy in the left CST (left) and
left AF (right).</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="yeatman2012" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Yeatman2012</a><span class="fn-bracket">]</span></span>
<p>Yeatman, Jason D., Robert F. Dougherty, Nathaniel J. Myall,
Brian A. Wandell, and Heidi M. Feldman. 2012. “Tract Profiles of White
Matter Properties: Automating Fiber-Tract Quantification” PloS One 7 (11):
e49790.</p>
</div>
<div class="citation" id="garyfallidis17" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Garyfallidis17<span class="fn-bracket">]</span></span>
<p>Garyfallidis et al. Recognition of white matter bundles
using local and global streamline-based registration and clustering,
Neuroimage, 2017.</p>
</div>
<div class="citation" id="garyfallidis12" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Garyfallidis12<span class="fn-bracket">]</span></span>
<p>Garyfallidis E. et al., QuickBundles a method for
tractography simplification, Frontiers in Neuroscience, vol 6, no 175, 2012.</p>
</div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.000 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-streamline-analysis-afq-tract-profiles-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e90b0c923a6c4bda757d3c640f2ba5af/afq_tract_profiles.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">afq_tract_profiles.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/09dee8cab5658c49b96cc8cf754747b0/afq_tract_profiles.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">afq_tract_profiles.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>

<div class="section ablog__blog_comments">
  
  
</div>

                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  
<script type="module" src="../../_static/scripts/grg-sphinx-theme.js"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2008-2023, dipy developers &lt;neuroimaging@python.org&gt;.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

    <div class="copyright-text">
      <i class="fa-regular fa-copyright"></i> 
    </div>
  </footer>
  </body>
</html>