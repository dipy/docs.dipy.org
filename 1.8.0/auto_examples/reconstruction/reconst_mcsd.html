
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>DIPY &#8212; dipy 1.8.0dev0 documentation</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/dipy.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

  
<link rel="stylesheet" href="../../_static/styles/grg-sphinx-theme.css"/>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/reconstruction/reconst_mcsd';</script>
    <link rel="icon" href="../../_static/dipy-favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="keywords" content="DIPY, dMRI, DTI, DSI, diffusion MRI, Tensor,
  neuroimaging, python, neuroscience, Eleftherios, Garyfallidis, tractography,
  streamlines, fiber tracking">

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/dipy-logo.png" class="logo__image only-light" alt="DIPY"/>
    <script>document.write(`<img src="../../_static/dipy-logo.png" class="logo__image only-dark" alt="DIPY"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org">
            Quick Start
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org/tutorials">
            Tutorials
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org/recipes">
            Recipes
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org/cli">
            CLI / Workflows
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org/reference">
            API
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org/cli/reference">
            CLI API
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../../blog.html">
          Blog
        </a>
      </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

      <li class="nav-item">
        <a class="nav-link" href="../../https%3A//app.gitter.im/%23/room/%2523dipy_dipy%3Agitter.im.html">
          Live Chat (Gitter)
        </a>
      </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../../team.html">
          Team
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../releases.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter/X</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-youtube"></i></span>
            <label class="sr-only">YouTube</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin"></i></span>
            <label class="sr-only">LinkedIn</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

</nav>
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org">
            Quick Start
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org/tutorials">
            Tutorials
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org/recipes">
            Recipes
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org/cli">
            CLI / Workflows
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org/reference">
            API
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://docs.dipy.org/cli/reference">
            CLI API
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../../blog.html">
          Blog
        </a>
      </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

      <li class="nav-item">
        <a class="nav-link" href="../../https%3A//app.gitter.im/%23/room/%2523dipy_dipy%3Agitter.im.html">
          Live Chat (Gitter)
        </a>
      </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../../team.html">
          Team
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../releases.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter/X</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-youtube"></i></span>
            <label class="sr-only">YouTube</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin"></i></span>
            <label class="sr-only">LinkedIn</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="reconst_qtiplus.html">Applying positivity constraints to Q-space Trajectory Imaging (QTI+)</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_shore.html">Continuous and analytical diffusion signal modelling with 3D-SHORE</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_dsi.html">Reconstruct with Diffusion Spectrum Imaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_dsid.html">DSI Deconvolution vs DSI</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_shore_metrics.html">Calculate SHORE scalar maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_gqi.html">Reconstruct with Generalized Q-Sampling Imaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_csa.html">Reconstruct with Constant Solid Angle (Q-Ball)</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_sfm.html">Reconstruction with the Sparse Fascicle Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_dsi_metrics.html">Calculate DSI-based scalar maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_dki.html">Reconstruction of the diffusion signal with the kurtosis tensor model</a></li>
<li class="toctree-l1"><a class="reference internal" href="kfold_xval.html">K-fold cross-validation for model comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_qti.html">Reconstruct with Q-space Trajectory Imaging (QTI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_dti.html">Reconstruction of the diffusion signal with the Tensor model</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_forecast.html">Crossing invariant fiber response function with FORECAST model</a></li>
<li class="toctree-l1"><a class="reference internal" href="restore_dti.html">Using the RESTORE algorithm for robust tensor fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="histology_resdnn.html">Local reconstruction using the Histological ResDNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_dki_micro.html">Reconstruction of the diffusion signal with the WMTI model</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_sh.html">Signal Reconstruction Using Spherical Harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_fwdti.html">Using the free water elimination model to remove DTI free water contamination</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_ivim.html">Intravoxel incoherent motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_csd.html">Reconstruction with Constrained Spherical Deconvolution</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Reconstruction with Multi-Shell Multi-Tissue CSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_mapmri.html">Continuous and analytical diffusion signal modelling with MAP-MRI</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_msdki.html">Mean signal diffusion kurtosis imaging (MSDKI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_rumba.html">Reconstruction with Robust and Unbiased Model-BAsed Spherical Deconvolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconst_qtdmri.html">Estimating diffusion time dependent q-space indices using qt-dMRI</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">DIPY</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-reconstruction-reconst-mcsd-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="reconstruction-with-multi-shell-multi-tissue-csd">
<span id="reconst-mcsd"></span><span id="sphx-glr-auto-examples-reconstruction-reconst-mcsd-py"></span><h1>Reconstruction with Multi-Shell Multi-Tissue CSD<a class="headerlink" href="#reconstruction-with-multi-shell-multi-tissue-csd" title="Permalink to this heading">#</a></h1>
<p>This example shows how to use Multi-Shell Multi-Tissue Constrained Spherical
Deconvolution (MSMT-CSD) introduced by Tournier et al. <a class="reference internal" href="#jeurissen2014" id="id1"><span>[Jeurissen2014]</span></a>. This
tutorial goes through the steps involved in implementing the method.</p>
<p>This method provides improved White Matter(WM), Grey Matter (GM), and
Cerebrospinal fluid (CSF) volume fraction maps, which is otherwise
overestimated in the standard CSD (SSST-CSD). This is done by using b-value
dependencies of the different tissue types to estimate ODFs. This method thus
extends the SSST-CSD introduced in <a class="reference internal" href="#tournier2007" id="id2"><span>[Tournier2007]</span></a>.</p>
<p>The reconstruction of the fiber orientation distribution function
(fODF) in MSMT-CSD involves the following steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Generate a mask using Median Otsu (optional step)</p></li>
<li><p>Denoise the data using MP-PCA (optional step)</p></li>
<li><p>Generate  Anisotropic Powermap (if T1 unavailable)</p></li>
<li><p>Fit DTI model to the data</p></li>
<li><p>Tissue Classification (needs to be at least two classes of tissues)</p></li>
<li><p>Estimation of the fiber response function</p></li>
<li><p>Use the response function to reconstruct the fODF</p></li>
</ol>
</div></blockquote>
<p>First, we import all the modules we need from dipy as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">dipy.reconst.shm</span> <span class="k">as</span> <span class="nn">shm</span>
<span class="kn">import</span> <span class="nn">dipy.direction.peaks</span> <span class="k">as</span> <span class="nn">dp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">dipy.denoise.localpca</span> <span class="kn">import</span> <a href="../../reference/dipy.denoise.html#dipy.denoise.localpca.mppca" title="dipy.denoise.localpca.mppca" class="sphx-glr-backref-module-dipy-denoise-localpca sphx-glr-backref-type-py-function"><span class="n">mppca</span></a>
<span class="kn">from</span> <span class="nn">dipy.core.gradients</span> <span class="kn">import</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.gradient_table" title="dipy.core.gradients.gradient_table" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-function"><span class="n">gradient_table</span></a><span class="p">,</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.unique_bvals_tolerance" title="dipy.core.gradients.unique_bvals_tolerance" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-function"><span class="n">unique_bvals_tolerance</span></a>
<span class="kn">from</span> <span class="nn">dipy.io.gradients</span> <span class="kn">import</span> <span class="n">read_bvals_bvecs</span>
<span class="kn">from</span> <span class="nn">dipy.io.image</span> <span class="kn">import</span> <a href="../../reference/dipy.io.html#dipy.io.image.load_nifti" title="dipy.io.image.load_nifti" class="sphx-glr-backref-module-dipy-io-image sphx-glr-backref-type-py-function"><span class="n">load_nifti</span></a>
<span class="kn">from</span> <span class="nn">dipy.segment.mask</span> <span class="kn">import</span> <a href="../../reference/dipy.segment.html#dipy.segment.mask.median_otsu" title="dipy.segment.mask.median_otsu" class="sphx-glr-backref-module-dipy-segment-mask sphx-glr-backref-type-py-function"><span class="n">median_otsu</span></a>
<span class="kn">from</span> <span class="nn">dipy.reconst.mcsd</span> <span class="kn">import</span> <span class="p">(</span><a href="../../reference/dipy.reconst.html#dipy.reconst.mcsd.auto_response_msmt" title="dipy.reconst.mcsd.auto_response_msmt" class="sphx-glr-backref-module-dipy-reconst-mcsd sphx-glr-backref-type-py-function"><span class="n">auto_response_msmt</span></a><span class="p">,</span>
                               <a href="../../reference/dipy.reconst.html#dipy.reconst.mcsd.mask_for_response_msmt" title="dipy.reconst.mcsd.mask_for_response_msmt" class="sphx-glr-backref-module-dipy-reconst-mcsd sphx-glr-backref-type-py-function"><span class="n">mask_for_response_msmt</span></a><span class="p">,</span>
                               <a href="../../reference/dipy.reconst.html#dipy.reconst.mcsd.response_from_mask_msmt" title="dipy.reconst.mcsd.response_from_mask_msmt" class="sphx-glr-backref-module-dipy-reconst-mcsd sphx-glr-backref-type-py-function"><span class="n">response_from_mask_msmt</span></a><span class="p">)</span>
<span class="kn">from</span> <span class="nn">dipy.segment.tissue</span> <span class="kn">import</span> <a href="../../reference/dipy.segment.html#dipy.segment.tissue.TissueClassifierHMRF" title="dipy.segment.tissue.TissueClassifierHMRF" class="sphx-glr-backref-module-dipy-segment-tissue sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">TissueClassifierHMRF</span></a>
<span class="kn">from</span> <span class="nn">dipy.reconst.mcsd</span> <span class="kn">import</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mcsd.MultiShellDeconvModel" title="dipy.reconst.mcsd.MultiShellDeconvModel" class="sphx-glr-backref-module-dipy-reconst-mcsd sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">MultiShellDeconvModel</span></a><span class="p">,</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mcsd.multi_shell_fiber_response" title="dipy.reconst.mcsd.multi_shell_fiber_response" class="sphx-glr-backref-module-dipy-reconst-mcsd sphx-glr-backref-type-py-function"><span class="n">multi_shell_fiber_response</span></a>
<span class="kn">from</span> <span class="nn">dipy.viz</span> <span class="kn">import</span> <span class="n">window</span><span class="p">,</span> <span class="n">actor</span>

<span class="kn">from</span> <span class="nn">dipy.data</span> <span class="kn">import</span> <a href="../../reference/dipy.data.html#dipy.data.get_sphere" title="dipy.data.get_sphere" class="sphx-glr-backref-module-dipy-data sphx-glr-backref-type-py-function"><span class="n">get_sphere</span></a><span class="p">,</span> <span class="n">get_fnames</span>
<span class="n">sphere</span> <span class="o">=</span> <a href="../../reference/dipy.data.html#dipy.data.get_sphere" title="dipy.data.get_sphere" class="sphx-glr-backref-module-dipy-data sphx-glr-backref-type-py-function"><span class="n">get_sphere</span></a><span class="p">(</span><span class="s1">&#39;symmetric724&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For this example, we use fetch to download a multi-shell dataset which was
kindly provided by Hansen and Jespersen (more details about the data are
provided in their paper <a class="reference internal" href="../../interfaces/basic_flow.html#hansen2016" id="id3"><span>[Hansen2016]</span></a>). The total size of the downloaded data
is 192 MBytes, however you only need to fetch it once.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fraw</span><span class="p">,</span> <span class="n">fbval</span><span class="p">,</span> <span class="n">fbvec</span><span class="p">,</span> <span class="n">t1_fname</span> <span class="o">=</span> <span class="n">get_fnames</span><span class="p">(</span><span class="s1">&#39;cfin_multib&#39;</span><span class="p">)</span>

<span class="n">data</span><span class="p">,</span> <span class="n">affine</span> <span class="o">=</span> <a href="../../reference/dipy.io.html#dipy.io.image.load_nifti" title="dipy.io.image.load_nifti" class="sphx-glr-backref-module-dipy-io-image sphx-glr-backref-type-py-function"><span class="n">load_nifti</span></a><span class="p">(</span><span class="n">fraw</span><span class="p">)</span>
<span class="n">bvals</span><span class="p">,</span> <span class="n">bvecs</span> <span class="o">=</span> <span class="n">read_bvals_bvecs</span><span class="p">(</span><span class="n">fbval</span><span class="p">,</span> <span class="n">fbvec</span><span class="p">)</span>
<span class="n">gtab</span> <span class="o">=</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.gradient_table" title="dipy.core.gradients.gradient_table" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-function"><span class="n">gradient_table</span></a><span class="p">(</span><span class="n">bvals</span><span class="p">,</span> <span class="n">bvecs</span><span class="p">)</span>
</pre></div>
</div>
<p>For the sake of simplicity, we only select two non-zero b-values for this
example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bvals</span> <span class="o">=</span> <span class="n">gtab</span><span class="o">.</span><span class="n">bvals</span>
<span class="n">bvecs</span> <span class="o">=</span> <span class="n">gtab</span><span class="o">.</span><span class="n">bvecs</span>

<span class="n">sel_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">bvals</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bvals</span> <span class="o">==</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">bvals</span> <span class="o">==</span> <span class="mi">2000</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">sel_b</span><span class="p">]</span>
</pre></div>
</div>
<p>The gradient table is also selected to have the selected b-values (0, 1000 and
2000)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gtab</span> <span class="o">=</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.gradient_table" title="dipy.core.gradients.gradient_table" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-function"><span class="n">gradient_table</span></a><span class="p">(</span><span class="n">bvals</span><span class="p">[</span><span class="n">sel_b</span><span class="p">],</span> <span class="n">bvecs</span><span class="p">[</span><span class="n">sel_b</span><span class="p">])</span>
</pre></div>
</div>
<p>We make use of the <code class="docutils literal notranslate"><span class="pre">median_otsu</span></code> method to generate the mask for the data as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b0_mask</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <a href="../../reference/dipy.segment.html#dipy.segment.mask.median_otsu" title="dipy.segment.mask.median_otsu" class="sphx-glr-backref-module-dipy-segment-mask sphx-glr-backref-type-py-function"><span class="n">median_otsu</span></a><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">median_radius</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">numpass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vol_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>


<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>As one can see from its shape, the selected data contains a total of 67
volumes of images corresponding to all the diffusion gradient directions
of the selected b-values and call the <code class="docutils literal notranslate"><span class="pre">mppca</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">denoised_arr</span> <span class="o">=</span> <a href="../../reference/dipy.denoise.html#dipy.denoise.localpca.mppca" title="dipy.denoise.localpca.mppca" class="sphx-glr-backref-module-dipy-denoise-localpca sphx-glr-backref-type-py-function"><span class="n">mppca</span></a><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">patch_radius</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we will use the denoised array (<code class="docutils literal notranslate"><span class="pre">denoised_arr</span></code>) obtained from <code class="docutils literal notranslate"><span class="pre">mppca</span></code>
in the rest of the steps in the tutorial.</p>
<p>As for the next step, we generate the anisotropic powermap introduced by
<a class="reference internal" href="#dellacqua2014" id="id4"><span>[DellAcqua2014]</span></a>. To do so, we make use of the Q-ball Model as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qball_model</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.shm.QballModel" title="dipy.reconst.shm.QballModel" class="sphx-glr-backref-module-dipy-reconst-shm sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">shm</span><span class="o">.</span><span class="n">QballModel</span></a><span class="p">(</span><span class="n">gtab</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<p>We generate the peaks from the <code class="docutils literal notranslate"><span class="pre">qball_model</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peaks</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">peaks_from_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">qball_model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">denoised_arr</span><span class="p">,</span>
                            <span class="n">relative_peak_threshold</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
                            <span class="n">min_separation_angle</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                            <span class="n">sphere</span><span class="o">=</span><span class="n">sphere</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>

<span class="n">ap</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.shm.anisotropic_power" title="dipy.reconst.shm.anisotropic_power" class="sphx-glr-backref-module-dipy-reconst-shm sphx-glr-backref-type-py-function"><span class="n">shm</span><span class="o">.</span><span class="n">anisotropic_power</span></a><span class="p">(</span><span class="n">peaks</span><span class="o">.</span><span class="n">shm_coeff</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">ap</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">10</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">bone</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;anisotropic_power_map.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id6">
<img alt="auto_examples/reconstruction/anisotropic_power_map.png" src="auto_examples/reconstruction/anisotropic_power_map.png" />
<figcaption>
<p><span class="caption-text">Anisotropic Power Map (Axial Slice)</span><a class="headerlink" href="#id6" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>The above figure is a visualization of the axial slice of the Anisotropic
Power Map. It can be treated as a pseudo-T1 for classification purposes
using the Hidden Markov Random Fields (HMRF) classifier, if the T1 image
is not available.</p>
<p>As we can see from the shape of the Anisotropic Power Map, it is 3D and can be
used for tissue classification using HMRF. The
HMRF needs the specification of the number of classes. For the case of MSMT-CSD
the <code class="docutils literal notranslate"><span class="pre">nclass</span></code> parameter needs to be <code class="docutils literal notranslate"><span class="pre">&gt;=2</span></code>. In our case, we set it to 3:
namely corticospinal fluid (csf), white matter (wm) and gray matter (gm).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nclass</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
<p>Then, the smoothness factor of the segmentation. Good performance is achieved
with values between 0 and 0.5.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
<p>We then call the <code class="docutils literal notranslate"><span class="pre">TissueClassifierHMRF</span></code> with the parameters specified as
above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hmrf</span> <span class="o">=</span> <a href="../../reference/dipy.segment.html#dipy.segment.tissue.TissueClassifierHMRF" title="dipy.segment.tissue.TissueClassifierHMRF" class="sphx-glr-backref-module-dipy-segment-tissue sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">TissueClassifierHMRF</span></a><span class="p">()</span>
<span class="n">initial_segmentation</span><span class="p">,</span> <span class="n">final_segmentation</span><span class="p">,</span> <span class="n">PVE</span> <span class="o">=</span> <span class="n">hmrf</span><span class="o">.</span><span class="n">classify</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">nclass</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, we get the tissues segmentation from the final_segmentation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">csf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">final_segmentation</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">gm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">final_segmentation</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">wm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">final_segmentation</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we want the response function for each of the three tissues and for each
bvalues. This can be achieved in two different ways. If the case that tissue
segmentation is available or that one wants to see the tissue masks used to
compute the response functions, a combination of the functions
<code class="docutils literal notranslate"><span class="pre">mask_for_response_msmt</span></code> and <code class="docutils literal notranslate"><span class="pre">response_from_mask</span></code> is needed.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">mask_for_response_msmt</span></code> function will return a mask of voxels within a
cuboid ROI and that meet some threshold constraints, for each tissue and bvalue.
More precisely, the WM mask must have a FA value above a given threshold. The GM
mask and CSF mask must have a FA below given thresholds and a MD below other
thresholds.</p>
<p>Note that for <code class="docutils literal notranslate"><span class="pre">mask_for_response_msmt</span></code>, the gtab and data should be for
bvalues under 1200, for optimal tensor fit.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mask_wm</span><span class="p">,</span> <span class="n">mask_gm</span><span class="p">,</span> <span class="n">mask_csf</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mcsd.mask_for_response_msmt" title="dipy.reconst.mcsd.mask_for_response_msmt" class="sphx-glr-backref-module-dipy-reconst-mcsd sphx-glr-backref-type-py-function"><span class="n">mask_for_response_msmt</span></a><span class="p">(</span><span class="n">gtab</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">roi_radii</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                                    <span class="n">wm_fa_thr</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                    <span class="n">gm_fa_thr</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                                                    <span class="n">csf_fa_thr</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
                                                    <span class="n">gm_md_thr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
                                                    <span class="n">csf_md_thr</span><span class="o">=</span><span class="mf">0.0032</span><span class="p">)</span>
</pre></div>
</div>
<p>If one wants to use the previously computed tissue segmentation in addition to
the threshold method, it is possible by simply multiplying both masks together.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mask_wm</span> <span class="o">*=</span> <span class="n">wm</span>
<span class="n">mask_gm</span> <span class="o">*=</span> <span class="n">gm</span>
<span class="n">mask_csf</span> <span class="o">*=</span> <span class="n">csf</span>
</pre></div>
</div>
<p>The masks can also be used to calculate the number of voxels for each tissue.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nvoxels_wm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask_wm</span><span class="p">)</span>
<span class="n">nvoxels_gm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask_gm</span><span class="p">)</span>
<span class="n">nvoxels_csf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask_csf</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">nvoxels_wm</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, the <code class="docutils literal notranslate"><span class="pre">response_from_mask</span></code> function will return the msmt response
functions using precalculated tissue masks.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">response_wm</span><span class="p">,</span> <span class="n">response_gm</span><span class="p">,</span> <span class="n">response_csf</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mcsd.response_from_mask_msmt" title="dipy.reconst.mcsd.response_from_mask_msmt" class="sphx-glr-backref-module-dipy-reconst-mcsd sphx-glr-backref-type-py-function"><span class="n">response_from_mask_msmt</span></a><span class="p">(</span><span class="n">gtab</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
                                                                 <span class="n">mask_wm</span><span class="p">,</span>
                                                                 <span class="n">mask_gm</span><span class="p">,</span>
                                                                 <span class="n">mask_csf</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that we can also get directly the response functions by calling the
<code class="docutils literal notranslate"><span class="pre">auto_response_msmt</span></code> function, which internally calls
<code class="docutils literal notranslate"><span class="pre">mask_for_response_msmt</span></code> followed by <code class="docutils literal notranslate"><span class="pre">response_from_mask</span></code>. By doing so, we
don’t have access to the masks and we might have problems with high bvalues
tensor fit.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auto_response_wm</span><span class="p">,</span> <span class="n">auto_response_gm</span><span class="p">,</span> <span class="n">auto_response_csf</span> <span class="o">=</span> \
    <a href="../../reference/dipy.reconst.html#dipy.reconst.mcsd.auto_response_msmt" title="dipy.reconst.mcsd.auto_response_msmt" class="sphx-glr-backref-module-dipy-reconst-mcsd sphx-glr-backref-type-py-function"><span class="n">auto_response_msmt</span></a><span class="p">(</span><span class="n">gtab</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">roi_radii</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>As we can see below, adding the tissue segmentation can change the results
of the response functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Responses&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response_wm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response_gm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response_csf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Auto responses&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">auto_response_wm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">auto_response_gm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">auto_response_csf</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point, there are two options on how to use those response functions. We
want to create a MultiShellDeconvModel, which takes a response function as
input. This response function can either be directly in the current format, or
it can be a MultiShellResponse format, as produced by the
<code class="docutils literal notranslate"><span class="pre">multi_shell_fiber_response</span></code> method. This function assumes a 3 compartments
model (wm, gm, csf) and takes one response function per tissue per bvalue. It is
important to note that the bvalues must be unique for this function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ubvals</span> <span class="o">=</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.unique_bvals_tolerance" title="dipy.core.gradients.unique_bvals_tolerance" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-function"><span class="n">unique_bvals_tolerance</span></a><span class="p">(</span><span class="n">gtab</span><span class="o">.</span><span class="n">bvals</span><span class="p">)</span>
<span class="n">response_mcsd</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mcsd.multi_shell_fiber_response" title="dipy.reconst.mcsd.multi_shell_fiber_response" class="sphx-glr-backref-module-dipy-reconst-mcsd sphx-glr-backref-type-py-function"><span class="n">multi_shell_fiber_response</span></a><span class="p">(</span><span class="n">sh_order</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                           <span class="n">bvals</span><span class="o">=</span><span class="n">ubvals</span><span class="p">,</span>
                                           <span class="n">wm_rf</span><span class="o">=</span><span class="n">response_wm</span><span class="p">,</span>
                                           <span class="n">gm_rf</span><span class="o">=</span><span class="n">response_gm</span><span class="p">,</span>
                                           <span class="n">csf_rf</span><span class="o">=</span><span class="n">response_csf</span><span class="p">)</span>
</pre></div>
</div>
<p>As mentioned, we can also build the model directly and it will call
<code class="docutils literal notranslate"><span class="pre">multi_shell_fiber_response</span></code> internally. Important note here, the function
<code class="docutils literal notranslate"><span class="pre">unique_bvals_tolerance</span></code> is used to keep only unique bvalues from the gtab
given to the model, as input for <code class="docutils literal notranslate"><span class="pre">multi_shell_fiber_response</span></code>. This may
introduce differences between the calculated response of each method, depending
on the bvalues given to <code class="docutils literal notranslate"><span class="pre">multi_shell_fiber_response</span></code> externally.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">response_wm</span><span class="p">,</span> <span class="n">response_gm</span><span class="p">,</span> <span class="n">response_csf</span><span class="p">])</span>
<span class="n">mcsd_model_simple_response</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mcsd.MultiShellDeconvModel" title="dipy.reconst.mcsd.MultiShellDeconvModel" class="sphx-glr-backref-module-dipy-reconst-mcsd sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">MultiShellDeconvModel</span></a><span class="p">(</span><span class="n">gtab</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">sh_order</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this technique only works for a 3 compartments model (wm, gm, csf). If
one wants more compartments, a custom MultiShellResponse object must be used. It
can be inspired by the <code class="docutils literal notranslate"><span class="pre">multi_shell_fiber_response</span></code> method.</p>
<p>Now we build the MSMT-CSD model with the <code class="docutils literal notranslate"><span class="pre">response_mcsd</span></code> as input. We then
call the <code class="docutils literal notranslate"><span class="pre">fit</span></code> function to fit one slice of the 3D data and visualize it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mcsd_model</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mcsd.MultiShellDeconvModel" title="dipy.reconst.mcsd.MultiShellDeconvModel" class="sphx-glr-backref-module-dipy-reconst-mcsd sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">MultiShellDeconvModel</span></a><span class="p">(</span><span class="n">gtab</span><span class="p">,</span> <span class="n">response_mcsd</span><span class="p">)</span>
<span class="n">mcsd_fit</span> <span class="o">=</span> <span class="n">mcsd_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">denoised_arr</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">11</span><span class="p">])</span>
</pre></div>
</div>
<p>The volume fractions of tissues for each voxel are also accessible, as well as
the sh coefficients for all tissues. One can also get each sh tissue separately
using <code class="docutils literal notranslate"><span class="pre">all_shm_coeff</span></code> for each compartment (isotropic) and
<code class="docutils literal notranslate"><span class="pre">shm_coeff</span></code> for white matter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vf</span> <span class="o">=</span> <span class="n">mcsd_fit</span><span class="o">.</span><span class="n">volume_fractions</span>
<span class="n">sh_coeff</span> <span class="o">=</span> <span class="n">mcsd_fit</span><span class="o">.</span><span class="n">all_shm_coeff</span>
<span class="n">csf_sh_coeff</span> <span class="o">=</span> <span class="n">sh_coeff</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">gm_sh_coeff</span> <span class="o">=</span> <span class="n">sh_coeff</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">wm_sh_coeff</span> <span class="o">=</span> <span class="n">mcsd_fit</span><span class="o">.</span><span class="n">shm_coeff</span>
</pre></div>
</div>
<p>The model allows to predict a signal from sh coefficients. There are two ways of
doing this.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mcsd_pred</span> <span class="o">=</span> <span class="n">mcsd_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="n">mcsd_pred</span> <span class="o">=</span> <span class="n">mcsd_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">mcsd_fit</span><span class="o">.</span><span class="n">all_shm_coeff</span><span class="p">)</span>
</pre></div>
</div>
<p>From the fit obtained in the previous step, we generate the ODFs which can be
visualized as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mcsd_odf</span> <span class="o">=</span> <span class="n">mcsd_fit</span><span class="o">.</span><span class="n">odf</span><span class="p">(</span><span class="n">sphere</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ODF&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mcsd_odf</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mcsd_odf</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">fodf_spheres</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">odf_slicer</span><span class="p">(</span><span class="n">mcsd_odf</span><span class="p">,</span> <span class="n">sphere</span><span class="o">=</span><span class="n">sphere</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">)</span>

<span class="n">interactive</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">scene</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">Scene</span><span class="p">()</span>
<span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fodf_spheres</span><span class="p">)</span>
<span class="n">scene</span><span class="o">.</span><span class="n">reset_camera_tight</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saving illustration as msdodf.png&#39;</span><span class="p">)</span>
<span class="n">window</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">scene</span><span class="p">,</span> <span class="n">out_path</span><span class="o">=</span><span class="s1">&#39;msdodf.png&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span>

<span class="k">if</span> <span class="n">interactive</span><span class="p">:</span>
    <span class="n">window</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id7">
<img alt="auto_examples/reconstruction/msdodf.png" src="auto_examples/reconstruction/msdodf.png" />
<figcaption>
<p><span class="caption-text">MSMT-CSD Peaks and ODFs.</span><a class="headerlink" href="#id7" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="jeurissen2014" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Jeurissen2014</a><span class="fn-bracket">]</span></span>
<p>B. Jeurissen, et al., “Multi-tissue constrained spherical
deconvolution for improved analysis of multi-shell
diffusion MRI data.” NeuroImage 103 (2014): 411-426.</p>
</div>
<div class="citation" id="tournier2007" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">Tournier2007</a><span class="fn-bracket">]</span></span>
<p>J-D. Tournier, F. Calamante and A. Connelly, “Robust
determination of the fibre orientation distribution in
diffusion MRI: Non-negativity constrained super-resolved
spherical deconvolution”, Neuroimage, vol. 35, no. 4,
pp. 1459-1472, (2007).</p>
</div>
<div class="citation" id="hansen2016" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">Hansen2016</a><span class="fn-bracket">]</span></span>
<p>B. Hansen and SN. Jespersen, “ Data for evaluation of fast
kurtosis strategies, b-value optimization and exploration
of diffusion MRI contrast”, Scientific Data 3: 160072
doi:10.1038/sdata.2016.72, (2016)</p>
</div>
<div class="citation" id="dellacqua2014" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">DellAcqua2014</a><span class="fn-bracket">]</span></span>
<p>F. Dell’Acqua, et. al., “Anisotropic Power Maps: A
diffusion contrast to reveal low anisotropy tissues from
HARDI data”, Proceedings of International Society for
Magnetic Resonance in Medicine. Milan, Italy, (2014).</p>
</div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 0.000 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-reconstruction-reconst-mcsd-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/81b2ea8dd0065cdd67a9d1e1cf68c325/reconst_mcsd.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">reconst_mcsd.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a3e00fc6eabbe6d2d1a1e18fe1ba7dad/reconst_mcsd.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">reconst_mcsd.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  
<script type="module" src="../../_static/scripts/grg-sphinx-theme.js"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><div>
  <h3 class="footer-heading">
    Never miss an update from us!
  </h3>
  <p class="footer-sub-heading">
    Don't worry! we are not going to spam you.
  </p>
  <div class="input-group mb-3 mar-t-10">
    <input type="text" class="form-control" placeholder="You email" aria-label="You email">
    <div class="input-group-append">
      <span class="input-group-text subscribe">Subscribe</span>
    </div>
  </div>  
  <ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-twitter"></i></span>
            <label class="sr-only">Twitter/X</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-youtube"></i></span>
            <label class="sr-only">YouTube</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin"></i></span>
            <label class="sr-only">LinkedIn</label></a>
        </li>
</ul>
</div></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="grid-3">
  
  <div>
    <h5 class="footer-heading">
      About
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="../../team.html">
            Developers
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../https%3A//github.com/dipy/dipy/discussions.html">
            Support
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../installation.html">
            Download
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../https%3A//dipy.org/contributors/.html">
            Get Started
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../https%3A//docs.dipy.org/tutorials/.html">
            Tutorials
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../https%3A//www.youtube.com/c/diffusionimaginginpython.html">
            Videos
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Friends
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="../../http%3A//nipy.org/.html">
            Nipy Projects
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../http%3A//fury.gl/.html">
            FURY
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../http%3A//nipy.org/nibabel.html">
            Nibabel
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../https%3A//tortoise.nibib.nih.gov/.html">
            Tortoise
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Support
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="../../https%3A//engineering.indiana.edu/.html">
            The department of Intelligent Systems Engineering of Indiana University
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../https%3A//www.nibib.nih.gov/.html">
            The National Institute of Biomedical Imaging and Bioengineering, NIH
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../https%3A//escience.washington.edu/tag/alfred-p-sloan-foundation/.html">
            The Gordon and Betty Moore Foundation and the Alfred P. Sloan Foundation, through the University of Washington eScience Institute Data Science Environment
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../https%3A//summerofcode.withgoogle.com/.html">
            Google supported DIPY through the Google Summer of Code Program during Summer 2015, 2016, 2018
          </a>
        </li>
        
      
    </ul>
  </div>
  
</div></div>
      
    </div>
  
</div>

    <div class="copyright-text">
      <i class="fa-regular fa-copyright"></i> Copyright 2008-2023, DIPY developers. Created using Grg Sphinx Theme and PyData Sphinx Theme.
    </div>
  </footer>
  </body>
</html>