
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DIPY &#8212; dipy 1.10.0 documentation</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/css/dipy.css?v=cedb193d" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

  
<link rel="stylesheet" href="../_static/styles/grg-sphinx-theme.css"/>

    <script src="../_static/documentation_options.js?v=1d24b1d9"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D610GKJZRC"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/dipy.nn';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.dipy.org/dev/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.10.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="icon" href="../_static/dipy-favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="reconst" href="dipy.reconst.html" />
    <link rel="prev" title="io" href="dipy.io.html" />
  <meta name="keywords" content="DIPY, dMRI, DTI, DSI, diffusion MRI, Tensor,
  neuroimaging, python, neuroscience, Eleftherios, Garyfallidis, tractography,
  streamlines, fiber tracking">

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
     
  

<a class="navbar-brand logo" href="https://dipy.org">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/dipy-logo.png" class="logo__image only-light" alt="DIPY"/>
    <script>document.write(`<img src="../_static/dipy-logo.png" class="logo__image only-dark" alt="DIPY"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../examples_built/index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

</nav>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../examples_built/index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dipy.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dipy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.align.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">align</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.core.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">core</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.data.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">data</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.denoise.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">denoise</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.direction.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">direction</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.io.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">io</span></code></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nn</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.reconst.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">reconst</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.segment.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">segment</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.sims.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sims</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.stats.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stats</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.tracking.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tracking</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.viz.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">viz</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="dipy.workflows.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">workflows</span></code></a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">DIPY</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-dipy.nn">
<span id="nn"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">nn</span></code><a class="headerlink" href="#module-dipy.nn" title="Link to this heading">#</a></h1>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
<section id="module-dipy.nn.tf">
<span id="module-nn-tf"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf</span></code><a class="headerlink" href="#module-dipy.nn.tf" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.nn.tf.cnn_1d_denoising">
<span id="module-nn-tf-cnn-1d-denoising"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.cnn_1d_denoising</span></code><a class="headerlink" href="#module-dipy.nn.tf.cnn_1d_denoising" title="Link to this heading">#</a></h2>
<section id="title-denoising-diffusion-weighted-imaging-data-using-cnn">
<h3>Title : Denoising diffusion weighted imaging data using CNN<a class="headerlink" href="#title-denoising-diffusion-weighted-imaging-data-using-cnn" title="Link to this heading">#</a></h3>
<p>Obtaining tissue microstructure measurements from diffusion weighted imaging
(DWI) with multiple, high b-values is crucial. However, the high noise levels
present in these images can adversely affect the accuracy of the
microstructural measurements. In this context, we suggest a straightforward
denoising technique <a class="footnote-reference brackets" href="#footcite-cheng2022" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> that can be applied to any DWI
dataset as long as a low-noise, single-subject dataset is obtained using the
same DWI sequence.</p>
<p>We created a simple 1D-CNN model with five layers, based on the 1D CNN for
denoising speech. The model consists of two convolutional layers followed by
max-pooling layers, and a dense layer. The first convolutional layer has
16 one-dimensional filters of size 16, and the second layer has 32 filters of
size 8. ReLu activation function is applied to both convolutional layers.
The max-pooling layer has a kernel size of 2 and a stride of 2.
The dense layer maps the features extracted from the noisy image to the
low-noise reference image.</p>
<section id="reference">
<h4>Reference<a class="headerlink" href="#reference" title="Link to this heading">#</a></h4>
<div class="docutils container" id="id2">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-cheng2022" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Hu Cheng, Sophia Vinci-Booher, Jian Wang, Bradley Caron, Qiuting Wen, Sharlene Newman, and Franco Pestilli. Denoising diffusion weighted imaging data using convolutional neural networks. <em>PLOS ONE</em>, 17(9):1–24, September 2022. URL: <a class="reference external" href="https://doi.org/10.1371/journal.pone.0274396">https://doi.org/10.1371/journal.pone.0274396</a>, <a class="reference external" href="https://doi.org/10.1371/journal.pone.0274396">doi:10.1371/journal.pone.0274396</a>.</p>
</aside>
</aside>
</div>
</section>
</section>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser" title="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cnn1DDenoiser</span></code></a>(sig_length, *[, optimizer, ...])</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.nn.tf.deepn4">
<span id="module-nn-tf-deepn4"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.deepn4</span></code><a class="headerlink" href="#module-dipy.nn.tf.deepn4" title="Link to this heading">#</a></h2>
<p>Class and helper functions for fitting the DeepN4 model.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.deepn4.EncoderBlock" title="dipy.nn.tf.deepn4.EncoderBlock"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EncoderBlock</span></code></a>(*args, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.deepn4.DecoderBlock" title="dipy.nn.tf.deepn4.DecoderBlock"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DecoderBlock</span></code></a>(*args, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.deepn4.DeepN4" title="dipy.nn.tf.deepn4.DeepN4"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeepN4</span></code></a>(*[, verbose])</p></td>
<td><p>This class is intended for the DeepN4 model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.deepn4.UNet3D" title="dipy.nn.tf.deepn4.UNet3D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UNet3D</span></code></a>(input_shape)</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.nn.tf.evac">
<span id="module-nn-tf-evac"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.evac</span></code><a class="headerlink" href="#module-dipy.nn.tf.evac" title="Link to this heading">#</a></h2>
<p>Class and helper functions for fitting the EVAC+ model.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.evac.Block" title="dipy.nn.tf.evac.Block"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Block</span></code></a>(*args, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.evac.ChannelSum" title="dipy.nn.tf.evac.ChannelSum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChannelSum</span></code></a>(*args, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.evac.EVACPlus" title="dipy.nn.tf.evac.EVACPlus"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EVACPlus</span></code></a>(*[, verbose])</p></td>
<td><p>This class is intended for the EVAC+ model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.evac.prepare_img" title="dipy.nn.tf.evac.prepare_img"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_img</span></code></a>(image)</p></td>
<td><p>Function to prepare image for model input Specific to EVAC+</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.evac.init_model" title="dipy.nn.tf.evac.init_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_model</span></code></a>(*[, model_scale])</p></td>
<td><p>Function to create model for EVAC+</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.nn.tf.histo_resdnn">
<span id="module-nn-tf-histo-resdnn"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.histo_resdnn</span></code><a class="headerlink" href="#module-dipy.nn.tf.histo_resdnn" title="Link to this heading">#</a></h2>
<p>Class and helper functions for fitting the Histological ResDNN model.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.histo_resdnn.HistoResDNN" title="dipy.nn.tf.histo_resdnn.HistoResDNN"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HistoResDNN</span></code></a>(*[, sh_order_max, basis_type, ...])</p></td>
<td><p>This class is intended for the ResDNN Histology Network model.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.nn.tf.model">
<span id="module-nn-tf-model"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.model</span></code><a class="headerlink" href="#module-dipy.nn.tf.model" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.model.SingleLayerPerceptron" title="dipy.nn.tf.model.SingleLayerPerceptron"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingleLayerPerceptron</span></code></a>(*[, input_shape, ...])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.model.MultipleLayerPercepton" title="dipy.nn.tf.model.MultipleLayerPercepton"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultipleLayerPercepton</span></code></a>(*[, input_shape, ...])</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.nn.tf.synb0">
<span id="module-nn-tf-synb0"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.synb0</span></code><a class="headerlink" href="#module-dipy.nn.tf.synb0" title="Link to this heading">#</a></h2>
<p>Class and helper functions for fitting the Synb0 model.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.synb0.EncoderBlock" title="dipy.nn.tf.synb0.EncoderBlock"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EncoderBlock</span></code></a>(*args, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.synb0.DecoderBlock" title="dipy.nn.tf.synb0.DecoderBlock"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DecoderBlock</span></code></a>(*args, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.synb0.Synb0" title="dipy.nn.tf.synb0.Synb0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Synb0</span></code></a>(*[, verbose])</p></td>
<td><p>This class is intended for the Synb0 model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.synb0.UNet3D" title="dipy.nn.tf.synb0.UNet3D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UNet3D</span></code></a>(input_shape)</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.nn.torch">
<span id="module-nn-torch"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.torch</span></code><a class="headerlink" href="#module-dipy.nn.torch" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.nn.torch.evac">
<span id="module-nn-torch-evac"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.torch.evac</span></code><a class="headerlink" href="#module-dipy.nn.torch.evac" title="Link to this heading">#</a></h2>
<p>Class and helper functions for fitting the EVAC+ model.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.MoveDimLayer" title="dipy.nn.torch.evac.MoveDimLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MoveDimLayer</span></code></a>(source_dim, dest_dim)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.ChannelSum" title="dipy.nn.torch.evac.ChannelSum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChannelSum</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.Add" title="dipy.nn.torch.evac.Add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Add</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.Block" title="dipy.nn.torch.evac.Block"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Block</span></code></a>(in_channels, out_channels, ...[, ...])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.Model" title="dipy.nn.torch.evac.Model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Model</span></code></a>([model_scale])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.EVACPlus" title="dipy.nn.torch.evac.EVACPlus"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EVACPlus</span></code></a>(*[, verbose])</p></td>
<td><p>This class is intended for the EVAC+ model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.prepare_img" title="dipy.nn.torch.evac.prepare_img"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_img</span></code></a>(image)</p></td>
<td><p>Function to prepare image for model input Specific to EVAC+</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.nn.torch.histo_resdnn">
<span id="module-nn-torch-histo-resdnn"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.torch.histo_resdnn</span></code><a class="headerlink" href="#module-dipy.nn.torch.histo_resdnn" title="Link to this heading">#</a></h2>
<p>Class and helper functions for fitting the Histological ResDNN model.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.histo_resdnn.DenseModel" title="dipy.nn.torch.histo_resdnn.DenseModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DenseModel</span></code></a>(sh_size, num_hidden)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.torch.histo_resdnn.HistoResDNN" title="dipy.nn.torch.histo_resdnn.HistoResDNN"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HistoResDNN</span></code></a>(*[, sh_order_max, basis_type, ...])</p></td>
<td><p>This class is intended for the ResDNN Histology Network model.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-dipy.nn.utils">
<span id="module-nn-utils"></span><h2>Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.utils</span></code><a class="headerlink" href="#module-dipy.nn.utils" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.utils.normalize" title="dipy.nn.utils.normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize</span></code></a>(image, *[, min_v, max_v, new_min, ...])</p></td>
<td><p>normalization function</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.utils.unnormalize" title="dipy.nn.utils.unnormalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unnormalize</span></code></a>(image, norm_min, norm_max, ...)</p></td>
<td><p>unnormalization function</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.utils.transform_img" title="dipy.nn.utils.transform_img"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_img</span></code></a>(image, affine, *[, voxsize, ...])</p></td>
<td><p>Function to reshape image as an input to the model</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.utils.recover_img" title="dipy.nn.utils.recover_img"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recover_img</span></code></a>(image, inv_affine, mid_shape, ...)</p></td>
<td><p>Function to recover image from transform_img</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.utils.pad_crop" title="dipy.nn.utils.pad_crop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pad_crop</span></code></a>(image, target_shape)</p></td>
<td><p>Function to figure out pad and crop range to fit the target shape with the image</p></td>
</tr>
</tbody>
</table>
</div>
<section id="cnn1ddenoiser">
<h3><a class="reference internal" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser" title="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cnn1DDenoiser</span></code></a><a class="headerlink" href="#cnn1ddenoiser" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.cnn_1d_denoising.</span></span><span class="sig-name descname"><span class="pre">Cnn1DDenoiser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sig_length</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean_squared_error'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('accuracy',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/cnn_1d_denoising.html#Cnn1DDenoiser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.compile" title="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.compile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compile</span></code></a>(*[, optimizer, loss, metrics, ...])</p></td>
<td><p>Configure the model for training.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.evaluate" title="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a>(x, y, *[, batch_size, verbose, ...])</p></td>
<td><p>Evaluate the model on a test dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.fit" title="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(x, y, *[, batch_size, epochs, verbose, ...])</p></td>
<td><p>Train the model on train dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.load_weights" title="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.load_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_weights</span></code></a>(filepath)</p></td>
<td><p>Load the model weights from the specified file path.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.predict" title="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(x, *[, batch_size, verbose, steps, ...])</p></td>
<td><p>Generate predictions for input samples.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.save_weights" title="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.save_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_weights</span></code></a>(filepath, *[, overwrite])</p></td>
<td><p>Save the weights of the model to HDF5 file format.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.summary" title="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.summary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code></a>()</p></td>
<td><p>Get the summary of the model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.train_test_split" title="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.train_test_split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_test_split</span></code></a>(x, y, *[, test_size, ...])</p></td>
<td><p>Split the input data into random train and test subsets.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/cnn_1d_denoising.html#Cnn1DDenoiser.compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.compile" title="Link to this definition">#</a></dt>
<dd><p>Configure the model for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>optimizer</strong><span class="classifier">str or optimizer object, optional</span></dt><dd><p>Name of optimizer or optimizer object.</p>
</dd>
<dt><strong>loss</strong><span class="classifier">str or objective function, optional</span></dt><dd><p>Name of objective function or objective function itself.
If ‘None’, the model will be compiled without any loss function
and can only be used to predict output.</p>
</dd>
<dt><strong>metrics</strong><span class="classifier">list of metrics, optional</span></dt><dd><p>List of metrics to be evaluated by the model during training
and testing.</p>
</dd>
<dt><strong>loss_weights</strong><span class="classifier">list or dict, optional</span></dt><dd><p>Optional list or dictionary specifying scalar coefficients(floats)
to weight the loss contributions of different model outputs.
The loss value that will be minimized by the model will then be
the weighted sum of all individual losses. If a list, it is
expected to have a 1:1 mapping to the model’s outputs. If a dict,
it is expected to map output names (strings) to scalar
coefficients.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/cnn_1d_denoising.html#Cnn1DDenoiser.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.evaluate" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the model on a test dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">ndarray</span></dt><dd><p>Test dataset (high-noise data). If 4D, it will be converted to 1D.</p>
</dd>
<dt><strong>y</strong><span class="classifier">ndarray</span></dt><dd><p>Labels of the test dataset (low-noise data). If 4D, it will be
converted to 1D.</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier">int, optional</span></dt><dd><p>Number of samples per gradient update.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int, optional</span></dt><dd><p>Verbosity mode. 0 = silent, 1 = progress bar, 2 = one line
per epoch.</p>
</dd>
<dt><strong>steps</strong><span class="classifier">int, optional</span></dt><dd><p>Total number of steps (batches of samples) before declaring the
evaluation round finished.</p>
</dd>
<dt><strong>callbacks</strong><span class="classifier">list, optional</span></dt><dd><p>List of callbacks to apply during evaluation.</p>
</dd>
<dt><strong>max_queue_size</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum size for the generator queue.</p>
</dd>
<dt><strong>workers</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum number of processes to spin up when using process-based
threading.</p>
</dd>
<dt><strong>use_multiprocessing</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>True</cite>, use process-based threading.</p>
</dd>
<dt><strong>return_dict</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>True</cite>, loss and metric results are returned as a dictionary.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>List or dict</dt><dd><p>If <cite>return_dict</cite> is <cite>False</cite>, returns a list of [loss, metrics]
values on the test dataset. If <cite>return_dict</cite> is <cite>True</cite>, returns
a dictionary of metric names and their corresponding values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_per_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/cnn_1d_denoising.html#Cnn1DDenoiser.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.fit" title="Link to this definition">#</a></dt>
<dd><p>Train the model on train dataset.</p>
<p>The fit method will train the model for a fixed number of epochs
(iterations) on a dataset. If given data is  4D it will convert
it into 1D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">ndarray</span></dt><dd><p>The input data, as an ndarray.</p>
</dd>
<dt><strong>y</strong><span class="classifier">ndarray</span></dt><dd><p>The target data, as an ndarray.</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier">int or None, optional</span></dt><dd><p>Number of samples per batch of computation.</p>
</dd>
<dt><strong>epochs</strong><span class="classifier">int, optional</span></dt><dd><p>The number of epochs.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">‘auto’, 0, 1, or 2, optional</span></dt><dd><p>Verbosity mode. 0 = silent, 1 = progress bar, 2 = one line
per epoch.</p>
</dd>
<dt><strong>callbacks</strong><span class="classifier">list of keras.callbacks.Callback instances, optional</span></dt><dd><p>List of callbacks to apply during training.</p>
</dd>
<dt><strong>validation_split</strong><span class="classifier">float between 0 and 1, optional</span></dt><dd><p>Fraction of the training data to be used as validation data.</p>
</dd>
<dt><strong>validation_data</strong><span class="classifier">tuple (x_val, y_val) or None, optional</span></dt><dd><p>Data on which to evaluate the loss and any model metrics at
the end of each epoch.</p>
</dd>
<dt><strong>shuffle</strong><span class="classifier">boolean, optional</span></dt><dd><p>This argument is ignored when x is a generator or an object of
tf.data.Dataset.</p>
</dd>
<dt><strong>initial_epoch</strong><span class="classifier">int, optional</span></dt><dd><p>Epoch at which to start training.</p>
</dd>
<dt><strong>steps_per_epoch</strong><span class="classifier">int or None, optional</span></dt><dd><p>Total number of steps (batches of samples) before declaring one
epoch finished and starting the next epoch.</p>
</dd>
<dt><strong>validation_batch_size</strong><span class="classifier">int or None, optional</span></dt><dd><p>Number of samples per validation batch.</p>
</dd>
<dt><strong>validation_steps</strong><span class="classifier">int or None, optional</span></dt><dd><p>Only relevant if validation_data is provided and is a
tf.data dataset.</p>
</dd>
<dt><strong>validation_freq</strong><span class="classifier">int or list/tuple/set, optional</span></dt><dd><p>Only relevant if validation data is provided. If an integer,
specifies how many training epochs to run before a new validation
run is performed. If a list, tuple, or set, specifies the epochs
on which to run validation.</p>
</dd>
<dt><strong>max_queue_size</strong><span class="classifier">int, optional</span></dt><dd><p>Used for generator or keras.utils.Sequence input only.</p>
</dd>
<dt><strong>workers</strong><span class="classifier">integer, optional</span></dt><dd><p>Used for generator or keras.utils.Sequence input only.</p>
</dd>
<dt><strong>use_multiprocessing</strong><span class="classifier">boolean, optional</span></dt><dd><p>Used for generator or keras.utils.Sequence input only.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hist</strong><span class="classifier">object</span></dt><dd><p>A History object. Its History.history attribute is a record of
training loss values and metrics values at successive epochs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.load_weights">
<span class="sig-name descname"><span class="pre">load_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/cnn_1d_denoising.html#Cnn1DDenoiser.load_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.load_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the model weights from the specified file path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filepath</strong><span class="classifier">str</span></dt><dd><p>The file path from which to load the weights.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/cnn_1d_denoising.html#Cnn1DDenoiser.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.predict" title="Link to this definition">#</a></dt>
<dd><p>Generate predictions for input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">ndarray</span></dt><dd><p>Input samples.</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier">int, optional</span></dt><dd><p>Number of samples per batch.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int, optional</span></dt><dd><p>Verbosity mode.</p>
</dd>
<dt><strong>steps</strong><span class="classifier">int, optional</span></dt><dd><p>Total number of steps (batches of samples) before declaring the
prediction round finished.</p>
</dd>
<dt><strong>callbacks</strong><span class="classifier">list, optional</span></dt><dd><p>List of Keras callbacks to apply during prediction.</p>
</dd>
<dt><strong>max_queue_size</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum size for the generator queue.</p>
</dd>
<dt><strong>workers</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum number of processes to spin up when using process-based
threading.</p>
</dd>
<dt><strong>use_multiprocessing</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>True</cite>, use process-based threading. If <cite>False</cite>, use
thread-based threading.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ndarray</dt><dd><p>Numpy array of predictions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.save_weights">
<span class="sig-name descname"><span class="pre">save_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/cnn_1d_denoising.html#Cnn1DDenoiser.save_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.save_weights" title="Link to this definition">#</a></dt>
<dd><p>Save the weights of the model to HDF5 file format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filepath</strong><span class="classifier">str</span></dt><dd><p>The path where the weights should be saved.</p>
</dd>
<dt><strong>overwrite</strong><span class="classifier">bool,optional</span></dt><dd><p>If <cite>True</cite>, overwrites the file if it already exists. If <cite>False</cite>,
raises an error if the file already exists.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/cnn_1d_denoising.html#Cnn1DDenoiser.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.summary" title="Link to this definition">#</a></dt>
<dd><p>Get the summary of the model.</p>
<p>The summary is textual and includes information about:
The layers and their order in the model.
The output shape of each layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>summary</strong><span class="classifier">NoneType</span></dt><dd><p>the summary of the model</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.train_test_split">
<span class="sig-name descname"><span class="pre">train_test_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stratify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/cnn_1d_denoising.html#Cnn1DDenoiser.train_test_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.train_test_split" title="Link to this definition">#</a></dt>
<dd><p>Split the input data into random train and test subsets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x: numpy array</strong></dt><dd><p>input data.</p>
</dd>
<dt><strong>y: numpy array</strong></dt><dd><p>target data.</p>
</dd>
<dt><strong>test_size: float or int, optional</strong></dt><dd><p>If float, should be between 0.0 and 1.0 and represent the
proportion of the dataset to include in the test split.
If int, represents the absolute number of test samples.
If None, the value is set to the complement of the train size.
If train_size is also None, it will be set to 0.25.</p>
</dd>
<dt><strong>train_size: float or int, optional</strong></dt><dd><p>If float, should be between 0.0 and 1.0 and represent the
proportion of the dataset to include in the train split.
If int, represents the absolute number of train samples.
If None, the value is automatically set to the complement of the
test size.</p>
</dd>
<dt><strong>random_state: int, RandomState instance or None, optional</strong></dt><dd><p>Controls the shuffling applied to the data before applying
the split. Pass an int for reproducible output across multiple
function calls. See Glossary.</p>
</dd>
<dt><strong>shuffle: bool, optional</strong></dt><dd><p>Whether or not to shuffle the data before splitting.
If shuffle=False then stratify must be None.</p>
</dd>
<dt><strong>stratify: array-like, optional</strong></dt><dd><p>If not None, data is split in a stratified fashion,
using this as the class labels. Read more in the User Guide.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple of four numpy arrays: x_train, x_test, y_train, y_test.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="encoderblock">
<h3><a class="reference internal" href="#dipy.nn.tf.deepn4.EncoderBlock" title="dipy.nn.tf.deepn4.EncoderBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">EncoderBlock</span></code></a><a class="headerlink" href="#encoderblock" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.deepn4.EncoderBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.deepn4.</span></span><span class="sig-name descname"><span class="pre">EncoderBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/deepn4.html#EncoderBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.deepn4.EncoderBlock" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_dtype</span></code></dt><dd><p>The dtype of the computations performed by the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></dt><dd><p>Alias of <cite>layer.variable_dtype</cite>.</p>
</dd>
<dt><strong>dtype_policy</strong></dt><dd></dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/functions.html#input" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input</span></code></a></dt><dd><p>Retrieves the input tensor(s) of a symbolic operation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_dtype</span></code></dt><dd><p>The dtype layer inputs should be converted to.</p>
</dd>
<dt><strong>input_spec</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">losses</span></code></dt><dd><p>List of scalar losses from <cite>add_loss</cite>, regularizers and sublayers.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics</span></code></dt><dd><p>List of all metrics.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics_variables</span></code></dt><dd><p>List of all metric variables.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_variables</span></code></dt><dd><p>List of all non-trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_weights</span></code></dt><dd><p>List of all non-trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output</span></code></dt><dd><p>Retrieves the output tensor(s) of a layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">path</span></code></dt><dd><p>The path of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">quantization_mode</span></code></dt><dd><p>The quantization mode of this layer, <cite>None</cite> if not quantized.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_masking</span></code></dt><dd><p>Whether this layer supports computing a mask using <cite>compute_mask</cite>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable</span></code></dt><dd><p>Settable boolean, whether this layer should be trainable or not.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_variables</span></code></dt><dd><p>List of all trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_weights</span></code></dt><dd><p>List of all trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variable_dtype</span></code></dt><dd><p>The dtype of the state (weights) of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variables</span></code></dt><dd><p>List of all layer state, including random seeds.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></dt><dd><p>List of all weight variables of the layer.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*args, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loss</span></code>(loss)</p></td>
<td><p>Can be called inside of the <cite>call()</cite> method to add a scalar loss.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_variable</span></code>(shape, initializer[, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_weight</span></code>([shape, initializer, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_from_config</span></code>(config)</p></td>
<td><p>Builds the layer's states with the supplied config dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_params</span></code>()</p></td>
<td><p>Count the total number of scalars composing the weights.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_config</span></code>(config)</p></td>
<td><p>Creates an operation from its config.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_build_config</span></code>()</p></td>
<td><p>Returns a dictionary with the layer's input shape.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config</span></code>()</p></td>
<td><p>Returns the config of the object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_weights</span></code>()</p></td>
<td><p>Return the values of <cite>layer.weights</cite> as a list of NumPy arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_own_variables</span></code>(store)</p></td>
<td><p>Loads the state of the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_own_variables</span></code>(store)</p></td>
<td><p>Saves the state of the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_weights</span></code>(weights)</p></td>
<td><p>Sets the values of <cite>layer.weights</cite> from a list of NumPy arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">stateless_call</span></code>(trainable_variables, ...[, ...])</p></td>
<td><p>Call the layer without any side effects.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>add_metric</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_mask</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>compute_output_shape</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_output_spec</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantize</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>quantized_build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantized_call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>symbolic_call</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.deepn4.EncoderBlock.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/deepn4.html#EncoderBlock.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.deepn4.EncoderBlock.call" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="decoderblock">
<h3><a class="reference internal" href="#dipy.nn.tf.deepn4.DecoderBlock" title="dipy.nn.tf.deepn4.DecoderBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">DecoderBlock</span></code></a><a class="headerlink" href="#decoderblock" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.deepn4.DecoderBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.deepn4.</span></span><span class="sig-name descname"><span class="pre">DecoderBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/deepn4.html#DecoderBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.deepn4.DecoderBlock" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_dtype</span></code></dt><dd><p>The dtype of the computations performed by the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></dt><dd><p>Alias of <cite>layer.variable_dtype</cite>.</p>
</dd>
<dt><strong>dtype_policy</strong></dt><dd></dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/functions.html#input" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input</span></code></a></dt><dd><p>Retrieves the input tensor(s) of a symbolic operation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_dtype</span></code></dt><dd><p>The dtype layer inputs should be converted to.</p>
</dd>
<dt><strong>input_spec</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">losses</span></code></dt><dd><p>List of scalar losses from <cite>add_loss</cite>, regularizers and sublayers.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics</span></code></dt><dd><p>List of all metrics.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics_variables</span></code></dt><dd><p>List of all metric variables.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_variables</span></code></dt><dd><p>List of all non-trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_weights</span></code></dt><dd><p>List of all non-trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output</span></code></dt><dd><p>Retrieves the output tensor(s) of a layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">path</span></code></dt><dd><p>The path of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">quantization_mode</span></code></dt><dd><p>The quantization mode of this layer, <cite>None</cite> if not quantized.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_masking</span></code></dt><dd><p>Whether this layer supports computing a mask using <cite>compute_mask</cite>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable</span></code></dt><dd><p>Settable boolean, whether this layer should be trainable or not.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_variables</span></code></dt><dd><p>List of all trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_weights</span></code></dt><dd><p>List of all trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variable_dtype</span></code></dt><dd><p>The dtype of the state (weights) of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variables</span></code></dt><dd><p>List of all layer state, including random seeds.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></dt><dd><p>List of all weight variables of the layer.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*args, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loss</span></code>(loss)</p></td>
<td><p>Can be called inside of the <cite>call()</cite> method to add a scalar loss.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_variable</span></code>(shape, initializer[, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_weight</span></code>([shape, initializer, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_from_config</span></code>(config)</p></td>
<td><p>Builds the layer's states with the supplied config dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_params</span></code>()</p></td>
<td><p>Count the total number of scalars composing the weights.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_config</span></code>(config)</p></td>
<td><p>Creates an operation from its config.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_build_config</span></code>()</p></td>
<td><p>Returns a dictionary with the layer's input shape.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config</span></code>()</p></td>
<td><p>Returns the config of the object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_weights</span></code>()</p></td>
<td><p>Return the values of <cite>layer.weights</cite> as a list of NumPy arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_own_variables</span></code>(store)</p></td>
<td><p>Loads the state of the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_own_variables</span></code>(store)</p></td>
<td><p>Saves the state of the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_weights</span></code>(weights)</p></td>
<td><p>Sets the values of <cite>layer.weights</cite> from a list of NumPy arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">stateless_call</span></code>(trainable_variables, ...[, ...])</p></td>
<td><p>Call the layer without any side effects.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>add_metric</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_mask</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>compute_output_shape</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_output_spec</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantize</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>quantized_build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantized_call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>symbolic_call</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.deepn4.DecoderBlock.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/deepn4.html#DecoderBlock.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.deepn4.DecoderBlock.call" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="deepn4">
<h3><a class="reference internal" href="#dipy.nn.tf.deepn4.DeepN4" title="dipy.nn.tf.deepn4.DeepN4"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepN4</span></code></a><a class="headerlink" href="#deepn4" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.deepn4.DeepN4">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.deepn4.</span></span><span class="sig-name descname"><span class="pre">DeepN4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/deepn4.html#DeepN4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.deepn4.DeepN4" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class is intended for the DeepN4 model.</p>
<p>The DeepN4 model <a class="footnote-reference brackets" href="#footcite-kanakaraj2024" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> predicts the bias field for
magnetic field inhomogeneity correction on T1-weighted images.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.deepn4.DeepN4.fetch_default_weights" title="dipy.nn.tf.deepn4.DeepN4.fetch_default_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_default_weights</span></code></a>()</p></td>
<td><p>Load the model pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.deepn4.DeepN4.load_model_weights" title="dipy.nn.tf.deepn4.DeepN4.load_model_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model_weights</span></code></a>(weights_path)</p></td>
<td><p>Load the custom pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.deepn4.DeepN4.predict" title="dipy.nn.tf.deepn4.DeepN4.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(img, img_affine, *[, voxsize])</p></td>
<td><p>Wrapper function to facilitate prediction of larger dataset.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>load_resample</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>pad</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">References</p>
<div class="docutils container" id="id4">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-kanakaraj2024" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p>Praitayini Kanakaraj, Tianyuan Yao, Leon Y. Cai, Ho Hin Lee, Nancy R. Newlin, Michael E. Kim, Chenyu Gao, Kimberly R. Pechman, Derek Archer, Timothy Hohman, Angela Jefferson, Lori L. Beason-Held, Susan M. Resnick, Eleftherios Garyfallidis, Adam Anderson, Kurt G. Schilling, Bennett A. Landman, Daniel Moyer, The Alzheimer’s Disease Neuroimaging Initiative (ADNI), and The BIOCARD Study Team. DeepN4: Learning N4ITK Bias Field Correction for T1-weighted Images. <em>Neuroinformatics</em>, 22(2):193–205, April 2024. URL: <a class="reference external" href="https://doi.org/10.1007/s12021-024-09655-9">https://doi.org/10.1007/s12021-024-09655-9</a>, <a class="reference external" href="https://doi.org/10.1007/s12021-024-09655-9">doi:10.1007/s12021-024-09655-9</a>.</p>
</aside>
</aside>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.deepn4.DeepN4.fetch_default_weights">
<span class="sig-name descname"><span class="pre">fetch_default_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/deepn4.html#DeepN4.fetch_default_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.deepn4.DeepN4.fetch_default_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the model pre-training weights to use for the fitting.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.deepn4.DeepN4.load_model_weights">
<span class="sig-name descname"><span class="pre">load_model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/deepn4.html#DeepN4.load_model_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.deepn4.DeepN4.load_model_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the custom pre-training weights to use for the fitting.
get_fnames(‘deepn4_default_weights’).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>weights_path</strong><span class="classifier">str</span></dt><dd><p>Path to the file containing the weights (hdf5, saved by tensorflow)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.deepn4.DeepN4.load_resample">
<span class="sig-name descname"><span class="pre">load_resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/deepn4.html#DeepN4.load_resample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.deepn4.DeepN4.load_resample" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.deepn4.DeepN4.pad">
<span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sz</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/deepn4.html#DeepN4.pad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.deepn4.DeepN4.pad" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.deepn4.DeepN4.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_affine</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/deepn4.html#DeepN4.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.deepn4.DeepN4.predict" title="Link to this definition">#</a></dt>
<dd><p>Wrapper function to facilitate prediction of larger dataset.
The function will mask, normalize, split, predict and ‘re-assemble’
the data as a volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_file</strong><span class="classifier">string</span></dt><dd><p>Path to the T1 scan</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>final_corrected</strong><span class="classifier">np.ndarray (x, y, z)</span></dt><dd><p>Predicted bias corrected image.
The volume has matching shape to the input data</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="unet3d">
<h3>UNet3D<a class="headerlink" href="#unet3d" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.nn.tf.deepn4.UNet3D">
<span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.deepn4.</span></span><span class="sig-name descname"><span class="pre">UNet3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/deepn4.html#UNet3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.deepn4.UNet3D" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="block">
<h3><a class="reference internal" href="#dipy.nn.tf.evac.Block" title="dipy.nn.tf.evac.Block"><code class="xref py py-class docutils literal notranslate"><span class="pre">Block</span></code></a><a class="headerlink" href="#block" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.evac.Block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.evac.</span></span><span class="sig-name descname"><span class="pre">Block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/evac.html#Block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.evac.Block" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_dtype</span></code></dt><dd><p>The dtype of the computations performed by the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></dt><dd><p>Alias of <cite>layer.variable_dtype</cite>.</p>
</dd>
<dt><strong>dtype_policy</strong></dt><dd></dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/functions.html#input" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input</span></code></a></dt><dd><p>Retrieves the input tensor(s) of a symbolic operation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_dtype</span></code></dt><dd><p>The dtype layer inputs should be converted to.</p>
</dd>
<dt><strong>input_spec</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">losses</span></code></dt><dd><p>List of scalar losses from <cite>add_loss</cite>, regularizers and sublayers.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics</span></code></dt><dd><p>List of all metrics.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics_variables</span></code></dt><dd><p>List of all metric variables.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_variables</span></code></dt><dd><p>List of all non-trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_weights</span></code></dt><dd><p>List of all non-trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output</span></code></dt><dd><p>Retrieves the output tensor(s) of a layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">path</span></code></dt><dd><p>The path of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">quantization_mode</span></code></dt><dd><p>The quantization mode of this layer, <cite>None</cite> if not quantized.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_masking</span></code></dt><dd><p>Whether this layer supports computing a mask using <cite>compute_mask</cite>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable</span></code></dt><dd><p>Settable boolean, whether this layer should be trainable or not.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_variables</span></code></dt><dd><p>List of all trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_weights</span></code></dt><dd><p>List of all trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variable_dtype</span></code></dt><dd><p>The dtype of the state (weights) of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variables</span></code></dt><dd><p>List of all layer state, including random seeds.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></dt><dd><p>List of all weight variables of the layer.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*args, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loss</span></code>(loss)</p></td>
<td><p>Can be called inside of the <cite>call()</cite> method to add a scalar loss.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_variable</span></code>(shape, initializer[, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_weight</span></code>([shape, initializer, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_from_config</span></code>(config)</p></td>
<td><p>Builds the layer's states with the supplied config dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_params</span></code>()</p></td>
<td><p>Count the total number of scalars composing the weights.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_config</span></code>(config)</p></td>
<td><p>Creates an operation from its config.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_build_config</span></code>()</p></td>
<td><p>Returns a dictionary with the layer's input shape.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config</span></code>()</p></td>
<td><p>Returns the config of the object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_weights</span></code>()</p></td>
<td><p>Return the values of <cite>layer.weights</cite> as a list of NumPy arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_own_variables</span></code>(store)</p></td>
<td><p>Loads the state of the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_own_variables</span></code>(store)</p></td>
<td><p>Saves the state of the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_weights</span></code>(weights)</p></td>
<td><p>Sets the values of <cite>layer.weights</cite> from a list of NumPy arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">stateless_call</span></code>(trainable_variables, ...[, ...])</p></td>
<td><p>Call the layer without any side effects.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>add_metric</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_mask</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>compute_output_shape</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_output_spec</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantize</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>quantized_build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantized_call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>symbolic_call</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.evac.Block.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">passed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/evac.html#Block.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.evac.Block.call" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="channelsum">
<h3><a class="reference internal" href="#dipy.nn.tf.evac.ChannelSum" title="dipy.nn.tf.evac.ChannelSum"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelSum</span></code></a><a class="headerlink" href="#channelsum" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.evac.ChannelSum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.evac.</span></span><span class="sig-name descname"><span class="pre">ChannelSum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/evac.html#ChannelSum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.evac.ChannelSum" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_dtype</span></code></dt><dd><p>The dtype of the computations performed by the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></dt><dd><p>Alias of <cite>layer.variable_dtype</cite>.</p>
</dd>
<dt><strong>dtype_policy</strong></dt><dd></dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/functions.html#input" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input</span></code></a></dt><dd><p>Retrieves the input tensor(s) of a symbolic operation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_dtype</span></code></dt><dd><p>The dtype layer inputs should be converted to.</p>
</dd>
<dt><strong>input_spec</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">losses</span></code></dt><dd><p>List of scalar losses from <cite>add_loss</cite>, regularizers and sublayers.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics</span></code></dt><dd><p>List of all metrics.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics_variables</span></code></dt><dd><p>List of all metric variables.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_variables</span></code></dt><dd><p>List of all non-trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_weights</span></code></dt><dd><p>List of all non-trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output</span></code></dt><dd><p>Retrieves the output tensor(s) of a layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">path</span></code></dt><dd><p>The path of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">quantization_mode</span></code></dt><dd><p>The quantization mode of this layer, <cite>None</cite> if not quantized.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_masking</span></code></dt><dd><p>Whether this layer supports computing a mask using <cite>compute_mask</cite>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable</span></code></dt><dd><p>Settable boolean, whether this layer should be trainable or not.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_variables</span></code></dt><dd><p>List of all trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_weights</span></code></dt><dd><p>List of all trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variable_dtype</span></code></dt><dd><p>The dtype of the state (weights) of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variables</span></code></dt><dd><p>List of all layer state, including random seeds.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></dt><dd><p>List of all weight variables of the layer.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*args, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loss</span></code>(loss)</p></td>
<td><p>Can be called inside of the <cite>call()</cite> method to add a scalar loss.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_variable</span></code>(shape, initializer[, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_weight</span></code>([shape, initializer, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_from_config</span></code>(config)</p></td>
<td><p>Builds the layer's states with the supplied config dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_params</span></code>()</p></td>
<td><p>Count the total number of scalars composing the weights.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_config</span></code>(config)</p></td>
<td><p>Creates an operation from its config.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_build_config</span></code>()</p></td>
<td><p>Returns a dictionary with the layer's input shape.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config</span></code>()</p></td>
<td><p>Returns the config of the object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_weights</span></code>()</p></td>
<td><p>Return the values of <cite>layer.weights</cite> as a list of NumPy arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_own_variables</span></code>(store)</p></td>
<td><p>Loads the state of the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_own_variables</span></code>(store)</p></td>
<td><p>Saves the state of the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_weights</span></code>(weights)</p></td>
<td><p>Sets the values of <cite>layer.weights</cite> from a list of NumPy arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">stateless_call</span></code>(trainable_variables, ...[, ...])</p></td>
<td><p>Call the layer without any side effects.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>add_metric</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_mask</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>compute_output_shape</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_output_spec</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantize</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>quantized_build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantized_call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>symbolic_call</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.evac.ChannelSum.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/evac.html#ChannelSum.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.evac.ChannelSum.call" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="evacplus">
<h3><a class="reference internal" href="#dipy.nn.tf.evac.EVACPlus" title="dipy.nn.tf.evac.EVACPlus"><code class="xref py py-class docutils literal notranslate"><span class="pre">EVACPlus</span></code></a><a class="headerlink" href="#evacplus" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.evac.EVACPlus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.evac.</span></span><span class="sig-name descname"><span class="pre">EVACPlus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/evac.html#EVACPlus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.evac.EVACPlus" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class is intended for the EVAC+ model.</p>
<p>The EVAC+ model <a class="footnote-reference brackets" href="#footcite-park2024" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> is a deep learning neural network for
brain extraction. It uses a V-net architecture combined with
multi-resolution input data, an additional conditional random field (CRF)
recurrent layer and supplementary Dice loss term for this recurrent layer.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.evac.EVACPlus.fetch_default_weights" title="dipy.nn.tf.evac.EVACPlus.fetch_default_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_default_weights</span></code></a>()</p></td>
<td><p>Load the model pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.evac.EVACPlus.load_model_weights" title="dipy.nn.tf.evac.EVACPlus.load_model_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model_weights</span></code></a>(weights_path)</p></td>
<td><p>Load the custom pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.evac.EVACPlus.predict" title="dipy.nn.tf.evac.EVACPlus.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(T1, affine, *[, voxsize, ...])</p></td>
<td><p>Wrapper function to facilitate prediction of larger dataset.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">References</p>
<div class="docutils container" id="id6">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-park2024" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id5">1</a>,<a role="doc-backlink" href="#id18">2</a>)</span>
<p>Jong Sung Park, Shreyas Fadnavis, and Eleftherios Garyfallidis. Multi-scale V-net architecture with deep feature CRF layers for brain extraction. <em>Communications Medicine</em>, 4(1):29, February 2024. URL: <a class="reference external" href="https://doi.org/10.1038/s43856-024-00452-8">https://doi.org/10.1038/s43856-024-00452-8</a>, <a class="reference external" href="https://doi.org/10.1038/s43856-024-00452-8">doi:10.1038/s43856-024-00452-8</a>.</p>
</aside>
</aside>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.evac.EVACPlus.fetch_default_weights">
<span class="sig-name descname"><span class="pre">fetch_default_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/evac.html#EVACPlus.fetch_default_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.evac.EVACPlus.fetch_default_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the model pre-training weights to use for the fitting.
While the user can load different weights, the function
is mainly intended for the class function ‘predict’.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.evac.EVACPlus.load_model_weights">
<span class="sig-name descname"><span class="pre">load_model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/evac.html#EVACPlus.load_model_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.evac.EVACPlus.load_model_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the custom pre-training weights to use for the fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>weights_path</strong><span class="classifier">str</span></dt><dd><p>Path to the file containing the weights (hdf5, saved by tensorflow)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.evac.EVACPlus.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_affine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finalize_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/evac.html#EVACPlus.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.evac.EVACPlus.predict" title="Link to this definition">#</a></dt>
<dd><p>Wrapper function to facilitate prediction of larger dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>T1</strong><span class="classifier">np.ndarray or list of np.ndarray</span></dt><dd><p>For a single image, input should be a 3D array.
If multiple images, it should be a a list or tuple.</p>
</dd>
<dt><strong>affine</strong><span class="classifier">np.ndarray (4, 4) or (batch, 4, 4)</span></dt><dd><p>or list of np.ndarrays with len of batch
Affine matrix for the T1 image. Should have
batch dimension if T1 has one.</p>
</dd>
<dt><strong>voxsize</strong><span class="classifier">np.ndarray or list or tuple, optional</span></dt><dd><p>(3,) or (batch, 3)
voxel size of the T1 image.</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier">int, optional</span></dt><dd><p>Number of images per prediction pass. Only available if data
is provided with a batch dimension.
Consider lowering it if you get an out of memory error.
Increase it if you want it to be faster and have a lot of data.
If None, batch_size will be set to 1 if the provided image
has a batch dimension.</p>
</dd>
<dt><strong>return_affine</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to return the affine matrix. Useful if the input was a
file path.</p>
</dd>
<dt><strong>return_prob</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to return the probability map instead of a
binary mask. Useful for testing.</p>
</dd>
<dt><strong>finalize_mask</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to remove potential holes or islands.
Useful for solving minor errors.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>pred_output</strong><span class="classifier">np.ndarray (…) or (batch, …)</span></dt><dd><p>Predicted brain mask</p>
</dd>
<dt><strong>affine</strong><span class="classifier">np.ndarray (…) or (batch, …)</span></dt><dd><p>affine matrix of mask
only if return_affine is True</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="prepare-img">
<h3>prepare_img<a class="headerlink" href="#prepare-img" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.nn.tf.evac.prepare_img">
<span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.evac.</span></span><span class="sig-name descname"><span class="pre">prepare_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/evac.html#prepare_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.evac.prepare_img" title="Link to this definition">#</a></dt>
<dd><p>Function to prepare image for model input
Specific to EVAC+</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image</strong><span class="classifier">np.ndarray</span></dt><dd><p>Input image</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>input_data</strong><span class="classifier">dict</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="init-model">
<h3>init_model<a class="headerlink" href="#init-model" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.nn.tf.evac.init_model">
<span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.evac.</span></span><span class="sig-name descname"><span class="pre">init_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/evac.html#init_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.evac.init_model" title="Link to this definition">#</a></dt>
<dd><p>Function to create model for EVAC+</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_scale</strong><span class="classifier">int, optional</span></dt><dd><p>The scale of the model
Should match the saved weights from fetcher
Default is 16</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model</strong><span class="classifier">tf.keras.Model</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="historesdnn">
<h3><a class="reference internal" href="#dipy.nn.tf.histo_resdnn.HistoResDNN" title="dipy.nn.tf.histo_resdnn.HistoResDNN"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoResDNN</span></code></a><a class="headerlink" href="#historesdnn" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.histo_resdnn.HistoResDNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.histo_resdnn.</span></span><span class="sig-name descname"><span class="pre">HistoResDNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh_order_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tournier07'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/histo_resdnn.html#HistoResDNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.histo_resdnn.HistoResDNN" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class is intended for the ResDNN Histology Network model.</p>
<p>ResDNN <a class="footnote-reference brackets" href="#footcite-nath2019" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> is a deep neural network that employs residual
blocks deep neural network to predict ground truth SH coefficients from SH
coefficients computed using DWI data. To this end, authors considered
histology FOD-computed SH coefficients (obtained from ex vivo non-human
primate acquisitions) as their ground truth, and the DWI-computed SH
coefficients as their target.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.histo_resdnn.HistoResDNN.fetch_default_weights" title="dipy.nn.tf.histo_resdnn.HistoResDNN.fetch_default_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_default_weights</span></code></a>()</p></td>
<td><p>Load the model pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.histo_resdnn.HistoResDNN.load_model_weights" title="dipy.nn.tf.histo_resdnn.HistoResDNN.load_model_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model_weights</span></code></a>(weights_path)</p></td>
<td><p>Load the custom pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.histo_resdnn.HistoResDNN.predict" title="dipy.nn.tf.histo_resdnn.HistoResDNN.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(data, gtab, *[, mask, chunk_size])</p></td>
<td><p>Wrapper function to facilitate prediction of larger dataset.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">References</p>
<div class="docutils container" id="id8">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-nath2019" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id7">1</a>,<a role="doc-backlink" href="#id21">2</a>)</span>
<p>Vishwesh Nath, Kurt G. Schilling, Prasanna Parvathaneni, Colin B. Hansen, Allison E. Hainline, Yuankai Huo, Justin A. Blaber, Ilwoo Lyu, Vaibhav Janve, Yurui Gao, Iwona Stepniewska, Adam W. Anderson, and Bennett A. Landman. Deep learning reveals untapped information for local white-matter fiber reconstruction in diffusion-weighted MRI. <em>Magnetic Resonance Imaging</em>, 62:220–227, 2019. URL: <a class="reference external" href="https://doi.org/10.1016/j.mri.2019.07.012">https://doi.org/10.1016/j.mri.2019.07.012</a>, <a class="reference external" href="https://doi.org/10.1016/j.mri.2019.07.012">doi:10.1016/j.mri.2019.07.012</a>.</p>
</aside>
</aside>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.histo_resdnn.HistoResDNN.fetch_default_weights">
<span class="sig-name descname"><span class="pre">fetch_default_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/histo_resdnn.html#HistoResDNN.fetch_default_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.histo_resdnn.HistoResDNN.fetch_default_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the model pre-training weights to use for the fitting.
Will not work if the declared SH_ORDER does not match the weights
expected input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.histo_resdnn.HistoResDNN.load_model_weights">
<span class="sig-name descname"><span class="pre">load_model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/histo_resdnn.html#HistoResDNN.load_model_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.histo_resdnn.HistoResDNN.load_model_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the custom pre-training weights to use for the fitting.
Will not work if the declared SH_ORDER does not match the weights
expected input.</p>
<dl class="simple">
<dt>The weights for a sh_order of 8 can be obtained via the function:</dt><dd><p>get_fnames(name=’histo_resdnn_tf_weights’).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>weights_path</strong><span class="classifier">str</span></dt><dd><p>Path to the file containing the weights (hdf5, saved by tensorflow)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.histo_resdnn.HistoResDNN.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gtab</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/histo_resdnn.html#HistoResDNN.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.histo_resdnn.HistoResDNN.predict" title="Link to this definition">#</a></dt>
<dd><p>Wrapper function to facilitate prediction of larger dataset.
The function will mask, normalize, split, predict and ‘re-assemble’
the data as a volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">np.ndarray</span></dt><dd><p>DWI signal in a 4D array</p>
</dd>
<dt><strong>gtab</strong><span class="classifier">GradientTable class instance</span></dt><dd><p>The acquisition scheme matching the data (must contain at least
one b0)</p>
</dd>
<dt><strong>mask</strong><span class="classifier">np.ndarray, optional</span></dt><dd><p>Binary mask of the brain to avoid unnecessary computation and
unreliable prediction outside the brain.
Default: Compute prediction only for nonzero voxels (with at least
one nonzero DWI value).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>pred_sh_coef</strong><span class="classifier">np.ndarray (x, y, z, M)</span></dt><dd><p>Predicted fODF (as SH). The volume has matching shape to the input
data, but with
<code class="docutils literal notranslate"><span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">*</span> <span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">2)</span> <span class="pre">/</span> <span class="pre">2</span></code> as a last
dimension.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="singlelayerperceptron">
<h3><a class="reference internal" href="#dipy.nn.tf.model.SingleLayerPerceptron" title="dipy.nn.tf.model.SingleLayerPerceptron"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingleLayerPerceptron</span></code></a><a class="headerlink" href="#singlelayerperceptron" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.model.SingleLayerPerceptron">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.model.</span></span><span class="sig-name descname"><span class="pre">SingleLayerPerceptron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(28,</span> <span class="pre">28)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sparse_categorical_crossentropy'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/model.html#SingleLayerPerceptron"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.model.SingleLayerPerceptron" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.model.SingleLayerPerceptron.evaluate" title="dipy.nn.tf.model.SingleLayerPerceptron.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a>(x_test, y_test, *[, verbose])</p></td>
<td><p>Evaluate the model on test dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.model.SingleLayerPerceptron.fit" title="dipy.nn.tf.model.SingleLayerPerceptron.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(x_train, y_train, *[, epochs])</p></td>
<td><p>Train the model on train dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.model.SingleLayerPerceptron.predict" title="dipy.nn.tf.model.SingleLayerPerceptron.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(x_test)</p></td>
<td><p>Predict the output from input samples.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.model.SingleLayerPerceptron.summary" title="dipy.nn.tf.model.SingleLayerPerceptron.summary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code></a>()</p></td>
<td><p>Get the summary of the model.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.model.SingleLayerPerceptron.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/model.html#SingleLayerPerceptron.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.model.SingleLayerPerceptron.evaluate" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the model on test dataset.</p>
<p>The evaluate method will evaluate the model on a test
dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x_test</strong><span class="classifier">ndarray</span></dt><dd><p>the x_test is the test dataset</p>
</dd>
<dt><strong>y_test</strong><span class="classifier">ndarray shape=(BatchSize,)</span></dt><dd><p>the y_test is the labels of the test dataset</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int (Default = 2)</span></dt><dd><p>By setting verbose 0, 1 or 2 you just say how do you want to
‘see’ the training progress for each epoch.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>evaluate</strong><span class="classifier">List</span></dt><dd><p>return list of loss value and accuracy value on test dataset</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.model.SingleLayerPerceptron.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/model.html#SingleLayerPerceptron.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.model.SingleLayerPerceptron.fit" title="Link to this definition">#</a></dt>
<dd><p>Train the model on train dataset.</p>
<p>The fit method will train the model for a fixed
number of epochs (iterations) on a dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x_train</strong><span class="classifier">ndarray</span></dt><dd><p>the x_train is the train dataset</p>
</dd>
<dt><strong>y_train</strong><span class="classifier">ndarray shape=(BatchSize,)</span></dt><dd><p>the y_train is the labels of the train dataset</p>
</dd>
<dt><strong>epochs</strong><span class="classifier">int (Default = 5)</span></dt><dd><p>the number of epochs</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hist</strong><span class="classifier">object</span></dt><dd><p>A History object. Its History.history attribute is a record of
training loss values and metrics values at successive epochs</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.model.SingleLayerPerceptron.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/model.html#SingleLayerPerceptron.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.model.SingleLayerPerceptron.predict" title="Link to this definition">#</a></dt>
<dd><p>Predict the output from input samples.</p>
<p>The predict method will generates output predictions
for the input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x_train</strong><span class="classifier">ndarray</span></dt><dd><p>the x_test is the test dataset or input samples</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>predict</strong><span class="classifier">ndarray shape(TestSize,OutputSize)</span></dt><dd><p>Numpy array(s) of predictions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.model.SingleLayerPerceptron.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/model.html#SingleLayerPerceptron.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.model.SingleLayerPerceptron.summary" title="Link to this definition">#</a></dt>
<dd><p>Get the summary of the model.</p>
<p>The summary is textual and includes information about:
The layers and their order in the model.
The output shape of each layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>summary</strong><span class="classifier">NoneType</span></dt><dd><p>the summary of the model</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="multiplelayerpercepton">
<h3><a class="reference internal" href="#dipy.nn.tf.model.MultipleLayerPercepton" title="dipy.nn.tf.model.MultipleLayerPercepton"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultipleLayerPercepton</span></code></a><a class="headerlink" href="#multiplelayerpercepton" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.model.MultipleLayerPercepton">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.model.</span></span><span class="sig-name descname"><span class="pre">MultipleLayerPercepton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(28,</span> <span class="pre">28)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(128,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_hidden</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'softmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sparse_categorical_crossentropy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/model.html#MultipleLayerPercepton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.model.MultipleLayerPercepton" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.model.MultipleLayerPercepton.evaluate" title="dipy.nn.tf.model.MultipleLayerPercepton.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a>(x_test, y_test, *[, verbose])</p></td>
<td><p>Evaluate the model on test dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.model.MultipleLayerPercepton.fit" title="dipy.nn.tf.model.MultipleLayerPercepton.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(x_train, y_train, *[, epochs])</p></td>
<td><p>Train the model on train dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.model.MultipleLayerPercepton.predict" title="dipy.nn.tf.model.MultipleLayerPercepton.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(x_test)</p></td>
<td><p>Predict the output from input samples.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.model.MultipleLayerPercepton.summary" title="dipy.nn.tf.model.MultipleLayerPercepton.summary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code></a>()</p></td>
<td><p>Get the summary of the model.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.model.MultipleLayerPercepton.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/model.html#MultipleLayerPercepton.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.model.MultipleLayerPercepton.evaluate" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the model on test dataset.</p>
<p>The evaluate method will evaluate the model on a test
dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x_test</strong><span class="classifier">ndarray</span></dt><dd><p>the x_test is the test dataset</p>
</dd>
<dt><strong>y_test</strong><span class="classifier">ndarray shape=(BatchSize,)</span></dt><dd><p>the y_test is the labels of the test dataset</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int (Default = 2)</span></dt><dd><p>By setting verbose 0, 1 or 2 you just say how do you want to
‘see’ the training progress for each epoch.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>evaluate</strong><span class="classifier">List</span></dt><dd><p>return list of loss value and accuracy value on test dataset</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.model.MultipleLayerPercepton.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/model.html#MultipleLayerPercepton.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.model.MultipleLayerPercepton.fit" title="Link to this definition">#</a></dt>
<dd><p>Train the model on train dataset.</p>
<p>The fit method will train the model for a fixed
number of epochs (iterations) on a dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x_train</strong><span class="classifier">ndarray</span></dt><dd><p>the x_train is the train dataset</p>
</dd>
<dt><strong>y_train</strong><span class="classifier">ndarray shape=(BatchSize,)</span></dt><dd><p>the y_train is the labels of the train dataset</p>
</dd>
<dt><strong>epochs</strong><span class="classifier">int (Default = 5)</span></dt><dd><p>the number of epochs</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hist</strong><span class="classifier">object</span></dt><dd><p>A History object. Its History.history attribute is a record of
training loss values and metrics values at successive epochs</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.model.MultipleLayerPercepton.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/model.html#MultipleLayerPercepton.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.model.MultipleLayerPercepton.predict" title="Link to this definition">#</a></dt>
<dd><p>Predict the output from input samples.</p>
<p>The predict method will generates output predictions
for the input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x_train</strong><span class="classifier">ndarray</span></dt><dd><p>the x_test is the test dataset or input samples</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>predict</strong><span class="classifier">ndarray shape(TestSize,OutputSize)</span></dt><dd><p>Numpy array(s) of predictions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.model.MultipleLayerPercepton.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/model.html#MultipleLayerPercepton.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.model.MultipleLayerPercepton.summary" title="Link to this definition">#</a></dt>
<dd><p>Get the summary of the model.</p>
<p>The summary is textual and includes information about:
The layers and their order in the model.
The output shape of each layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>summary</strong><span class="classifier">NoneType</span></dt><dd><p>the summary of the model</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id9">
<h3><a class="reference internal" href="#dipy.nn.tf.synb0.EncoderBlock" title="dipy.nn.tf.synb0.EncoderBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">EncoderBlock</span></code></a><a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.synb0.EncoderBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.synb0.</span></span><span class="sig-name descname"><span class="pre">EncoderBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/synb0.html#EncoderBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.synb0.EncoderBlock" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_dtype</span></code></dt><dd><p>The dtype of the computations performed by the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></dt><dd><p>Alias of <cite>layer.variable_dtype</cite>.</p>
</dd>
<dt><strong>dtype_policy</strong></dt><dd></dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/functions.html#input" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input</span></code></a></dt><dd><p>Retrieves the input tensor(s) of a symbolic operation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_dtype</span></code></dt><dd><p>The dtype layer inputs should be converted to.</p>
</dd>
<dt><strong>input_spec</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">losses</span></code></dt><dd><p>List of scalar losses from <cite>add_loss</cite>, regularizers and sublayers.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics</span></code></dt><dd><p>List of all metrics.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics_variables</span></code></dt><dd><p>List of all metric variables.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_variables</span></code></dt><dd><p>List of all non-trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_weights</span></code></dt><dd><p>List of all non-trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output</span></code></dt><dd><p>Retrieves the output tensor(s) of a layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">path</span></code></dt><dd><p>The path of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">quantization_mode</span></code></dt><dd><p>The quantization mode of this layer, <cite>None</cite> if not quantized.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_masking</span></code></dt><dd><p>Whether this layer supports computing a mask using <cite>compute_mask</cite>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable</span></code></dt><dd><p>Settable boolean, whether this layer should be trainable or not.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_variables</span></code></dt><dd><p>List of all trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_weights</span></code></dt><dd><p>List of all trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variable_dtype</span></code></dt><dd><p>The dtype of the state (weights) of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variables</span></code></dt><dd><p>List of all layer state, including random seeds.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></dt><dd><p>List of all weight variables of the layer.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*args, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loss</span></code>(loss)</p></td>
<td><p>Can be called inside of the <cite>call()</cite> method to add a scalar loss.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_variable</span></code>(shape, initializer[, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_weight</span></code>([shape, initializer, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_from_config</span></code>(config)</p></td>
<td><p>Builds the layer's states with the supplied config dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_params</span></code>()</p></td>
<td><p>Count the total number of scalars composing the weights.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_config</span></code>(config)</p></td>
<td><p>Creates an operation from its config.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_build_config</span></code>()</p></td>
<td><p>Returns a dictionary with the layer's input shape.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config</span></code>()</p></td>
<td><p>Returns the config of the object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_weights</span></code>()</p></td>
<td><p>Return the values of <cite>layer.weights</cite> as a list of NumPy arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_own_variables</span></code>(store)</p></td>
<td><p>Loads the state of the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_own_variables</span></code>(store)</p></td>
<td><p>Saves the state of the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_weights</span></code>(weights)</p></td>
<td><p>Sets the values of <cite>layer.weights</cite> from a list of NumPy arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">stateless_call</span></code>(trainable_variables, ...[, ...])</p></td>
<td><p>Call the layer without any side effects.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>add_metric</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_mask</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>compute_output_shape</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_output_spec</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantize</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>quantized_build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantized_call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>symbolic_call</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.synb0.EncoderBlock.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/synb0.html#EncoderBlock.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.synb0.EncoderBlock.call" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="id10">
<h3><a class="reference internal" href="#dipy.nn.tf.synb0.DecoderBlock" title="dipy.nn.tf.synb0.DecoderBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">DecoderBlock</span></code></a><a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.synb0.DecoderBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.synb0.</span></span><span class="sig-name descname"><span class="pre">DecoderBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/synb0.html#DecoderBlock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.synb0.DecoderBlock" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_dtype</span></code></dt><dd><p>The dtype of the computations performed by the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></dt><dd><p>Alias of <cite>layer.variable_dtype</cite>.</p>
</dd>
<dt><strong>dtype_policy</strong></dt><dd></dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/functions.html#input" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">input</span></code></a></dt><dd><p>Retrieves the input tensor(s) of a symbolic operation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">input_dtype</span></code></dt><dd><p>The dtype layer inputs should be converted to.</p>
</dd>
<dt><strong>input_spec</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">losses</span></code></dt><dd><p>List of scalar losses from <cite>add_loss</cite>, regularizers and sublayers.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics</span></code></dt><dd><p>List of all metrics.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics_variables</span></code></dt><dd><p>List of all metric variables.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_variables</span></code></dt><dd><p>List of all non-trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_trainable_weights</span></code></dt><dd><p>List of all non-trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">output</span></code></dt><dd><p>Retrieves the output tensor(s) of a layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">path</span></code></dt><dd><p>The path of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">quantization_mode</span></code></dt><dd><p>The quantization mode of this layer, <cite>None</cite> if not quantized.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_masking</span></code></dt><dd><p>Whether this layer supports computing a mask using <cite>compute_mask</cite>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable</span></code></dt><dd><p>Settable boolean, whether this layer should be trainable or not.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_variables</span></code></dt><dd><p>List of all trainable layer state.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">trainable_weights</span></code></dt><dd><p>List of all trainable weight variables of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variable_dtype</span></code></dt><dd><p>The dtype of the state (weights) of the layer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">variables</span></code></dt><dd><p>List of all layer state, including random seeds.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></dt><dd><p>List of all weight variables of the layer.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(*args, **kwargs)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_loss</span></code>(loss)</p></td>
<td><p>Can be called inside of the <cite>call()</cite> method to add a scalar loss.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_variable</span></code>(shape, initializer[, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_weight</span></code>([shape, initializer, dtype, ...])</p></td>
<td><p>Add a weight variable to the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_from_config</span></code>(config)</p></td>
<td><p>Builds the layer's states with the supplied config dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_params</span></code>()</p></td>
<td><p>Count the total number of scalars composing the weights.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_config</span></code>(config)</p></td>
<td><p>Creates an operation from its config.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_build_config</span></code>()</p></td>
<td><p>Returns a dictionary with the layer's input shape.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config</span></code>()</p></td>
<td><p>Returns the config of the object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_weights</span></code>()</p></td>
<td><p>Return the values of <cite>layer.weights</cite> as a list of NumPy arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_own_variables</span></code>(store)</p></td>
<td><p>Loads the state of the layer.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_own_variables</span></code>(store)</p></td>
<td><p>Saves the state of the layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_weights</span></code>(weights)</p></td>
<td><p>Sets the values of <cite>layer.weights</cite> from a list of NumPy arrays.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">stateless_call</span></code>(trainable_variables, ...[, ...])</p></td>
<td><p>Call the layer without any side effects.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>add_metric</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_mask</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>compute_output_shape</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_output_spec</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantize</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>quantized_build</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>quantized_call</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>symbolic_call</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.synb0.DecoderBlock.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/synb0.html#DecoderBlock.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.synb0.DecoderBlock.call" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="synb0">
<h3><a class="reference internal" href="#dipy.nn.tf.synb0.Synb0" title="dipy.nn.tf.synb0.Synb0"><code class="xref py py-class docutils literal notranslate"><span class="pre">Synb0</span></code></a><a class="headerlink" href="#synb0" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.tf.synb0.Synb0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.synb0.</span></span><span class="sig-name descname"><span class="pre">Synb0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/synb0.html#Synb0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.synb0.Synb0" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class is intended for the Synb0 model.</p>
<p>Synb0 <a class="footnote-reference brackets" href="#footcite-schilling2019" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>, <a class="footnote-reference brackets" href="#footcite-schilling2020" id="id12" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a> uses a neural
network to synthesize a b0 volume for distortion correction in DWI images.</p>
<p>The model is the deep learning part of the Synb0-Disco
pipeline, thus stand-alone usage is not
recommended.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.synb0.Synb0.fetch_default_weights" title="dipy.nn.tf.synb0.Synb0.fetch_default_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_default_weights</span></code></a>(idx)</p></td>
<td><p>Load the model pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.tf.synb0.Synb0.load_model_weights" title="dipy.nn.tf.synb0.Synb0.load_model_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model_weights</span></code></a>(weights_path)</p></td>
<td><p>Load the custom pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.tf.synb0.Synb0.predict" title="dipy.nn.tf.synb0.Synb0.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(b0, T1, *[, batch_size, average])</p></td>
<td><p>Wrapper function to facilitate prediction of larger dataset.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">References</p>
<div class="docutils container" id="id13">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-schilling2019" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id11">5</a><span class="fn-bracket">]</span></span>
<p>Kurt G. Schilling, Justin Blaber, Yuankai Huo, Allen Newton, Colin Hansen, Vishwesh Nath, Andrea T. Shafer, Owen Williams, Susan M. Resnick, Baxter Rogers, Adam W. Anderson, and Bennett A. Landman. Synthesized b0 for diffusion distortion correction (Synb0-DisCo). <em>Magnetic Resonance Imaging</em>, 64:62–70, 2019. Artificial Intelligence in MRI. URL: <a class="reference external" href="https://doi.org/10.1016/j.mri.2019.05.008">https://doi.org/10.1016/j.mri.2019.05.008</a>, <a class="reference external" href="https://doi.org/10.1016/j.mri.2019.05.008">doi:10.1016/j.mri.2019.05.008</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-schilling2020" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id12">6</a><span class="fn-bracket">]</span></span>
<p>Kurt G. Schilling, Justin Blaber, Colin Hansen, Leon Cai, Baxter Rogers, Adam W. Anderson, Seth Smith, Praitayini Kanakaraj, Tonia Rex, Susan M. Resnick, Andrea T. Shafer, Laurie E. Cutting, Neil Woodward, David Zald, and Bennett A. Landman. Distortion correction of diffusion weighted MRI without reverse phase-encoding scans or field-maps. <em>PLOS ONE</em>, 15(7):1–15, July 2020. URL: <a class="reference external" href="https://doi.org/10.1371/journal.pone.0236418">https://doi.org/10.1371/journal.pone.0236418</a>, <a class="reference external" href="https://doi.org/10.1371/journal.pone.0236418">doi:10.1371/journal.pone.0236418</a>.</p>
</aside>
</aside>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.synb0.Synb0.fetch_default_weights">
<span class="sig-name descname"><span class="pre">fetch_default_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/synb0.html#Synb0.fetch_default_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.synb0.Synb0.fetch_default_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the model pre-training weights to use for the fitting.
While the user can load different weights, the function
is mainly intended for the class function ‘predict’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>idx</strong><span class="classifier">int</span></dt><dd><p>The idx of the default weights. It can be from 0~4.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.synb0.Synb0.load_model_weights">
<span class="sig-name descname"><span class="pre">load_model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/synb0.html#Synb0.load_model_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.synb0.Synb0.load_model_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the custom pre-training weights to use for the fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>weights_path</strong><span class="classifier">str</span></dt><dd><p>Path to the file containing the weights (hdf5, saved by tensorflow)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.tf.synb0.Synb0.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/synb0.html#Synb0.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.synb0.Synb0.predict" title="Link to this definition">#</a></dt>
<dd><p>Wrapper function to facilitate prediction of larger dataset.
The function will pad the data to meet the required shape of image.
Note that the b0 and T1 image should have the same shape</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b0</strong><span class="classifier">np.ndarray (batch, 77, 91, 77) or (77, 91, 77)</span></dt><dd><p>For a single image, input should be a 3D array. If multiple images,
there should also be a batch dimension.</p>
</dd>
<dt><strong>T1</strong><span class="classifier">np.ndarray (batch, 77, 91, 77) or (77, 91, 77)</span></dt><dd><p>For a single image, input should be a 3D array. If multiple images,
there should also be a batch dimension.</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier">int</span></dt><dd><p>Number of images per prediction pass. Only available if data
is provided with a batch dimension.
Consider lowering it if you get an out of memory error.
Increase it if you want it to be faster and have a lot of data.
If None, batch_size will be set to 1 if the provided image
has a batch dimension.
Default is None</p>
</dd>
<dt><strong>average</strong><span class="classifier">bool</span></dt><dd><p>Whether the function follows the Synb0-Disco pipeline and
averages the prediction of 5 different models.
If False, it uses the loaded weights for prediction.
Default is True.</p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>——-</strong></dt><dd></dd>
<dt><strong>pred_output</strong><span class="classifier">np.ndarray (…) or (batch, …)</span></dt><dd><p>Reconstructed b-inf image(s)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id14">
<h3>UNet3D<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.nn.tf.synb0.UNet3D">
<span class="sig-prename descclassname"><span class="pre">dipy.nn.tf.synb0.</span></span><span class="sig-name descname"><span class="pre">UNet3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/tf/synb0.html#UNet3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.tf.synb0.UNet3D" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="movedimlayer">
<h3><a class="reference internal" href="#dipy.nn.torch.evac.MoveDimLayer" title="dipy.nn.torch.evac.MoveDimLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">MoveDimLayer</span></code></a><a class="headerlink" href="#movedimlayer" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.MoveDimLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.torch.evac.</span></span><span class="sig-name descname"><span class="pre">MoveDimLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#MoveDimLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.MoveDimLayer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Add a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Apply <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Return an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compile</span></code>(*args, **kwargs)</p></td>
<td><p>Compile this Module's forward using <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Move all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Set the module in evaluation mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">float</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.MoveDimLayer.forward" title="dipy.nn.torch.evac.MoveDimLayer.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(x)</p></td>
<td><p>Define the computation performed at every call.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_buffer</span></code>(target)</p></td>
<td><p>Return the buffer given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_extra_state</span></code>()</p></td>
<td><p>Return any extra state to include in the module's state_dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(target)</p></td>
<td><p>Return the parameter given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_submodule</span></code>(target)</p></td>
<td><p>Return the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ipu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the IPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict, assign])</p></td>
<td><p>Copy parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Return an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mtia</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the MTIA.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix, remove_duplicate])</p></td>
<td><p>Return an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Return an iterator over module parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Add a buffer to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook, *[, prepend, ...])</p></td>
<td><p>Register a forward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook, *[, ...])</p></td>
<td><p>Register a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_pre_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook to be run after module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook to be run before module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_module</span></code>(name, module)</p></td>
<td><p>Alias for <code class="xref py py-func docutils literal notranslate"><span class="pre">add_module()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Add a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_extra_state</span></code>(state)</p></td>
<td><p>Set extra state contained in the loaded <cite>state_dict</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_submodule</span></code>(target, module)</p></td>
<td><p>Set the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">share_memory</span></code>()</p></td>
<td><p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.share_memory_()</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>(*args[, destination, prefix, ...])</p></td>
<td><p>Return a dictionary containing references to the whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Move and/or cast the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_empty</span></code>(*, device[, recurse])</p></td>
<td><p>Move the parameters and buffers to the specified device without copying storage.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Set the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">xpu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the XPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>([set_to_none])</p></td>
<td><p>Reset gradients of all model parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.MoveDimLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#MoveDimLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.MoveDimLayer.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="id15">
<h3><a class="reference internal" href="#dipy.nn.torch.evac.ChannelSum" title="dipy.nn.torch.evac.ChannelSum"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelSum</span></code></a><a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.ChannelSum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.torch.evac.</span></span><span class="sig-name descname"><span class="pre">ChannelSum</span></span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#ChannelSum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.ChannelSum" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Add a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Apply <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Return an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compile</span></code>(*args, **kwargs)</p></td>
<td><p>Compile this Module's forward using <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Move all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Set the module in evaluation mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">float</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.ChannelSum.forward" title="dipy.nn.torch.evac.ChannelSum.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(inputs)</p></td>
<td><p>Define the computation performed at every call.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_buffer</span></code>(target)</p></td>
<td><p>Return the buffer given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_extra_state</span></code>()</p></td>
<td><p>Return any extra state to include in the module's state_dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(target)</p></td>
<td><p>Return the parameter given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_submodule</span></code>(target)</p></td>
<td><p>Return the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ipu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the IPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict, assign])</p></td>
<td><p>Copy parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Return an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mtia</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the MTIA.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix, remove_duplicate])</p></td>
<td><p>Return an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Return an iterator over module parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Add a buffer to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook, *[, prepend, ...])</p></td>
<td><p>Register a forward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook, *[, ...])</p></td>
<td><p>Register a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_pre_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook to be run after module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook to be run before module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_module</span></code>(name, module)</p></td>
<td><p>Alias for <code class="xref py py-func docutils literal notranslate"><span class="pre">add_module()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Add a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_extra_state</span></code>(state)</p></td>
<td><p>Set extra state contained in the loaded <cite>state_dict</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_submodule</span></code>(target, module)</p></td>
<td><p>Set the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">share_memory</span></code>()</p></td>
<td><p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.share_memory_()</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>(*args[, destination, prefix, ...])</p></td>
<td><p>Return a dictionary containing references to the whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Move and/or cast the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_empty</span></code>(*, device[, recurse])</p></td>
<td><p>Move the parameters and buffers to the specified device without copying storage.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Set the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">xpu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the XPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>([set_to_none])</p></td>
<td><p>Reset gradients of all model parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.ChannelSum.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#ChannelSum.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.ChannelSum.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="add">
<h3><a class="reference internal" href="#dipy.nn.torch.evac.Add" title="dipy.nn.torch.evac.Add"><code class="xref py py-class docutils literal notranslate"><span class="pre">Add</span></code></a><a class="headerlink" href="#add" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.Add">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.torch.evac.</span></span><span class="sig-name descname"><span class="pre">Add</span></span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#Add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.Add" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Add a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Apply <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Return an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compile</span></code>(*args, **kwargs)</p></td>
<td><p>Compile this Module's forward using <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Move all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Set the module in evaluation mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">float</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.Add.forward" title="dipy.nn.torch.evac.Add.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(x, passed)</p></td>
<td><p>Define the computation performed at every call.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_buffer</span></code>(target)</p></td>
<td><p>Return the buffer given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_extra_state</span></code>()</p></td>
<td><p>Return any extra state to include in the module's state_dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(target)</p></td>
<td><p>Return the parameter given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_submodule</span></code>(target)</p></td>
<td><p>Return the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ipu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the IPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict, assign])</p></td>
<td><p>Copy parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Return an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mtia</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the MTIA.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix, remove_duplicate])</p></td>
<td><p>Return an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Return an iterator over module parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Add a buffer to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook, *[, prepend, ...])</p></td>
<td><p>Register a forward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook, *[, ...])</p></td>
<td><p>Register a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_pre_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook to be run after module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook to be run before module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_module</span></code>(name, module)</p></td>
<td><p>Alias for <code class="xref py py-func docutils literal notranslate"><span class="pre">add_module()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Add a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_extra_state</span></code>(state)</p></td>
<td><p>Set extra state contained in the loaded <cite>state_dict</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_submodule</span></code>(target, module)</p></td>
<td><p>Set the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">share_memory</span></code>()</p></td>
<td><p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.share_memory_()</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>(*args[, destination, prefix, ...])</p></td>
<td><p>Return a dictionary containing references to the whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Move and/or cast the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_empty</span></code>(*, device[, recurse])</p></td>
<td><p>Move the parameters and buffers to the specified device without copying storage.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Set the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">xpu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the XPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>([set_to_none])</p></td>
<td><p>Reset gradients of all model parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.Add.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">passed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#Add.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.Add.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="id16">
<h3><a class="reference internal" href="#dipy.nn.torch.evac.Block" title="dipy.nn.torch.evac.Block"><code class="xref py py-class docutils literal notranslate"><span class="pre">Block</span></code></a><a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.Block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.torch.evac.</span></span><span class="sig-name descname"><span class="pre">Block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">passed_channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'down'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#Block"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.Block" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Add a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Apply <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Return an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compile</span></code>(*args, **kwargs)</p></td>
<td><p>Compile this Module's forward using <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Move all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Set the module in evaluation mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">float</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.Block.forward" title="dipy.nn.torch.evac.Block.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(input, passed)</p></td>
<td><p>Define the computation performed at every call.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_buffer</span></code>(target)</p></td>
<td><p>Return the buffer given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_extra_state</span></code>()</p></td>
<td><p>Return any extra state to include in the module's state_dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(target)</p></td>
<td><p>Return the parameter given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_submodule</span></code>(target)</p></td>
<td><p>Return the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ipu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the IPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict, assign])</p></td>
<td><p>Copy parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Return an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mtia</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the MTIA.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix, remove_duplicate])</p></td>
<td><p>Return an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Return an iterator over module parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Add a buffer to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook, *[, prepend, ...])</p></td>
<td><p>Register a forward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook, *[, ...])</p></td>
<td><p>Register a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_pre_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook to be run after module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook to be run before module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_module</span></code>(name, module)</p></td>
<td><p>Alias for <code class="xref py py-func docutils literal notranslate"><span class="pre">add_module()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Add a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_extra_state</span></code>(state)</p></td>
<td><p>Set extra state contained in the loaded <cite>state_dict</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_submodule</span></code>(target, module)</p></td>
<td><p>Set the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">share_memory</span></code>()</p></td>
<td><p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.share_memory_()</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>(*args[, destination, prefix, ...])</p></td>
<td><p>Return a dictionary containing references to the whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Move and/or cast the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_empty</span></code>(*, device[, recurse])</p></td>
<td><p>Move the parameters and buffers to the specified device without copying storage.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Set the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">xpu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the XPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>([set_to_none])</p></td>
<td><p>Reset gradients of all model parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.Block.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">passed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#Block.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.Block.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="model">
<h3><a class="reference internal" href="#dipy.nn.torch.evac.Model" title="dipy.nn.torch.evac.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a><a class="headerlink" href="#model" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.torch.evac.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.Model" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Add a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Apply <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Return an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compile</span></code>(*args, **kwargs)</p></td>
<td><p>Compile this Module's forward using <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Move all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Set the module in evaluation mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">float</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.Model.forward" title="dipy.nn.torch.evac.Model.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(inputs, raw_input_2, raw_input_3, ...)</p></td>
<td><p>Define the computation performed at every call.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_buffer</span></code>(target)</p></td>
<td><p>Return the buffer given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_extra_state</span></code>()</p></td>
<td><p>Return any extra state to include in the module's state_dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(target)</p></td>
<td><p>Return the parameter given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_submodule</span></code>(target)</p></td>
<td><p>Return the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ipu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the IPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict, assign])</p></td>
<td><p>Copy parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Return an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mtia</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the MTIA.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix, remove_duplicate])</p></td>
<td><p>Return an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Return an iterator over module parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Add a buffer to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook, *[, prepend, ...])</p></td>
<td><p>Register a forward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook, *[, ...])</p></td>
<td><p>Register a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_pre_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook to be run after module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook to be run before module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_module</span></code>(name, module)</p></td>
<td><p>Alias for <code class="xref py py-func docutils literal notranslate"><span class="pre">add_module()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Add a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_extra_state</span></code>(state)</p></td>
<td><p>Set extra state contained in the loaded <cite>state_dict</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_submodule</span></code>(target, module)</p></td>
<td><p>Set the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">share_memory</span></code>()</p></td>
<td><p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.share_memory_()</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>(*args[, destination, prefix, ...])</p></td>
<td><p>Return a dictionary containing references to the whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Move and/or cast the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_empty</span></code>(*, device[, recurse])</p></td>
<td><p>Move the parameters and buffers to the specified device without copying storage.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Set the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">xpu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the XPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>([set_to_none])</p></td>
<td><p>Reset gradients of all model parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.Model.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_input_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_input_3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_input_4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_input_5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#Model.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.Model.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="id17">
<h3><a class="reference internal" href="#dipy.nn.torch.evac.EVACPlus" title="dipy.nn.torch.evac.EVACPlus"><code class="xref py py-class docutils literal notranslate"><span class="pre">EVACPlus</span></code></a><a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.EVACPlus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.torch.evac.</span></span><span class="sig-name descname"><span class="pre">EVACPlus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#EVACPlus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.EVACPlus" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class is intended for the EVAC+ model.</p>
<p>The EVAC+ model <a class="footnote-reference brackets" href="#footcite-park2024" id="id18" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> is a deep learning neural network for
brain extraction. It uses a V-net architecture combined with
multi-resolution input data, an additional conditional random field (CRF)
recurrent layer and supplementary Dice loss term for this recurrent layer.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.EVACPlus.fetch_default_weights" title="dipy.nn.torch.evac.EVACPlus.fetch_default_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_default_weights</span></code></a>()</p></td>
<td><p>Load the model pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.EVACPlus.load_model_weights" title="dipy.nn.torch.evac.EVACPlus.load_model_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model_weights</span></code></a>(weights_path)</p></td>
<td><p>Load the custom pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.evac.EVACPlus.predict" title="dipy.nn.torch.evac.EVACPlus.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(T1, affine, *[, voxsize, ...])</p></td>
<td><p>Wrapper function to facilitate prediction of larger dataset.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>init_model</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">References</p>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.EVACPlus.fetch_default_weights">
<span class="sig-name descname"><span class="pre">fetch_default_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#EVACPlus.fetch_default_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.EVACPlus.fetch_default_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the model pre-training weights to use for the fitting.</p>
<p>While the user can load different weights, the function
is mainly intended for the class function ‘predict’.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.EVACPlus.init_model">
<span class="sig-name descname"><span class="pre">init_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#EVACPlus.init_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.EVACPlus.init_model" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.EVACPlus.load_model_weights">
<span class="sig-name descname"><span class="pre">load_model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#EVACPlus.load_model_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.EVACPlus.load_model_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the custom pre-training weights to use for the fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>weights_path</strong><span class="classifier">str</span></dt><dd><p>Path to the file containing the weights (pth, saved by Pytorch)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.EVACPlus.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_affine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finalize_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#EVACPlus.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.EVACPlus.predict" title="Link to this definition">#</a></dt>
<dd><p>Wrapper function to facilitate prediction of larger dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>T1</strong><span class="classifier">np.ndarray or list of np.ndarray</span></dt><dd><p>For a single image, input should be a 3D array.
If multiple images, it should be a a list or tuple.</p>
</dd>
<dt><strong>affine</strong><span class="classifier">np.ndarray (4, 4) or (batch, 4, 4)</span></dt><dd><p>or list of np.ndarrays with len of batch
Affine matrix for the T1 image. Should have
batch dimension if T1 has one.</p>
</dd>
<dt><strong>voxsize</strong><span class="classifier">np.ndarray or list or tuple, optional</span></dt><dd><p>(3,) or (batch, 3)
voxel size of the T1 image.</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier">int, optional</span></dt><dd><p>Number of images per prediction pass. Only available if data
is provided with a batch dimension.
Consider lowering it if you get an out of memory error.
Increase it if you want it to be faster and have a lot of data.
If None, batch_size will be set to 1 if the provided image
has a batch dimension.</p>
</dd>
<dt><strong>return_affine</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to return the affine matrix. Useful if the input was a
file path.</p>
</dd>
<dt><strong>return_prob</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to return the probability map instead of a
binary mask. Useful for testing.</p>
</dd>
<dt><strong>finalize_mask</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to remove potential holes or islands.
Useful for solving minor errors.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>pred_output</strong><span class="classifier">np.ndarray (…) or (batch, …)</span></dt><dd><p>Predicted brain mask</p>
</dd>
<dt><strong>affine</strong><span class="classifier">np.ndarray (…) or (batch, …)</span></dt><dd><p>affine matrix of mask
only if return_affine is True</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="id19">
<h3>prepare_img<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.nn.torch.evac.prepare_img">
<span class="sig-prename descclassname"><span class="pre">dipy.nn.torch.evac.</span></span><span class="sig-name descname"><span class="pre">prepare_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/evac.html#prepare_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.evac.prepare_img" title="Link to this definition">#</a></dt>
<dd><p>Function to prepare image for model input
Specific to EVAC+</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image</strong><span class="classifier">np.ndarray</span></dt><dd><p>Input image</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>input_data</strong><span class="classifier">dict</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="densemodel">
<h3><a class="reference internal" href="#dipy.nn.torch.histo_resdnn.DenseModel" title="dipy.nn.torch.histo_resdnn.DenseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DenseModel</span></code></a><a class="headerlink" href="#densemodel" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.torch.histo_resdnn.DenseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.torch.histo_resdnn.</span></span><span class="sig-name descname"><span class="pre">DenseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sh_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hidden</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/histo_resdnn.html#DenseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.histo_resdnn.DenseModel" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Add a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Apply <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Return an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compile</span></code>(*args, **kwargs)</p></td>
<td><p>Compile this Module's forward using <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Move all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Set the module in evaluation mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">float</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.histo_resdnn.DenseModel.forward" title="dipy.nn.torch.histo_resdnn.DenseModel.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(x)</p></td>
<td><p>Define the computation performed at every call.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_buffer</span></code>(target)</p></td>
<td><p>Return the buffer given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_extra_state</span></code>()</p></td>
<td><p>Return any extra state to include in the module's state_dict.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(target)</p></td>
<td><p>Return the parameter given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_submodule</span></code>(target)</p></td>
<td><p>Return the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ipu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the IPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict, assign])</p></td>
<td><p>Copy parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Return an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mtia</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the MTIA.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix, remove_duplicate])</p></td>
<td><p>Return an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Return an iterator over module parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Add a buffer to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook, *[, prepend, ...])</p></td>
<td><p>Register a forward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook, *[, ...])</p></td>
<td><p>Register a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_pre_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook to be run after module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook to be run before module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_module</span></code>(name, module)</p></td>
<td><p>Alias for <code class="xref py py-func docutils literal notranslate"><span class="pre">add_module()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Add a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_extra_state</span></code>(state)</p></td>
<td><p>Set extra state contained in the loaded <cite>state_dict</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_submodule</span></code>(target, module)</p></td>
<td><p>Set the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">share_memory</span></code>()</p></td>
<td><p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.share_memory_()</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>(*args[, destination, prefix, ...])</p></td>
<td><p>Return a dictionary containing references to the whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Move and/or cast the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_empty</span></code>(*, device[, recurse])</p></td>
<td><p>Move the parameters and buffers to the specified device without copying storage.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Set the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">xpu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the XPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>([set_to_none])</p></td>
<td><p>Reset gradients of all model parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.histo_resdnn.DenseModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/histo_resdnn.html#DenseModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.histo_resdnn.DenseModel.forward" title="Link to this definition">#</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="id20">
<h3><a class="reference internal" href="#dipy.nn.torch.histo_resdnn.HistoResDNN" title="dipy.nn.torch.histo_resdnn.HistoResDNN"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoResDNN</span></code></a><a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="dipy.nn.torch.histo_resdnn.HistoResDNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dipy.nn.torch.histo_resdnn.</span></span><span class="sig-name descname"><span class="pre">HistoResDNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sh_order_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tournier07'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/histo_resdnn.html#HistoResDNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.histo_resdnn.HistoResDNN" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class is intended for the ResDNN Histology Network model.</p>
<p>ResDNN <a class="footnote-reference brackets" href="#footcite-nath2019" id="id21" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> is a deep neural network that employs residual
blocks deep neural network to predict ground truth SH coefficients from SH
coefficients computed using DWI data. To this end, authors considered
histology FOD-computed SH coefficients (obtained from ex vivo non-human
primate acquisitions) as their ground truth, and the DWI-computed SH
coefficients as their target.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.histo_resdnn.HistoResDNN.fetch_default_weights" title="dipy.nn.torch.histo_resdnn.HistoResDNN.fetch_default_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_default_weights</span></code></a>()</p></td>
<td><p>Load the model pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dipy.nn.torch.histo_resdnn.HistoResDNN.load_model_weights" title="dipy.nn.torch.histo_resdnn.HistoResDNN.load_model_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model_weights</span></code></a>(weights_path)</p></td>
<td><p>Load the custom pre-training weights to use for the fitting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dipy.nn.torch.histo_resdnn.HistoResDNN.predict" title="dipy.nn.torch.histo_resdnn.HistoResDNN.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(data, gtab, *[, mask, chunk_size])</p></td>
<td><p>Wrapper function to facilitate prediction of larger dataset.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">References</p>
<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.histo_resdnn.HistoResDNN.fetch_default_weights">
<span class="sig-name descname"><span class="pre">fetch_default_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/histo_resdnn.html#HistoResDNN.fetch_default_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.histo_resdnn.HistoResDNN.fetch_default_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the model pre-training weights to use for the fitting.
Will not work if the declared SH_ORDER does not match the weights
expected input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.histo_resdnn.HistoResDNN.load_model_weights">
<span class="sig-name descname"><span class="pre">load_model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/histo_resdnn.html#HistoResDNN.load_model_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.histo_resdnn.HistoResDNN.load_model_weights" title="Link to this definition">#</a></dt>
<dd><p>Load the custom pre-training weights to use for the fitting.
Will not work if the declared SH_ORDER does not match the weights
expected input.</p>
<dl class="simple">
<dt>The weights for a sh_order of 8 can be obtained via the function:</dt><dd><p>get_fnames(‘histo_resdnn_torch_weights’).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>weights_path</strong><span class="classifier">str</span></dt><dd><p>Path to the file containing the weights (pth, saved by Pytorch)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dipy.nn.torch.histo_resdnn.HistoResDNN.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gtab</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/torch/histo_resdnn.html#HistoResDNN.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.torch.histo_resdnn.HistoResDNN.predict" title="Link to this definition">#</a></dt>
<dd><p>Wrapper function to facilitate prediction of larger dataset.
The function will mask, normalize, split, predict and ‘re-assemble’
the data as a volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">np.ndarray</span></dt><dd><p>DWI signal in a 4D array</p>
</dd>
<dt><strong>gtab</strong><span class="classifier">GradientTable class instance</span></dt><dd><p>The acquisition scheme matching the data (must contain at least
one b0)</p>
</dd>
<dt><strong>mask</strong><span class="classifier">np.ndarray, optional</span></dt><dd><p>Binary mask of the brain to avoid unnecessary computation and
unreliable prediction outside the brain.
Default: Compute prediction only for nonzero voxels (with at least
one nonzero DWI value).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>pred_sh_coef</strong><span class="classifier">np.ndarray (x, y, z, M)</span></dt><dd><p>Predicted fODF (as SH). The volume has matching shape to the input
data, but with
<code class="docutils literal notranslate"><span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">*</span> <span class="pre">(sh_order_max</span> <span class="pre">+</span> <span class="pre">2)</span> <span class="pre">/</span> <span class="pre">2</span></code> as a last
dimension.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="normalize">
<h3>normalize<a class="headerlink" href="#normalize" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.nn.utils.normalize">
<span class="sig-prename descclassname"><span class="pre">dipy.nn.utils.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/utils.html#normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.utils.normalize" title="Link to this definition">#</a></dt>
<dd><p>normalization function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image</strong><span class="classifier">np.ndarray</span></dt><dd><p>Image to be normalized.</p>
</dd>
<dt><strong>min_v</strong><span class="classifier">int or float, optional</span></dt><dd><p>minimum value range for normalization
intensities below min_v will be clipped
if None it is set to min value of image
Default : None</p>
</dd>
<dt><strong>max_v</strong><span class="classifier">int or float, optional</span></dt><dd><p>maximum value range for normalization
intensities above max_v will be clipped
if None it is set to max value of image
Default : None</p>
</dd>
<dt><strong>new_min</strong><span class="classifier">int or float, optional</span></dt><dd><p>new minimum value after normalization
Default : 0</p>
</dd>
<dt><strong>new_max</strong><span class="classifier">int or float, optional</span></dt><dd><p>new maximum value after normalization
Default : 1</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Normalized image from range new_min to new_max</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="unnormalize">
<h3>unnormalize<a class="headerlink" href="#unnormalize" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.nn.utils.unnormalize">
<span class="sig-prename descclassname"><span class="pre">dipy.nn.utils.</span></span><span class="sig-name descname"><span class="pre">unnormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/utils.html#unnormalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.utils.unnormalize" title="Link to this definition">#</a></dt>
<dd><p>unnormalization function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image</strong><span class="classifier">np.ndarray</span></dt><dd></dd>
<dt><strong>norm_min</strong><span class="classifier">int or float</span></dt><dd><p>minimum value of normalized image</p>
</dd>
<dt><strong>norm_max</strong><span class="classifier">int or float</span></dt><dd><p>maximum value of normalized image</p>
</dd>
<dt><strong>min_v</strong><span class="classifier">int or float</span></dt><dd><p>minimum value of unnormalized image</p>
</dd>
<dt><strong>max_v</strong><span class="classifier">int or float</span></dt><dd><p>maximum value of unnormalized image</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>unnormalized image from range min_v to max_v</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="transform-img">
<h3>transform_img<a class="headerlink" href="#transform-img" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.nn.utils.transform_img">
<span class="sig-prename descclassname"><span class="pre">dipy.nn.utils.</span></span><span class="sig-name descname"><span class="pre">transform_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">considered_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'corners'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(256,</span> <span class="pre">256,</span> <span class="pre">256)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/utils.html#transform_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.utils.transform_img" title="Link to this definition">#</a></dt>
<dd><p>Function to reshape image as an input to the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image</strong><span class="classifier">np.ndarray</span></dt><dd><p>Image to transform to voxelspace</p>
</dd>
<dt><strong>affine</strong><span class="classifier">np.ndarray</span></dt><dd><p>Affine matrix provided by the file</p>
</dd>
<dt><strong>voxsize</strong><span class="classifier">np.ndarray (3,), optional</span></dt><dd><p>Voxel size of the image</p>
</dd>
<dt><strong>considered_points</strong><span class="classifier">str, optional</span></dt><dd><p>which points to consider when calculating
the boundary of the image. If there is shearing
in the affine, ‘all’ might be more accurate</p>
</dd>
<dt><strong>init_shape</strong><span class="classifier">list, tuple or numpy array (3,), optional</span></dt><dd><p>Initial shape to transform the image to</p>
</dd>
<dt><strong>scale</strong><span class="classifier">float, optional</span></dt><dd><p>How much we want to scale the image</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>tuple</dt><dd><p>Tuple with variables for recover_img</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="recover-img">
<h3>recover_img<a class="headerlink" href="#recover-img" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.nn.utils.recover_img">
<span class="sig-prename descclassname"><span class="pre">dipy.nn.utils.</span></span><span class="sig-name descname"><span class="pre">recover_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_affine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mid_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_vs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/utils.html#recover_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.utils.recover_img" title="Link to this definition">#</a></dt>
<dd><p>Function to recover image from transform_img</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image</strong><span class="classifier">np.ndarray</span></dt><dd><p>Image to recover</p>
</dd>
<dt><strong>inv_affine</strong><span class="classifier">np.ndarray</span></dt><dd><p>Affine matrix returned from transform_img</p>
</dd>
<dt><strong>mid_shape</strong><span class="classifier">np.ndarray (3,)</span></dt><dd><p>shape of image returned from transform_img</p>
</dd>
<dt><strong>ori_shape</strong><span class="classifier">tuple (3,)</span></dt><dd><p>original shape of the image</p>
</dd>
<dt><strong>offset_array</strong><span class="classifier">np.ndarray</span></dt><dd><p>Affine matrix that was used in transform_img
to translate the center</p>
</dd>
<dt><strong>voxsize</strong><span class="classifier">np.ndarray (3,)</span></dt><dd><p>Voxel size used in transform_img</p>
</dd>
<dt><strong>scale</strong><span class="classifier">float</span></dt><dd><p>Scale used in transform_img</p>
</dd>
<dt><strong>crop_vs</strong><span class="classifier">np.ndarray (3,2)</span></dt><dd><p>crop range used in transform_img</p>
</dd>
<dt><strong>pad_vs</strong><span class="classifier">np.ndarray (3,2)</span></dt><dd><p>pad range used in transform_img</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>image2</strong><span class="classifier">np.ndarray</span></dt><dd><p>Recovered image</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="pad-crop">
<h3>pad_crop<a class="headerlink" href="#pad-crop" title="Link to this heading">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="dipy.nn.utils.pad_crop">
<span class="sig-prename descclassname"><span class="pre">dipy.nn.utils.</span></span><span class="sig-name descname"><span class="pre">pad_crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dipy/nn/utils.html#pad_crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dipy.nn.utils.pad_crop" title="Link to this definition">#</a></dt>
<dd><p>Function to figure out pad and crop range
to fit the target shape with the image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image</strong><span class="classifier">np.ndarray</span></dt><dd><p>Target image</p>
</dd>
<dt><strong>target_shape</strong><span class="classifier">(3,)</span></dt><dd><p>Target shape</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>image</strong><span class="classifier">np.ndarray</span></dt><dd><p>Padded/cropped image</p>
</dd>
<dt><strong>pad_vs</strong><span class="classifier">np.ndarray (3,2)</span></dt><dd><p>Pad range used</p>
</dd>
<dt><strong>crop_vs</strong><span class="classifier">np.ndarray (3,2)</span></dt><dd><p>Crop range used</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="dipy.io.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">io</span></code></p>
      </div>
    </a>
    <a class="right-next"
       href="dipy.reconst.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">reconst</span></code></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.nn.tf">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.nn.tf.cnn_1d_denoising">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.cnn_1d_denoising</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#title-denoising-diffusion-weighted-imaging-data-using-cnn">Title : Denoising diffusion weighted imaging data using CNN</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reference">Reference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.nn.tf.deepn4">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.deepn4</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.nn.tf.evac">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.evac</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.nn.tf.histo_resdnn">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.histo_resdnn</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.nn.tf.model">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.model</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.nn.tf.synb0">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.tf.synb0</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.nn.torch">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.torch</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.nn.torch.evac">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.torch.evac</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.nn.torch.histo_resdnn">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.torch.histo_resdnn</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-dipy.nn.utils">Module: <code class="xref py py-mod docutils literal notranslate"><span class="pre">nn.utils</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cnn1ddenoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cnn1DDenoiser</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser"><code class="docutils literal notranslate"><span class="pre">Cnn1DDenoiser</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.compile"><code class="docutils literal notranslate"><span class="pre">Cnn1DDenoiser.compile()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.evaluate"><code class="docutils literal notranslate"><span class="pre">Cnn1DDenoiser.evaluate()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.fit"><code class="docutils literal notranslate"><span class="pre">Cnn1DDenoiser.fit()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.load_weights"><code class="docutils literal notranslate"><span class="pre">Cnn1DDenoiser.load_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.predict"><code class="docutils literal notranslate"><span class="pre">Cnn1DDenoiser.predict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.save_weights"><code class="docutils literal notranslate"><span class="pre">Cnn1DDenoiser.save_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.summary"><code class="docutils literal notranslate"><span class="pre">Cnn1DDenoiser.summary()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.cnn_1d_denoising.Cnn1DDenoiser.train_test_split"><code class="docutils literal notranslate"><span class="pre">Cnn1DDenoiser.train_test_split()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encoderblock"><code class="xref py py-class docutils literal notranslate"><span class="pre">EncoderBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.deepn4.EncoderBlock"><code class="docutils literal notranslate"><span class="pre">EncoderBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.deepn4.EncoderBlock.call"><code class="docutils literal notranslate"><span class="pre">EncoderBlock.call()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decoderblock"><code class="xref py py-class docutils literal notranslate"><span class="pre">DecoderBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.deepn4.DecoderBlock"><code class="docutils literal notranslate"><span class="pre">DecoderBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.deepn4.DecoderBlock.call"><code class="docutils literal notranslate"><span class="pre">DecoderBlock.call()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deepn4"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeepN4</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.deepn4.DeepN4"><code class="docutils literal notranslate"><span class="pre">DeepN4</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.deepn4.DeepN4.fetch_default_weights"><code class="docutils literal notranslate"><span class="pre">DeepN4.fetch_default_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.deepn4.DeepN4.load_model_weights"><code class="docutils literal notranslate"><span class="pre">DeepN4.load_model_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.deepn4.DeepN4.load_resample"><code class="docutils literal notranslate"><span class="pre">DeepN4.load_resample()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.deepn4.DeepN4.pad"><code class="docutils literal notranslate"><span class="pre">DeepN4.pad()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.deepn4.DeepN4.predict"><code class="docutils literal notranslate"><span class="pre">DeepN4.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unet3d">UNet3D</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.deepn4.UNet3D"><code class="docutils literal notranslate"><span class="pre">UNet3D()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#block"><code class="xref py py-class docutils literal notranslate"><span class="pre">Block</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.evac.Block"><code class="docutils literal notranslate"><span class="pre">Block</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.evac.Block.call"><code class="docutils literal notranslate"><span class="pre">Block.call()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#channelsum"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelSum</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.evac.ChannelSum"><code class="docutils literal notranslate"><span class="pre">ChannelSum</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.evac.ChannelSum.call"><code class="docutils literal notranslate"><span class="pre">ChannelSum.call()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evacplus"><code class="xref py py-class docutils literal notranslate"><span class="pre">EVACPlus</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.evac.EVACPlus"><code class="docutils literal notranslate"><span class="pre">EVACPlus</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.evac.EVACPlus.fetch_default_weights"><code class="docutils literal notranslate"><span class="pre">EVACPlus.fetch_default_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.evac.EVACPlus.load_model_weights"><code class="docutils literal notranslate"><span class="pre">EVACPlus.load_model_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.evac.EVACPlus.predict"><code class="docutils literal notranslate"><span class="pre">EVACPlus.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-img">prepare_img</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.evac.prepare_img"><code class="docutils literal notranslate"><span class="pre">prepare_img()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#init-model">init_model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.evac.init_model"><code class="docutils literal notranslate"><span class="pre">init_model()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#historesdnn"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoResDNN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.histo_resdnn.HistoResDNN"><code class="docutils literal notranslate"><span class="pre">HistoResDNN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.histo_resdnn.HistoResDNN.fetch_default_weights"><code class="docutils literal notranslate"><span class="pre">HistoResDNN.fetch_default_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.histo_resdnn.HistoResDNN.load_model_weights"><code class="docutils literal notranslate"><span class="pre">HistoResDNN.load_model_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.histo_resdnn.HistoResDNN.predict"><code class="docutils literal notranslate"><span class="pre">HistoResDNN.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#singlelayerperceptron"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingleLayerPerceptron</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.model.SingleLayerPerceptron"><code class="docutils literal notranslate"><span class="pre">SingleLayerPerceptron</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.model.SingleLayerPerceptron.evaluate"><code class="docutils literal notranslate"><span class="pre">SingleLayerPerceptron.evaluate()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.model.SingleLayerPerceptron.fit"><code class="docutils literal notranslate"><span class="pre">SingleLayerPerceptron.fit()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.model.SingleLayerPerceptron.predict"><code class="docutils literal notranslate"><span class="pre">SingleLayerPerceptron.predict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.model.SingleLayerPerceptron.summary"><code class="docutils literal notranslate"><span class="pre">SingleLayerPerceptron.summary()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiplelayerpercepton"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultipleLayerPercepton</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.model.MultipleLayerPercepton"><code class="docutils literal notranslate"><span class="pre">MultipleLayerPercepton</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.model.MultipleLayerPercepton.evaluate"><code class="docutils literal notranslate"><span class="pre">MultipleLayerPercepton.evaluate()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.model.MultipleLayerPercepton.fit"><code class="docutils literal notranslate"><span class="pre">MultipleLayerPercepton.fit()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.model.MultipleLayerPercepton.predict"><code class="docutils literal notranslate"><span class="pre">MultipleLayerPercepton.predict()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.model.MultipleLayerPercepton.summary"><code class="docutils literal notranslate"><span class="pre">MultipleLayerPercepton.summary()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="xref py py-class docutils literal notranslate"><span class="pre">EncoderBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.synb0.EncoderBlock"><code class="docutils literal notranslate"><span class="pre">EncoderBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.synb0.EncoderBlock.call"><code class="docutils literal notranslate"><span class="pre">EncoderBlock.call()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><code class="xref py py-class docutils literal notranslate"><span class="pre">DecoderBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.synb0.DecoderBlock"><code class="docutils literal notranslate"><span class="pre">DecoderBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.synb0.DecoderBlock.call"><code class="docutils literal notranslate"><span class="pre">DecoderBlock.call()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#synb0"><code class="xref py py-class docutils literal notranslate"><span class="pre">Synb0</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.synb0.Synb0"><code class="docutils literal notranslate"><span class="pre">Synb0</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.synb0.Synb0.fetch_default_weights"><code class="docutils literal notranslate"><span class="pre">Synb0.fetch_default_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.synb0.Synb0.load_model_weights"><code class="docutils literal notranslate"><span class="pre">Synb0.load_model_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.synb0.Synb0.predict"><code class="docutils literal notranslate"><span class="pre">Synb0.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">UNet3D</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.tf.synb0.UNet3D"><code class="docutils literal notranslate"><span class="pre">UNet3D()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#movedimlayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">MoveDimLayer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.MoveDimLayer"><code class="docutils literal notranslate"><span class="pre">MoveDimLayer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.MoveDimLayer.forward"><code class="docutils literal notranslate"><span class="pre">MoveDimLayer.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChannelSum</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.ChannelSum"><code class="docutils literal notranslate"><span class="pre">ChannelSum</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.ChannelSum.forward"><code class="docutils literal notranslate"><span class="pre">ChannelSum.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add"><code class="xref py py-class docutils literal notranslate"><span class="pre">Add</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.Add"><code class="docutils literal notranslate"><span class="pre">Add</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.Add.forward"><code class="docutils literal notranslate"><span class="pre">Add.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"><code class="xref py py-class docutils literal notranslate"><span class="pre">Block</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.Block"><code class="docutils literal notranslate"><span class="pre">Block</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.Block.forward"><code class="docutils literal notranslate"><span class="pre">Block.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.Model.forward"><code class="docutils literal notranslate"><span class="pre">Model.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17"><code class="xref py py-class docutils literal notranslate"><span class="pre">EVACPlus</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.EVACPlus"><code class="docutils literal notranslate"><span class="pre">EVACPlus</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.EVACPlus.fetch_default_weights"><code class="docutils literal notranslate"><span class="pre">EVACPlus.fetch_default_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.EVACPlus.init_model"><code class="docutils literal notranslate"><span class="pre">EVACPlus.init_model()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.EVACPlus.load_model_weights"><code class="docutils literal notranslate"><span class="pre">EVACPlus.load_model_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.EVACPlus.predict"><code class="docutils literal notranslate"><span class="pre">EVACPlus.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">prepare_img</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.evac.prepare_img"><code class="docutils literal notranslate"><span class="pre">prepare_img()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#densemodel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DenseModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.histo_resdnn.DenseModel"><code class="docutils literal notranslate"><span class="pre">DenseModel</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.histo_resdnn.DenseModel.forward"><code class="docutils literal notranslate"><span class="pre">DenseModel.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoResDNN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.histo_resdnn.HistoResDNN"><code class="docutils literal notranslate"><span class="pre">HistoResDNN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.histo_resdnn.HistoResDNN.fetch_default_weights"><code class="docutils literal notranslate"><span class="pre">HistoResDNN.fetch_default_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.histo_resdnn.HistoResDNN.load_model_weights"><code class="docutils literal notranslate"><span class="pre">HistoResDNN.load_model_weights()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.torch.histo_resdnn.HistoResDNN.predict"><code class="docutils literal notranslate"><span class="pre">HistoResDNN.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize">normalize</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.utils.normalize"><code class="docutils literal notranslate"><span class="pre">normalize()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unnormalize">unnormalize</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.utils.unnormalize"><code class="docutils literal notranslate"><span class="pre">unnormalize()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transform-img">transform_img</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.utils.transform_img"><code class="docutils literal notranslate"><span class="pre">transform_img()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recover-img">recover_img</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.utils.recover_img"><code class="docutils literal notranslate"><span class="pre">recover_img()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pad-crop">pad_crop</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dipy.nn.utils.pad_crop"><code class="docutils literal notranslate"><span class="pre">pad_crop()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  
<script type="module" src="../_static/scripts/grg-sphinx-theme.js"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><div>
  <h3 class="footer-heading">
    Never miss an update from us!
  </h3>
  <p class="footer-sub-heading">
    Don't worry! we are not going to spam you.
  </p>
  <div class="input-group mb-3 mar-t-10">
    <input type="text" class="form-control" placeholder="You email" aria-label="You email" id="grg-subscribe-email">
    <div class="input-group-append pointer" onclick="(document.getElementById('grg-subscribe-email').value)">
      <span class="input-group-text subscribe">Subscribe</span>
    </div>
  </div>  
  <ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul>
</div></div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="grid-3">
  
  <div>
    <h5 class="footer-heading">
      About
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://dipy.org/team">
            Developers
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://github.com/dipy/dipy/discussions" target="_blank" rel="noopener noreferrer">
            Support
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../user_guide/installation.html">
            Download
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../user_guide/getting_started.html">
            Get Started
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../examples_built/index.html">
            Tutorials
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank" rel="noopener noreferrer">
            Videos
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Friends
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/" target="_blank" rel="noopener noreferrer">
            Nipy Projects
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://fury.gl/" target="_blank" rel="noopener noreferrer">
            FURY
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/nibabel" target="_blank" rel="noopener noreferrer">
            Nibabel
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://tortoise.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            Tortoise
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Support
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://engineering.indiana.edu/" target="_blank" rel="noopener noreferrer">
            The department of Intelligent Systems Engineering of Indiana University
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            The National Institute of Biomedical Imaging and Bioengineering, NIH
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://escience.washington.edu" target="_blank" rel="noopener noreferrer">
            The Gordon and Betty Moore Foundation and the Alfred P. Sloan Foundation, through the University of Washington eScience Institute Data Science Environment
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://summerofcode.withgoogle.com/" target="_blank" rel="noopener noreferrer">
            Google supported DIPY through the Google Summer of Code Program (2015-2024)
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
</div></div>
      
    </div>
  
</div>

    <div class="copyright-text">
      <i class="fa-regular fa-copyright"></i> Copyright 2008-2024,DIPY developers. Created using Grg Sphinx Theme and PyData Sphinx Theme.
    </div>
  </footer>
  </body>
</html>