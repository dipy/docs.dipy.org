
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DIPY &#8212; dipy 1.10.0 documentation</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/dipy.css?v=cedb193d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

  
<link rel="stylesheet" href="../../_static/styles/grg-sphinx-theme.css"/>

    <script src="../../_static/documentation_options.js?v=1d24b1d9"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D610GKJZRC"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples_built/reconstruction/reconst_qtdmri';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.dipy.org/dev/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.10.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="icon" href="../../_static/dipy-favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Contextual Enhancement" href="../contextual_enhancement/index.html" />
    <link rel="prev" title="Reconstruction with Robust and Unbiased Model-BAsed Spherical Deconvolution (RUMBA)" href="reconst_rumba.html" />
  <meta name="keywords" content="DIPY, dMRI, DTI, DSI, diffusion MRI, Tensor,
  neuroimaging, python, neuroscience, Eleftherios, Garyfallidis, tractography,
  streamlines, fiber tracking">

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
     
  

<a class="navbar-brand logo" href="https://dipy.org">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/dipy-logo.png" class="logo__image only-light" alt="DIPY"/>
    <script>document.write(`<img src="../../_static/dipy-logo.png" class="logo__image only-dark" alt="DIPY"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference/index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

</nav>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference/index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../quick_start/index.html">Quick Start</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../quick_start/quick_start.html">Getting started with DIPY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick_start/tracking_introduction_eudx.html">Introduction to Basic Tracking</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../preprocessing/index.html">Preprocessing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/reslice_datasets.html">Reslice diffusion datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/motion_correction.html">Between-volumes Motion Correction on DWI datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/piesno.html">Noise estimation using PIESNO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_nlmeans.html">Denoise images using Non-Local Means (NLMEANS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/brain_extraction_dwi.html">Brain segmentation with median_otsu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_patch2self.html">Patch2Self: Self-Supervised Denoising via Statistical Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_localpca.html">Denoise images using Local PCA via empirical thresholds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/gradients_spheres.html">Gradients and Spheres</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_ascm.html">Denoise images using Adaptive Soft Coefficient Matching (ASCM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/snr_in_cc.html">SNR estimation for Diffusion-Weighted Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_mppca.html">Denoise images using the Marcenko-Pastur PCA algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_gibbs.html">Suppress Gibbs oscillations</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Reconstruction</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="reconst_qtiplus.html">Applying positivity constraints to Q-space Trajectory Imaging (QTI+)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dsi.html">Reconstruct with Diffusion Spectrum Imaging (DSI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_cti.html">Reconstruction of the diffusion signal with the correlation tensor model (CTI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dsid.html">DSI Deconvolution (DSID) vs DSI</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_shore_metrics.html">Calculate SHORE scalar maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_gqi.html">Reconstruct with Generalized Q-Sampling Imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_shore.html">Continuous and analytical diffusion signal modelling with 3D-SHORE</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_csa.html">Reconstruct with Constant Solid Angle (Q-Ball)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_sfm.html">Reconstruction with the Sparse Fascicle Model (SFM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dsi_metrics.html">Calculate DSI-based scalar maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dki.html">Reconstruction of the diffusion signal with the kurtosis tensor model (DKI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_qti.html">Reconstruct with Q-space Trajectory Imaging (QTI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dti.html">Reconstruction of the diffusion signal with DTI (single tensor) model</a></li>
<li class="toctree-l2"><a class="reference internal" href="kfold_xval.html">K-fold cross-validation for model comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_forecast.html">Crossing invariant fiber response function with FORECAST model</a></li>
<li class="toctree-l2"><a class="reference internal" href="histology_resdnn.html">Local reconstruction using the Histological ResDNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dki_micro.html">Reconstruction of the diffusion signal with the WMTI model (DKI-MICRO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="restore_dti.html">Using the RESTORE algorithm for robust tensor fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_fwdti.html">Using the free water elimination model to remove DTI free water contamination</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_sh.html">Signal Reconstruction Using Spherical Harmonics</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_mcsd.html">Reconstruction with Multi-Shell Multi-Tissue CSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_mapmri.html">Continuous and analytical diffusion signal modelling with MAP-MRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_csd.html">Reconstruction with Constrained Spherical Deconvolution model (CSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_ivim.html">Intravoxel incoherent motion (IVIM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_bingham.html">Reconstruction of Bingham Functions from ODFs</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_msdki.html">Mean signal diffusion kurtosis imaging (MSDKI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_rumba.html">Reconstruction with Robust and Unbiased Model-BAsed Spherical Deconvolution (RUMBA)</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Estimating diffusion time dependent q-space indices using qt-dMRI</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contextual_enhancement/index.html">Contextual Enhancement</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contextual_enhancement/contextual_enhancement.html">Crossing-preserving contextual enhancement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contextual_enhancement/fiber_to_bundle_coherence.html">Fiber to bundle coherence measures</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fiber_tracking/index.html">Fiber Tracking</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/surface_seed.html">Surface seeding for tractography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_deterministic.html">An introduction to the Deterministic Maximum Direction Getter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_ptt.html">Parallel Transport Tractography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_bootstrap_peaks.html">Bootstrap and Closest Peak Direction Getters Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_sfm.html">Tracking with the Sparse Fascicle Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_rumba.html">Tracking with Robust Unbiased Model-BAsed Spherical Deconvolution (RUMBA-SD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_introduction_eudx_1.html">Introduction to Basic Tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_pft.html">Particle Filtering Tractography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_probabilistic.html">An introduction to the Probabilistic Direction Getter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/linear_fascicle_evaluation.html">Linear fascicle evaluation (LiFE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_stopping_criterion.html">Using Various Stopping Criterion for Tractography</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../streamline_analysis/index.html">Streamlines Analysis and Connectivity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/bundle_shape_similarity.html">BUAN Bundle Shape Similarity Score</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/bundle_assignment_maps.html">BUAN Bundle Assignment Maps Creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/afq_tract_profiles.html">Extracting AFQ tract profiles from segmented bundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/cluster_confidence.html">Calculation of Outliers with Cluster Confidence Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/streamline_length.html">Streamline length and size reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/path_length_map.html">Calculate Path Length Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/streamline_tools.html">Connectivity Matrices, ROI Intersections and Density Maps</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../registration/index.html">Registration</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../registration/bundle_group_registration.html">Groupwise Bundle Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/bundle_registration.html">Direct Bundle Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/register_binary_fuzzy.html">Diffeomorphic Registration with binary and fuzzy images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/syn_registration_3d.html">Symmetric Diffeomorphic Registration in 3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/syn_registration_2d.html">Symmetric Diffeomorphic Registration in 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/bundlewarp_registration.html">Nonrigid Bundle Registration with BundleWarp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/streamline_registration.html">Applying image-based deformations to streamlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/affine_registration_masks.html">Affine Registration with Masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/affine_registration_3d.html">Affine Registration in 3D</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../segmentation/index.html">Segmentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/brain_extraction_dwi_1.html">Brain segmentation with median_otsu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_quickbundles.html">Tractography Clustering with QuickBundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/tissue_classification.html">Tissue Classification of a T1-weighted Structural Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_clustering_metrics.html">Tractography Clustering - Available Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/fast_streamline_search.html">Fast Streamline Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_extending_clustering_framework.html">Enhancing QuickBundles with different metrics and features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_clustering_features.html">Tractography Clustering - Available Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/bundle_extraction.html">Automatic Fiber Bundle Extraction with RecoBundles</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../simulations/index.html">Simulation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../simulations/reconst_dsid_1.html">DSI Deconvolution (DSID) vs DSI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/simulate_dki.html">DKI MultiTensor Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/simulate_multi_tensor.html">MultiTensor Simulation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../multiprocessing/index.html">Multiprocessing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../multiprocessing/reconst_csa_parallel.html">Parallel reconstruction using Q-Ball</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multiprocessing/reconst_csd_parallel.html">Parallel reconstruction using CSD</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../file_formats/index.html">File Formats</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../file_formats/streamline_formats.html">Read/Write streamline files</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualization/index.html">Visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_roi_contour.html">Visualization of ROI Surface Rendered with Streamlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_bundles.html">Visualize bundles and metrics on bundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_slice.html">Simple volume slicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_advanced.html">Advanced interactive visualization</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../workflows/index.html">Workflows</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../workflows/workflow_creation.html">Creating a new workflow.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workflows/combined_workflow_creation.html">Creating a new combined workflow</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Reconstruction</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">DIPY</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-built-reconstruction-reconst-qtdmri-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="estimating-diffusion-time-dependent-q-space-indices-using-qt-dmri">
<span id="sphx-glr-examples-built-reconstruction-reconst-qtdmri-py"></span><h1>Estimating diffusion time dependent q-space indices using qt-dMRI<a class="headerlink" href="#estimating-diffusion-time-dependent-q-space-indices-using-qt-dmri" title="Link to this heading">#</a></h1>
<p>Effective representation of the four-dimensional diffusion MRI signal –
varying over three-dimensional q-space and diffusion time – is a sought-after
and still unsolved challenge in diffusion MRI (dMRI). We propose a functional
basis approach that is specifically designed to represent the dMRI signal in
this qtau-space <a class="footnote-reference brackets" href="#footcite-fick2018" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. Following recent terminology, we refer
to our qtau-functional basis as <span class="math notranslate nohighlight">\(q        au\)</span>-dMRI. We use GraphNet
regularization –imposing both signal smoothness and sparsity – to drastically
reduce the number of diffusion-weighted images (DWIs) that is needed to
represent the dMRI signal in the qtau-space. As the main contribution,
<span class="math notranslate nohighlight">\(q        au\)</span>-dMRI provides the framework to – without making biophysical
assumptions – represent the <span class="math notranslate nohighlight">\(q   au\)</span>-space signal and estimate
time-dependent q-space indices (<span class="math notranslate nohighlight">\(q        au\)</span>-indices), providing a new means
for studying diffusion in nervous tissue. <span class="math notranslate nohighlight">\(q      au\)</span>-dMRI is the first of its
kind in being specifically designed to provide open interpretation of the
<span class="math notranslate nohighlight">\(q        au\)</span>-diffusion signal.</p>
<p><span class="math notranslate nohighlight">\(q        au\)</span>-dMRI can be seen as a time-dependent extension of the MAP-MRI
functional basis <a class="footnote-reference brackets" href="#footcite-ozarslan2013" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>, and all the previously proposed
q-space can be estimated for any diffusion time. These include rotationally
invariant quantities such as the Mean Squared Displacement (MSD), Q-space
Inverse Variance (QIV) and Return-To-Origin Probability (RTOP). Also
directional indices such as the Return To the Axis Probability (RTAP) and
Return To the Plane Probability (RTPP) are available, as well as the
Orientation Distribution Function (ODF).</p>
<p>In this example we illustrate how to use the <span class="math notranslate nohighlight">\(q   au\)</span>-dMRI to estimate
time-dependent q-space indices from a <span class="math notranslate nohighlight">\(q  au\)</span>-acquisition of a mouse.</p>
<p>First import the necessary modules:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">dipy.data.fetcher</span> <span class="kn">import</span> <span class="p">(</span>
    <a href="../../reference/dipy.data.html#dipy.data.fetcher.fetch_qtdMRI_test_retest_2subjects" title="dipy.data.fetcher.fetch_qtdMRI_test_retest_2subjects" class="sphx-glr-backref-module-dipy-data-fetcher sphx-glr-backref-type-py-function"><span class="n">fetch_qtdMRI_test_retest_2subjects</span></a><span class="p">,</span>
    <a href="../../reference/dipy.data.html#dipy.data.fetcher.read_qtdMRI_test_retest_2subjects" title="dipy.data.fetcher.read_qtdMRI_test_retest_2subjects" class="sphx-glr-backref-module-dipy-data-fetcher sphx-glr-backref-type-py-function"><span class="n">read_qtdMRI_test_retest_2subjects</span></a><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">dipy.reconst</span> <span class="kn">import</span> <span class="n">dti</span><span class="p">,</span> <span class="n">qtdmri</span>
</pre></div>
</div>
<p>Download and read the data for this tutorial.</p>
<p><span class="math notranslate nohighlight">\(q\tau\)</span>-dMRI requires data with multiple gradient directions, gradient
strength and diffusion times. We will use the test-retest acquisitions of two
mice that were used in the test-retest study by <a class="footnote-reference brackets" href="#footcite-fick2018" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. The
data itself is freely available and citeable at <a class="footnote-reference brackets" href="#footcite-wassermann2017" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../reference/dipy.data.html#dipy.data.fetcher.fetch_qtdMRI_test_retest_2subjects" title="dipy.data.fetcher.fetch_qtdMRI_test_retest_2subjects" class="sphx-glr-backref-module-dipy-data-fetcher sphx-glr-backref-type-py-function"><span class="n">fetch_qtdMRI_test_retest_2subjects</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cc_masks</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtabs</span></a> <span class="o">=</span> <a href="../../reference/dipy.data.html#dipy.data.fetcher.read_qtdMRI_test_retest_2subjects" title="dipy.data.fetcher.read_qtdMRI_test_retest_2subjects" class="sphx-glr-backref-module-dipy-data-fetcher sphx-glr-backref-type-py-function"><span class="n">read_qtdMRI_test_retest_2subjects</span></a><span class="p">()</span>
</pre></div>
</div>
<p>data contains 4 qt-dMRI datasets of size [80, 160, 5, 515]. The first two are
the test-retest datasets of the first mouse and the second two are those of
the second mouse. cc_masks contains 4 corresponding binary masks for the
corpus callosum voxels in the middle slice that were used in the test-retest
study. Finally, gtab contains the qt-dMRI gradient tables for the DWIs in the
dataset.</p>
<p>The data consists of 515 DWIs, divided over 35 shells, with 7 “gradient
strength shells” up to 491 mT/m, 5 equally spaced “pulse separation shells”
(big_delta) between [10.8-20] ms and a pulse duration (small_delta) of 5ms.</p>
<p>To visualize qt-dMRI acquisition schemes in an intuitive way, the qtdmri
module provides a visualization function to illustrate the relationship
between gradient strength (G), pulse separation (big_delta) and b-value:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a href="../../reference/dipy.reconst.html#dipy.reconst.qtdmri.visualise_gradient_table_G_Delta_rainbow" title="dipy.reconst.qtdmri.visualise_gradient_table_G_Delta_rainbow" class="sphx-glr-backref-module-dipy-reconst-qtdmri sphx-glr-backref-type-py-function"><span class="n">qtdmri</span><span class="o">.</span><span class="n">visualise_gradient_table_G_Delta_rainbow</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtabs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;qt-dMRI_acquisition_scheme.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_reconst_qtdmri_001.png" srcset="../../_images/sphx_glr_reconst_qtdmri_001.png" alt="reconst qtdmri" class = "sphx-glr-single-img"/><p class="centered small fst-italic fw-semibold">In the figure the dots represent measured DWIs in any direction, for a given
gradient strength and pulse separation. The background isolines represent the
corresponding b-values for different combinations of G and big_delta.</p>
<p>Next, we visualize the middle slices of the test-retest data sets with their
corresponding masks. To better illustrate the white matter architecture in
the data, we calculate DTI’s fractional anisotropy (FA) over the whole slice
and project the corpus callosum mask on the FA image.:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subplot_titles</span></a> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Subject1 Test&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Subject1 Retest&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Subject2 Test&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Subject2 Retest&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">,</span> <span class="p">(</span><span class="n">data_</span><span class="p">,</span> <span class="n">mask_</span><span class="p">,</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab_</span></a><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cc_masks</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtabs</span></a><span class="p">)):</span>
    <span class="c1"># take the middle slice</span>
    <span class="n">data_middle_slice</span> <span class="o">=</span> <span class="n">data_</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">mask_middle_slice</span> <span class="o">=</span> <span class="n">mask_</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span>

    <span class="c1"># estimate fractional anisotropy (FA) for this slice</span>
    <a href="../../reference/dipy.reconst.html#dipy.reconst.dti.TensorModel" title="dipy.reconst.dti.TensorModel" class="sphx-glr-backref-module-dipy-reconst-dti sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tenmod</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.dti.TensorModel" title="dipy.reconst.dti.TensorModel" class="sphx-glr-backref-module-dipy-reconst-dti sphx-glr-backref-type-py-class"><span class="n">dti</span><span class="o">.</span><span class="n">TensorModel</span></a><span class="p">(</span><a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab_</span></a><span class="p">)</span>
    <a href="../../reference/dipy.reconst.html#dipy.reconst.dti.TensorFit" title="dipy.reconst.dti.TensorFit" class="sphx-glr-backref-module-dipy-reconst-dti sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tenfit</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.dti.TensorModel.fit" title="dipy.reconst.dti.TensorModel.fit" class="sphx-glr-backref-module-dipy-reconst-dti sphx-glr-backref-type-py-method"><span class="n">tenmod</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">data_middle_slice</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">data_middle_slice</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">fa</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.dti.TensorFit" title="dipy.reconst.dti.TensorFit" class="sphx-glr-backref-module-dipy-reconst-dti sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tenfit</span></a><span class="o">.</span><span class="n">fa</span>

    <span class="c1"># set mask color to green with 0.5 opacity as overlay</span>
    <span class="n">mask_template</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mask_middle_slice</span><span class="o">.</span><span class="n">shape</span></a><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
    <span class="n">mask_template</span><span class="p">[</span><span class="n">mask_middle_slice</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>

    <span class="c1"># produce the FA images with corpus callosum masks.</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">subplot_titles</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">i</span></a><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys_r&quot;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask_template</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;qt-dMRI_datasets_fa_with_ccmasks.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_reconst_qtdmri_002.png" srcset="../../_images/sphx_glr_reconst_qtdmri_002.png" alt="reconst qtdmri" class = "sphx-glr-single-img"/><p class="centered small fst-italic fw-semibold">Next, we use qt-dMRI to estimate of time-dependent q-space indices
(q:math:<cite>tau</cite>-indices) for the masked voxels in the corpus callosum of each
dataset. In particular, we estimate the Return-to-Original, Return-to-Axis
and Return-to-Plane Probability (RTOP, RTAP and RTPP), as well as the Mean
Squared Displacement (MSD).</p>
<p>In this example we don’t extrapolate the data beyond the maximum diffusion
time, so we estimate <span class="math notranslate nohighlight">\(q\tau\)</span> indices between the minimum and maximum
diffusion times of the data at 5 equally spaced points. However, it should
the noted that qt-dMRI’s combined smoothness and sparsity regularization
allows for smooth interpolation at any <span class="math notranslate nohighlight">\(q\tau\)</span> position. In other
words, once the basis is fitted to the data, its coefficients describe the
entire <span class="math notranslate nohighlight">\(q\tau\)</span>-space, and any <span class="math notranslate nohighlight">\(q\tau\)</span>-position can be freely
recovered. This including points beyond the dataset’s maximum
<span class="math notranslate nohighlight">\(q\tau\)</span> value (although this should be done with caution).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tau_min</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtabs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tau</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">tau_max</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtabs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tau</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">taus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tau_min</span><span class="p">,</span> <span class="n">tau_max</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qtdmri_fits</span></a> <span class="o">=</span> <span class="p">[]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">msds</span></a> <span class="o">=</span> <span class="p">[]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtops</span></a> <span class="o">=</span> <span class="p">[]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtaps</span></a> <span class="o">=</span> <span class="p">[]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtpps</span></a> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">data_</span><span class="p">,</span> <span class="n">mask_</span><span class="p">,</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab_</span></a> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cc_masks</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtabs</span></a><span class="p">):</span>
    <span class="c1"># select the corpus callosum voxel for every dataset</span>
    <span class="n">cc_voxels</span> <span class="o">=</span> <span class="n">data_</span><span class="p">[</span><span class="n">mask_</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
    <span class="c1"># initialize the qt-dMRI model.</span>
    <span class="c1"># recommended basis orders are radial_order=6 and time_order=2.</span>
    <span class="c1"># The combined Laplacian and l1-regularization using Generalized</span>
    <span class="c1"># Cross-Validation (GCV) and Cross-Validation (CV) settings is most robust,</span>
    <span class="c1"># but can be used separately and with weightings preset to any positive</span>
    <span class="c1"># value to optimize for speed.</span>
    <a href="../../reference/dipy.reconst.html#dipy.reconst.qtdmri.QtdmriModel" title="dipy.reconst.qtdmri.QtdmriModel" class="sphx-glr-backref-module-dipy-reconst-qtdmri sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qtdmri_mod</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.qtdmri.QtdmriModel" title="dipy.reconst.qtdmri.QtdmriModel" class="sphx-glr-backref-module-dipy-reconst-qtdmri sphx-glr-backref-type-py-class"><span class="n">qtdmri</span><span class="o">.</span><span class="n">QtdmriModel</span></a><span class="p">(</span>
        <a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab_</span></a><span class="p">,</span>
        <span class="n">radial_order</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
        <span class="n">time_order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">laplacian_regularization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">laplacian_weighting</span><span class="o">=</span><span class="s2">&quot;GCV&quot;</span><span class="p">,</span>
        <span class="n">l1_regularization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">l1_weighting</span><span class="o">=</span><span class="s2">&quot;CV&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># fit the model.</span>
    <span class="c1"># Here we take every 5th voxel for speed, but of course all voxels can be</span>
    <span class="c1"># fit for a more robust result later on.</span>
    <a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qtdmri_fit</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.qtdmri.QtdmriModel.fit" title="dipy.reconst.qtdmri.QtdmriModel.fit" class="sphx-glr-backref-module-dipy-reconst-qtdmri sphx-glr-backref-type-py-method"><span class="n">qtdmri_mod</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">cc_voxels</span><span class="p">[::</span><span class="mi">5</span><span class="p">])</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qtdmri_fits</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qtdmri_fit</span></a><span class="p">)</span>
    <span class="c1"># We estimate MSD, RTOP, RTAP and RTPP for the chosen diffusion times.</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">msds</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.CallableArray" title="dipy.reconst.multi_voxel.CallableArray" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qtdmri_fit</span><span class="o">.</span><span class="n">msd</span></a><span class="p">,</span> <span class="n">taus</span><span class="p">))))</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtops</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.CallableArray" title="dipy.reconst.multi_voxel.CallableArray" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qtdmri_fit</span><span class="o">.</span><span class="n">rtop</span></a><span class="p">,</span> <span class="n">taus</span><span class="p">))))</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtaps</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.CallableArray" title="dipy.reconst.multi_voxel.CallableArray" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qtdmri_fit</span><span class="o">.</span><span class="n">rtap</span></a><span class="p">,</span> <span class="n">taus</span><span class="p">))))</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtpps</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.CallableArray" title="dipy.reconst.multi_voxel.CallableArray" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">qtdmri_fit</span><span class="o">.</span><span class="n">rtpp</span></a><span class="p">,</span> <span class="n">taus</span><span class="p">))))</span>
</pre></div>
</div>
<p>The estimated <span class="math notranslate nohighlight">\(q\tau\)</span>-indices, for the chosen diffusion times, are now
stored in msds, rtops, rtaps and rtpps. The trends of these
<span class="math notranslate nohighlight">\(q\tau\)</span>-indices over time say something about the restriction of
diffusing particles over time, which is currently a hot topic in the dMRI
community. We evaluate the test-retest reproducibility for the two subjects
by plotting the <span class="math notranslate nohighlight">\(q\tau\)</span>-indices for each subject together. This
example will produce similar results as Fig. 10 in <a class="footnote-reference brackets" href="#footcite-fick2018" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<p>We first define a small function to plot the mean and standard deviation of
the <span class="math notranslate nohighlight">\(q\tau\)</span>-index trends in a subject.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">ind1</span><span class="p">,</span> <span class="n">plotcolor</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">std_mult</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="n">means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ind1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">stds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ind1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">plotcolor</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
        <span class="n">time</span><span class="p">,</span>
        <span class="n">means</span> <span class="o">+</span> <span class="n">std_mult</span> <span class="o">*</span> <span class="n">stds</span><span class="p">,</span>
        <span class="n">means</span> <span class="o">-</span> <span class="n">std_mult</span> <span class="o">*</span> <span class="n">stds</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">plotcolor</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">means</span> <span class="o">+</span> <span class="n">std_mult</span> <span class="o">*</span> <span class="n">stds</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plotcolor</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">means</span> <span class="o">-</span> <span class="n">std_mult</span> <span class="o">*</span> <span class="n">stds</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plotcolor</span><span class="p">)</span>
</pre></div>
</div>
<p>We start by showing the test-retest MSD of both subjects over time. We plot
the <span class="math notranslate nohighlight">\(q\tau\)</span>-indices together with <span class="math notranslate nohighlight">\(q\tau\)</span>-index trends of free
diffusion with different diffusivities as background.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we first generate the data to produce the background index isolines.</span>
<span class="n">Delta_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">MSD_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">4e-5</span><span class="p">,</span> <span class="mf">10e-5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Delta_grid</span><span class="p">,</span> <span class="n">MSD_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">Delta_</span><span class="p">,</span> <span class="n">MSD_</span><span class="p">)</span>
<span class="n">D_grid</span> <span class="o">=</span> <span class="n">MSD_grid</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">Delta_grid</span><span class="p">)</span>
<span class="n">D_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-4</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="c1"># start with the plot of subject 1.</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># first plot the background</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Delta_</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">1e5</span> <span class="o">*</span> <span class="n">MSD_</span><span class="p">,</span> <span class="n">D_grid</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">D_levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># plot the test-retest mean MSD and standard deviation of subject 1.</span>
<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">1e5</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">msds</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;dashdot&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MSD Test&quot;</span><span class="p">)</span>
<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">1e5</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">msds</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;dashdot&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MSD Retest&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="c1"># plot some text markers to clarify the background diffusivity lines.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0091</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">6.33</span><span class="p">,</span> <span class="s2">&quot;D=14e-4&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0091</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">4.55</span><span class="p">,</span> <span class="s2">&quot;D=10e-4&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.009</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">0.0185</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Test-Retest MSD(:math:`\tau`) Subject 1&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Diffusion Time (ms)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;MSD (:math:`10^{-5}mm^2`)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

<span class="c1"># then do the same thing for subject 2.</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Delta_</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">1e5</span> <span class="o">*</span> <span class="n">MSD_</span><span class="p">,</span> <span class="n">D_grid</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">D_levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Free Diffusivity (:math:`mm^2/s`)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">1e5</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">msds</span></a><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;dashdot&quot;</span><span class="p">)</span>
<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">1e5</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">msds</span></a><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;dashdot&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.009</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">0.0185</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Diffusion Time (ms)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Test-Retest MSD(:math:`\tau`) Subject 2&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;qt_indices_msd.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_reconst_qtdmri_003.png" srcset="../../_images/sphx_glr_reconst_qtdmri_003.png" alt="reconst qtdmri" class = "sphx-glr-single-img"/><p class="centered small fst-italic fw-semibold">You can see that the MSD in both subjects increases over time, but also
slowly levels off as time progresses. This makes sense as diffusing particles
are becoming more restricted by surrounding tissue as time goes on. You can
also see that for Subject 1 the index trends nearly perfectly overlap, but
for subject 2 they are slightly off, which is also what we found in the
paper.</p>
<p>Next, we follow the same procedure to estimate the test-retest RTAP, RTOP and
RTPP over diffusion time for both subject. For ease of comparison, we will
estimate all three in the same unit [1/mm] by taking the square root of RTAP
and the cubed root of RTOP.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Again, first we define the data for the background illustration.</span>
<span class="n">Delta_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">RTXP_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Delta_grid</span><span class="p">,</span> <span class="n">RTXP_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">Delta_</span><span class="p">,</span> <span class="n">RTXP_</span><span class="p">)</span>
<span class="n">D_grid</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">RTXP_grid</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">*</span> <span class="n">Delta_grid</span><span class="p">)</span>
<span class="n">D_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-4</span>
<span class="n">D_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># We start with estimating the RTOP illustration.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Delta_</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">RTXP_</span><span class="p">,</span> <span class="n">D_grid</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">D_colors</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">D_levels</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plot_mean_with_std</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtops</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RTOP:math:`^{1/3}` Test&quot;</span>
<span class="p">)</span>
<span class="n">plot_mean_with_std</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtops</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">),</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RTOP:math:`^{1/3}` Retest&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0091</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="s2">&quot;D=3e-4&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">22</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0091</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="s2">&quot;D=4e-4&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0091</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="s2">&quot;D=6e-4&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">54</span><span class="p">,</span> <span class="mi">170</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.009</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">0.0185</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Test-Retest RTOP(:math:`\tau`) Subject 1&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Diffusion Time (ms)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;RTOP:math:`^{1/3}` (1/mm)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Delta_</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">RTXP_</span><span class="p">,</span> <span class="n">D_grid</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">D_colors</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">D_levels</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Free Diffusivity (:math:`mm^2/s`)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtops</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtops</span></a><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">),</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">54</span><span class="p">,</span> <span class="mi">170</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.009</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">0.0185</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Diffusion Time (ms)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Test-Retest RTOP(:math:`\tau`) Subject 2&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;qt_indices_rtop.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_reconst_qtdmri_004.png" srcset="../../_images/sphx_glr_reconst_qtdmri_004.png" alt="reconst qtdmri" class = "sphx-glr-single-img"/><p class="centered small fst-italic fw-semibold">Similarly as MSD, the RTOP is related to the restriction that particles are
experiencing and is also rotationally invariant. RTOP is defined as the
probability that particles are found at the same position at the time of
both gradient pulses. As time increases, the odds become smaller that a
particle will arrive at the same position it left, which is illustrated by
all RTOP trends in the figure. Notice that the estimated RTOP trends decrease
less fast than free diffusion, meaning that particles experience restriction
over time. Also notice that the RTOP trends in both subjects nearly
perfectly overlap.</p>
<p>Next, we estimate two directional <span class="math notranslate nohighlight">\(q\tau\)</span>-indices, RTAP and RTPP,
describing particle restriction perpendicular and parallel to the
orientation of the principal diffusivity in that voxel. If the voxel
describes coherent white matter (which it does in our corpus callosum
example), then they describe properties related to restriction
perpendicular and parallel to the axon bundles.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, we estimate the RTAP trends.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Delta_</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">RTXP_</span><span class="p">,</span> <span class="n">D_grid</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">D_colors</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">D_levels</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plot_mean_with_std</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtaps</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RTAP:math:`^{1/2}` Test&quot;</span>
<span class="p">)</span>
<span class="n">plot_mean_with_std</span><span class="p">(</span>
    <span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtaps</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RTAP:math:`^{1/2}` Retest&quot;</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0091</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="s2">&quot;D=3e-4&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">22</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0091</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="s2">&quot;D=4e-4&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0091</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="s2">&quot;D=6e-4&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">54</span><span class="p">,</span> <span class="mi">170</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.009</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">0.0185</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Test-Retest RTAP(:math:`\tau`) Subject 1&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Diffusion Time (ms)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;RTAP:math:`^{1/2}` (1/mm)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Delta_</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">RTXP_</span><span class="p">,</span> <span class="n">D_grid</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">D_colors</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">D_levels</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Free Diffusivity (:math:`mm^2/s`)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtaps</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtaps</span></a><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">54</span><span class="p">,</span> <span class="mi">170</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.009</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">0.0185</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Diffusion Time (ms)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Test-Retest RTAP(:math:`\tau`) Subject 2&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;qt_indices_rtap.png&quot;</span><span class="p">)</span>


<span class="c1"># Finally the last one for RTPP.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Delta_</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">RTXP_</span><span class="p">,</span> <span class="n">D_grid</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">D_colors</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">D_levels</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtpps</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RTPP Test&quot;</span><span class="p">)</span>
<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtpps</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RTPP Retest&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0091</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="s2">&quot;D=6e-4&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0091</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="s2">&quot;D=9e-4&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.0091</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="s2">&quot;D=15e-4&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">54</span><span class="p">,</span> <span class="mi">170</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.009</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">0.0185</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Test-Retest RTPP(:math:`\tau`) Subject 1&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Diffusion Time (ms)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;RTPP (1/mm)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">Delta_</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">RTXP_</span><span class="p">,</span> <span class="n">D_grid</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">D_colors</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">D_levels</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Free Diffusivity (:math:`mm^2/s`)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtpps</span></a><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">plot_mean_with_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">taus</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rtpps</span></a><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">54</span><span class="p">,</span> <span class="mi">170</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.009</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">0.0185</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Diffusion Time (ms)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Test-Retest RTPP(:math:`\tau`) Subject 2&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;qt_indices_rtpp.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../_images/sphx_glr_reconst_qtdmri_005.png" srcset="../../_images/sphx_glr_reconst_qtdmri_005.png" alt="reconst qtdmri" class = "sphx-glr-multi-img"/></li>
<li><img src="../../_images/sphx_glr_reconst_qtdmri_006.png" srcset="../../_images/sphx_glr_reconst_qtdmri_006.png" alt="reconst qtdmri" class = "sphx-glr-multi-img"/></li>
</ul>
<p class="centered small fst-italic fw-semibold">As those of RTOP, the trends in RTAP and RTPP also decrease over time. It can
be seen that RTAP:math:<cite>^{1/2}</cite> is always bigger than RTPP, which makes sense as
particles in coherent white matter experience more restriction perpendicular
to the white matter orientation than parallel to it. Again, in both subjects
the test-retest RTAP and RTPP is nearly perfectly consistent.
Aside from the estimation of <span class="math notranslate nohighlight">\(q\tau\)</span>-space indices, <span class="math notranslate nohighlight">\(q\tau\)</span>-dMRI
also allows for the estimation of time-dependent ODFs. Once the Qtdmri model
is fitted it can be simply called by qtdmri_fit.odf(sphere,
s=sharpening_factor). This is identical to how the mapmri module functions,
and allows one to study the time-dependence of ODF directionality.</p>
<p>This concludes the example on qt-dMRI. As we showed, approaches such as
qt-dMRI can help in studying the (finite-<span class="math notranslate nohighlight">\(\tau\)</span>) temporal properties
of diffusion in biological tissues. Differences in <span class="math notranslate nohighlight">\(q\tau\)</span>-index trends
could be indicative of underlying structural differences that affect the
time-dependence of the diffusion process.</p>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div class="docutils container" id="id6">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-fick2018" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id3">2</a>,<a role="doc-backlink" href="#id5">3</a>)</span>
<p>Rutger H. J. Fick, Alexandra Petiet, Mathieu Santin, Anne-Charlotte Philippe, Stephane Lehericy, Rachid Deriche, and Demian Wassermann. Non-parametric graphnet-regularized representation of dMRI in space and time. <em>Medical Image Analysis</em>, 43:37–53, 2018. URL: <a class="reference external" href="https://doi.org/10.1016/j.media.2017.09.002">https://doi.org/10.1016/j.media.2017.09.002</a>, <a class="reference external" href="https://doi.org/10.1016/j.media.2017.09.002">doi:10.1016/j.media.2017.09.002</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-ozarslan2013" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Evren Özarslan, Cheng Guan Koay, Timothy M. Shepherd, Michal E. Komlosh, M. Okan İrfanoǧlu, Carlo Pierpaoli, and Peter J. Basser. Mean apparent propagator (MAP) MRI: A novel diffusion imaging method for mapping tissue microstructure. <em>NeuroImage</em>, 78:16–32, 2013. URL: <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2013.04.016">https://doi.org/10.1016/j.neuroimage.2013.04.016</a>, <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2013.04.016">doi:10.1016/j.neuroimage.2013.04.016</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-wassermann2017" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">3</a><span class="fn-bracket">]</span></span>
<p>Demian Wassermann, Mathieu Santin, Anne-Charlotte Philippe, Rutger Fick, Rachid Deriche, Stephane Lehericy, and Alexandra Petiet. Test-Retest qt-dMRI datasets for Non-Parametric GraphNet-Regularized Representation of dMRI in Space and Time. Zenodo, September 2017. Dataset. URL: <a class="reference external" href="https://zenodo.org/records/996889">https://zenodo.org/records/996889</a>, <a class="reference external" href="https://doi.org/10.5281/zenodo.996889">doi:10.5281/zenodo.996889</a>.</p>
</aside>
</aside>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (5 minutes 52.755 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-built-reconstruction-reconst-qtdmri-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/1af02520a79f9d26dac286b6fa0b5ab8/reconst_qtdmri.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">reconst_qtdmri.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/fbb7c917b00bdaed49a9aa07823200c7/reconst_qtdmri.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">reconst_qtdmri.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/81d1cdec61ad421e49259e9483027db7/reconst_qtdmri.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">reconst_qtdmri.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reconst_rumba.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Reconstruction with Robust and Unbiased Model-BAsed Spherical Deconvolution (RUMBA)</p>
      </div>
    </a>
    <a class="right-next"
       href="../contextual_enhancement/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Contextual Enhancement</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  
<script type="module" src="../../_static/scripts/grg-sphinx-theme.js"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><div>
  <h3 class="footer-heading">
    Never miss an update from us!
  </h3>
  <p class="footer-sub-heading">
    Don't worry! we are not going to spam you.
  </p>
  <div class="input-group mb-3 mar-t-10">
    <input type="text" class="form-control" placeholder="You email" aria-label="You email" id="grg-subscribe-email">
    <div class="input-group-append pointer" onclick="(document.getElementById('grg-subscribe-email').value)">
      <span class="input-group-text subscribe">Subscribe</span>
    </div>
  </div>  
  <ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul>
</div></div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="grid-3">
  
  <div>
    <h5 class="footer-heading">
      About
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://dipy.org/team">
            Developers
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://github.com/dipy/dipy/discussions" target="_blank" rel="noopener noreferrer">
            Support
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../user_guide/installation.html">
            Download
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../user_guide/getting_started.html">
            Get Started
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../index.html">
            Tutorials
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank" rel="noopener noreferrer">
            Videos
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Friends
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/" target="_blank" rel="noopener noreferrer">
            Nipy Projects
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://fury.gl/" target="_blank" rel="noopener noreferrer">
            FURY
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/nibabel" target="_blank" rel="noopener noreferrer">
            Nibabel
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://tortoise.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            Tortoise
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Support
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://engineering.indiana.edu/" target="_blank" rel="noopener noreferrer">
            The department of Intelligent Systems Engineering of Indiana University
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            The National Institute of Biomedical Imaging and Bioengineering, NIH
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://escience.washington.edu" target="_blank" rel="noopener noreferrer">
            The Gordon and Betty Moore Foundation and the Alfred P. Sloan Foundation, through the University of Washington eScience Institute Data Science Environment
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://summerofcode.withgoogle.com/" target="_blank" rel="noopener noreferrer">
            Google supported DIPY through the Google Summer of Code Program (2015-2024)
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
</div></div>
      
    </div>
  
</div>

    <div class="copyright-text">
      <i class="fa-regular fa-copyright"></i> Copyright 2008-2024,DIPY developers. Created using Grg Sphinx Theme and PyData Sphinx Theme.
    </div>
  </footer>
  </body>
</html>