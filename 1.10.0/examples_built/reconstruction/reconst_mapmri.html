
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DIPY &#8212; dipy 1.10.0 documentation</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/dipy.css?v=cedb193d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

  
<link rel="stylesheet" href="../../_static/styles/grg-sphinx-theme.css"/>

    <script src="../../_static/documentation_options.js?v=1d24b1d9"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-D610GKJZRC"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-D610GKJZRC');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples_built/reconstruction/reconst_mapmri';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.dipy.org/dev/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.10.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="icon" href="../../_static/dipy-favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reconstruction with Constrained Spherical Deconvolution model (CSD)" href="reconst_csd.html" />
    <link rel="prev" title="Reconstruction with Multi-Shell Multi-Tissue CSD" href="reconst_mcsd.html" />
  <meta name="keywords" content="DIPY, dMRI, DTI, DSI, diffusion MRI, Tensor,
  neuroimaging, python, neuroscience, Eleftherios, Garyfallidis, tractography,
  streamlines, fiber tracking">

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
<nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
     
  

<a class="navbar-brand logo" href="https://dipy.org">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/dipy-logo.png" class="logo__image only-light" alt="DIPY"/>
    <script>document.write(`<img src="../../_static/dipy-logo.png" class="logo__image only-dark" alt="DIPY"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference/index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

</nav>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  
  <ul class="bd-navbar-elements navbar-nav">
    
          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Docs
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
      <li class="nav-item">
        <a class="nav-link" href="../../index.html">
          Overview
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../index.html">
          Tutorials
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../recipes.html">
          Recipes
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../interfaces/index.html">
          CLI / Workflows
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference/index.html">
          API
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../reference_cmd/index.html">
          CLI API
        </a>
      </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Workshops
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Latest
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2024" target="_blank">
            DIPY Workshop 2024 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Past
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2023" target="_blank">
            DIPY Workshop 2023 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2022" target="_blank">
            DIPY Workshop 2022 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2021" target="_blank">
            DIPY Workshop 2021 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2020" target="_blank">
            DIPY Workshop 2020 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/workshops/dipy-workshop-2019" target="_blank">
            DIPY Workshop 2019 <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    Community
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
    <li class="nav-item">
      <p class="nav-section-title nav-link">
        News
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/calendar">
            Calendar
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://mail.python.org/mailman3/lists/dipy.python.org/" target="_blank">
            Newsletters <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/blog">
            Blog
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank">
            Youtube <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

    <li class="nav-item">
      <p class="nav-section-title nav-link">
        Help
      </p>
    </li>

        <li class="nav-item">
          <a class="nav-link" href="https://app.gitter.im/#/room/%23dipy_dipy:gitter.im" target="_blank">
            Live Chat (Gitter) <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dipy/dipy/discussions" target="_blank">
            Github Discussions <i class="fa-solid fa-arrow-up-long external-icon mar-l-5"></i>
          </a>
        </li>
                </ul>
            </li>
          

          <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-header-nav-more-links">
                    About
                </button>
                <ul id="pst-header-nav-more-links" class="dropdown-menu">
                    
        <li class="nav-item">
          <a class="nav-link" href="https://dipy.org/team">
            Team
          </a>
        </li>

      <li class="nav-item">
        <a class="nav-link" href="../../faq.html">
          FAQ
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../user_guide/mission.html">
          Mission Statement
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../stateoftheart.html">
          Releases
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../cite.html">
          Cite
        </a>
      </li>

      <li class="nav-item">
        <a class="nav-link" href="../../glossary.html">
          Glossary
        </a>
      </li>
                </ul>
            </li>
          
  </ul>
  
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../quick_start/index.html">Quick Start</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../quick_start/quick_start.html">Getting started with DIPY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick_start/tracking_introduction_eudx.html">Introduction to Basic Tracking</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../preprocessing/index.html">Preprocessing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/reslice_datasets.html">Reslice diffusion datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/motion_correction.html">Between-volumes Motion Correction on DWI datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/piesno.html">Noise estimation using PIESNO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_nlmeans.html">Denoise images using Non-Local Means (NLMEANS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/brain_extraction_dwi.html">Brain segmentation with median_otsu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_patch2self.html">Patch2Self: Self-Supervised Denoising via Statistical Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_localpca.html">Denoise images using Local PCA via empirical thresholds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/gradients_spheres.html">Gradients and Spheres</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_ascm.html">Denoise images using Adaptive Soft Coefficient Matching (ASCM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/snr_in_cc.html">SNR estimation for Diffusion-Weighted Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_mppca.html">Denoise images using the Marcenko-Pastur PCA algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/denoise_gibbs.html">Suppress Gibbs oscillations</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Reconstruction</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="reconst_qtiplus.html">Applying positivity constraints to Q-space Trajectory Imaging (QTI+)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dsi.html">Reconstruct with Diffusion Spectrum Imaging (DSI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_cti.html">Reconstruction of the diffusion signal with the correlation tensor model (CTI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dsid.html">DSI Deconvolution (DSID) vs DSI</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_shore_metrics.html">Calculate SHORE scalar maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_gqi.html">Reconstruct with Generalized Q-Sampling Imaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_shore.html">Continuous and analytical diffusion signal modelling with 3D-SHORE</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_csa.html">Reconstruct with Constant Solid Angle (Q-Ball)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_sfm.html">Reconstruction with the Sparse Fascicle Model (SFM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dsi_metrics.html">Calculate DSI-based scalar maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dki.html">Reconstruction of the diffusion signal with the kurtosis tensor model (DKI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_qti.html">Reconstruct with Q-space Trajectory Imaging (QTI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dti.html">Reconstruction of the diffusion signal with DTI (single tensor) model</a></li>
<li class="toctree-l2"><a class="reference internal" href="kfold_xval.html">K-fold cross-validation for model comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_forecast.html">Crossing invariant fiber response function with FORECAST model</a></li>
<li class="toctree-l2"><a class="reference internal" href="histology_resdnn.html">Local reconstruction using the Histological ResDNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_dki_micro.html">Reconstruction of the diffusion signal with the WMTI model (DKI-MICRO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="restore_dti.html">Using the RESTORE algorithm for robust tensor fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_fwdti.html">Using the free water elimination model to remove DTI free water contamination</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_sh.html">Signal Reconstruction Using Spherical Harmonics</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_mcsd.html">Reconstruction with Multi-Shell Multi-Tissue CSD</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Continuous and analytical diffusion signal modelling with MAP-MRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_csd.html">Reconstruction with Constrained Spherical Deconvolution model (CSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_ivim.html">Intravoxel incoherent motion (IVIM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_bingham.html">Reconstruction of Bingham Functions from ODFs</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_msdki.html">Mean signal diffusion kurtosis imaging (MSDKI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_rumba.html">Reconstruction with Robust and Unbiased Model-BAsed Spherical Deconvolution (RUMBA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reconst_qtdmri.html">Estimating diffusion time dependent q-space indices using qt-dMRI</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contextual_enhancement/index.html">Contextual Enhancement</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../contextual_enhancement/contextual_enhancement.html">Crossing-preserving contextual enhancement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contextual_enhancement/fiber_to_bundle_coherence.html">Fiber to bundle coherence measures</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fiber_tracking/index.html">Fiber Tracking</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/surface_seed.html">Surface seeding for tractography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_deterministic.html">An introduction to the Deterministic Maximum Direction Getter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_ptt.html">Parallel Transport Tractography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_bootstrap_peaks.html">Bootstrap and Closest Peak Direction Getters Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_sfm.html">Tracking with the Sparse Fascicle Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_rumba.html">Tracking with Robust Unbiased Model-BAsed Spherical Deconvolution (RUMBA-SD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_introduction_eudx_1.html">Introduction to Basic Tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_pft.html">Particle Filtering Tractography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_probabilistic.html">An introduction to the Probabilistic Direction Getter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/linear_fascicle_evaluation.html">Linear fascicle evaluation (LiFE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fiber_tracking/tracking_stopping_criterion.html">Using Various Stopping Criterion for Tractography</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../streamline_analysis/index.html">Streamlines Analysis and Connectivity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/bundle_shape_similarity.html">BUAN Bundle Shape Similarity Score</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/bundle_assignment_maps.html">BUAN Bundle Assignment Maps Creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/afq_tract_profiles.html">Extracting AFQ tract profiles from segmented bundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/cluster_confidence.html">Calculation of Outliers with Cluster Confidence Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/streamline_length.html">Streamline length and size reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/path_length_map.html">Calculate Path Length Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streamline_analysis/streamline_tools.html">Connectivity Matrices, ROI Intersections and Density Maps</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../registration/index.html">Registration</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../registration/bundle_group_registration.html">Groupwise Bundle Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/bundle_registration.html">Direct Bundle Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/register_binary_fuzzy.html">Diffeomorphic Registration with binary and fuzzy images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/syn_registration_3d.html">Symmetric Diffeomorphic Registration in 3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/syn_registration_2d.html">Symmetric Diffeomorphic Registration in 2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/bundlewarp_registration.html">Nonrigid Bundle Registration with BundleWarp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/streamline_registration.html">Applying image-based deformations to streamlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/affine_registration_masks.html">Affine Registration with Masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/affine_registration_3d.html">Affine Registration in 3D</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../segmentation/index.html">Segmentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/brain_extraction_dwi_1.html">Brain segmentation with median_otsu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_quickbundles.html">Tractography Clustering with QuickBundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/tissue_classification.html">Tissue Classification of a T1-weighted Structural Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_clustering_metrics.html">Tractography Clustering - Available Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/fast_streamline_search.html">Fast Streamline Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_extending_clustering_framework.html">Enhancing QuickBundles with different metrics and features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/segment_clustering_features.html">Tractography Clustering - Available Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/bundle_extraction.html">Automatic Fiber Bundle Extraction with RecoBundles</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../simulations/index.html">Simulation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../simulations/reconst_dsid_1.html">DSI Deconvolution (DSID) vs DSI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/simulate_dki.html">DKI MultiTensor Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulations/simulate_multi_tensor.html">MultiTensor Simulation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../multiprocessing/index.html">Multiprocessing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../multiprocessing/reconst_csa_parallel.html">Parallel reconstruction using Q-Ball</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multiprocessing/reconst_csd_parallel.html">Parallel reconstruction using CSD</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../file_formats/index.html">File Formats</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../file_formats/streamline_formats.html">Read/Write streamline files</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualization/index.html">Visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_roi_contour.html">Visualization of ROI Surface Rendered with Streamlines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_bundles.html">Visualize bundles and metrics on bundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_slice.html">Simple volume slicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz_advanced.html">Advanced interactive visualization</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../workflows/index.html">Workflows</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../workflows/workflow_creation.html">Creating a new workflow.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workflows/combined_workflow_creation.html">Creating a new combined workflow</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Reconstruction</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">DIPY</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-built-reconstruction-reconst-mapmri-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="continuous-and-analytical-diffusion-signal-modelling-with-map-mri">
<span id="sphx-glr-examples-built-reconstruction-reconst-mapmri-py"></span><h1>Continuous and analytical diffusion signal modelling with MAP-MRI<a class="headerlink" href="#continuous-and-analytical-diffusion-signal-modelling-with-map-mri" title="Link to this heading">#</a></h1>
<p>We show how to model the diffusion signal as a linear combination of continuous
functions from the MAP-MRI basis <a class="footnote-reference brackets" href="#footcite-ozarslan2013" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. This continuous
representation allows for the computation of many properties of both the signal
and diffusion propagator.</p>
<p>We show how to estimate the analytical orientation distribution function (ODF)
and a variety of scalar indices. These include rotationally invariant
quantities such as the mean squared displacement (MSD), Q-space inverse
variance (QIV), teturn-to-origin probability (RTOP) and non-Gaussianity (NG).
Interestingly, the MAP-MRI basis also allows for the computation of directional
indices, such as the return-to-axis probability (RTAP), the return-to-plane
probability (RTPP), and the parallel and perpendicular non-Gaussianity.</p>
<p>The estimation of these properties from noisy and sparse DWIs requires that the
fitting of the MAP-MRI basis is constrained and/or regularized. This can be
done by constraining the diffusion propagator to positive values
<a class="footnote-reference brackets" href="#footcite-ozarslan2013" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, <a class="footnote-reference brackets" href="#footcite-delahaije2020" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>, and through analytic
Laplacian regularization (MAPL) <a class="footnote-reference brackets" href="#footcite-fick2016b" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<p>First import the necessary modules:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dipy.core.gradients</span> <span class="kn">import</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.gradient_table" title="dipy.core.gradients.gradient_table" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-function"><span class="n">gradient_table</span></a>
<span class="kn">from</span> <span class="nn">dipy.data</span> <span class="kn">import</span> <span class="n">get_fnames</span><span class="p">,</span> <a href="../../reference/dipy.data.html#dipy.data.get_sphere" title="dipy.data.get_sphere" class="sphx-glr-backref-module-dipy-data sphx-glr-backref-type-py-function"><span class="n">get_sphere</span></a>
<span class="kn">from</span> <span class="nn">dipy.io.gradients</span> <span class="kn">import</span> <span class="n">read_bvals_bvecs</span>
<span class="kn">from</span> <span class="nn">dipy.io.image</span> <span class="kn">import</span> <a href="../../reference/dipy.io.html#dipy.io.image.load_nifti" title="dipy.io.image.load_nifti" class="sphx-glr-backref-module-dipy-io-image sphx-glr-backref-type-py-function"><span class="n">load_nifti</span></a>
<span class="kn">from</span> <span class="nn">dipy.reconst</span> <span class="kn">import</span> <span class="n">mapmri</span>
<span class="kn">from</span> <span class="nn">dipy.viz</span> <span class="kn">import</span> <span class="n">actor</span><span class="p">,</span> <span class="n">window</span>
<span class="kn">from</span> <span class="nn">dipy.viz.plotting</span> <span class="kn">import</span> <a href="../../reference/dipy.viz.html#dipy.viz.plotting.compare_maps" title="dipy.viz.plotting.compare_maps" class="sphx-glr-backref-module-dipy-viz-plotting sphx-glr-backref-type-py-function"><span class="n">compare_maps</span></a>
</pre></div>
</div>
<p>Download and read the data for this tutorial.</p>
<p>MAP-MRI requires multi-shell data, to properly fit the radial part of the
basis. The total size of the downloaded data is 187.66 MBytes, however you
only need to fetch it once.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fraw</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fbval</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fbvec</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t1_fname</span></a> <span class="o">=</span> <span class="n">get_fnames</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;cfin_multib&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">data</span></code> contains the voxel data and <code class="docutils literal notranslate"><span class="pre">gtab</span></code> contains a <code class="docutils literal notranslate"><span class="pre">GradientTable</span></code>
object (gradient information e.g. b-values). For example, to show the
b-values it is possible to write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a><span class="o">.</span><span class="n">bvals</span><span class="p">)</span>
</pre></div>
</div>
<p>For the values of the q-space indices to make sense it is necessary to
explicitly state the <code class="docutils literal notranslate"><span class="pre">big_delta</span></code> and <code class="docutils literal notranslate"><span class="pre">small_delta</span></code> parameters in the
gradient table.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">,</span> <span class="n">affine</span> <span class="o">=</span> <a href="../../reference/dipy.io.html#dipy.io.image.load_nifti" title="dipy.io.image.load_nifti" class="sphx-glr-backref-module-dipy-io-image sphx-glr-backref-type-py-function"><span class="n">load_nifti</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fraw</span></a><span class="p">)</span>
<span class="n">bvals</span><span class="p">,</span> <span class="n">bvecs</span> <span class="o">=</span> <span class="n">read_bvals_bvecs</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fbval</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fbvec</span></a><span class="p">)</span>
<a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a> <span class="o">=</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.gradient_table" title="dipy.core.gradients.gradient_table" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-function"><span class="n">gradient_table</span></a><span class="p">(</span><span class="n">bvals</span><span class="p">,</span> <span class="n">bvecs</span><span class="o">=</span><span class="n">bvecs</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">big_delta</span></a> <span class="o">=</span> <span class="mf">0.0365</span>  <span class="c1"># seconds</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">small_delta</span></a> <span class="o">=</span> <span class="mf">0.0157</span>  <span class="c1"># seconds</span>
<a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a> <span class="o">=</span> <a href="../../reference/dipy.core.html#dipy.core.gradients.gradient_table" title="dipy.core.gradients.gradient_table" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-function"><span class="n">gradient_table</span></a><span class="p">(</span>
    <span class="n">bvals</span><span class="o">=</span><a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a><span class="o">.</span><span class="n">bvals</span><span class="p">,</span> <span class="n">bvecs</span><span class="o">=</span><a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a><span class="o">.</span><span class="n">bvecs</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">big_delta</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">big_delta</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">small_delta</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">small_delta</span></a>
<span class="p">)</span>

<span class="n">data_small</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">40</span><span class="p">:</span><span class="mi">65</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span><span class="mi">51</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;data.shape </span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">shape</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>data.shape (96, 96, 19, 496)
</pre></div>
</div>
<p>The MAP-MRI Model can now be instantiated. The <code class="docutils literal notranslate"><span class="pre">radial_order</span></code> determines
the expansion order of the basis, i.e., how many basis functions are used to
approximate the signal.</p>
<p>First, we must decide to use the anisotropic or isotropic MAP-MRI basis. As
was shown in <a class="footnote-reference brackets" href="#footcite-fick2016b" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>, the isotropic basis is best used for
tractography purposes, as the anisotropic basis has a bias towards smaller
crossing angles in the ODF. For signal fitting and estimation of scalar
quantities the anisotropic basis is suggested. The choice can be made by
setting <code class="docutils literal notranslate"><span class="pre">anisotropic_scaling=True</span></code> or <code class="docutils literal notranslate"><span class="pre">anisotropic_scaling=False</span></code>.</p>
<p>First, we must select the method of regularization and/or constraining the
basis fitting.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">laplacian_regularization=True</span></code> makes it use Laplacian regularization
<a class="footnote-reference brackets" href="#footcite-fick2016b" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>. This method essentially reduces spurious
oscillations in the reconstruction by minimizing the Laplacian of the fitted
signal. Several options can be given to select the regularization weight:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">regularization_weighting=GCV</span></code> uses generalized cross-validation
<a class="footnote-reference brackets" href="#footcite-craven1979" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> to find an optimal weight.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regularization_weighting=0.2</span></code> for example would omit the GCV and
just set it to 0.2 (found to be reasonable in HCP data
<a class="footnote-reference brackets" href="#footcite-fick2016b" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regularization_weighting=np.array(weights)</span></code> would make the GCV use
a custom range to find an optimal weight.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">positivity_constraint=True</span></code> makes it use a positivity constraint on the
diffusion propagator. This method constrains the final solution of the
diffusion propagator to be positive either globally
<a class="footnote-reference brackets" href="#footcite-delahaije2020" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> or at a set of discrete points
<a class="footnote-reference brackets" href="#footcite-ozarslan2013" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, since negative values should not exist.</p>
<blockquote>
<div><ul class="simple">
<li><p>Setting <code class="docutils literal notranslate"><span class="pre">global_constraints=True</span></code> enforces positivity everywhere.
With the setting <code class="docutils literal notranslate"><span class="pre">global_constraints=False</span></code> positivity is enforced on
a grid determined by <code class="docutils literal notranslate"><span class="pre">pos_grid</span></code> and <code class="docutils literal notranslate"><span class="pre">pos_radius</span></code>.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>Both methods do a good job of producing viable solutions to the signal
fitting in practice. The difference is that the Laplacian regularization
imposes smoothness over the entire signal, including the extrapolation
beyond the measured signal. In practice this may result in, but does not
guarantee, positive solutions of the diffusion propagator. The positivity
constraint guarantees a positive solution which in general results in smooth
solutions, but does not guarantee it.</p>
<p>A suggested strategy is to use a low Laplacian weight together with a
positivity constraint. In this way both desired properties are guaranteed
in final solution. Higher Laplacian weights are recommended when the data is
very noisy.</p>
<p>We use the package CVXPY (<a class="reference external" href="https://www.cvxpy.org/">https://www.cvxpy.org/</a>) to solve convex
optimization problems when <code class="docutils literal notranslate"><span class="pre">positivity_constraint=True</span></code>, so we need to
first install CVXPY. When using <code class="docutils literal notranslate"><span class="pre">global_constraints=True</span></code> to ensure
global positivity, it is recommended to use the MOSEK solver
(<a class="reference external" href="https://www.mosek.com/">https://www.mosek.com/</a>) together with CVXPY by setting
<code class="docutils literal notranslate"><span class="pre">cvxpy_solver='MOSEK'</span></code>. Different solvers can differ greatly in
terms of runtime and solution accuracy, and in some cases solvers may show
warnings about convergence or recommended option settings.</p>
<p>For now we will generate the anisotropic models for different combinations.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a> <span class="o">=</span> <span class="mi">6</span>

<a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">map_model_laplacian_aniso</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class"><span class="n">mapmri</span><span class="o">.</span><span class="n">MapmriModel</span></a><span class="p">(</span>
    <a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="p">,</span>
    <span class="n">laplacian_regularization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">laplacian_weighting</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<span class="p">)</span>

<a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">map_model_positivity_aniso</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class"><span class="n">mapmri</span><span class="o">.</span><span class="n">MapmriModel</span></a><span class="p">(</span>
    <a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="p">,</span>
    <span class="n">laplacian_regularization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">positivity_constraint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">map_model_both_aniso</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class"><span class="n">mapmri</span><span class="o">.</span><span class="n">MapmriModel</span></a><span class="p">(</span>
    <a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="p">,</span>
    <span class="n">laplacian_regularization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">laplacian_weighting</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">positivity_constraint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">map_model_plus_aniso</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class"><span class="n">mapmri</span><span class="o">.</span><span class="n">MapmriModel</span></a><span class="p">(</span>
    <a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="p">,</span>
    <span class="n">laplacian_regularization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">positivity_constraint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">global_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that when we use only Laplacian regularization, the <code class="docutils literal notranslate"><span class="pre">GCV</span></code> option may
select very low regularization weights in very anisotropic white matter such
as the corpus callosum, resulting in corrupted scalar indices. In this
example we therefore choose a preset value of 0.2, which was shown to be
quite robust and also faster in practice <a class="footnote-reference brackets" href="#footcite-fick2016b" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<p>We can then fit the MAP-MRI model to the data:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_laplacian_aniso</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel.fit" title="dipy.reconst.mapmri.MapmriModel.fit" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-method"><span class="n">map_model_laplacian_aniso</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">data_small</span><span class="p">)</span>
<a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_positivity_aniso</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel.fit" title="dipy.reconst.mapmri.MapmriModel.fit" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-method"><span class="n">map_model_positivity_aniso</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">data_small</span><span class="p">)</span>
<a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_both_aniso</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel.fit" title="dipy.reconst.mapmri.MapmriModel.fit" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-method"><span class="n">map_model_both_aniso</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">data_small</span><span class="p">)</span>
<a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_plus_aniso</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel.fit" title="dipy.reconst.mapmri.MapmriModel.fit" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-method"><span class="n">map_model_plus_aniso</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">data_small</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fits</span></a> <span class="o">=</span> <span class="p">[</span>
    <a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_laplacian_aniso</span></a><span class="p">,</span>
    <a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_positivity_aniso</span></a><span class="p">,</span>
    <a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_both_aniso</span></a><span class="p">,</span>
    <a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_plus_aniso</span></a><span class="p">,</span>
<span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MAPL&quot;</span><span class="p">,</span> <span class="s2">&quot;CMAP&quot;</span><span class="p">,</span> <span class="s2">&quot;CMAPL&quot;</span><span class="p">,</span> <span class="s2">&quot;MAP+&quot;</span><span class="p">]</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/opt/homebrew/Caskroom/miniforge/base/envs/py312-test/lib/python3.12/site-packages/cvxpy/problems/problem.py:1481: UserWarning: Solution may be inaccurate. Try another solver, adjusting the solver settings, or solve with verbose=True for more information.
  warnings.warn(
</pre></div>
</div>
<p>From the fitted models we will first illustrate the estimation of q-space
indices. We will compare the estimation using only Laplacian regularization
(MAPL), using only the global positivity constraint (MAP+), using only
positivity in discrete points (CMAP), or using both Laplacian regularization
and positivity in discrete points (CMAPL). We first show the RTOP
<a class="footnote-reference brackets" href="#footcite-ozarslan2013" id="id12" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../reference/dipy.viz.html#dipy.viz.plotting.compare_maps" title="dipy.viz.plotting.compare_maps" class="sphx-glr-backref-module-dipy-viz-plotting sphx-glr-backref-type-py-function"><span class="n">compare_maps</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fits</span></a><span class="p">,</span>
    <span class="n">maps</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rtop&quot;</span><span class="p">],</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a><span class="p">,</span>
    <span class="n">map_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;RTOP&quot;</span><span class="p">],</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;MAPMRI_rtop.png&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_reconst_mapmri_001.png" srcset="../../_images/sphx_glr_reconst_mapmri_001.png" alt="reconst mapmri" class = "sphx-glr-single-img"/><p class="centered small fst-italic fw-semibold">It can be seen that all maps appear quite smooth and similar, although it is
clear that the global positivity constraints provide smoother maps than the
discrete constraints. Higher Laplacian weights also produce smoother maps,
but tend to suppress the estimated RTOP values. The similarity and
differences in reconstruction can be further illustrated by visualizing the
analytic norm of the Laplacian of the fitted signal.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../reference/dipy.viz.html#dipy.viz.plotting.compare_maps" title="dipy.viz.plotting.compare_maps" class="sphx-glr-backref-module-dipy-viz-plotting sphx-glr-backref-type-py-function"><span class="n">compare_maps</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fits</span></a><span class="p">,</span>
    <span class="n">maps</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;norm_of_laplacian_signal&quot;</span><span class="p">],</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a><span class="p">,</span>
    <span class="n">map_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Norm of Laplacian&quot;</span><span class="p">],</span>
    <span class="n">map_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;MAPMRI_norm_laplacian.png&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_reconst_mapmri_002.png" srcset="../../_images/sphx_glr_reconst_mapmri_002.png" alt="reconst mapmri" class = "sphx-glr-single-img"/><p class="centered small fst-italic fw-semibold">A high Laplacian norm indicates that the gradient in the three-dimensional
signal reconstruction changes a lot – something that may indicate spurious
oscillations. In the Laplacian reconstruction (left) we see that there are
some isolated voxels that have a higher norm than the rest. In the positivity
constrained reconstruction the norm is already smoother. When both methods
are used together the overall norm gets smoother still, since both smoothness
of the signal and positivity of the propagator are imposed.</p>
<p>From now on we will just use the combined approach and the globally
constrained approach, show all maps we can generate, and explain their
significance.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fits</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fits</span></a><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>

<a href="../../reference/dipy.viz.html#dipy.viz.plotting.compare_maps" title="dipy.viz.plotting.compare_maps" class="sphx-glr-backref-module-dipy-viz-plotting sphx-glr-backref-type-py-function"><span class="n">compare_maps</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fits</span></a><span class="p">,</span>
    <span class="n">maps</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;msd&quot;</span><span class="p">,</span> <span class="s2">&quot;qiv&quot;</span><span class="p">,</span> <span class="s2">&quot;rtop&quot;</span><span class="p">,</span> <span class="s2">&quot;rtap&quot;</span><span class="p">,</span> <span class="s2">&quot;rtpp&quot;</span><span class="p">],</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a><span class="p">,</span>
    <span class="n">map_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MSD&quot;</span><span class="p">,</span> <span class="s2">&quot;QIV&quot;</span><span class="p">,</span> <span class="s2">&quot;RTOP&quot;</span><span class="p">,</span> <span class="s2">&quot;RTAP&quot;</span><span class="p">,</span> <span class="s2">&quot;RTPP&quot;</span><span class="p">],</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;MAPMRI_maps.png&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_reconst_mapmri_003.png" srcset="../../_images/sphx_glr_reconst_mapmri_003.png" alt="reconst mapmri" class = "sphx-glr-single-img"/><p class="centered small fst-italic fw-semibold">From left to right:</p>
<ul class="simple">
<li><p>Mean squared displacement (MSD) is a measure for how far protons are able
to diffuse. a decrease in MSD indicates protons are hindered/restricted
more, as can be seen by the high MSD in the CSF, but low in the white
matter.</p></li>
<li><p>Q-space Inverse Variance (QIV) is a measure of variance in the signal,
which is said to have higher contrast to white matter than the MSD
<a class="footnote-reference brackets" href="#footcite-hosseinbor2013" id="id13" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>. QIV has also been shown to have high
sensitivity to tissue composition change in a simulation study
<a class="footnote-reference brackets" href="#footcite-fick2016a" id="id14" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>.</p></li>
<li><p>Return-to-origin probability (RTOP) quantifies the probability that a
proton will be at the same position at the first and second diffusion
gradient pulse. A higher RTOP indicates that the volume a spin is inside
of is smaller, meaning more overall restriction. This is illustrated by
the low values in CSF and high values in white matter.</p></li>
<li><p>Return-to-axis probability (RTAP) is a directional index that quantifies
the probability that a proton will be along the axis of the main
eigenvector of a diffusion tensor during both diffusion gradient pulses.
RTAP has been related to the apparent axon diameter
<a class="footnote-reference brackets" href="#footcite-ozarslan2013" id="id15" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, <a class="footnote-reference brackets" href="#footcite-fick2016b" id="id16" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> under several strong
assumptions on the tissue composition and acquisition protocol.</p></li>
<li><p>Return-to-plane probability (RTPP) is a directional index that quantifies
the probability that a proton will be on the plane perpendicular to the
main eigenvector of a diffusion tensor during both gradient pulses. RTPP
is related to the length of a pore <a class="footnote-reference brackets" href="#footcite-ozarslan2013" id="id17" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> but in
practice should be similar to that of Gaussian diffusion.</p></li>
</ul>
<p>It is also possible to estimate the amount of non-Gaussian diffusion in every
voxel <a class="footnote-reference brackets" href="#footcite-ozarslan2013" id="id18" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. This quantity is estimated through the ratio
between Gaussian volume (MAP-MRI’s first basis function) and the non-Gaussian
volume (all other basis functions) of the fitted signal. For this value to be
physically meaningful we must use a b-value threshold in the MAP-MRI model.
This threshold makes the scale estimation in MAP-MRI use only samples that
realistically describe Gaussian diffusion, i.e., at low b-values.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">map_model_both_ng</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class"><span class="n">mapmri</span><span class="o">.</span><span class="n">MapmriModel</span></a><span class="p">(</span>
    <a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="p">,</span>
    <span class="n">laplacian_regularization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">laplacian_weighting</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">positivity_constraint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">bval_threshold</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
<span class="p">)</span>

<a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">map_model_plus_ng</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class"><span class="n">mapmri</span><span class="o">.</span><span class="n">MapmriModel</span></a><span class="p">(</span>
    <a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="p">,</span>
    <span class="n">positivity_constraint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">global_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">bval_threshold</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
<span class="p">)</span>

<a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_both_ng</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel.fit" title="dipy.reconst.mapmri.MapmriModel.fit" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-method"><span class="n">map_model_both_ng</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">data_small</span><span class="p">)</span>
<a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_plus_ng</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel.fit" title="dipy.reconst.mapmri.MapmriModel.fit" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-method"><span class="n">map_model_plus_ng</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">data_small</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fits</span></a> <span class="o">=</span> <span class="p">[</span><a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_both_ng</span></a><span class="p">,</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_plus_ng</span></a><span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CMAPL&quot;</span><span class="p">,</span> <span class="s2">&quot;MAP+&quot;</span><span class="p">]</span>

<a href="../../reference/dipy.viz.html#dipy.viz.plotting.compare_maps" title="dipy.viz.plotting.compare_maps" class="sphx-glr-backref-module-dipy-viz-plotting sphx-glr-backref-type-py-function"><span class="n">compare_maps</span></a><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fits</span></a><span class="p">,</span>
    <span class="n">maps</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ng&quot;</span><span class="p">,</span> <span class="s2">&quot;ng_perpendicular&quot;</span><span class="p">,</span> <span class="s2">&quot;ng_parallel&quot;</span><span class="p">],</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fit_labels</span></a><span class="p">,</span>
    <span class="n">map_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;NG&quot;</span><span class="p">,</span> <span class="s2">&quot;NG perpendicular&quot;</span><span class="p">,</span> <span class="s2">&quot;NG parallel&quot;</span><span class="p">],</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;MAPMRI_ng.png&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_reconst_mapmri_004.png" srcset="../../_images/sphx_glr_reconst_mapmri_004.png" alt="reconst mapmri" class = "sphx-glr-single-img"/><p class="centered small fst-italic fw-semibold">On the left we see the overall NG and on the right the directional
perpendicular NG and parallel NG. The NG ranges from 1
(completely non-Gaussian) to 0 (completely Gaussian). The overall NG of a
voxel is always higher or equal than each of its components. It can be seen
that NG has low values in the CSF and higher in the white matter.</p>
<p>Increases or decreases in these values do not point to a specific
microstructural change, but can indicate clues as to what is happening,
similar to fractional anisotropy. An initial simulation study that quantifies
the added value of q-space indices over DTI indices is given in
<a class="footnote-reference brackets" href="#footcite-fick2016a" id="id19" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>.</p>
<p>The MAP-MRI framework also allows for the estimation of orientation
distribution functions (ODFs). We recommend to use the isotropic
implementation for this purpose, as the anisotropic implementation has a bias
towards smaller crossing angles.</p>
<p>For the isotropic basis we recommend to use a <code class="docutils literal notranslate"><span class="pre">radial_order</span></code> of 8, as the
basis needs more generic and needs more basis functions to approximate the
signal.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a> <span class="o">=</span> <span class="mi">8</span>
<a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">map_model_both_iso</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel" title="dipy.reconst.mapmri.MapmriModel" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-class"><span class="n">mapmri</span><span class="o">.</span><span class="n">MapmriModel</span></a><span class="p">(</span>
    <a href="../../reference/dipy.core.html#dipy.core.gradients.GradientTable" title="dipy.core.gradients.GradientTable" class="sphx-glr-backref-module-dipy-core-gradients sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gtab</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">radial_order</span></a><span class="p">,</span>
    <span class="n">laplacian_regularization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">laplacian_weighting</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">positivity_constraint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">anisotropic_scaling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.MultiVoxelFit" title="dipy.reconst.multi_voxel.MultiVoxelFit" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_both_iso</span></a> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.mapmri.MapmriModel.fit" title="dipy.reconst.mapmri.MapmriModel.fit" class="sphx-glr-backref-module-dipy-reconst-mapmri sphx-glr-backref-type-py-method"><span class="n">map_model_both_iso</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">data_small</span><span class="p">)</span>
</pre></div>
</div>
<p>Load an ODF reconstruction sphere.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="../../reference/dipy.core.html#dipy.core.sphere.Sphere" title="dipy.core.sphere.Sphere" class="sphx-glr-backref-module-dipy-core-sphere sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sphere</span></a> <span class="o">=</span> <a href="../../reference/dipy.data.html#dipy.data.get_sphere" title="dipy.data.get_sphere" class="sphx-glr-backref-module-dipy-data sphx-glr-backref-type-py-function"><span class="n">get_sphere</span></a><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;repulsion724&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute the ODFs.</p>
<p>The radial order <code class="docutils literal notranslate"><span class="pre">s</span></code> can be increased to sharpen the results, but it might
also make the ODFs noisier. Always check the results visually.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">odf</span> <span class="o">=</span> <a href="../../reference/dipy.reconst.html#dipy.reconst.multi_voxel.CallableArray" title="dipy.reconst.multi_voxel.CallableArray" class="sphx-glr-backref-module-dipy-reconst-multi_voxel sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mapfit_both_iso</span><span class="o">.</span><span class="n">odf</span></a><span class="p">(</span><a href="../../reference/dipy.core.html#dipy.core.sphere.Sphere" title="dipy.core.sphere.Sphere" class="sphx-glr-backref-module-dipy-core-sphere sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sphere</span></a><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;odf.shape </span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">odf</span><span class="o">.</span><span class="n">shape</span></a><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>odf.shape (25, 1, 19, 724)
</pre></div>
</div>
<p>Display the ODFs.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enables/disables interactive visualization</span>
<a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">interactive</span></a> <span class="o">=</span> <span class="kc">False</span>

<span class="n">scene</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">Scene</span><span class="p">()</span>
<span class="n">sfu</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">odf_slicer</span><span class="p">(</span><span class="n">odf</span><span class="p">,</span> <a href="../../reference/dipy.core.html#dipy.core.sphere.Sphere" title="dipy.core.sphere.Sphere" class="sphx-glr-backref-module-dipy-core-sphere sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sphere</span></a><span class="o">=</span><a href="../../reference/dipy.core.html#dipy.core.sphere.Sphere" title="dipy.core.sphere.Sphere" class="sphx-glr-backref-module-dipy-core-sphere sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sphere</span></a><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s2">&quot;plasma&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">sfu</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sfu</span><span class="o">.</span><span class="n">RotateX</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sfu</span><span class="p">)</span>
<span class="n">window</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">scene</span><span class="o">=</span><span class="n">scene</span><span class="p">,</span> <span class="n">out_path</span><span class="o">=</span><span class="s2">&quot;odfs.png&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">))</span>
<span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">interactive</span></a><span class="p">:</span>
    <span class="n">window</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">scene</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_reconst_mapmri_005.png" srcset="../../_images/sphx_glr_reconst_mapmri_005.png" alt="reconst mapmri" class = "sphx-glr-single-img"/><p class="centered small fst-italic fw-semibold">Orientation distribution functions (ODFs).</p>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div class="docutils container" id="id20">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-ozarslan2013" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id2">2</a>,<a role="doc-backlink" href="#id10">3</a>,<a role="doc-backlink" href="#id12">4</a>,<a role="doc-backlink" href="#id15">5</a>,<a role="doc-backlink" href="#id17">6</a>,<a role="doc-backlink" href="#id18">7</a>)</span>
<p>Evren Özarslan, Cheng Guan Koay, Timothy M. Shepherd, Michal E. Komlosh, M. Okan İrfanoǧlu, Carlo Pierpaoli, and Peter J. Basser. Mean apparent propagator (MAP) MRI: A novel diffusion imaging method for mapping tissue microstructure. <em>NeuroImage</em>, 78:16–32, 2013. URL: <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2013.04.016">https://doi.org/10.1016/j.neuroimage.2013.04.016</a>, <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2013.04.016">doi:10.1016/j.neuroimage.2013.04.016</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-delahaije2020" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id3">1</a>,<a role="doc-backlink" href="#id9">2</a>)</span>
<p>Tom Dela Haije, Evren Özarslan, and Aasa Feragen. Enforcing necessary non-negativity constraints for common diffusion MRI models using sum of squares programming. <em>NeuroImage</em>, 209:116405, 2020. URL: <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2019.116405">https://doi.org/10.1016/j.neuroimage.2019.116405</a>, <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2019.116405">doi:10.1016/j.neuroimage.2019.116405</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-fick2016b" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id4">1</a>,<a role="doc-backlink" href="#id5">2</a>,<a role="doc-backlink" href="#id6">3</a>,<a role="doc-backlink" href="#id8">4</a>,<a role="doc-backlink" href="#id11">5</a>,<a role="doc-backlink" href="#id16">6</a>)</span>
<p>Rutger H. J. Fick, Demian Wassermann, Emmanuel Caruyer, and Rachid Deriche. MAPL: Tissue microstructure estimation using Laplacian-regularized MAP-MRI and its application to HCP data. <em>NeuroImage</em>, 134:365–385, July 2016. URL: <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2016.03.046">https://doi.org/10.1016/j.neuroimage.2016.03.046</a>, <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2016.03.046">doi:10.1016/j.neuroimage.2016.03.046</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-craven1979" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">4</a><span class="fn-bracket">]</span></span>
<p>Peter Craven and Grace Wahba. Smoothing Noisy Data with Spline Functions - Estimating the Correct Degree of Smoothing by the Method of Generalized Cross-Validation. <em>Numerische Mathematik</em>, 31(4):377–403, 1979. <a class="reference external" href="https://doi.org/">doi:</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-hosseinbor2013" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">5</a><span class="fn-bracket">]</span></span>
<p>A. Pasha Hosseinbor, Moo K. Chung, Yu-Chien Wu, and Andrew L. Alexander. Bessel Fourier Orientation Reconstruction (BFOR): An analytical diffusion propagator reconstruction for hybrid diffusion imaging and computation of q-space indices. <em>NeuroImage</em>, 64:650–670, 2013. URL: <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2012.08.072">https://doi.org/10.1016/j.neuroimage.2012.08.072</a>, <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2012.08.072">doi:10.1016/j.neuroimage.2012.08.072</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-fick2016a" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id14">1</a>,<a role="doc-backlink" href="#id19">2</a>)</span>
<p>Rutger H. J. Fick, MArco Pizzolato, Demian Wassermann, Mauro Zucchelli, Gloria Menegaz, and Rachid Deriche. A sensitivity analysis of q-space indices with respect to changes in axonal diameter, dispersion and tissue composition. In <em>IEEE 13th International Symposium on Biomedical Imaging (ISBI)</em>, volume, 1241–1244. April 2016. <a class="reference external" href="https://doi.org/10.1109/ISBI.2016.7493491">doi:10.1109/ISBI.2016.7493491</a>.</p>
</aside>
</aside>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (18 minutes 40.585 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-built-reconstruction-reconst-mapmri-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b05bd8ab46894d1aee9a7cbefcee8317/reconst_mapmri.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">reconst_mapmri.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/ff62abb666b7a370e048f0b2cffd9a35/reconst_mapmri.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">reconst_mapmri.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e324981ce4d141e8adae0d82377171ea/reconst_mapmri.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">reconst_mapmri.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reconst_mcsd.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Reconstruction with Multi-Shell Multi-Tissue CSD</p>
      </div>
    </a>
    <a class="right-next"
       href="reconst_csd.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Reconstruction with Constrained Spherical Deconvolution model (CSD)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  
<script type="module" src="../../_static/scripts/grg-sphinx-theme.js"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><div>
  <h3 class="footer-heading">
    Never miss an update from us!
  </h3>
  <p class="footer-sub-heading">
    Don't worry! we are not going to spam you.
  </p>
  <div class="input-group mb-3 mar-t-10">
    <input type="text" class="form-control" placeholder="You email" aria-label="You email" id="grg-subscribe-email">
    <div class="input-group-append pointer" onclick="(document.getElementById('grg-subscribe-email').value)">
      <span class="input-group-text subscribe">Subscribe</span>
    </div>
  </div>  
  <ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/dipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/dipymri" title="Twitter/X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter/X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/diffusionimaginginpython" title="YouTube" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-youtube fa-lg" aria-hidden="true"></i>
            <span class="sr-only">YouTube</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/dipy/" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul>
</div></div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="grid-3">
  
  <div>
    <h5 class="footer-heading">
      About
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://dipy.org/team">
            Developers
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://github.com/dipy/dipy/discussions" target="_blank" rel="noopener noreferrer">
            Support
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../user_guide/installation.html">
            Download
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../../user_guide/getting_started.html">
            Get Started
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="../index.html">
            Tutorials
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.youtube.com/c/diffusionimaginginpython" target="_blank" rel="noopener noreferrer">
            Videos
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Friends
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/" target="_blank" rel="noopener noreferrer">
            Nipy Projects
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://fury.gl/" target="_blank" rel="noopener noreferrer">
            FURY
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="http://nipy.org/nibabel" target="_blank" rel="noopener noreferrer">
            Nibabel
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://tortoise.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            Tortoise
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
  <div>
    <h5 class="footer-heading">
      Support
    </h5>
    <ul class="footer-section">
      
        
        <li class="pad-v-5">
          <a href="https://engineering.indiana.edu/" target="_blank" rel="noopener noreferrer">
            The department of Intelligent Systems Engineering of Indiana University
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://www.nibib.nih.gov/" target="_blank" rel="noopener noreferrer">
            The National Institute of Biomedical Imaging and Bioengineering, NIH
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://escience.washington.edu" target="_blank" rel="noopener noreferrer">
            The Gordon and Betty Moore Foundation and the Alfred P. Sloan Foundation, through the University of Washington eScience Institute Data Science Environment
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
        
        <li class="pad-v-5">
          <a href="https://summerofcode.withgoogle.com/" target="_blank" rel="noopener noreferrer">
            Google supported DIPY through the Google Summer of Code Program (2015-2024)
            <i class="fa-solid fa-arrow-up-long mar-l-5"></i>
          </a>
        </li>
        
      
    </ul>
  </div>
  
</div></div>
      
    </div>
  
</div>

    <div class="copyright-text">
      <i class="fa-regular fa-copyright"></i> Copyright 2008-2024,DIPY developers. Created using Grg Sphinx Theme and PyData Sphinx Theme.
    </div>
  </footer>
  </body>
</html>